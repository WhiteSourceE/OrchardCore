Æ
ÄD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\AdminMenu.cs
	namespace 	
OrchardCore
 
. 
Tenants 
{ 
public		 

class		 
	AdminMenu		 
:		 
INavigationProvider		 0
{

 
private 
readonly 
ShellSettings &
_shellSettings' 5
;5 6
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public 
	AdminMenu 
( 
IStringLocalizer )
<) *
	AdminMenu* 3
>3 4
	localizer5 >
,> ?
ShellSettings@ M
shellSettingsN [
)[ \
{ 	
_shellSettings 
= 
shellSettings *
;* +
S 
= 
	localizer 
; 
} 	
public 
Task  
BuildNavigationAsync (
(( )
string) /
name0 4
,4 5
NavigationBuilder6 G
builderH O
)O P
{ 	
if 
( 
! 
String 
. 
Equals 
( 
name #
,# $
$str% ,
,, -
StringComparison. >
.> ?
OrdinalIgnoreCase? P
)P Q
)Q R
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
if 
( 
_shellSettings 
. 
Name #
!=$ &
ShellHelper' 2
.2 3
DefaultShellName3 C
)C D
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
builder!! 
."" 
Add"" 
("" 
S"" 
["" 
$str"" &
]""& '
,""' (
configuration"") 6
=>""7 9
configuration"": G
.## 
AddClass## 
(## 
$str## 2
)##2 3
.##3 4
Id##4 6
(##6 7
$str##7 F
)##F G
.$$ 
Add$$ 
($$ 
S$$ 
[$$ 
$str$$ $
]$$$ %
,$$% &
$str$$' ,
+$$- .
S$$/ 0
[$$0 1
$str$$1 :
]$$: ;
,$$; <

deployment$$= G
=>$$H J

deployment$$K U
.%% 
Action%% 
(%%  
$str%%  '
,%%' (
$str%%) 0
,%%0 1
new%%2 5
{%%6 7
area%%8 <
=%%= >
$str%%? T
}%%U V
)%%V W
.&& 

Permission&& #
(&&# $
Permissions&&$ /
.&&/ 0
ManageTenants&&0 =
)&&= >
.'' 
LocalNav'' !
(''! "
)''" #
)(( 
))) 
;)) 
return++ 
Task++ 
.++ 
CompletedTask++ %
;++% &
},, 	
}-- 
}.. ›ô
íD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Controllers\AdminController.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
Controllers )
{ 
public 

class 
AdminController  
:! "

Controller# -
{ 
private 
readonly 

IShellHost #

_shellHost$ .
;. /
private 
readonly !
IShellSettingsManager .!
_shellSettingsManager/ D
;D E
private 
readonly 
IEnumerable $
<$ %
DatabaseProvider% 5
>5 6
_databaseProviders7 I
;I J
private   
readonly   !
IAuthorizationService   .!
_authorizationService  / D
;  D E
private!! 
readonly!! 
ShellSettings!! &!
_currentShellSettings!!' <
;!!< =
private"" 
readonly"" 
IEnumerable"" $
<""$ %
IRecipeHarvester""% 5
>""5 6
_recipeHarvesters""7 H
;""H I
private## 
readonly## #
IDataProtectionProvider## 0"
_dataProtectorProvider##1 G
;##G H
private$$ 
readonly$$ 
IClock$$ 
_clock$$  &
;$$& '
private%% 
readonly%% 
	INotifier%% "
	_notifier%%# ,
;%%, -
private&& 
readonly&& 
ISiteService&& %
_siteService&&& 2
;&&2 3
private(( 
readonly(( 
dynamic((  
New((! $
;(($ %
private)) 
readonly)) 
IStringLocalizer)) )
S))* +
;))+ ,
private** 
readonly** 
IHtmlLocalizer** '
H**( )
;**) *
public,, 
AdminController,, 
(,, 

IShellHost-- 
	shellHost--  
,--  !!
IShellSettingsManager.. ! 
shellSettingsManager.." 6
,..6 7
IEnumerable// 
<// 
DatabaseProvider// (
>//( )
databaseProviders//* ;
,//; <!
IAuthorizationService00 ! 
authorizationService00" 6
,006 7
ShellSettings11  
currentShellSettings11 .
,11. /
IEnumerable22 
<22 
IRecipeHarvester22 (
>22( )
recipeHarvesters22* :
,22: ;#
IDataProtectionProvider33 #!
dataProtectorProvider33$ 9
,339 :
IClock44 
clock44 
,44 
	INotifier55 
notifier55 
,55 
ISiteService66 
siteService66 $
,66$ %
IShapeFactory77 
shapeFactory77 &
,77& '
IStringLocalizer88 
<88 
AdminController88 ,
>88, -
stringLocalizer88. =
,88= >
IHtmlLocalizer99 
<99 
AdminController99 *
>99* +
htmlLocalizer99, 9
)999 :
{:: 	

_shellHost;; 
=;; 
	shellHost;; "
;;;" #!
_authorizationService<< !
=<<" # 
authorizationService<<$ 8
;<<8 9!
_shellSettingsManager== !
===" # 
shellSettingsManager==$ 8
;==8 9
_databaseProviders>> 
=>>  
databaseProviders>>! 2
;>>2 3!
_currentShellSettings?? !
=??" # 
currentShellSettings??$ 8
;??8 9"
_dataProtectorProvider@@ "
=@@# $!
dataProtectorProvider@@% :
;@@: ;
_recipeHarvestersAA 
=AA 
recipeHarvestersAA  0
;AA0 1
_clockBB 
=BB 
clockBB 
;BB 
	_notifierCC 
=CC 
notifierCC  
;CC  !
_siteServiceDD 
=DD 
siteServiceDD &
;DD& '
NewFF 
=FF 
shapeFactoryFF 
;FF 
SGG 
=GG 
stringLocalizerGG 
;GG  
HHH 
=HH 
htmlLocalizerHH 
;HH 
}II 	
publicKK 
asyncKK 
TaskKK 
<KK 
IActionResultKK '
>KK' (
IndexKK) .
(KK. /
TenantIndexOptionsKK/ A
optionsKKB I
,KKI J
PagerParametersKKK Z
pagerParametersKK[ j
)KKj k
{LL 	
ifMM 
(MM 
!MM 
awaitMM !
_authorizationServiceMM ,
.MM, -
AuthorizeAsyncMM- ;
(MM; <
UserMM< @
,MM@ A
PermissionsMMB M
.MMM N
ManageTenantsMMN [
)MM[ \
)MM\ ]
{NN 
returnOO 
ForbidOO 
(OO 
)OO 
;OO  
}PP 
ifRR 
(RR 
!RR 
IsDefaultShellRR 
(RR  
)RR  !
)RR! "
{SS 
returnTT 
ForbidTT 
(TT 
)TT 
;TT  
}UU 
varWW 
allSettingsWW 
=WW 

_shellHostWW (
.WW( )
GetAllSettingsWW) 7
(WW7 8
)WW8 9
.WW9 :
OrderByWW: A
(WWA B
sWWB C
=>WWD F
sWWG H
.WWH I
NameWWI M
)WWM N
;WWN O
varXX 
dataProtectorXX 
=XX "
_dataProtectorProviderXX  6
.XX6 7
CreateProtectorXX7 F
(XXF G
$strXXG O
)XXO P
.XXP Q&
ToTimeLimitedDataProtectorXXQ k
(XXk l
)XXl m
;XXm n
varZZ 
siteSettingsZZ 
=ZZ 
awaitZZ $
_siteServiceZZ% 1
.ZZ1 2 
GetSiteSettingsAsyncZZ2 F
(ZZF G
)ZZG H
;ZZH I
var[[ 
pager[[ 
=[[ 
new[[ 
Pager[[ !
([[! "
pagerParameters[[" 1
,[[1 2
siteSettings[[3 ?
.[[? @
PageSize[[@ H
)[[H I
;[[I J
var]] 
entries]] 
=]] 
allSettings]] %
.]]% &
Select]]& ,
(]], -
x]]- .
=>]]/ 1
{^^ 
var__ 
entry__ 
=__ 
new__  #
ShellSettingsEntry__$ 6
{`` 
Descriptionaa #
=aa$ %
xaa& '
[aa' (
$straa( 5
]aa5 6
,aa6 7
Namebb 
=bb 
xbb  
.bb  !
Namebb! %
,bb% &
ShellSettingscc %
=cc& '
xcc( )
,cc) *
IsDefaultTenantdd '
=dd( )
Stringdd* 0
.dd0 1
Equalsdd1 7
(dd7 8
xdd8 9
.dd9 :
Namedd: >
,dd> ?
ShellHelperdd@ K
.ddK L
DefaultShellNameddL \
,dd\ ]
StringComparisondd^ n
.ddn o
OrdinalIgnoreCase	ddo Ä
)
ddÄ Å
}ee 
;ee 
ifgg 
(gg 
xgg 
.gg 
Stategg 
==gg  "
TenantStategg# .
.gg. /
Uninitializedgg/ <
&&gg= ?
!gg@ A
StringggA G
.ggG H
IsNullOrEmptyggH U
(ggU V
xggV W
[ggW X
$strggX `
]gg` a
)gga b
)ggb c
{hh 
entryii 
.ii 
Tokenii #
=ii$ %
dataProtectorii& 3
.ii3 4
Protectii4 ;
(ii; <
xii< =
[ii= >
$strii> F
]iiF G
,iiG H
_clockiiI O
.iiO P
UtcNowiiP V
.iiV W
AddiiW Z
(iiZ [
newii[ ^
TimeSpanii_ g
(iig h
$numiih j
,iij k
$numiil m
,iim n
$numiio p
)iip q
)iiq r
)iir s
;iis t
}jj 
returnll 
entryll  
;ll  !
}mm 
)mm 
.mm 
ToListmm 
(mm 
)mm 
;mm 
ifoo 
(oo 
!oo 
Stringoo 
.oo 
IsNullOrWhiteSpaceoo *
(oo* +
optionsoo+ 2
.oo2 3
Searchoo3 9
)oo9 :
)oo: ;
{pp 
entriesqq 
=qq 
entriesqq !
.qq! "
Whereqq" '
(qq' (
tqq( )
=>qq* ,
tqq- .
.qq. /
Nameqq/ 3
.qq3 4
IndexOfqq4 ;
(qq; <
optionsqq< C
.qqC D
SearchqqD J
,qqJ K
StringComparisonqqL \
.qq\ ]
OrdinalIgnoreCaseqq] n
)qqn o
>qqp q
-qqr s
$numqqs t
||qqu w
(rr 
trr 
.rr 
ShellSettingsrr $
!=rr% '
nullrr( ,
&&rr- /
(ss 
(ss 
tss 
.ss 
ShellSettingsss &
.ss& '
RequestUrlHostss' 5
!=ss6 8
nullss9 =
&&ss> @
tssA B
.ssB C
ShellSettingsssC P
.ssP Q
RequestUrlHostssQ _
.ss_ `
IndexOfss` g
(ssg h
optionsssh o
.sso p
Searchssp v
,ssv w
StringComparison	ssx à
.
ssà â
OrdinalIgnoreCase
ssâ ö
)
ssö õ
>
ssú ù
-
ssû ü
$num
ssü †
)
ss† °
||
ss¢ §
(tt 
ttt 
.tt 
ShellSettingstt %
.tt% &
RequestUrlPrefixtt& 6
!=tt7 9
nulltt: >
&&tt? A
tttB C
.ttC D
ShellSettingsttD Q
.ttQ R
RequestUrlPrefixttR b
.ttb c
IndexOfttc j
(ttj k
optionsttk r
.ttr s
Searchtts y
,tty z
StringComparison	tt{ ã
.
ttã å
OrdinalIgnoreCase
ttå ù
)
ttù û
>
ttü †
-
tt° ¢
$num
tt¢ £
)
tt£ §
)
tt§ •
)
tt• ¶
)
tt¶ ß
.
ttß ®
ToList
tt® Æ
(
ttÆ Ø
)
ttØ ∞
;
tt∞ ±
}uu 
switchww 
(ww 
optionsww 
.ww 
Filterww "
)ww" #
{xx 
caseyy 
TenantsFilteryy "
.yy" #
Disabledyy# +
:yy+ ,
entrieszz 
=zz 
entrieszz %
.zz% &
Wherezz& +
(zz+ ,
tzz, -
=>zz. 0
tzz1 2
.zz2 3
ShellSettingszz3 @
.zz@ A
StatezzA F
==zzG I
TenantStatezzJ U
.zzU V
DisabledzzV ^
)zz^ _
.zz_ `
ToListzz` f
(zzf g
)zzg h
;zzh i
break{{ 
;{{ 
case|| 
TenantsFilter|| "
.||" #
Running||# *
:||* +
entries}} 
=}} 
entries}} %
.}}% &
Where}}& +
(}}+ ,
t}}, -
=>}}. 0
t}}1 2
.}}2 3
ShellSettings}}3 @
.}}@ A
State}}A F
==}}G I
TenantState}}J U
.}}U V
Running}}V ]
)}}] ^
.}}^ _
ToList}}_ e
(}}e f
)}}f g
;}}g h
break~~ 
;~~ 
case 
TenantsFilter "
." #
Uninitialized# 0
:0 1
entries
ÄÄ 
=
ÄÄ 
entries
ÄÄ %
.
ÄÄ% &
Where
ÄÄ& +
(
ÄÄ+ ,
t
ÄÄ, -
=>
ÄÄ. 0
t
ÄÄ1 2
.
ÄÄ2 3
ShellSettings
ÄÄ3 @
.
ÄÄ@ A
State
ÄÄA F
==
ÄÄG I
TenantState
ÄÄJ U
.
ÄÄU V
Uninitialized
ÄÄV c
)
ÄÄc d
.
ÄÄd e
ToList
ÄÄe k
(
ÄÄk l
)
ÄÄl m
;
ÄÄm n
break
ÅÅ 
;
ÅÅ 
}
ÇÇ 
switch
ÑÑ 
(
ÑÑ 
options
ÑÑ 
.
ÑÑ 
OrderBy
ÑÑ #
)
ÑÑ# $
{
ÖÖ 
case
ÜÜ 
TenantsOrder
ÜÜ !
.
ÜÜ! "
Name
ÜÜ" &
:
ÜÜ& '
entries
áá 
=
áá 
entries
áá %
.
áá% &
OrderBy
áá& -
(
áá- .
t
áá. /
=>
áá0 2
t
áá3 4
.
áá4 5
Name
áá5 9
)
áá9 :
.
áá: ;
ToList
áá; A
(
ááA B
)
ááB C
;
ááC D
break
àà 
;
àà 
case
ââ 
TenantsOrder
ââ !
.
ââ! "
State
ââ" '
:
ââ' (
entries
ää 
=
ää 
entries
ää %
.
ää% &
OrderBy
ää& -
(
ää- .
t
ää. /
=>
ää0 2
t
ää3 4
.
ää4 5
ShellSettings
ää5 B
?
ääB C
.
ääC D
State
ääD I
)
ääI J
.
ääJ K
ToList
ääK Q
(
ääQ R
)
ääR S
;
ääS T
break
ãã 
;
ãã 
default
åå 
:
åå 
entries
çç 
=
çç 
entries
çç %
.
çç% &
OrderByDescending
çç& 7
(
çç7 8
t
çç8 9
=>
çç: <
t
çç= >
.
çç> ?
Name
çç? C
)
ççC D
.
ççD E
ToList
ççE K
(
ççK L
)
ççL M
;
ççM N
break
éé 
;
éé 
}
èè 
var
êê 
count
êê 
=
êê 
entries
êê 
.
êê  
Count
êê  %
(
êê% &
)
êê& '
;
êê' (
var
íí 
results
íí 
=
íí 
entries
íí !
.
ìì 
Skip
ìì 
(
ìì 
pager
ìì 
.
ìì 
GetStartIndex
ìì )
(
ìì) *
)
ìì* +
)
ìì+ ,
.
îî 
Take
îî 
(
îî 
pager
îî 
.
îî 
PageSize
îî $
)
îî$ %
.
îî% &
ToList
îî& ,
(
îî, -
)
îî- .
;
îî. /
var
óó 
	routeData
óó 
=
óó 
new
óó 
	RouteData
óó  )
(
óó) *
)
óó* +
;
óó+ ,
	routeData
òò 
.
òò 
Values
òò 
.
òò 
Add
òò  
(
òò  !
$str
òò! 1
,
òò1 2
options
òò3 :
.
òò: ;
Filter
òò; A
)
òòA B
;
òòB C
	routeData
ôô 
.
ôô 
Values
ôô 
.
ôô 
Add
ôô  
(
ôô  !
$str
ôô! 1
,
ôô1 2
options
ôô3 :
.
ôô: ;
Search
ôô; A
)
ôôA B
;
ôôB C
	routeData
öö 
.
öö 
Values
öö 
.
öö 
Add
öö  
(
öö  !
$str
öö! 2
,
öö2 3
options
öö4 ;
.
öö; <
OrderBy
öö< C
)
ööC D
;
ööD E
var
úú 

pagerShape
úú 
=
úú 
(
úú 
await
úú #
New
úú$ '
.
úú' (
Pager
úú( -
(
úú- .
pager
úú. 3
)
úú3 4
)
úú4 5
.
úú5 6
TotalItemCount
úú6 D
(
úúD E
count
úúE J
)
úúJ K
.
úúK L
	RouteData
úúL U
(
úúU V
	routeData
úúV _
)
úú_ `
;
úú` a
var
ûû 
model
ûû 
=
ûû 
new
ûû !
AdminIndexViewModel
ûû /
{
üü "
ShellSettingsEntries
†† $
=
††% &
results
††' .
,
††. /
Options
°° 
=
°° 
options
°° !
,
°°! "
Pager
¢¢ 
=
¢¢ 

pagerShape
¢¢ "
}
££ 
;
££ 
model
¶¶ 
.
¶¶ 
Options
¶¶ 
.
¶¶ 
TenantsStates
¶¶ '
=
¶¶( )
new
¶¶* -
List
¶¶. 2
<
¶¶2 3
SelectListItem
¶¶3 A
>
¶¶A B
(
¶¶B C
)
¶¶C D
{
¶¶E F
new
ßß 
SelectListItem
ßß "
(
ßß" #
)
ßß# $
{
ßß% &
Text
ßß' +
=
ßß, -
S
ßß. /
[
ßß/ 0
$str
ßß0 <
]
ßß< =
,
ßß= >
Value
ßß? D
=
ßßE F
nameof
ßßG M
(
ßßM N
TenantsFilter
ßßN [
.
ßß[ \
All
ßß\ _
)
ßß_ `
}
ßßa b
,
ßßb c
new
®® 
SelectListItem
®® "
(
®®" #
)
®®# $
{
®®% &
Text
®®' +
=
®®, -
S
®®. /
[
®®/ 0
$str
®®0 9
]
®®9 :
,
®®: ;
Value
®®< A
=
®®B C
nameof
®®D J
(
®®J K
TenantsFilter
®®K X
.
®®X Y
Running
®®Y `
)
®®` a
}
®®b c
,
®®c d
new
©© 
SelectListItem
©© "
(
©©" #
)
©©# $
{
©©% &
Text
©©' +
=
©©, -
S
©©. /
[
©©/ 0
$str
©©0 :
]
©©: ;
,
©©; <
Value
©©= B
=
©©C D
nameof
©©E K
(
©©K L
TenantsFilter
©©L Y
.
©©Y Z
Disabled
©©Z b
)
©©b c
}
©©d e
,
©©e f
new
™™ 
SelectListItem
™™ "
(
™™" #
)
™™# $
{
™™% &
Text
™™' +
=
™™, -
S
™™. /
[
™™/ 0
$str
™™0 ?
]
™™? @
,
™™@ A
Value
™™B G
=
™™H I
nameof
™™J P
(
™™P Q
TenantsFilter
™™Q ^
.
™™^ _
Uninitialized
™™_ l
)
™™l m
}
™™n o
}
´´ 
;
´´ 
model
≠≠ 
.
≠≠ 
Options
≠≠ 
.
≠≠ 
TenantsSorts
≠≠ &
=
≠≠' (
new
≠≠) ,
List
≠≠- 1
<
≠≠1 2
SelectListItem
≠≠2 @
>
≠≠@ A
(
≠≠A B
)
≠≠B C
{
≠≠D E
new
ÆÆ 
SelectListItem
ÆÆ "
(
ÆÆ" #
)
ÆÆ# $
{
ÆÆ% &
Text
ÆÆ' +
=
ÆÆ, -
S
ÆÆ. /
[
ÆÆ/ 0
$str
ÆÆ0 6
]
ÆÆ6 7
,
ÆÆ7 8
Value
ÆÆ9 >
=
ÆÆ? @
nameof
ÆÆA G
(
ÆÆG H
TenantsOrder
ÆÆH T
.
ÆÆT U
Name
ÆÆU Y
)
ÆÆY Z
}
ÆÆ[ \
,
ÆÆ\ ]
new
ØØ 
SelectListItem
ØØ "
(
ØØ" #
)
ØØ# $
{
ØØ% &
Text
ØØ' +
=
ØØ, -
S
ØØ. /
[
ØØ/ 0
$str
ØØ0 7
]
ØØ7 8
,
ØØ8 9
Value
ØØ: ?
=
ØØ@ A
nameof
ØØB H
(
ØØH I
TenantsOrder
ØØI U
.
ØØU V
State
ØØV [
)
ØØ[ \
}
ØØ] ^
}
∞∞ 
;
∞∞ 
model
≤≤ 
.
≤≤ 
Options
≤≤ 
.
≤≤ 
TenantsBulkAction
≤≤ +
=
≤≤, -
new
≤≤. 1
List
≤≤2 6
<
≤≤6 7
SelectListItem
≤≤7 E
>
≤≤E F
(
≤≤F G
)
≤≤G H
{
≤≤I J
new
≥≥ 
SelectListItem
≥≥ "
(
≥≥" #
)
≥≥# $
{
≥≥% &
Text
≥≥' +
=
≥≥, -
S
≥≥. /
[
≥≥/ 0
$str
≥≥0 9
]
≥≥9 :
,
≥≥: ;
Value
≥≥< A
=
≥≥B C
nameof
≥≥D J
(
≥≥J K
TenantsBulkAction
≥≥K \
.
≥≥\ ]
Disable
≥≥] d
)
≥≥d e
}
≥≥f g
,
≥≥g h
new
¥¥ 
SelectListItem
¥¥ "
(
¥¥" #
)
¥¥# $
{
¥¥% &
Text
¥¥' +
=
¥¥, -
S
¥¥. /
[
¥¥/ 0
$str
¥¥0 8
]
¥¥8 9
,
¥¥9 :
Value
¥¥; @
=
¥¥A B
nameof
¥¥C I
(
¥¥I J
TenantsBulkAction
¥¥J [
.
¥¥[ \
Enable
¥¥\ b
)
¥¥b c
}
¥¥d e
}
µµ 
;
µµ 
return
∑∑ 
View
∑∑ 
(
∑∑ 
model
∑∑ 
)
∑∑ 
;
∑∑ 
}
∏∏ 	
[
∫∫ 	
HttpPost
∫∫	 
,
∫∫ 

ActionName
∫∫ 
(
∫∫ 
$str
∫∫ %
)
∫∫% &
]
∫∫& '
[
ªª 	
FormValueRequired
ªª	 
(
ªª 
$str
ªª *
)
ªª* +
]
ªª+ ,
public
ºº 
ActionResult
ºº 
IndexFilterPOST
ºº +
(
ºº+ ,!
AdminIndexViewModel
ºº, ?
model
ºº@ E
)
ººE F
{
ΩΩ 	
return
ææ 
RedirectToAction
ææ #
(
ææ# $
$str
ææ$ +
,
ææ+ ,
new
ææ- 0"
RouteValueDictionary
ææ1 E
{
ææF G
{
øø 
$str
øø "
,
øø" #
model
øø$ )
.
øø) *
Options
øø* 1
.
øø1 2
Filter
øø2 8
}
øø9 :
,
øø: ;
{
¿¿ 
$str
¿¿ #
,
¿¿# $
model
¿¿% *
.
¿¿* +
Options
¿¿+ 2
.
¿¿2 3
OrderBy
¿¿3 :
}
¿¿; <
,
¿¿< =
{
¡¡ 
$str
¡¡ "
,
¡¡" #
model
¡¡$ )
.
¡¡) *
Options
¡¡* 1
.
¡¡1 2
Search
¡¡2 8
}
¡¡9 :
,
¡¡: ;
{
¬¬ 
$str
¬¬ )
,
¬¬) *
model
¬¬+ 0
.
¬¬0 1
Options
¬¬1 8
.
¬¬8 9
TenantsStates
¬¬9 F
}
¬¬G H
}
√√ 
)
√√ 
;
√√ 
}
ƒƒ 	
[
∆∆ 	
HttpPost
∆∆	 
]
∆∆ 
[
«« 	
FormValueRequired
««	 
(
«« 
$str
«« .
)
««. /
]
««/ 0
public
»» 
async
»» 
Task
»» 
<
»» 
IActionResult
»» '
>
»»' (
Index
»») .
(
»». /!
BulkActionViewModel
»»/ B
model
»»C H
)
»»H I
{
…… 	
if
   
(
   
!
   
await
   #
_authorizationService
   ,
.
  , -
AuthorizeAsync
  - ;
(
  ; <
User
  < @
,
  @ A
Permissions
  B M
.
  M N
ManageTenants
  N [
)
  [ \
)
  \ ]
{
ÀÀ 
return
ÃÃ 
Forbid
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ  
}
ÕÕ 
if
œœ 
(
œœ 
!
œœ 
IsDefaultShell
œœ 
(
œœ  
)
œœ  !
)
œœ! "
{
–– 
return
—— 
Forbid
—— 
(
—— 
)
—— 
;
——  
}
““ 
var
‘‘ 
allSettings
‘‘ 
=
‘‘ 

_shellHost
‘‘ (
.
‘‘( )
GetAllSettings
‘‘) 7
(
‘‘7 8
)
‘‘8 9
;
‘‘9 :
foreach
÷÷ 
(
÷÷ 
var
÷÷ 

tenantName
÷÷ #
in
÷÷$ &
model
÷÷' ,
.
÷÷, -
TenantNames
÷÷- 8
??
÷÷9 ;

Enumerable
÷÷< F
.
÷÷F G
Empty
÷÷G L
<
÷÷L M
string
÷÷M S
>
÷÷S T
(
÷÷T U
)
÷÷U V
)
÷÷V W
{
◊◊ 
var
ÿÿ 
shellSettings
ÿÿ !
=
ÿÿ" #
allSettings
ÿÿ$ /
.
ŸŸ 
Where
ŸŸ 
(
ŸŸ 
x
ŸŸ 
=>
ŸŸ 
String
ŸŸ  &
.
ŸŸ& '
Equals
ŸŸ' -
(
ŸŸ- .
x
ŸŸ. /
.
ŸŸ/ 0
Name
ŸŸ0 4
,
ŸŸ4 5

tenantName
ŸŸ6 @
,
ŸŸ@ A
StringComparison
ŸŸB R
.
ŸŸR S
OrdinalIgnoreCase
ŸŸS d
)
ŸŸd e
)
ŸŸe f
.
⁄⁄ 
FirstOrDefault
⁄⁄ #
(
⁄⁄# $
)
⁄⁄$ %
;
⁄⁄% &
if
‹‹ 
(
‹‹ 
shellSettings
‹‹ !
==
‹‹" $
null
‹‹% )
)
‹‹) *
{
›› 
break
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
switch
·· 
(
·· 
model
·· 
.
·· 

BulkAction
·· (
.
··( )
ToString
··) 1
(
··1 2
)
··2 3
)
··3 4
{
‚‚ 
case
„„ 
$str
„„ "
:
„„" #
if
‰‰ 
(
‰‰ 
String
‰‰ "
.
‰‰" #
Equals
‰‰# )
(
‰‰) *
shellSettings
‰‰* 7
.
‰‰7 8
Name
‰‰8 <
,
‰‰< =
ShellHelper
‰‰> I
.
‰‰I J
DefaultShellName
‰‰J Z
,
‰‰Z [
StringComparison
‰‰\ l
.
‰‰l m
OrdinalIgnoreCase
‰‰m ~
)
‰‰~ 
)‰‰ Ä
{
ÂÂ 
	_notifier
ÊÊ %
.
ÊÊ% &
Warning
ÊÊ& -
(
ÊÊ- .
H
ÊÊ. /
[
ÊÊ/ 0
$str
ÊÊ0 X
]
ÊÊX Y
)
ÊÊY Z
;
ÊÊZ [
}
ÁÁ 
else
ËË 
if
ËË 
(
ËË  !
shellSettings
ËË! .
.
ËË. /
State
ËË/ 4
!=
ËË5 7
TenantState
ËË8 C
.
ËËC D
Running
ËËD K
)
ËËK L
{
ÈÈ 
	_notifier
ÍÍ %
.
ÍÍ% &
Warning
ÍÍ& -
(
ÍÍ- .
H
ÍÍ. /
[
ÍÍ/ 0
$str
ÍÍ0 W
,
ÍÍW X
shellSettings
ÍÍY f
.
ÍÍf g
Name
ÍÍg k
]
ÍÍk l
)
ÍÍl m
;
ÍÍm n
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
shellSettings
ÓÓ )
.
ÓÓ) *
State
ÓÓ* /
=
ÓÓ0 1
TenantState
ÓÓ2 =
.
ÓÓ= >
Disabled
ÓÓ> F
;
ÓÓF G
await
ÔÔ !

_shellHost
ÔÔ" ,
.
ÔÔ, -&
UpdateShellSettingsAsync
ÔÔ- E
(
ÔÔE F
shellSettings
ÔÔF S
)
ÔÔS T
;
ÔÔT U
}
 
break
ÚÚ 
;
ÚÚ 
case
ÙÙ 
$str
ÙÙ !
:
ÙÙ! "
if
ıı 
(
ıı 
shellSettings
ıı )
.
ıı) *
State
ıı* /
!=
ıı0 2
TenantState
ıı3 >
.
ıı> ?
Disabled
ıı? G
)
ııG H
{
ˆˆ 
	_notifier
˜˜ %
.
˜˜% &
Warning
˜˜& -
(
˜˜- .
H
˜˜. /
[
˜˜/ 0
$str
˜˜0 V
,
˜˜V W
shellSettings
˜˜X e
.
˜˜e f
Name
˜˜f j
]
˜˜j k
)
˜˜k l
;
˜˜l m
}
¯¯ 
else
˘˘ 
{
˙˙ 
shellSettings
˚˚ )
.
˚˚) *
State
˚˚* /
=
˚˚0 1
TenantState
˚˚2 =
.
˚˚= >
Running
˚˚> E
;
˚˚E F
await
¸¸ !

_shellHost
¸¸" ,
.
¸¸, -&
UpdateShellSettingsAsync
¸¸- E
(
¸¸E F
shellSettings
¸¸F S
)
¸¸S T
;
¸¸T U
}
˝˝ 
break
ˇˇ 
;
ˇˇ 
default
ÅÅ 
:
ÅÅ 
break
ÇÇ 
;
ÇÇ 
}
ÉÉ 
}
ÑÑ 
return
ÜÜ 
RedirectToAction
ÜÜ #
(
ÜÜ# $
nameof
ÜÜ$ *
(
ÜÜ* +
Index
ÜÜ+ 0
)
ÜÜ0 1
)
ÜÜ1 2
;
ÜÜ2 3
}
áá 	
public
ââ 
async
ââ 
Task
ââ 
<
ââ 
IActionResult
ââ '
>
ââ' (
Create
ââ) /
(
ââ/ 0
)
ââ0 1
{
ää 	
if
ãã 
(
ãã 
!
ãã 
await
ãã #
_authorizationService
ãã ,
.
ãã, -
AuthorizeAsync
ãã- ;
(
ãã; <
User
ãã< @
,
ãã@ A
Permissions
ããB M
.
ããM N
ManageTenants
ããN [
)
ãã[ \
)
ãã\ ]
{
åå 
return
çç 
Forbid
çç 
(
çç 
)
çç 
;
çç  
}
éé 
if
êê 
(
êê 
!
êê 
IsDefaultShell
êê 
(
êê  
)
êê  !
)
êê! "
{
ëë 
return
íí 
Forbid
íí 
(
íí 
)
íí 
;
íí  
}
ìì 
var
ïï 
recipeCollections
ïï !
=
ïï" #
await
ïï$ )
Task
ïï* .
.
ïï. /
WhenAll
ïï/ 6
(
ïï6 7
_recipeHarvesters
ïï7 H
.
ïïH I
Select
ïïI O
(
ïïO P
x
ïïP Q
=>
ïïR T
x
ïïU V
.
ïïV W!
HarvestRecipesAsync
ïïW j
(
ïïj k
)
ïïk l
)
ïïl m
)
ïïm n
;
ïïn o
var
ññ 
recipes
ññ 
=
ññ 
recipeCollections
ññ +
.
ññ+ ,

SelectMany
ññ, 6
(
ññ6 7
x
ññ7 8
=>
ññ9 ;
x
ññ< =
)
ññ= >
.
ññ> ?
Where
ññ? D
(
ññD E
x
ññE F
=>
ññG I
x
ññJ K
.
ññK L
IsSetupRecipe
ññL Y
)
ññY Z
.
ññZ [
OrderBy
ññ[ b
(
ññb c
r
ññc d
=>
ññe g
r
ññh i
.
ññi j
DisplayName
ññj u
)
ññu v
.
ññv w
ToArray
ññw ~
(
ññ~ 
)ññ Ä
;ññÄ Å
var
ôô 
shellSettings
ôô 
=
ôô #
_shellSettingsManager
ôô  5
.
ôô5 6#
CreateDefaultSettings
ôô6 K
(
ôôK L
)
ôôL M
;
ôôM N
var
õõ 
model
õõ 
=
õõ 
new
õõ !
EditTenantViewModel
õõ /
{
úú 
Recipes
ùù 
=
ùù 
recipes
ùù !
,
ùù! "
RequestUrlHost
ûû 
=
ûû  
shellSettings
ûû! .
.
ûû. /
RequestUrlHost
ûû/ =
,
ûû= >
RequestUrlPrefix
üü  
=
üü! "
shellSettings
üü# 0
.
üü0 1
RequestUrlPrefix
üü1 A
,
üüA B
TablePrefix
†† 
=
†† 
shellSettings
†† +
[
††+ ,
$str
††, 9
]
††9 :
,
††: ;

RecipeName
°° 
=
°° 
shellSettings
°° *
[
°°* +
$str
°°+ 7
]
°°7 8
}
¢¢ 
;
¢¢ )
SetConfigurationShellValues
££ '
(
££' (
model
££( -
)
££- .
;
££. /
model
•• 
.
•• 
Recipes
•• 
=
•• 
recipes
•• #
;
••# $
return
ßß 
View
ßß 
(
ßß 
model
ßß 
)
ßß 
;
ßß 
}
®® 	
[
™™ 	
HttpPost
™™	 
]
™™ 
public
´´ 
async
´´ 
Task
´´ 
<
´´ 
IActionResult
´´ '
>
´´' (
Create
´´) /
(
´´/ 0!
EditTenantViewModel
´´0 C
model
´´D I
)
´´I J
{
¨¨ 	
if
≠≠ 
(
≠≠ 
!
≠≠ 
await
≠≠ #
_authorizationService
≠≠ ,
.
≠≠, -
AuthorizeAsync
≠≠- ;
(
≠≠; <
User
≠≠< @
,
≠≠@ A
Permissions
≠≠B M
.
≠≠M N
ManageTenants
≠≠N [
)
≠≠[ \
)
≠≠\ ]
{
ÆÆ 
return
ØØ 
Forbid
ØØ 
(
ØØ 
)
ØØ 
;
ØØ  
}
∞∞ 
if
≤≤ 
(
≤≤ 
!
≤≤ 
IsDefaultShell
≤≤ 
(
≤≤  
)
≤≤  !
)
≤≤! "
{
≥≥ 
return
¥¥ 
Forbid
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥  
}
µµ 
if
∑∑ 
(
∑∑ 

ModelState
∑∑ 
.
∑∑ 
IsValid
∑∑ "
)
∑∑" #
{
∏∏ 
ValidateViewModel
ππ !
(
ππ! "
model
ππ" '
,
ππ' (
true
ππ) -
)
ππ- .
;
ππ. /
}
∫∫ 
if
ºº 
(
ºº 

ModelState
ºº 
.
ºº 
IsValid
ºº "
)
ºº" #
{
ΩΩ 
var
øø 
shellSettings
øø !
=
øø" ##
_shellSettingsManager
øø$ 9
.
øø9 :#
CreateDefaultSettings
øø: O
(
øøO P
)
øøP Q
;
øøQ R
shellSettings
¡¡ 
.
¡¡ 
Name
¡¡ "
=
¡¡# $
model
¡¡% *
.
¡¡* +
Name
¡¡+ /
;
¡¡/ 0
shellSettings
¬¬ 
.
¬¬ 
RequestUrlHost
¬¬ ,
=
¬¬- .
model
¬¬/ 4
.
¬¬4 5
RequestUrlHost
¬¬5 C
;
¬¬C D
shellSettings
√√ 
.
√√ 
RequestUrlPrefix
√√ .
=
√√/ 0
model
√√1 6
.
√√6 7
RequestUrlPrefix
√√7 G
;
√√G H
shellSettings
ƒƒ 
.
ƒƒ 
State
ƒƒ #
=
ƒƒ$ %
TenantState
ƒƒ& 1
.
ƒƒ1 2
Uninitialized
ƒƒ2 ?
;
ƒƒ? @)
SetConfigurationShellValues
∆∆ +
(
∆∆+ ,
model
∆∆, 1
)
∆∆1 2
;
∆∆2 3
shellSettings
«« 
[
«« 
$str
«« +
]
««+ ,
=
««- .
model
««/ 4
.
««4 5
Description
««5 @
;
««@ A
shellSettings
»» 
[
»» 
$str
»» 0
]
»»0 1
=
»»2 3
model
»»4 9
.
»»9 :
ConnectionString
»»: J
;
»»J K
shellSettings
…… 
[
…… 
$str
…… +
]
……+ ,
=
……- .
model
……/ 4
.
……4 5
TablePrefix
……5 @
;
……@ A
shellSettings
   
[
   
$str
   0
]
  0 1
=
  2 3
model
  4 9
.
  9 :
DatabaseProvider
  : J
;
  J K
shellSettings
ÀÀ 
[
ÀÀ 
$str
ÀÀ &
]
ÀÀ& '
=
ÀÀ( )
Guid
ÀÀ* .
.
ÀÀ. /
NewGuid
ÀÀ/ 6
(
ÀÀ6 7
)
ÀÀ7 8
.
ÀÀ8 9
ToString
ÀÀ9 A
(
ÀÀA B
)
ÀÀB C
;
ÀÀC D
shellSettings
ÃÃ 
[
ÃÃ 
$str
ÃÃ *
]
ÃÃ* +
=
ÃÃ, -
model
ÃÃ. 3
.
ÃÃ3 4

RecipeName
ÃÃ4 >
;
ÃÃ> ?
await
ŒŒ 

_shellHost
ŒŒ  
.
ŒŒ  !&
UpdateShellSettingsAsync
ŒŒ! 9
(
ŒŒ9 :
shellSettings
ŒŒ: G
)
ŒŒG H
;
ŒŒH I
return
–– 
RedirectToAction
–– '
(
––' (
nameof
––( .
(
––. /
Index
––/ 4
)
––4 5
)
––5 6
;
––6 7
}
—— 
var
”” 
recipeCollections
”” !
=
””" #
await
””$ )
Task
””* .
.
””. /
WhenAll
””/ 6
(
””6 7
_recipeHarvesters
””7 H
.
””H I
Select
””I O
(
””O P
x
””P Q
=>
””R T
x
””U V
.
””V W!
HarvestRecipesAsync
””W j
(
””j k
)
””k l
)
””l m
)
””m n
;
””n o
var
‘‘ 
recipes
‘‘ 
=
‘‘ 
recipeCollections
‘‘ +
.
‘‘+ ,

SelectMany
‘‘, 6
(
‘‘6 7
x
‘‘7 8
=>
‘‘9 ;
x
‘‘< =
)
‘‘= >
.
‘‘> ?
Where
‘‘? D
(
‘‘D E
x
‘‘E F
=>
‘‘G I
x
‘‘J K
.
‘‘K L
IsSetupRecipe
‘‘L Y
)
‘‘Y Z
.
‘‘Z [
OrderBy
‘‘[ b
(
‘‘b c
r
‘‘c d
=>
‘‘e g
r
‘‘h i
.
‘‘i j
DisplayName
‘‘j u
)
‘‘u v
.
‘‘v w
ToArray
‘‘w ~
(
‘‘~ 
)‘‘ Ä
;‘‘Ä Å
model
’’ 
.
’’ 
Recipes
’’ 
=
’’ 
recipes
’’ #
;
’’# $
return
ÿÿ 
View
ÿÿ 
(
ÿÿ 
model
ÿÿ 
)
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
public
€€ 
async
€€ 
Task
€€ 
<
€€ 
IActionResult
€€ '
>
€€' (
Edit
€€) -
(
€€- .
string
€€. 4
id
€€5 7
)
€€7 8
{
‹‹ 	
if
›› 
(
›› 
!
›› 
await
›› #
_authorizationService
›› ,
.
››, -
AuthorizeAsync
››- ;
(
››; <
User
››< @
,
››@ A
Permissions
››B M
.
››M N
ManageTenants
››N [
)
››[ \
)
››\ ]
{
ﬁﬁ 
return
ﬂﬂ 
Forbid
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ  
}
‡‡ 
if
‚‚ 
(
‚‚ 
!
‚‚ 
IsDefaultShell
‚‚ 
(
‚‚  
)
‚‚  !
)
‚‚! "
{
„„ 
return
‰‰ 
Forbid
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰  
}
ÂÂ 
var
ÁÁ 
shellSettings
ÁÁ 
=
ÁÁ 

_shellHost
ÁÁ  *
.
ÁÁ* +
GetAllSettings
ÁÁ+ 9
(
ÁÁ9 :
)
ÁÁ: ;
.
ËË 
Where
ËË 
(
ËË 
x
ËË 
=>
ËË 
String
ËË "
.
ËË" #
Equals
ËË# )
(
ËË) *
x
ËË* +
.
ËË+ ,
Name
ËË, 0
,
ËË0 1
id
ËË2 4
,
ËË4 5
StringComparison
ËË6 F
.
ËËF G
OrdinalIgnoreCase
ËËG X
)
ËËX Y
)
ËËY Z
.
ÈÈ 
FirstOrDefault
ÈÈ 
(
ÈÈ  
)
ÈÈ  !
;
ÈÈ! "
if
ÎÎ 
(
ÎÎ 
shellSettings
ÎÎ 
==
ÎÎ  
null
ÎÎ! %
)
ÎÎ% &
{
ÏÏ 
return
ÌÌ 
NotFound
ÌÌ 
(
ÌÌ  
)
ÌÌ  !
;
ÌÌ! "
}
ÓÓ 
var
 
model
 
=
 
new
 !
EditTenantViewModel
 /
{
ÒÒ 
Description
ÚÚ 
=
ÚÚ 
shellSettings
ÚÚ +
[
ÚÚ+ ,
$str
ÚÚ, 9
]
ÚÚ9 :
,
ÚÚ: ;
Name
ÛÛ 
=
ÛÛ 
shellSettings
ÛÛ $
.
ÛÛ$ %
Name
ÛÛ% )
,
ÛÛ) *
RequestUrlHost
ÙÙ 
=
ÙÙ  
shellSettings
ÙÙ! .
.
ÙÙ. /
RequestUrlHost
ÙÙ/ =
,
ÙÙ= >
RequestUrlPrefix
ıı  
=
ıı! "
shellSettings
ıı# 0
.
ıı0 1
RequestUrlPrefix
ıı1 A
,
ııA B
}
ˆˆ 
;
ˆˆ 
if
˙˙ 
(
˙˙ 
shellSettings
˙˙ 
.
˙˙ 
State
˙˙ #
==
˙˙$ &
TenantState
˙˙' 2
.
˙˙2 3
Uninitialized
˙˙3 @
)
˙˙@ A
{
˚˚ 
var
¸¸ 
recipeCollections
¸¸ %
=
¸¸& '
await
¸¸( -
Task
¸¸. 2
.
¸¸2 3
WhenAll
¸¸3 :
(
¸¸: ;
_recipeHarvesters
¸¸; L
.
¸¸L M
Select
¸¸M S
(
¸¸S T
x
¸¸T U
=>
¸¸V X
x
¸¸Y Z
.
¸¸Z [!
HarvestRecipesAsync
¸¸[ n
(
¸¸n o
)
¸¸o p
)
¸¸p q
)
¸¸q r
;
¸¸r s
var
˝˝ 
recipes
˝˝ 
=
˝˝ 
recipeCollections
˝˝ /
.
˝˝/ 0

SelectMany
˝˝0 :
(
˝˝: ;
x
˝˝; <
=>
˝˝= ?
x
˝˝@ A
)
˝˝A B
.
˝˝B C
Where
˝˝C H
(
˝˝H I
x
˝˝I J
=>
˝˝K M
x
˝˝N O
.
˝˝O P
IsSetupRecipe
˝˝P ]
)
˝˝] ^
.
˝˝^ _
OrderBy
˝˝_ f
(
˝˝f g
r
˝˝g h
=>
˝˝i k
r
˝˝l m
.
˝˝m n
DisplayName
˝˝n y
)
˝˝y z
.
˝˝z {
ToArray˝˝{ Ç
(˝˝Ç É
)˝˝É Ñ
;˝˝Ñ Ö
model
˛˛ 
.
˛˛ 
Recipes
˛˛ 
=
˛˛ 
recipes
˛˛  '
;
˛˛' (
model
ÄÄ 
.
ÄÄ 
DatabaseProvider
ÄÄ &
=
ÄÄ' (
shellSettings
ÄÄ) 6
[
ÄÄ6 7
$str
ÄÄ7 I
]
ÄÄI J
;
ÄÄJ K
model
ÅÅ 
.
ÅÅ 
TablePrefix
ÅÅ !
=
ÅÅ" #
shellSettings
ÅÅ$ 1
[
ÅÅ1 2
$str
ÅÅ2 ?
]
ÅÅ? @
;
ÅÅ@ A
model
ÇÇ 
.
ÇÇ 
ConnectionString
ÇÇ &
=
ÇÇ' (
shellSettings
ÇÇ) 6
[
ÇÇ6 7
$str
ÇÇ7 I
]
ÇÇI J
;
ÇÇJ K
model
ÉÉ 
.
ÉÉ 

RecipeName
ÉÉ  
=
ÉÉ! "
shellSettings
ÉÉ# 0
[
ÉÉ0 1
$str
ÉÉ1 =
]
ÉÉ= >
;
ÉÉ> ?
model
ÑÑ 
.
ÑÑ $
CanEditDatabasePresets
ÑÑ ,
=
ÑÑ- .
true
ÑÑ/ 3
;
ÑÑ3 4)
SetConfigurationShellValues
ÖÖ +
(
ÖÖ+ ,
model
ÖÖ, 1
)
ÖÖ1 2
;
ÖÖ2 3
}
ÜÜ 
return
àà 
View
àà 
(
àà 
model
àà 
)
àà 
;
àà 
}
ââ 	
[
ãã 	
HttpPost
ãã	 
]
ãã 
public
åå 
async
åå 
Task
åå 
<
åå 
IActionResult
åå '
>
åå' (
Edit
åå) -
(
åå- .!
EditTenantViewModel
åå. A
model
ååB G
)
ååG H
{
çç 	
if
éé 
(
éé 
!
éé 
await
éé #
_authorizationService
éé ,
.
éé, -
AuthorizeAsync
éé- ;
(
éé; <
User
éé< @
,
éé@ A
Permissions
ééB M
.
ééM N
ManageTenants
ééN [
)
éé[ \
)
éé\ ]
{
èè 
return
êê 
Forbid
êê 
(
êê 
)
êê 
;
êê  
}
ëë 
if
ìì 
(
ìì 
!
ìì 
IsDefaultShell
ìì 
(
ìì  
)
ìì  !
)
ìì! "
{
îî 
return
ïï 
Forbid
ïï 
(
ïï 
)
ïï 
;
ïï  
}
ññ 
if
òò 
(
òò 

ModelState
òò 
.
òò 
IsValid
òò "
)
òò" #
{
ôô 
ValidateViewModel
öö !
(
öö! "
model
öö" '
,
öö' (
false
öö) .
)
öö. /
;
öö/ 0
}
õõ 
var
ùù 
shellSettings
ùù 
=
ùù 

_shellHost
ùù  *
.
ùù* +
GetAllSettings
ùù+ 9
(
ùù9 :
)
ùù: ;
.
ûû 
Where
ûû 
(
ûû 
x
ûû 
=>
ûû 
String
ûû "
.
ûû" #
Equals
ûû# )
(
ûû) *
x
ûû* +
.
ûû+ ,
Name
ûû, 0
,
ûû0 1
model
ûû2 7
.
ûû7 8
Name
ûû8 <
,
ûû< =
StringComparison
ûû> N
.
ûûN O
OrdinalIgnoreCase
ûûO `
)
ûû` a
)
ûûa b
.
üü 
FirstOrDefault
üü 
(
üü  
)
üü  !
;
üü! "
if
°° 
(
°° 
shellSettings
°° 
==
°°  
null
°°! %
)
°°% &
{
¢¢ 
return
££ 
NotFound
££ 
(
££  
)
££  !
;
££! "
}
§§ 
if
¶¶ 
(
¶¶ 

ModelState
¶¶ 
.
¶¶ 
IsValid
¶¶ "
)
¶¶" #
{
ßß 
shellSettings
®® 
[
®® 
$str
®® +
]
®®+ ,
=
®®- .
model
®®/ 4
.
®®4 5
Description
®®5 @
;
®®@ A
shellSettings
©© 
.
©© 
RequestUrlPrefix
©© .
=
©©/ 0
model
©©1 6
.
©©6 7
RequestUrlPrefix
©©7 G
;
©©G H
shellSettings
™™ 
.
™™ 
RequestUrlHost
™™ ,
=
™™- .
model
™™/ 4
.
™™4 5
RequestUrlHost
™™5 C
;
™™C D
if
ÆÆ 
(
ÆÆ 
shellSettings
ÆÆ !
.
ÆÆ! "
State
ÆÆ" '
==
ÆÆ( *
TenantState
ÆÆ+ 6
.
ÆÆ6 7
Uninitialized
ÆÆ7 D
)
ÆÆD E
{
ØØ )
SetConfigurationShellValues
∞∞ /
(
∞∞/ 0
model
∞∞0 5
)
∞∞5 6
;
∞∞6 7
shellSettings
±± !
[
±±! "
$str
±±" 4
]
±±4 5
=
±±6 7
model
±±8 =
.
±±= >
DatabaseProvider
±±> N
;
±±N O
shellSettings
≤≤ !
[
≤≤! "
$str
≤≤" /
]
≤≤/ 0
=
≤≤1 2
model
≤≤3 8
.
≤≤8 9
TablePrefix
≤≤9 D
;
≤≤D E
shellSettings
≥≥ !
[
≥≥! "
$str
≥≥" 4
]
≥≥4 5
=
≥≥6 7
model
≥≥8 =
.
≥≥= >
ConnectionString
≥≥> N
;
≥≥N O
shellSettings
¥¥ !
[
¥¥! "
$str
¥¥" .
]
¥¥. /
=
¥¥0 1
model
¥¥2 7
.
¥¥7 8

RecipeName
¥¥8 B
;
¥¥B C
shellSettings
µµ !
[
µµ! "
$str
µµ" *
]
µµ* +
=
µµ, -
Guid
µµ. 2
.
µµ2 3
NewGuid
µµ3 :
(
µµ: ;
)
µµ; <
.
µµ< =
ToString
µµ= E
(
µµE F
)
µµF G
;
µµG H
}
∂∂ 
await
∏∏ 

_shellHost
∏∏  
.
∏∏  !&
UpdateShellSettingsAsync
∏∏! 9
(
∏∏9 :
shellSettings
∏∏: G
)
∏∏G H
;
∏∏H I
return
∫∫ 
RedirectToAction
∫∫ '
(
∫∫' (
nameof
∫∫( .
(
∫∫. /
Index
∫∫/ 4
)
∫∫4 5
)
∫∫5 6
;
∫∫6 7
}
ªª 
if
øø 
(
øø 
shellSettings
øø 
.
øø 
State
øø #
==
øø$ &
TenantState
øø' 2
.
øø2 3
Uninitialized
øø3 @
)
øø@ A
{
¿¿ 
model
¡¡ 
.
¡¡ 
DatabaseProvider
¡¡ &
=
¡¡' (
shellSettings
¡¡) 6
[
¡¡6 7
$str
¡¡7 I
]
¡¡I J
;
¡¡J K
model
¬¬ 
.
¬¬ 
TablePrefix
¬¬ !
=
¬¬" #
shellSettings
¬¬$ 1
[
¬¬1 2
$str
¬¬2 ?
]
¬¬? @
;
¬¬@ A
model
√√ 
.
√√ 
ConnectionString
√√ &
=
√√' (
shellSettings
√√) 6
[
√√6 7
$str
√√7 I
]
√√I J
;
√√J K
model
ƒƒ 
.
ƒƒ 

RecipeName
ƒƒ  
=
ƒƒ! "
shellSettings
ƒƒ# 0
[
ƒƒ0 1
$str
ƒƒ1 =
]
ƒƒ= >
;
ƒƒ> ?
model
≈≈ 
.
≈≈ $
CanEditDatabasePresets
≈≈ ,
=
≈≈- .
true
≈≈/ 3
;
≈≈3 4)
SetConfigurationShellValues
∆∆ +
(
∆∆+ ,
model
∆∆, 1
)
∆∆1 2
;
∆∆2 3
}
«« 
var
…… 
recipeCollections
…… !
=
……" #
await
……$ )
Task
……* .
.
……. /
WhenAll
……/ 6
(
……6 7
_recipeHarvesters
……7 H
.
……H I
Select
……I O
(
……O P
x
……P Q
=>
……R T
x
……U V
.
……V W!
HarvestRecipesAsync
……W j
(
……j k
)
……k l
)
……l m
)
……m n
;
……n o
var
   
recipes
   
=
   
recipeCollections
   +
.
  + ,

SelectMany
  , 6
(
  6 7
x
  7 8
=>
  9 ;
x
  < =
)
  = >
.
  > ?
Where
  ? D
(
  D E
x
  E F
=>
  G I
x
  J K
.
  K L
IsSetupRecipe
  L Y
)
  Y Z
.
  Z [
OrderBy
  [ b
(
  b c
r
  c d
=>
  e g
r
  h i
.
  i j
DisplayName
  j u
)
  u v
.
  v w
ToArray
  w ~
(
  ~ 
)   Ä
;  Ä Å
model
ÀÀ 
.
ÀÀ 
Recipes
ÀÀ 
=
ÀÀ 
recipes
ÀÀ #
;
ÀÀ# $
return
ŒŒ 
View
ŒŒ 
(
ŒŒ 
model
ŒŒ 
)
ŒŒ 
;
ŒŒ 
}
œœ 	
[
—— 	
HttpPost
——	 
]
—— 
public
““ 
async
““ 
Task
““ 
<
““ 
IActionResult
““ '
>
““' (
Disable
““) 0
(
““0 1
string
““1 7
id
““8 :
)
““: ;
{
”” 	
if
‘‘ 
(
‘‘ 
!
‘‘ 
await
‘‘ #
_authorizationService
‘‘ ,
.
‘‘, -
AuthorizeAsync
‘‘- ;
(
‘‘; <
User
‘‘< @
,
‘‘@ A
Permissions
‘‘B M
.
‘‘M N
ManageTenants
‘‘N [
)
‘‘[ \
)
‘‘\ ]
{
’’ 
return
÷÷ 
Forbid
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷  
}
◊◊ 
if
ŸŸ 
(
ŸŸ 
!
ŸŸ 
IsDefaultShell
ŸŸ 
(
ŸŸ  
)
ŸŸ  !
)
ŸŸ! "
{
⁄⁄ 
return
€€ 
Forbid
€€ 
(
€€ 
)
€€ 
;
€€  
}
‹‹ 
var
ﬁﬁ 
shellSettings
ﬁﬁ 
=
ﬁﬁ 

_shellHost
ﬁﬁ  *
.
ﬁﬁ* +
GetAllSettings
ﬁﬁ+ 9
(
ﬁﬁ9 :
)
ﬁﬁ: ;
.
ﬂﬂ 
Where
ﬂﬂ 
(
ﬂﬂ 
s
ﬂﬂ 
=>
ﬂﬂ 
String
ﬂﬂ "
.
ﬂﬂ" #
Equals
ﬂﬂ# )
(
ﬂﬂ) *
s
ﬂﬂ* +
.
ﬂﬂ+ ,
Name
ﬂﬂ, 0
,
ﬂﬂ0 1
id
ﬂﬂ2 4
,
ﬂﬂ4 5
StringComparison
ﬂﬂ6 F
.
ﬂﬂF G
OrdinalIgnoreCase
ﬂﬂG X
)
ﬂﬂX Y
)
ﬂﬂY Z
.
‡‡ 
FirstOrDefault
‡‡ 
(
‡‡  
)
‡‡  !
;
‡‡! "
if
‚‚ 
(
‚‚ 
shellSettings
‚‚ 
==
‚‚  
null
‚‚! %
)
‚‚% &
{
„„ 
return
‰‰ 
NotFound
‰‰ 
(
‰‰  
)
‰‰  !
;
‰‰! "
}
ÂÂ 
if
ÁÁ 
(
ÁÁ 
String
ÁÁ 
.
ÁÁ 
Equals
ÁÁ 
(
ÁÁ 
shellSettings
ÁÁ +
.
ÁÁ+ ,
Name
ÁÁ, 0
,
ÁÁ0 1
ShellHelper
ÁÁ2 =
.
ÁÁ= >
DefaultShellName
ÁÁ> N
,
ÁÁN O
StringComparison
ÁÁP `
.
ÁÁ` a
OrdinalIgnoreCase
ÁÁa r
)
ÁÁr s
)
ÁÁs t
{
ËË 
	_notifier
ÈÈ 
.
ÈÈ 
Error
ÈÈ 
(
ÈÈ  
H
ÈÈ  !
[
ÈÈ! "
$str
ÈÈ" J
]
ÈÈJ K
)
ÈÈK L
;
ÈÈL M
return
ÍÍ 
RedirectToAction
ÍÍ '
(
ÍÍ' (
nameof
ÍÍ( .
(
ÍÍ. /
Index
ÍÍ/ 4
)
ÍÍ4 5
)
ÍÍ5 6
;
ÍÍ6 7
}
ÎÎ 
if
ÌÌ 
(
ÌÌ 
shellSettings
ÌÌ 
.
ÌÌ 
State
ÌÌ #
!=
ÌÌ$ &
TenantState
ÌÌ' 2
.
ÌÌ2 3
Running
ÌÌ3 :
)
ÌÌ: ;
{
ÓÓ 
	_notifier
ÔÔ 
.
ÔÔ 
Error
ÔÔ 
(
ÔÔ  
H
ÔÔ  !
[
ÔÔ! "
$str
ÔÔ" K
]
ÔÔK L
)
ÔÔL M
;
ÔÔM N
return
 
RedirectToAction
 '
(
' (
nameof
( .
(
. /
Index
/ 4
)
4 5
)
5 6
;
6 7
}
ÒÒ 
shellSettings
ÛÛ 
.
ÛÛ 
State
ÛÛ 
=
ÛÛ  !
TenantState
ÛÛ" -
.
ÛÛ- .
Disabled
ÛÛ. 6
;
ÛÛ6 7
await
ÙÙ 

_shellHost
ÙÙ 
.
ÙÙ &
UpdateShellSettingsAsync
ÙÙ 5
(
ÙÙ5 6
shellSettings
ÙÙ6 C
)
ÙÙC D
;
ÙÙD E
return
ˆˆ 
RedirectToAction
ˆˆ #
(
ˆˆ# $
nameof
ˆˆ$ *
(
ˆˆ* +
Index
ˆˆ+ 0
)
ˆˆ0 1
)
ˆˆ1 2
;
ˆˆ2 3
}
˜˜ 	
[
˘˘ 	
HttpPost
˘˘	 
]
˘˘ 
public
˙˙ 
async
˙˙ 
Task
˙˙ 
<
˙˙ 
IActionResult
˙˙ '
>
˙˙' (
Enable
˙˙) /
(
˙˙/ 0
string
˙˙0 6
id
˙˙7 9
)
˙˙9 :
{
˚˚ 	
if
¸¸ 
(
¸¸ 
!
¸¸ 
await
¸¸ #
_authorizationService
¸¸ ,
.
¸¸, -
AuthorizeAsync
¸¸- ;
(
¸¸; <
User
¸¸< @
,
¸¸@ A
Permissions
¸¸B M
.
¸¸M N
ManageTenants
¸¸N [
)
¸¸[ \
)
¸¸\ ]
{
˝˝ 
return
˛˛ 
Forbid
˛˛ 
(
˛˛ 
)
˛˛ 
;
˛˛  
}
ˇˇ 
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
IsDefaultShell
ÅÅ 
(
ÅÅ  
)
ÅÅ  !
)
ÅÅ! "
{
ÇÇ 
return
ÉÉ 
Forbid
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ  
}
ÑÑ 
var
ÜÜ 
shellSettings
ÜÜ 
=
ÜÜ 

_shellHost
ÜÜ  *
.
ÜÜ* +
GetAllSettings
ÜÜ+ 9
(
ÜÜ9 :
)
ÜÜ: ;
.
áá 
Where
áá 
(
áá 
x
áá 
=>
áá 
String
áá "
.
áá" #
Equals
áá# )
(
áá) *
x
áá* +
.
áá+ ,
Name
áá, 0
,
áá0 1
id
áá2 4
,
áá4 5
StringComparison
áá6 F
.
ááF G
OrdinalIgnoreCase
ááG X
)
ááX Y
)
ááY Z
.
àà 
FirstOrDefault
àà 
(
àà  
)
àà  !
;
àà! "
if
ää 
(
ää 
shellSettings
ää 
==
ää  
null
ää! %
)
ää% &
{
ãã 
return
åå 
NotFound
åå 
(
åå  
)
åå  !
;
åå! "
}
çç 
if
èè 
(
èè 
shellSettings
èè 
.
èè 
State
èè #
!=
èè$ &
TenantState
èè' 2
.
èè2 3
Disabled
èè3 ;
)
èè; <
{
êê 
	_notifier
ëë 
.
ëë 
Error
ëë 
(
ëë  
H
ëë  !
[
ëë! "
$str
ëë" J
]
ëëJ K
)
ëëK L
;
ëëL M
}
íí 
shellSettings
îî 
.
îî 
State
îî 
=
îî  !
TenantState
îî" -
.
îî- .
Running
îî. 5
;
îî5 6
await
ïï 

_shellHost
ïï 
.
ïï &
UpdateShellSettingsAsync
ïï 5
(
ïï5 6
shellSettings
ïï6 C
)
ïïC D
;
ïïD E
return
óó 
RedirectToAction
óó #
(
óó# $
nameof
óó$ *
(
óó* +
Index
óó+ 0
)
óó0 1
)
óó1 2
;
óó2 3
}
òò 	
[
öö 	
HttpPost
öö	 
]
öö 
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
IActionResult
õõ '
>
õõ' (
Reload
õõ) /
(
õõ/ 0
string
õõ0 6
id
õõ7 9
)
õõ9 :
{
úú 	
if
ùù 
(
ùù 
!
ùù 
await
ùù #
_authorizationService
ùù ,
.
ùù, -
AuthorizeAsync
ùù- ;
(
ùù; <
User
ùù< @
,
ùù@ A
Permissions
ùùB M
.
ùùM N
ManageTenants
ùùN [
)
ùù[ \
)
ùù\ ]
{
ûû 
return
üü 
Forbid
üü 
(
üü 
)
üü 
;
üü  
}
†† 
if
¢¢ 
(
¢¢ 
!
¢¢ 
IsDefaultShell
¢¢ 
(
¢¢  
)
¢¢  !
)
¢¢! "
{
££ 
return
§§ 
Forbid
§§ 
(
§§ 
)
§§ 
;
§§  
}
•• 
var
ßß 
shellSettings
ßß 
=
ßß 

_shellHost
ßß  *
.
ßß* +
GetAllSettings
ßß+ 9
(
ßß9 :
)
ßß: ;
.
®® 
Where
®® 
(
®® 
x
®® 
=>
®® 
String
®® "
.
®®" #
Equals
®®# )
(
®®) *
x
®®* +
.
®®+ ,
Name
®®, 0
,
®®0 1
id
®®2 4
,
®®4 5
StringComparison
®®6 F
.
®®F G
OrdinalIgnoreCase
®®G X
)
®®X Y
)
®®Y Z
.
©© 
FirstOrDefault
©© 
(
©©  
)
©©  !
;
©©! "
if
´´ 
(
´´ 
shellSettings
´´ 
==
´´  
null
´´! %
)
´´% &
{
¨¨ 
return
≠≠ 
NotFound
≠≠ 
(
≠≠  
)
≠≠  !
;
≠≠! "
}
ÆÆ 
var
¥¥ 
redirectUrl
¥¥ 
=
¥¥ 
Url
¥¥ !
.
¥¥! "
Action
¥¥" (
(
¥¥( )
nameof
¥¥) /
(
¥¥/ 0
Index
¥¥0 5
)
¥¥5 6
)
¥¥6 7
;
¥¥7 8
await
∂∂ 

_shellHost
∂∂ 
.
∂∂ %
ReloadShellContextAsync
∂∂ 4
(
∂∂4 5
shellSettings
∂∂5 B
)
∂∂B C
;
∂∂C D
return
∏∏ 
Redirect
∏∏ 
(
∏∏ 
redirectUrl
∏∏ '
)
∏∏' (
;
∏∏( )
}
ππ 	
private
ªª 
void
ªª 
ValidateViewModel
ªª &
(
ªª& '!
EditTenantViewModel
ªª' :
model
ªª; @
,
ªª@ A
bool
ªªB F
	newTenant
ªªG P
)
ªªP Q
{
ºº 	
var
ΩΩ 
selectedProvider
ΩΩ  
=
ΩΩ! " 
_databaseProviders
ΩΩ# 5
.
ΩΩ5 6
FirstOrDefault
ΩΩ6 D
(
ΩΩD E
x
ΩΩE F
=>
ΩΩG I
x
ΩΩJ K
.
ΩΩK L
Value
ΩΩL Q
==
ΩΩR T
model
ΩΩU Z
.
ΩΩZ [
DatabaseProvider
ΩΩ[ k
)
ΩΩk l
;
ΩΩl m
if
øø 
(
øø 
selectedProvider
øø  
!=
øø! #
null
øø$ (
&&
øø) +
selectedProvider
øø, <
.
øø< =!
HasConnectionString
øø= P
&&
øøQ S
String
øøT Z
.
øøZ [ 
IsNullOrWhiteSpace
øø[ m
(
øøm n
model
øøn s
.
øøs t
ConnectionStringøøt Ñ
)øøÑ Ö
)øøÖ Ü
{
¿¿ 

ModelState
¡¡ 
.
¡¡ 
AddModelError
¡¡ (
(
¡¡( )
nameof
¡¡) /
(
¡¡/ 0!
EditTenantViewModel
¡¡0 C
.
¡¡C D
ConnectionString
¡¡D T
)
¡¡T U
,
¡¡U V
S
¡¡W X
[
¡¡X Y
$str¡¡Y ê
]¡¡ê ë
)¡¡ë í
;¡¡í ì
}
¬¬ 
if
ƒƒ 
(
ƒƒ 
String
ƒƒ 
.
ƒƒ  
IsNullOrWhiteSpace
ƒƒ )
(
ƒƒ) *
model
ƒƒ* /
.
ƒƒ/ 0
Name
ƒƒ0 4
)
ƒƒ4 5
)
ƒƒ5 6
{
≈≈ 

ModelState
∆∆ 
.
∆∆ 
AddModelError
∆∆ (
(
∆∆( )
nameof
∆∆) /
(
∆∆/ 0!
EditTenantViewModel
∆∆0 C
.
∆∆C D
Name
∆∆D H
)
∆∆H I
,
∆∆I J
S
∆∆K L
[
∆∆L M
$str
∆∆M l
]
∆∆l m
)
∆∆m n
;
∆∆n o
}
«« 
var
…… 
allSettings
…… 
=
…… 

_shellHost
…… (
.
……( )
GetAllSettings
……) 7
(
……7 8
)
……8 9
;
……9 :
if
ÀÀ 
(
ÀÀ 
	newTenant
ÀÀ 
&&
ÀÀ 
allSettings
ÀÀ (
.
ÀÀ( )
Any
ÀÀ) ,
(
ÀÀ, -
tenant
ÀÀ- 3
=>
ÀÀ4 6
String
ÀÀ7 =
.
ÀÀ= >
Equals
ÀÀ> D
(
ÀÀD E
tenant
ÀÀE K
.
ÀÀK L
Name
ÀÀL P
,
ÀÀP Q
model
ÀÀR W
.
ÀÀW X
Name
ÀÀX \
,
ÀÀ\ ]
StringComparison
ÀÀ^ n
.
ÀÀn o 
OrdinalIgnoreCaseÀÀo Ä
)ÀÀÄ Å
)ÀÀÅ Ç
)ÀÀÇ É
{
ÃÃ 

ModelState
ÕÕ 
.
ÕÕ 
AddModelError
ÕÕ (
(
ÕÕ( )
nameof
ÕÕ) /
(
ÕÕ/ 0!
EditTenantViewModel
ÕÕ0 C
.
ÕÕC D
Name
ÕÕD H
)
ÕÕH I
,
ÕÕI J
S
ÕÕK L
[
ÕÕL M
$str
ÕÕM z
,
ÕÕz {
modelÕÕ| Å
.ÕÕÅ Ç
NameÕÕÇ Ü
]ÕÕÜ á
)ÕÕá à
;ÕÕà â
}
ŒŒ 
if
–– 
(
–– 
!
–– 
String
–– 
.
–– 
IsNullOrEmpty
–– %
(
––% &
model
––& +
.
––+ ,
Name
––, 0
)
––0 1
&&
––2 4
!
––5 6
Regex
––6 ;
.
––; <
IsMatch
––< C
(
––C D
model
––D I
.
––I J
Name
––J N
,
––N O
$str
––P X
)
––X Y
)
––Y Z
{
—— 

ModelState
““ 
.
““ 
AddModelError
““ (
(
““( )
nameof
““) /
(
““/ 0!
EditTenantViewModel
““0 C
.
““C D
Name
““D H
)
““H I
,
““I J
S
““K L
[
““L M
$str““M è
]““è ê
)““ê ë
;““ë í
}
”” 
if
’’ 
(
’’ 
!
’’ 
IsDefaultShell
’’ 
(
’’  
)
’’  !
&&
’’" $
String
’’% +
.
’’+ , 
IsNullOrWhiteSpace
’’, >
(
’’> ?
model
’’? D
.
’’D E
RequestUrlHost
’’E S
)
’’S T
&&
’’U W
String
’’X ^
.
’’^ _ 
IsNullOrWhiteSpace
’’_ q
(
’’q r
model
’’r w
.
’’w x
RequestUrlPrefix’’x à
)’’à â
)’’â ä
{
÷÷ 

ModelState
◊◊ 
.
◊◊ 
AddModelError
◊◊ (
(
◊◊( )
nameof
◊◊) /
(
◊◊/ 0!
EditTenantViewModel
◊◊0 C
.
◊◊C D
RequestUrlPrefix
◊◊D T
)
◊◊T U
,
◊◊U V
S
◊◊W X
[
◊◊X Y
$str◊◊Y ë
]◊◊ë í
)◊◊í ì
;◊◊ì î
}
ÿÿ 
var
⁄⁄ 
allOtherShells
⁄⁄ 
=
⁄⁄  
allSettings
⁄⁄! ,
.
⁄⁄, -
Where
⁄⁄- 2
(
⁄⁄2 3
tenant
⁄⁄3 9
=>
⁄⁄: <
!
⁄⁄= >
string
⁄⁄> D
.
⁄⁄D E
Equals
⁄⁄E K
(
⁄⁄K L
tenant
⁄⁄L R
.
⁄⁄R S
Name
⁄⁄S W
,
⁄⁄W X
model
⁄⁄Y ^
.
⁄⁄^ _
Name
⁄⁄_ c
,
⁄⁄c d
StringComparison
⁄⁄e u
.
⁄⁄u v 
OrdinalIgnoreCase⁄⁄v á
)⁄⁄á à
)⁄⁄à â
;⁄⁄â ä
if
€€ 
(
€€ 
allOtherShells
€€ 
.
€€ 
Any
€€ "
(
€€" #
tenant
€€# )
=>
€€* ,
String
€€- 3
.
€€3 4
Equals
€€4 :
(
€€: ;
tenant
€€; A
.
€€A B
RequestUrlPrefix
€€B R
,
€€R S
model
€€T Y
.
€€Y Z
RequestUrlPrefix
€€Z j
?
€€j k
.
€€k l
Trim
€€l p
(
€€p q
)
€€q r
,
€€r s
StringComparison€€t Ñ
.€€Ñ Ö!
OrdinalIgnoreCase€€Ö ñ
)€€ñ ó
&&€€ò ö
String€€õ °
.€€° ¢
Equals€€¢ ®
(€€® ©
tenant€€© Ø
.€€Ø ∞
RequestUrlHost€€∞ æ
,€€æ ø
model€€¿ ≈
.€€≈ ∆
RequestUrlHost€€∆ ‘
,€€‘ ’ 
StringComparison€€÷ Ê
.€€Ê Á!
OrdinalIgnoreCase€€Á ¯
)€€¯ ˘
)€€˘ ˙
)€€˙ ˚
{
‹‹ 

ModelState
›› 
.
›› 
AddModelError
›› (
(
››( )
nameof
››) /
(
››/ 0!
EditTenantViewModel
››0 C
.
››C D
RequestUrlPrefix
››D T
)
››T U
,
››U V
S
››W X
[
››X Y
$str››Y ë
,››ë í
model››ì ò
.››ò ô
Name››ô ù
]››ù û
)››û ü
;››ü †
}
ﬁﬁ 
if
‡‡ 
(
‡‡ 
!
‡‡ 
String
‡‡ 
.
‡‡  
IsNullOrWhiteSpace
‡‡ *
(
‡‡* +
model
‡‡+ 0
.
‡‡0 1
RequestUrlPrefix
‡‡1 A
)
‡‡A B
)
‡‡B C
{
·· 
if
‚‚ 
(
‚‚ 
model
‚‚ 
.
‚‚ 
RequestUrlPrefix
‚‚ *
.
‚‚* +
Contains
‚‚+ 3
(
‚‚3 4
$char
‚‚4 7
)
‚‚7 8
)
‚‚8 9
{
„„ 

ModelState
‰‰ 
.
‰‰ 
AddModelError
‰‰ ,
(
‰‰, -
nameof
‰‰- 3
(
‰‰3 4!
EditTenantViewModel
‰‰4 G
.
‰‰G H
RequestUrlPrefix
‰‰H X
)
‰‰X Y
,
‰‰Y Z
S
‰‰[ \
[
‰‰\ ]
$str‰‰] î
]‰‰î ï
)‰‰ï ñ
;‰‰ñ ó
}
ÂÂ 
}
ÊÊ 
}
ÁÁ 	
private
ÈÈ 
bool
ÈÈ 
IsDefaultShell
ÈÈ #
(
ÈÈ# $
)
ÈÈ$ %
{
ÍÍ 	
return
ÎÎ 
String
ÎÎ 
.
ÎÎ 
Equals
ÎÎ  
(
ÎÎ  !#
_currentShellSettings
ÎÎ! 6
.
ÎÎ6 7
Name
ÎÎ7 ;
,
ÎÎ; <
ShellHelper
ÎÎ= H
.
ÎÎH I
DefaultShellName
ÎÎI Y
,
ÎÎY Z
StringComparison
ÎÎ[ k
.
ÎÎk l
OrdinalIgnoreCase
ÎÎl }
)
ÎÎ} ~
;
ÎÎ~ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ )
SetConfigurationShellValues
ÓÓ 0
(
ÓÓ0 1!
EditTenantViewModel
ÓÓ1 D
model
ÓÓE J
)
ÓÓJ K
{
ÔÔ 	
var
 
shellSettings
 
=
 #
_shellSettingsManager
  5
.
5 6#
CreateDefaultSettings
6 K
(
K L
)
L M
;
M N
var
ÒÒ 0
"configurationShellConnectionString
ÒÒ 2
=
ÒÒ3 4
shellSettings
ÒÒ5 B
[
ÒÒB C
$str
ÒÒC U
]
ÒÒU V
;
ÒÒV W
var
ÚÚ +
configurationDatabaseProvider
ÚÚ -
=
ÚÚ. /
shellSettings
ÚÚ0 =
[
ÚÚ= >
$str
ÚÚ> P
]
ÚÚP Q
;
ÚÚQ R
model
ÙÙ 
.
ÙÙ )
DatabaseConfigurationPreset
ÙÙ -
=
ÙÙ. /
!
ÙÙ0 1
string
ÙÙ1 7
.
ÙÙ7 8
IsNullOrEmpty
ÙÙ8 E
(
ÙÙE F0
"configurationShellConnectionString
ÙÙF h
)
ÙÙh i
||
ÙÙj l
!
ÙÙm n
string
ÙÙn t
.
ÙÙt u
IsNullOrEmptyÙÙu Ç
(ÙÙÇ É-
configurationDatabaseProviderÙÙÉ †
)ÙÙ† °
;ÙÙ° ¢
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
string
ˆˆ 
.
ˆˆ 
IsNullOrEmpty
ˆˆ $
(
ˆˆ$ %0
"configurationShellConnectionString
ˆˆ% G
)
ˆˆG H
)
ˆˆH I
{
˜˜ 
model
¯¯ 
.
¯¯ 
ConnectionString
¯¯ &
=
¯¯' (0
"configurationShellConnectionString
¯¯) K
;
¯¯K L
}
˘˘ 
if
˚˚ 
(
˚˚ 
!
˚˚ 
string
˚˚ 
.
˚˚ 
IsNullOrEmpty
˚˚ $
(
˚˚$ %+
configurationDatabaseProvider
˚˚% B
)
˚˚B C
)
˚˚C D
{
¸¸ 
model
˝˝ 
.
˝˝ 
DatabaseProvider
˝˝ &
=
˝˝' (+
configurationDatabaseProvider
˝˝) F
;
˝˝F G
}
˛˛ 
}
ˇˇ 	
}
ÄÄ 
}ÅÅ ·ˆ
êD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Controllers\ApiController.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
[ 
	Authorize 
( !
AuthenticationSchemes $
=% &
$str' ,
), -
,- ."
IgnoreAntiforgeryToken/ E
,E F
AllowAnonymousG U
]U V
public 

class 
ApiController 
:  

Controller! +
{   
private!! 
readonly!! 

IShellHost!! #

_shellHost!!$ .
;!!. /
private"" 
readonly"" 
ShellSettings"" &!
_currentShellSettings""' <
;""< =
private## 
readonly## !
IAuthorizationService## .!
_authorizationService##/ D
;##D E
private$$ 
readonly$$ !
IShellSettingsManager$$ .!
_shellSettingsManager$$/ D
;$$D E
private%% 
readonly%% #
IDataProtectionProvider%% 0"
_dataProtectorProvider%%1 G
;%%G H
private&& 
readonly&& 
ISetupService&& &
_setupService&&' 4
;&&4 5
private'' 
readonly'' 
IClock'' 
_clock''  &
;''& '
private(( 
readonly(( "
IEmailAddressValidator(( /"
_emailAddressValidator((0 F
;((F G
private)) 
readonly)) 
IdentityOptions)) (
_identityOptions))) 9
;))9 :
private** 
readonly** 
IEnumerable** $
<**$ %
DatabaseProvider**% 5
>**5 6
_databaseProviders**7 I
;**I J
private++ 
readonly++ 
IStringLocalizer++ )
S++* +
;+++ ,
public-- 
ApiController-- 
(-- 

IShellHost.. 
	shellHost..  
,..  !
ShellSettings//  
currentShellSettings// .
,//. /!
IAuthorizationService00 ! 
authorizationService00" 6
,006 7!
IShellSettingsManager11 ! 
shellSettingsManager11" 6
,116 7#
IDataProtectionProvider22 #!
dataProtectorProvider22$ 9
,229 :
ISetupService33 
setupService33 &
,33& '
IClock44 
clock44 
,44 "
IEmailAddressValidator55 "!
emailAddressValidator55# 8
,558 9
IOptions66 
<66 
IdentityOptions66 $
>66$ %
identityOptions66& 5
,665 6
IEnumerable77 
<77 
DatabaseProvider77 (
>77( )
databaseProviders77* ;
,77; <
IStringLocalizer88 
<88 
AdminController88 ,
>88, -
stringLocalizer88. =
)88= >
{99 	

_shellHost:: 
=:: 
	shellHost:: "
;::" #!
_currentShellSettings;; !
=;;" # 
currentShellSettings;;$ 8
;;;8 9!
_authorizationService<< !
=<<" # 
authorizationService<<$ 8
;<<8 9"
_dataProtectorProvider== "
===# $!
dataProtectorProvider==% :
;==: ;!
_shellSettingsManager>> !
=>>" # 
shellSettingsManager>>$ 8
;>>8 9
_setupService?? 
=?? 
setupService?? (
;??( )
_clock@@ 
=@@ 
clock@@ 
;@@ "
_emailAddressValidatorAA "
=AA# $!
emailAddressValidatorAA% :
;AA: ;
_identityOptionsBB 
=BB 
identityOptionsBB .
.BB. /
ValueBB/ 4
;BB4 5
_databaseProvidersCC 
=CC  
databaseProvidersCC! 2
;CC2 3
SDD 
=DD 
stringLocalizerDD 
;DD  
}EE 	
[GG 	
HttpPostGG	 
]GG 
[HH 	
RouteHH	 
(HH 
$strHH 
)HH 
]HH 
publicII 
asyncII 
TaskII 
<II 
IActionResultII '
>II' (
CreateII) /
(II/ 0
CreateApiViewModelII0 B
modelIIC H
)IIH I
{JJ 	
ifKK 
(KK 
!KK 
IsDefaultShellKK 
(KK  
)KK  !
)KK! "
{LL 
returnMM 
ForbidMM 
(MM 
)MM 
;MM  
}NN 
ifPP 
(PP 
!PP 
awaitPP !
_authorizationServicePP ,
.PP, -
AuthorizeAsyncPP- ;
(PP; <
UserPP< @
,PP@ A
PermissionsPPB M
.PPM N
ManageTenantsPPN [
)PP[ \
)PP\ ]
{QQ 
returnRR 
thisRR 
.RR 
ChallengeOrForbidRR -
(RR- .
$strRR. 3
)RR3 4
;RR4 5
}SS 
ifUU 
(UU 
!UU 
StringUU 
.UU 
IsNullOrEmptyUU %
(UU% &
modelUU& +
.UU+ ,
NameUU, 0
)UU0 1
&&UU2 4
!UU5 6
RegexUU6 ;
.UU; <
IsMatchUU< C
(UUC D
modelUUD I
.UUI J
NameUUJ N
,UUN O
$strUUP X
)UUX Y
)UUY Z
{VV 

ModelStateWW 
.WW 
AddModelErrorWW (
(WW( )
nameofWW) /
(WW/ 0
CreateApiViewModelWW0 B
.WWB C
NameWWC G
)WWG H
,WWH I
SWWJ K
[WWK L
$str	WWL é
]
WWé è
)
WWè ê
;
WWê ë
}XX 
var[[ 
shellSettings[[ 
=[[ !
_shellSettingsManager[[  5
.[[5 6!
CreateDefaultSettings[[6 K
([[K L
)[[L M
;[[M N
shellSettings]] 
.]] 
Name]] 
=]]  
model]]! &
.]]& '
Name]]' +
;]]+ ,
shellSettings^^ 
.^^ 
RequestUrlHost^^ (
=^^) *
model^^+ 0
.^^0 1
RequestUrlHost^^1 ?
;^^? @
shellSettings__ 
.__ 
RequestUrlPrefix__ *
=__+ ,
model__- 2
.__2 3
RequestUrlPrefix__3 C
;__C D
shellSettings`` 
.`` 
State`` 
=``  !
TenantState``" -
.``- .
Uninitialized``. ;
;``; <
shellSettingsbb 
[bb 
$strbb ,
]bb, -
=bb. /
modelbb0 5
.bb5 6
ConnectionStringbb6 F
;bbF G
shellSettingscc 
[cc 
$strcc '
]cc' (
=cc) *
modelcc+ 0
.cc0 1
TablePrefixcc1 <
;cc< =
shellSettingsdd 
[dd 
$strdd ,
]dd, -
=dd. /
modeldd0 5
.dd5 6
DatabaseProviderdd6 F
;ddF G
shellSettingsee 
[ee 
$stree "
]ee" #
=ee$ %
Guidee& *
.ee* +
NewGuidee+ 2
(ee2 3
)ee3 4
.ee4 5
ToStringee5 =
(ee= >
)ee> ?
;ee? @
shellSettingsff 
[ff 
$strff &
]ff& '
=ff( )
modelff* /
.ff/ 0

RecipeNameff0 :
;ff: ;
ifhh 
(hh 
Stringhh 
.hh 
IsNullOrWhiteSpacehh )
(hh) *
shellSettingshh* 7
.hh7 8
RequestUrlHosthh8 F
)hhF G
&&hhH J
StringhhK Q
.hhQ R
IsNullOrWhiteSpacehhR d
(hhd e
shellSettingshhe r
.hhr s
RequestUrlPrefix	hhs É
)
hhÉ Ñ
)
hhÑ Ö
{ii 

ModelStatejj 
.jj 
AddModelErrorjj (
(jj( )
nameofjj) /
(jj/ 0
CreateApiViewModeljj0 B
.jjB C
RequestUrlPrefixjjC S
)jjS T
,jjT U
SjjV W
[jjW X
$str	jjX ê
]
jjê ë
)
jjë í
;
jjí ì
}kk 
ifmm 
(mm 
!mm 
Stringmm 
.mm 
IsNullOrWhiteSpacemm *
(mm* +
shellSettingsmm+ 8
.mm8 9
RequestUrlPrefixmm9 I
)mmI J
)mmJ K
{nn 
ifoo 
(oo 
shellSettingsoo !
.oo! "
RequestUrlPrefixoo" 2
.oo2 3
Containsoo3 ;
(oo; <
$charoo< ?
)oo? @
)oo@ A
{pp 

ModelStateqq 
.qq 
AddModelErrorqq ,
(qq, -
nameofqq- 3
(qq3 4
CreateApiViewModelqq4 F
.qqF G
RequestUrlPrefixqqG W
)qqW X
,qqX Y
SqqZ [
[qq[ \
$str	qq\ ì
]
qqì î
)
qqî ï
;
qqï ñ
}rr 
}ss 
ifuu 
(uu 

ModelStateuu 
.uu 
IsValiduu "
)uu" #
{vv 
ifww 
(ww 

_shellHostww 
.ww 
TryGetSettingsww -
(ww- .
modelww. 3
.ww3 4
Nameww4 8
,ww8 9
outww: =
varww> A
settingswwB J
)wwJ K
)wwK L
{xx 
var{{ 
token{{ 
={{ 
CreateSetupToken{{  0
({{0 1
settings{{1 9
){{9 :
;{{: ;
return}} 

StatusCode}} %
(}}% &
$num}}& )
,}}) *
GetEncodedUrl}}+ 8
(}}8 9
settings}}9 A
,}}A B
token}}C H
)}}H I
)}}I J
;}}J K
}~~ 
else 
{
ÄÄ 
await
ÅÅ 

_shellHost
ÅÅ $
.
ÅÅ$ %&
UpdateShellSettingsAsync
ÅÅ% =
(
ÅÅ= >
shellSettings
ÅÅ> K
)
ÅÅK L
;
ÅÅL M
var
ÉÉ 
token
ÉÉ 
=
ÉÉ 
CreateSetupToken
ÉÉ  0
(
ÉÉ0 1
shellSettings
ÉÉ1 >
)
ÉÉ> ?
;
ÉÉ? @
return
ÖÖ 
Ok
ÖÖ 
(
ÖÖ 
GetEncodedUrl
ÖÖ +
(
ÖÖ+ ,
shellSettings
ÖÖ, 9
,
ÖÖ9 :
token
ÖÖ; @
)
ÖÖ@ A
)
ÖÖA B
;
ÖÖB C
}
ÜÜ 
}
áá 
return
ââ 

BadRequest
ââ 
(
ââ 

ModelState
ââ (
)
ââ( )
;
ââ) *
}
ää 	
[
åå 	
HttpPost
åå	 
]
åå 
[
çç 	
Route
çç	 
(
çç 
$str
çç 
)
çç 
]
çç 
public
éé 
async
éé 
Task
éé 
<
éé 
ActionResult
éé &
>
éé& '
Setup
éé( -
(
éé- .
SetupApiViewModel
éé. ?
model
éé@ E
)
ééE F
{
èè 	
if
êê 
(
êê 
!
êê 
IsDefaultShell
êê 
(
êê  
)
êê  !
)
êê! "
{
ëë 
return
íí 
this
íí 
.
íí 
ChallengeOrForbid
íí -
(
íí- .
$str
íí. 3
)
íí3 4
;
íí4 5
}
ìì 
if
ïï 
(
ïï 
!
ïï 
await
ïï #
_authorizationService
ïï ,
.
ïï, -
AuthorizeAsync
ïï- ;
(
ïï; <
User
ïï< @
,
ïï@ A
Permissions
ïïB M
.
ïïM N
ManageTenants
ïïN [
)
ïï[ \
)
ïï\ ]
{
ññ 
return
óó 
this
óó 
.
óó 
ChallengeOrForbid
óó -
(
óó- .
$str
óó. 3
)
óó3 4
;
óó4 5
}
òò 
if
öö 
(
öö 
!
öö 
String
öö 
.
öö 
IsNullOrEmpty
öö %
(
öö% &
model
öö& +
.
öö+ ,
UserName
öö, 4
)
öö4 5
&&
öö6 8
model
öö9 >
.
öö> ?
UserName
öö? G
.
ööG H
Any
ööH K
(
ööK L
c
ööL M
=>
ööN P
!
ööQ R
_identityOptions
ööR b
.
ööb c
User
ööc g
.
öög h(
AllowedUserNameCharactersööh Å
.ööÅ Ç
ContainsööÇ ä
(ööä ã
cööã å
)ööå ç
)ööç é
)ööé è
{
õõ 

ModelState
úú 
.
úú 
AddModelError
úú (
(
úú( )
nameof
úú) /
(
úú/ 0
model
úú0 5
.
úú5 6
UserName
úú6 >
)
úú> ?
,
úú? @
S
úúA B
[
úúB C
$strúúC Ñ
,úúÑ Ö
modelúúÜ ã
.úúã å
UserNameúúå î
]úúî ï
)úúï ñ
;úúñ ó
}
ùù 
if
†† 
(
†† 
!
†† 
String
†† 
.
†† 
IsNullOrEmpty
†† %
(
††% &
model
††& +
.
††+ ,
Email
††, 1
)
††1 2
&&
††3 5
!
††6 7$
_emailAddressValidator
††7 M
.
††M N
Validate
††N V
(
††V W
model
††W \
.
††\ ]
Email
††] b
)
††b c
)
††c d
{
°° 

ModelState
¢¢ 
.
¢¢ 
AddModelError
¢¢ (
(
¢¢( )
nameof
¢¢) /
(
¢¢/ 0
model
¢¢0 5
.
¢¢5 6
Email
¢¢6 ;
)
¢¢; <
,
¢¢< =
S
¢¢> ?
[
¢¢? @
$str
¢¢@ W
]
¢¢W X
)
¢¢X Y
;
¢¢Y Z
}
££ 
if
•• 
(
•• 
!
•• 

ModelState
•• 
.
•• 
IsValid
•• #
)
••# $
{
¶¶ 
return
ßß 

BadRequest
ßß !
(
ßß! "
)
ßß" #
;
ßß# $
}
®® 
if
™™ 
(
™™ 
!
™™ 

_shellHost
™™ 
.
™™ 
TryGetSettings
™™ *
(
™™* +
model
™™+ 0
.
™™0 1
Name
™™1 5
,
™™5 6
out
™™7 :
var
™™; >
shellSettings
™™? L
)
™™L M
)
™™M N
{
´´ 

ModelState
¨¨ 
.
¨¨ 
AddModelError
¨¨ (
(
¨¨( )
nameof
¨¨) /
(
¨¨/ 0
SetupApiViewModel
¨¨0 A
.
¨¨A B
Name
¨¨B F
)
¨¨F G
,
¨¨G H
S
¨¨I J
[
¨¨J K
$str
¨¨K d
,
¨¨d e
model
¨¨f k
.
¨¨k l
Name
¨¨l p
]
¨¨p q
)
¨¨q r
;
¨¨r s
}
≠≠ 
if
ØØ 
(
ØØ 
shellSettings
ØØ 
.
ØØ 
State
ØØ #
==
ØØ$ &
TenantState
ØØ' 2
.
ØØ2 3
Running
ØØ3 :
)
ØØ: ;
{
∞∞ 
return
±± 

StatusCode
±± !
(
±±! "
$num
±±" %
)
±±% &
;
±±& '
}
≤≤ 
if
¥¥ 
(
¥¥ 
shellSettings
¥¥ 
.
¥¥ 
State
¥¥ #
!=
¥¥$ &
TenantState
¥¥' 2
.
¥¥2 3
Uninitialized
¥¥3 @
)
¥¥@ A
{
µµ 
return
∂∂ 

BadRequest
∂∂ !
(
∂∂! "
S
∂∂" #
[
∂∂# $
$str
∂∂$ @
]
∂∂@ A
)
∂∂A B
;
∂∂B C
}
∑∑ 
var
ππ 
databaseProvider
ππ  
=
ππ! "
shellSettings
ππ# 0
[
ππ0 1
$str
ππ1 C
]
ππC D
;
ππD E
if
ªª 
(
ªª 
String
ªª 
.
ªª 
IsNullOrEmpty
ªª $
(
ªª$ %
databaseProvider
ªª% 5
)
ªª5 6
)
ªª6 7
{
ºº 
databaseProvider
ΩΩ  
=
ΩΩ! "
model
ΩΩ# (
.
ΩΩ( )
DatabaseProvider
ΩΩ) 9
;
ΩΩ9 :
}
ææ 
var
¿¿ 
selectedProvider
¿¿  
=
¿¿! " 
_databaseProviders
¿¿# 5
.
¿¿5 6
FirstOrDefault
¿¿6 D
(
¿¿D E
x
¿¿E F
=>
¿¿G I
String
¿¿J P
.
¿¿P Q
Equals
¿¿Q W
(
¿¿W X
x
¿¿X Y
.
¿¿Y Z
Value
¿¿Z _
,
¿¿_ `
databaseProvider
¿¿a q
,
¿¿q r
StringComparison¿¿s É
.¿¿É Ñ!
OrdinalIgnoreCase¿¿Ñ ï
)¿¿ï ñ
)¿¿ñ ó
;¿¿ó ò
if
¬¬ 
(
¬¬ 
selectedProvider
¬¬  
==
¬¬! #
null
¬¬$ (
)
¬¬( )
{
√√ 
return
ƒƒ 

BadRequest
ƒƒ !
(
ƒƒ! "
S
ƒƒ" #
[
ƒƒ# $
$str
ƒƒ$ K
]
ƒƒK L
)
ƒƒL M
;
ƒƒM N
}
≈≈ 
var
«« 
tablePrefix
«« 
=
«« 
shellSettings
«« +
[
««+ ,
$str
««, 9
]
««9 :
;
««: ;
if
…… 
(
…… 
String
…… 
.
…… 
IsNullOrEmpty
…… $
(
……$ %
tablePrefix
……% 0
)
……0 1
)
……1 2
{
   
tablePrefix
ÀÀ 
=
ÀÀ 
model
ÀÀ #
.
ÀÀ# $
TablePrefix
ÀÀ$ /
;
ÀÀ/ 0
}
ÃÃ 
var
ŒŒ 
connectionString
ŒŒ  
=
ŒŒ! "
shellSettings
ŒŒ# 0
[
ŒŒ0 1
$str
ŒŒ1 C
]
ŒŒC D
;
ŒŒD E
if
–– 
(
–– 
String
–– 
.
–– 
IsNullOrEmpty
–– $
(
––$ %
connectionString
––% 5
)
––5 6
)
––6 7
{
—— 
connectionString
““  
=
““! "
model
““# (
.
““( )
ConnectionString
““) 9
;
““9 :
}
”” 
if
’’ 
(
’’ 
selectedProvider
’’  
.
’’  !!
HasConnectionString
’’! 4
&&
’’5 7
String
’’8 >
.
’’> ?
IsNullOrEmpty
’’? L
(
’’L M
connectionString
’’M ]
)
’’] ^
)
’’^ _
{
÷÷ 
return
◊◊ 

BadRequest
◊◊ !
(
◊◊! "
S
◊◊" #
[
◊◊# $
$str
◊◊$ c
]
◊◊c d
)
◊◊d e
;
◊◊e f
}
ÿÿ 
var
⁄⁄ 

recipeName
⁄⁄ 
=
⁄⁄ 
shellSettings
⁄⁄ *
[
⁄⁄* +
$str
⁄⁄+ 7
]
⁄⁄7 8
;
⁄⁄8 9
if
‹‹ 
(
‹‹ 
String
‹‹ 
.
‹‹ 
IsNullOrEmpty
‹‹ $
(
‹‹$ %

recipeName
‹‹% /
)
‹‹/ 0
)
‹‹0 1
{
›› 

recipeName
ﬁﬁ 
=
ﬁﬁ 
model
ﬁﬁ "
.
ﬁﬁ" #

RecipeName
ﬁﬁ# -
;
ﬁﬁ- .
}
ﬂﬂ 
RecipeDescriptor
·· 
recipeDescriptor
·· -
=
··. /
null
··0 4
;
··4 5
if
„„ 
(
„„ 
String
„„ 
.
„„ 
IsNullOrEmpty
„„ $
(
„„$ %

recipeName
„„% /
)
„„/ 0
)
„„0 1
{
‰‰ 
if
ÂÂ 
(
ÂÂ 
model
ÂÂ 
.
ÂÂ 
Recipe
ÂÂ  
==
ÂÂ! #
null
ÂÂ$ (
)
ÂÂ( )
{
ÊÊ 
return
ÁÁ 

BadRequest
ÁÁ %
(
ÁÁ% &
S
ÁÁ& '
[
ÁÁ' (
$str
ÁÁ( V
]
ÁÁV W
)
ÁÁW X
;
ÁÁX Y
}
ËË 
var
ÍÍ 
tempFilename
ÍÍ  
=
ÍÍ! "
Path
ÍÍ# '
.
ÍÍ' (
GetTempFileName
ÍÍ( 7
(
ÍÍ7 8
)
ÍÍ8 9
;
ÍÍ9 :
using
ÏÏ 
(
ÏÏ 
var
ÏÏ 
fs
ÏÏ 
=
ÏÏ 
System
ÏÏ  &
.
ÏÏ& '
IO
ÏÏ' )
.
ÏÏ) *
File
ÏÏ* .
.
ÏÏ. /
Create
ÏÏ/ 5
(
ÏÏ5 6
tempFilename
ÏÏ6 B
)
ÏÏB C
)
ÏÏC D
{
ÌÌ 
await
ÓÓ 
model
ÓÓ 
.
ÓÓ  
Recipe
ÓÓ  &
.
ÓÓ& '
CopyToAsync
ÓÓ' 2
(
ÓÓ2 3
fs
ÓÓ3 5
)
ÓÓ5 6
;
ÓÓ6 7
}
ÔÔ 
var
ÒÒ 
fileProvider
ÒÒ  
=
ÒÒ! "
new
ÒÒ# &"
PhysicalFileProvider
ÒÒ' ;
(
ÒÒ; <
Path
ÒÒ< @
.
ÒÒ@ A
GetDirectoryName
ÒÒA Q
(
ÒÒQ R
tempFilename
ÒÒR ^
)
ÒÒ^ _
)
ÒÒ_ `
;
ÒÒ` a
recipeDescriptor
ÛÛ  
=
ÛÛ! "
new
ÛÛ# &
RecipeDescriptor
ÛÛ' 7
{
ÙÙ 
FileProvider
ıı  
=
ıı! "
fileProvider
ıı# /
,
ıı/ 0
BasePath
ˆˆ 
=
ˆˆ 
$str
ˆˆ !
,
ˆˆ! "
RecipeFileInfo
˜˜ "
=
˜˜# $
fileProvider
˜˜% 1
.
˜˜1 2
GetFileInfo
˜˜2 =
(
˜˜= >
Path
˜˜> B
.
˜˜B C
GetFileName
˜˜C N
(
˜˜N O
tempFilename
˜˜O [
)
˜˜[ \
)
˜˜\ ]
}
¯¯ 
;
¯¯ 
}
˘˘ 
else
˙˙ 
{
˚˚ 
var
¸¸ 
setupRecipes
¸¸  
=
¸¸! "
await
¸¸# (
_setupService
¸¸) 6
.
¸¸6 7"
GetSetupRecipesAsync
¸¸7 K
(
¸¸K L
)
¸¸L M
;
¸¸M N
recipeDescriptor
˝˝  
=
˝˝! "
setupRecipes
˝˝# /
.
˝˝/ 0
FirstOrDefault
˝˝0 >
(
˝˝> ?
x
˝˝? @
=>
˝˝A C
String
˝˝D J
.
˝˝J K
Equals
˝˝K Q
(
˝˝Q R
x
˝˝R S
.
˝˝S T
Name
˝˝T X
,
˝˝X Y

recipeName
˝˝Z d
,
˝˝d e
StringComparison
˝˝f v
.
˝˝v w 
OrdinalIgnoreCase˝˝w à
)˝˝à â
)˝˝â ä
;˝˝ä ã
if
ˇˇ 
(
ˇˇ 
recipeDescriptor
ˇˇ $
==
ˇˇ% '
null
ˇˇ( ,
)
ˇˇ, -
{
ÄÄ 
return
ÅÅ 

BadRequest
ÅÅ %
(
ÅÅ% &
S
ÅÅ& '
[
ÅÅ' (
$str
ÅÅ( A
,
ÅÅA B

recipeName
ÅÅC M
]
ÅÅM N
)
ÅÅN O
;
ÅÅO P
}
ÇÇ 
}
ÉÉ 
var
ÖÖ 
setupContext
ÖÖ 
=
ÖÖ 
new
ÖÖ "
SetupContext
ÖÖ# /
{
ÜÜ 
ShellSettings
áá 
=
áá 
shellSettings
áá  -
,
áá- .
EnabledFeatures
àà 
=
àà  !
null
àà" &
,
àà& '
Errors
ââ 
=
ââ 
new
ââ 

Dictionary
ââ '
<
ââ' (
string
ââ( .
,
ââ. /
string
ââ0 6
>
ââ6 7
(
ââ7 8
)
ââ8 9
,
ââ9 :
Recipe
ää 
=
ää 
recipeDescriptor
ää )
,
ää) *

Properties
ãã 
=
ãã 
new
ãã  

Dictionary
ãã! +
<
ãã+ ,
string
ãã, 2
,
ãã2 3
object
ãã4 :
>
ãã: ;
{
åå 
{
çç 
SetupConstants
çç $
.
çç$ %
SiteName
çç% -
,
çç- .
model
çç/ 4
.
çç4 5
SiteName
çç5 =
}
çç> ?
,
çç? @
{
éé 
SetupConstants
éé $
.
éé$ %
AdminUsername
éé% 2
,
éé2 3
model
éé4 9
.
éé9 :
UserName
éé: B
}
ééC D
,
ééD E
{
èè 
SetupConstants
èè $
.
èè$ %

AdminEmail
èè% /
,
èè/ 0
model
èè1 6
.
èè6 7
Email
èè7 <
}
èè= >
,
èè> ?
{
êê 
SetupConstants
êê $
.
êê$ %
AdminPassword
êê% 2
,
êê2 3
model
êê4 9
.
êê9 :
Password
êê: B
}
êêC D
,
êêD E
{
ëë 
SetupConstants
ëë $
.
ëë$ %
SiteTimeZone
ëë% 1
,
ëë1 2
model
ëë3 8
.
ëë8 9
SiteTimeZone
ëë9 E
}
ëëF G
,
ëëG H
{
íí 
SetupConstants
íí $
.
íí$ %
DatabaseProvider
íí% 5
,
íí5 6
selectedProvider
íí7 G
.
ííG H
Value
ííH M
}
ííN O
,
ííO P
{
ìì 
SetupConstants
ìì $
.
ìì$ %&
DatabaseConnectionString
ìì% =
,
ìì= >
connectionString
ìì? O
}
ììP Q
,
ììQ R
{
îî 
SetupConstants
îî $
.
îî$ %!
DatabaseTablePrefix
îî% 8
,
îî8 9
tablePrefix
îî: E
}
îîF G
,
îîG H
}
ïï 
}
ññ 
;
ññ 
var
òò 
executionId
òò 
=
òò 
await
òò #
_setupService
òò$ 1
.
òò1 2

SetupAsync
òò2 <
(
òò< =
setupContext
òò= I
)
òòI J
;
òòJ K
if
õõ 
(
õõ 
setupContext
õõ 
.
õõ 
Errors
õõ #
.
õõ# $
Any
õõ$ '
(
õõ' (
)
õõ( )
)
õõ) *
{
úú 
foreach
ùù 
(
ùù 
var
ùù 
error
ùù "
in
ùù# %
setupContext
ùù& 2
.
ùù2 3
Errors
ùù3 9
)
ùù9 :
{
ûû 

ModelState
üü 
.
üü 
AddModelError
üü ,
(
üü, -
error
üü- 2
.
üü2 3
Key
üü3 6
,
üü6 7
error
üü8 =
.
üü= >
Value
üü> C
)
üüC D
;
üüD E
}
†† 
return
¢¢ 

StatusCode
¢¢ !
(
¢¢! "
$num
¢¢" %
,
¢¢% &

ModelState
¢¢' 1
)
¢¢1 2
;
¢¢2 3
}
££ 
return
•• 
Ok
•• 
(
•• 
executionId
•• !
)
••! "
;
••" #
}
¶¶ 	
private
®® 
bool
®® 
IsDefaultShell
®® #
(
®®# $
)
®®$ %
{
©© 	
return
™™ 
String
™™ 
.
™™ 
Equals
™™  
(
™™  !#
_currentShellSettings
™™! 6
.
™™6 7
Name
™™7 ;
,
™™; <
ShellHelper
™™= H
.
™™H I
DefaultShellName
™™I Y
,
™™Y Z
StringComparison
™™[ k
.
™™k l
OrdinalIgnoreCase
™™l }
)
™™} ~
;
™™~ 
}
´´ 	
private
≠≠ 
string
≠≠ 
GetEncodedUrl
≠≠ $
(
≠≠$ %
ShellSettings
≠≠% 2
shellSettings
≠≠3 @
,
≠≠@ A
string
≠≠B H
token
≠≠I N
)
≠≠N O
{
ÆÆ 	
var
ØØ 
requestHost
ØØ 
=
ØØ 
Request
ØØ %
.
ØØ% &
Host
ØØ& *
;
ØØ* +
var
∞∞ 
host
∞∞ 
=
∞∞ 
shellSettings
∞∞ $
.
∞∞$ %
RequestUrlHost
∞∞% 3
?
∞∞3 4
.
∞∞4 5
Split
∞∞5 :
(
∞∞: ;
$char
∞∞; >
,
∞∞> ? 
StringSplitOptions
∞∞@ R
.
∞∞R S 
RemoveEmptyEntries
∞∞S e
)
∞∞e f
.
∞∞f g
FirstOrDefault
∞∞g u
(
∞∞u v
)
∞∞v w
??
∞∞x z
requestHost∞∞{ Ü
.∞∞Ü á
Host∞∞á ã
;∞∞ã å
var
≤≤ 
port
≤≤ 
=
≤≤ 
requestHost
≤≤ "
.
≤≤" #
Port
≤≤# '
;
≤≤' (
if
¥¥ 
(
¥¥ 
port
¥¥ 
.
¥¥ 
HasValue
¥¥ 
)
¥¥ 
{
µµ 
host
∂∂ 
+=
∂∂ 
$str
∂∂ 
+
∂∂ 
port
∂∂ "
;
∂∂" #
}
∑∑ 
var
ππ 

hostString
ππ 
=
ππ 
new
ππ  

HostString
ππ! +
(
ππ+ ,
host
ππ, 0
)
ππ0 1
;
ππ1 2
var
ªª 

pathString
ªª 
=
ªª 
HttpContext
ªª (
.
ªª( )
Features
ªª) 1
.
ªª1 2
Get
ªª2 5
<
ªª5 6!
ShellContextFeature
ªª6 I
>
ªªI J
(
ªªJ K
)
ªªK L
.
ªªL M
OriginalPathBase
ªªM ]
;
ªª] ^
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 
String
ΩΩ 
.
ΩΩ 
IsNullOrEmpty
ΩΩ %
(
ΩΩ% &
shellSettings
ΩΩ& 3
.
ΩΩ3 4
RequestUrlPrefix
ΩΩ4 D
)
ΩΩD E
)
ΩΩE F
{
ææ 

pathString
øø 
=
øø 

pathString
øø '
.
øø' (
Add
øø( +
(
øø+ ,
$char
øø, /
+
øø0 1
shellSettings
øø2 ?
.
øø? @
RequestUrlPrefix
øø@ P
)
øøP Q
;
øøQ R
}
¿¿ 
QueryString
¬¬ 
queryString
¬¬ #
=
¬¬$ %
QueryString
¬¬& 1
.
¬¬1 2
Empty
¬¬2 7
;
¬¬7 8
if
√√ 
(
√√ 
!
√√ 
String
√√ 
.
√√ 
IsNullOrEmpty
√√ %
(
√√% &
token
√√& +
)
√√+ ,
)
√√, -
{
ƒƒ 
queryString
≈≈ 
=
≈≈ 
QueryString
≈≈ )
.
≈≈) *
Create
≈≈* 0
(
≈≈0 1
$str
≈≈1 8
,
≈≈8 9
token
≈≈: ?
)
≈≈? @
;
≈≈@ A
}
∆∆ 
return
»» 
$"
»» 
{
»» 
Request
»» 
.
»» 
Scheme
»» $
}
»»$ %
://
»»% (
{
»»( )

hostString
»») 3
+
»»4 5

pathString
»»6 @
+
»»A B
queryString
»»C N
}
»»N O
"
»»O P
;
»»P Q
}
…… 	
private
ÀÀ 
string
ÀÀ 
CreateSetupToken
ÀÀ '
(
ÀÀ' (
ShellSettings
ÀÀ( 5
shellSettings
ÀÀ6 C
)
ÀÀC D
{
ÃÃ 	
var
ŒŒ 
dataProtector
ŒŒ 
=
ŒŒ $
_dataProtectorProvider
ŒŒ  6
.
ŒŒ6 7
CreateProtector
ŒŒ7 F
(
ŒŒF G
$str
ŒŒG O
)
ŒŒO P
.
ŒŒP Q(
ToTimeLimitedDataProtector
ŒŒQ k
(
ŒŒk l
)
ŒŒl m
;
ŒŒm n
var
œœ 
token
œœ 
=
œœ 
dataProtector
œœ %
.
œœ% &
Protect
œœ& -
(
œœ- .
shellSettings
œœ. ;
[
œœ; <
$str
œœ< D
]
œœD E
,
œœE F
_clock
œœG M
.
œœM N
UtcNow
œœN T
.
œœT U
Add
œœU X
(
œœX Y
new
œœY \
TimeSpan
œœ] e
(
œœe f
$num
œœf h
,
œœh i
$num
œœj k
,
œœk l
$num
œœm n
)
œœn o
)
œœo p
)
œœp q
;
œœq r
return
–– 
token
–– 
;
–– 
}
—— 	
}
““ 
}”” Ó
D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Manifest.cs
[ 
assembly 	
:	 

Module 
( 
Name 
=	 

$str 
, 
Author 

= 
ManifestConstants 
. 
OrchardCoreTeam .
,. /
Website 
= 
ManifestConstants 
.  
OrchardCoreWebsite  2
,2 3
Version 
= 
ManifestConstants 
.  
OrchardCoreVersion  2
) 
] 
[

 
assembly

 	
:

	 

Feature

 
(

 
Id 
= 
$str	 
, 
Name 
=	 

$str 
, 
Description 
= 
$str D
,D E
Category 
= 
$str 
,  
DefaultTenantOnly 
= 
true 
) 
] 
[ 
assembly 	
:	 

Feature 
( 
Id 
= 
$str	 +
,+ ,
Name 
=	 

$str !
,! "
Description 
= 
$str U
,U V
Category 
= 
$str 
,  
DefaultTenantOnly 
= 
false 
) 
] 
[ 
assembly 	
:	 

Feature 
( 
Id 
= 
$str	 *
,* +
Name 
=	 

$str  
,  !
Description 
= 
$str _
,_ `
Category 
= 
$str 
, 
DefaultTenantOnly 
= 
true 
)   
]   Ä
ÇD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Permissions.cs
	namespace 	
OrchardCore
 
. 
Tenants 
{ 
public 

class 
Permissions 
: 
IPermissionProvider 2
{		 
public

 
static

 
readonly

 

Permission

 )
ManageTenants

* 7
=

8 9
new

: =

Permission

> H
(

H I
$str

I X
,

X Y
$str

Z j
)

j k
;

k l
public 
Task 
< 
IEnumerable 
<  

Permission  *
>* +
>+ ,
GetPermissionsAsync- @
(@ A
)A B
{ 	
return 
Task 
. 

FromResult "
(" #
new# &
[& '
]' (
{) *
ManageTenants+ 8
}9 :
.: ;
AsEnumerable; G
(G H
)H I
)I J
;J K
} 	
public 
IEnumerable 
<  
PermissionStereotype /
>/ 0!
GetDefaultStereotypes1 F
(F G
)G H
{ 	
return 
new 
[ 
] 
{ 
new  
PermissionStereotype (
{ 
Name 
= 
$str *
,* +
Permissions 
=  !
new" %
[% &
]& '
{( )
ManageTenants* 7
}8 9
} 
} 
; 
} 	
} 
} ﬁ
éD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[		 
assembly		 	
:			 

AssemblyProduct		 
(		 
$str		 0
)		0 1
]		1 2
[

 
assembly

 	
:

	 

AssemblyTrademark

 
(

 
$str

 
)

  
]

  !
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8¡
ìD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Services\ITenantFileProvider.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
Services &
{ 
public 

	interface 
ITenantFileProvider (
:) *
IStaticFileProvider+ >
{ 
} 
} †
íD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Services\TenantFileProvider.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
Services &
{ 
public 

class 
TenantFileProvider #
:$ % 
PhysicalFileProvider& :
,: ;
ITenantFileProvider< O
{ 
public 
TenantFileProvider !
(! "
string" (
root) -
)- .
:/ 0
base1 5
(5 6
root6 :
): ;
{		 	
}

 	
public 
TenantFileProvider !
(! "
string" (
root) -
,- .
ExclusionFilters/ ?
filters@ G
)G H
:I J
baseK O
(O P
rootP T
,T U
filtersV ]
)] ^
{ 	
} 	
} 
} ˇP
~D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Startup.cs
	namespace 	
OrchardCore
 
. 
Tenants 
{ 
public 

class 
Startup 
: 
StartupBase &
{ 
private 
readonly 
AdminOptions %
_adminOptions& 3
;3 4
public 
Startup 
( 
IOptions 
<  
AdminOptions  ,
>, -
adminOptions. :
): ;
{ 	
_adminOptions 
= 
adminOptions (
.( )
Value) .
;. /
} 	
public 
override 
void 
ConfigureServices .
(. /
IServiceCollection/ A
servicesB J
)J K
{   	
services!! 
.!! 
AddTransient!! !
<!!! "
INavigationProvider!!" 5
,!!5 6
	AdminMenu!!7 @
>!!@ A
(!!A B
)!!B C
;!!C D
services"" 
."" 
	AddScoped"" 
<"" 
IPermissionProvider"" 2
,""2 3
Permissions""4 ?
>""? @
(""@ A
)""A B
;""B C
services## 
.## 
AddSetup## 
(## 
)## 
;##  
}$$ 	
public&& 
override&& 
void&& 
	Configure&& &
(&&& '
IApplicationBuilder&&' :
builder&&; B
,&&B C!
IEndpointRouteBuilder&&D Y
routes&&Z `
,&&` a
IServiceProvider&&b r
serviceProvider	&&s Ç
)
&&Ç É
{'' 	
var(( 
adminControllerName(( #
=(($ %
typeof((& ,
(((, -
AdminController((- <
)((< =
.((= >
ControllerName((> L
(((L M
)((M N
;((N O
routes** 
.** "
MapAreaControllerRoute** )
(**) *
name++ 
:++ 
$str++ 
,++  
areaName,, 
:,, 
$str,, /
,,,/ 0
pattern-- 
:-- 
_adminOptions-- &
.--& '
AdminUrlPrefix--' 5
+--6 7
$str--8 B
,--B C
defaults.. 
:.. 
new.. 
{.. 

controller..  *
=..+ ,
adminControllerName..- @
,..@ A
action..B H
=..I J
nameof..K Q
(..Q R
AdminController..R a
...a b
Index..b g
)..g h
}..i j
)// 
;// 
routes00 
.00 "
MapAreaControllerRoute00 )
(00) *
name11 
:11 
$str11 %
,11% &
areaName22 
:22 
$str22 /
,22/ 0
pattern33 
:33 
_adminOptions33 &
.33& '
AdminUrlPrefix33' 5
+336 7
$str338 I
,33I J
defaults44 
:44 
new44 
{44 

controller44  *
=44+ ,
adminControllerName44- @
,44@ A
action44B H
=44I J
nameof44K Q
(44Q R
AdminController44R a
.44a b
Create44b h
)44h i
}44j k
)55 
;55 
routes66 
.66 "
MapAreaControllerRoute66 )
(66) *
name77 
:77 
$str77 #
,77# $
areaName88 
:88 
$str88 /
,88/ 0
pattern99 
:99 
_adminOptions99 &
.99& '
AdminUrlPrefix99' 5
+996 7
$str998 L
,99L M
defaults:: 
::: 
new:: 
{:: 

controller::  *
=::+ ,
adminControllerName::- @
,::@ A
action::B H
=::I J
nameof::K Q
(::Q R
AdminController::R a
.::a b
Edit::b f
)::f g
}::h i
);; 
;;; 
routes<< 
.<< "
MapAreaControllerRoute<< )
(<<) *
name== 
:== 
$str== %
,==% &
areaName>> 
:>> 
$str>> /
,>>/ 0
pattern?? 
:?? 
_adminOptions?? &
.??& '
AdminUrlPrefix??' 5
+??6 7
$str??8 N
,??N O
defaults@@ 
:@@ 
new@@ 
{@@ 

controller@@  *
=@@+ ,
adminControllerName@@- @
,@@@ A
action@@B H
=@@I J
nameof@@K Q
(@@Q R
AdminController@@R a
.@@a b
Reload@@b h
)@@h i
}@@j k
)AA 
;AA 
}BB 	
}CC 
[EE 
FeatureEE 
(EE 
$strEE /
)EE/ 0
]EE0 1
publicFF 

classFF 
FileProviderStartupFF $
:FF% &
StartupBaseFF' 2
{GG 
privateKK 
constKK 
stringKK 

AssetsPathKK '
=KK( )
$strKK* 3
;KK3 4
publicNN 
overrideNN 
intNN 
OrderNN !
=>NN" $
$numNN% '
;NN' (
publicPP 
overridePP 
voidPP 
ConfigureServicesPP .
(PP. /
IServiceCollectionPP/ A
servicesPPB J
)PPJ K
{QQ 	
servicesRR 
.RR 
AddSingletonRR !
<RR! "
ITenantFileProviderRR" 5
>RR5 6
(RR6 7
serviceProviderRR7 F
=>RRG I
{SS 
varTT 
shellOptionsTT  
=TT! "
serviceProviderTT# 2
.TT2 3
GetRequiredServiceTT3 E
<TTE F
IOptionsTTF N
<TTN O
ShellOptionsTTO [
>TT[ \
>TT\ ]
(TT] ^
)TT^ _
;TT_ `
varUU 
shellSettingsUU !
=UU" #
serviceProviderUU$ 3
.UU3 4
GetRequiredServiceUU4 F
<UUF G
ShellSettingsUUG T
>UUT U
(UUU V
)UUV W
;UUW X
stringWW 
contentRootWW "
=WW# $
GetContentRootWW% 3
(WW3 4
shellOptionsWW4 @
.WW@ A
ValueWWA F
,WWF G
shellSettingsWWH U
)WWU V
;WWV W
ifYY 
(YY 
!YY 
	DirectoryYY 
.YY 
ExistsYY %
(YY% &
contentRootYY& 1
)YY1 2
)YY2 3
{ZZ 
	Directory[[ 
.[[ 
CreateDirectory[[ -
([[- .
contentRoot[[. 9
)[[9 :
;[[: ;
}\\ 
return]] 
new]] 
TenantFileProvider]] -
(]]- .
contentRoot]]. 9
)]]9 :
;]]: ;
}^^ 
)^^ 
;^^ 
services`` 
.`` 
AddSingleton`` !
<``! "
IStaticFileProvider``" 5
>``5 6
(``6 7
serviceProvider``7 F
=>``G I
{aa 
returnbb 
serviceProviderbb &
.bb& '
GetRequiredServicebb' 9
<bb9 :
ITenantFileProviderbb: M
>bbM N
(bbN O
)bbO P
;bbP Q
}cc 
)cc 
;cc 
}dd 	
publicff 
overrideff 
voidff 
	Configureff &
(ff& '
IApplicationBuilderff' :
appff; >
,ff> ?!
IEndpointRouteBuilderff@ U
routesffV \
,ff\ ]
IServiceProviderff^ n
serviceProviderffo ~
)ff~ 
{gg 	
varhh 
tenantFileProviderhh "
=hh# $
serviceProviderhh% 4
.hh4 5
GetRequiredServicehh5 G
<hhG H
ITenantFileProviderhhH [
>hh[ \
(hh\ ]
)hh] ^
;hh^ _
appjj 
.jj 
UseStaticFilesjj 
(jj 
newjj "
StaticFileOptionsjj# 4
{kk 
FileProviderll 
=ll 
tenantFileProviderll 1
,ll1 2
DefaultContentTypemm "
=mm# $
$strmm% ?
,mm? @!
ServeUnknownFileTypesnn %
=nn& '
truenn( ,
,nn, -
OnPrepareResponseqq !
=qq" #
ctxqq$ '
=>qq( *
{rr 
ctxss 
.ss 
Contextss 
.ss  
Responsess  (
.ss( )
Headersss) 0
[ss0 1
HeaderNamesss1 <
.ss< =
CacheControlss= I
]ssI J
=ssK L
$strssM z
;ssz {
}tt 
}uu 
)uu 
;uu 
}vv 	
privatexx 
stringxx 
GetContentRootxx %
(xx% &
ShellOptionsxx& 2
shellOptionsxx3 ?
,xx? @
ShellSettingsxxA N
shellSettingsxxO \
)xx\ ]
{yy 	
returnzz 
Pathzz 
.zz 
Combinezz 
(zz  
shellOptionszz  ,
.zz, -%
ShellsApplicationDataPathzz- F
,zzF G
shellOptionszzH T
.zzT U
ShellsContainerNamezzU h
,zzh i
shellSettingszzj w
.zzw x
Namezzx |
,zz| }

AssetsPath	zz~ à
)
zzà â
;
zzâ ä
}{{ 	
}|| 
[~~ 
Feature~~ 
(~~ 
$str~~ .
)~~. /
]~~/ 0
public 

class 
DistributedStartup #
:$ %
StartupBase& 1
{
ÄÄ 
public
ÅÅ 
override
ÅÅ 
void
ÅÅ 
ConfigureServices
ÅÅ .
(
ÅÅ. / 
IServiceCollection
ÅÅ/ A
services
ÅÅB J
)
ÅÅJ K
{
ÇÇ 	
services
ÉÉ 
.
ÉÉ 
AddSingleton
ÉÉ !
<
ÉÉ! "+
DistributedShellMarkerService
ÉÉ" ?
>
ÉÉ? @
(
ÉÉ@ A
)
ÉÉA B
;
ÉÉB C
}
ÑÑ 	
}
ÖÖ 
}ÜÜ „'
ïD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\ViewModels\AdminIndexViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 

ViewModels (
{ 
public 

class 
AdminIndexViewModel $
{		 
public

 
List

 
<

 
ShellSettingsEntry

 &
>

& ' 
ShellSettingsEntries

( <
{

= >
get

? B
;

B C
set

D G
;

G H
}

I J
=

K L
new

M P
List

Q U
<

U V
ShellSettingsEntry

V h
>

h i
(

i j
)

j k
;

k l
public 
TenantIndexOptions !
Options" )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
TenantIndexOptions> P
(P Q
)Q R
;R S
[ 	
	BindNever	 
] 
public 
dynamic 
Pager 
{ 
get "
;" #
set$ '
;' (
}) *
} 
public 

class 
BulkActionViewModel $
{ 
public 

BulkAction 

BulkAction $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
[ 
] 
TenantNames #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
public 

enum 

BulkAction 
{ 
Disable 
, 
Enable 
} 
public 

class 
ShellSettingsEntry #
{ 
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public!! 
bool!! 
Selected!! 
{!! 
get!! "
;!!" #
set!!$ '
;!!' (
}!!) *
public## 
string## 
Name## 
{## 
get##  
;##  !
set##" %
;##% &
}##' (
public%% 
bool%% 
IsDefaultTenant%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public'' 
string'' 
Token'' 
{'' 
get'' !
;''! "
set''# &
;''& '
}''( )
[)) 	
	BindNever))	 
])) 
public** 
ShellSettings** 
ShellSettings** *
{**+ ,
get**- 0
;**0 1
set**2 5
;**5 6
}**7 8
}++ 
public-- 

class-- 
TenantIndexOptions-- #
{.. 
public// 
string// 
Search// 
{// 
get// "
;//" #
set//$ '
;//' (
}//) *
public00 
TenantsFilter00 
Filter00 #
{00$ %
get00& )
;00) *
set00+ .
;00. /
}000 1
public11 
TenantsBulkAction11  

BulkAction11! +
{11, -
get11. 1
;111 2
set113 6
;116 7
}118 9
public22 
TenantsOrder22 
OrderBy22 #
{22$ %
get22& )
;22) *
set22+ .
;22. /
}220 1
[44 	
	BindNever44	 
]44 
public55 
List55 
<55 
SelectListItem55 "
>55" #
TenantsStates55$ 1
{552 3
get554 7
;557 8
set559 <
;55< =
}55> ?
[77 	
	BindNever77	 
]77 
public88 
List88 
<88 
SelectListItem88 "
>88" #
TenantsSorts88$ 0
{881 2
get883 6
;886 7
set888 ;
;88; <
}88= >
[:: 	
	BindNever::	 
]:: 
public;; 
List;; 
<;; 
SelectListItem;; "
>;;" #
TenantsBulkAction;;$ 5
{;;6 7
get;;8 ;
;;;; <
set;;= @
;;;@ A
};;B C
}<< 
public>> 

enum>> 
TenantsFilter>> 
{?? 
All@@ 
,@@ 
RunningAA 
,AA 
DisabledBB 
,BB 
UninitializedCC 
}DD 
publicFF 

enumFF 
TenantsBulkActionFF !
{GG 
NoneHH 
,HH 
DisableII 
,II 
EnableJJ 
}KK 
publicMM 

enumMM 
TenantsOrderMM 
{NN 
NameOO 
,OO 
StatePP 
}QQ 
}RR ≈
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\ViewModels\CreateApiViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 

ViewModels (
{ 
public 

class 
CreateApiViewModel #
{ 
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
[		 	
Required			 
]		 
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
DatabaseProvider &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RequestUrlPrefix &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RequestUrlHost $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ConnectionString &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
TablePrefix !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 

RecipeName  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} ƒ
ïD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\ViewModels\EditTenantViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 

ViewModels (
{ 
public 

class 
EditTenantViewModel $
{ 
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public

 
string

 
Name

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
public 
string 
DatabaseProvider &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RequestUrlPrefix &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RequestUrlHost $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
ConnectionString &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
TablePrefix !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 

RecipeName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
IEnumerable 
< 
RecipeDescriptor +
>+ ,
Recipes- 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
public 
bool "
CanEditDatabasePresets *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
bool '
DatabaseConfigurationPreset /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ±
ìD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\ViewModels\SetupApiViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 

ViewModels (
{ 
public 

class 
SetupApiViewModel "
{ 
[ 	
Required	 
] 
public		 
string		 
Name		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
[ 	
Required	 
] 
public 
string 
SiteName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
DatabaseProvider &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
ConnectionString &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
TablePrefix !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 
UserName 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

RecipeName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
	IFormFile 
Recipe 
{  !
get" %
;% &
set' *
;* +
}, -
public   
string   
SiteTimeZone   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
}!! 
}"" âr
úD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Activities\CreateTenantTask.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

Activities( 2
{ 
public 

class 
CreateTenantTask !
:" #

TenantTask$ .
{ 
public 
CreateTenantTask 
(  !
IShellSettingsManager ! 
shellSettingsManager" 6
,6 7

IShellHost 
	shellHost  
,  !(
IWorkflowExpressionEvaluator (
expressionEvaluator) <
,< =$
IWorkflowScriptEvaluator $
scriptEvaluator% 4
,4 5
IStringLocalizer 
< 
CreateTenantTask -
>- .
	localizer/ 8
)8 9
: 
base 
(  
shellSettingsManager '
,' (
	shellHost) 2
,2 3
expressionEvaluator4 G
,G H
scriptEvaluatorI X
,X Y
	localizerZ c
)c d
{ 	
} 	
public 
override 
string 
Name #
=>$ &
nameof' -
(- .
CreateTenantTask. >
)> ?
;? @
public 
override 
LocalizedString '
Category( 0
=>1 3
S4 5
[5 6
$str6 >
]> ?
;? @
public 
override 
LocalizedString '
DisplayText( 3
=>4 6
S7 8
[8 9
$str9 M
]M N
;N O
public!! 
string!! 
ContentType!! !
{"" 	
get## 
=>## 
GetProperty## 
<## 
string## %
>##% &
(##& '
)##' (
;##( )
set$$ 
=>$$ 
SetProperty$$ 
($$ 
value$$ $
)$$$ %
;$$% &
}%% 	
public'' 
WorkflowExpression'' !
<''! "
string''" (
>''( )
Description''* 5
{(( 	
get)) 
=>)) 
GetProperty)) 
()) 
())  
)))  !
=>))" $
new))% (
WorkflowExpression))) ;
<)); <
string))< B
>))B C
())C D
)))D E
)))E F
;))F G
set** 
=>** 
SetProperty** 
(** 
value** $
)**$ %
;**% &
}++ 	
public-- 
WorkflowExpression-- !
<--! "
string--" (
>--( )
RequestUrlPrefix--* :
{.. 	
get// 
=>// 
GetProperty// 
(// 
(//  
)//  !
=>//" $
new//% (
WorkflowExpression//) ;
<//; <
string//< B
>//B C
(//C D
)//D E
)//E F
;//F G
set00 
=>00 
SetProperty00 
(00 
value00 $
)00$ %
;00% &
}11 	
public33 
WorkflowExpression33 !
<33! "
string33" (
>33( )
RequestUrlHost33* 8
{44 	
get55 
=>55 
GetProperty55 
(55 
(55  
)55  !
=>55" $
new55% (
WorkflowExpression55) ;
<55; <
string55< B
>55B C
(55C D
)55D E
)55E F
;55F G
set66 
=>66 
SetProperty66 
(66 
value66 $
)66$ %
;66% &
}77 	
public99 
WorkflowExpression99 !
<99! "
string99" (
>99( )
DatabaseProvider99* :
{:: 	
get;; 
=>;; 
GetProperty;; 
(;; 
(;;  
);;  !
=>;;" $
new;;% (
WorkflowExpression;;) ;
<;;; <
string;;< B
>;;B C
(;;C D
);;D E
);;E F
;;;F G
set<< 
=><< 
SetProperty<< 
(<< 
value<< $
)<<$ %
;<<% &
}== 	
public?? 
WorkflowExpression?? !
<??! "
string??" (
>??( )
ConnectionString??* :
{@@ 	
getAA 
=>AA 
GetPropertyAA 
(AA 
(AA  
)AA  !
=>AA" $
newAA% (
WorkflowExpressionAA) ;
<AA; <
stringAA< B
>AAB C
(AAC D
)AAD E
)AAE F
;AAF G
setBB 
=>BB 
SetPropertyBB 
(BB 
valueBB $
)BB$ %
;BB% &
}CC 	
publicEE 
WorkflowExpressionEE !
<EE! "
stringEE" (
>EE( )
TablePrefixEE* 5
{FF 	
getGG 
=>GG 
GetPropertyGG 
(GG 
(GG  
)GG  !
=>GG" $
newGG% (
WorkflowExpressionGG) ;
<GG; <
stringGG< B
>GGB C
(GGC D
)GGD E
)GGE F
;GGF G
setHH 
=>HH 
SetPropertyHH 
(HH 
valueHH $
)HH$ %
;HH% &
}II 	
publicKK 
WorkflowExpressionKK !
<KK! "
stringKK" (
>KK( )

RecipeNameKK* 4
{LL 	
getMM 
=>MM 
GetPropertyMM 
(MM 
(MM  
)MM  !
=>MM" $
newMM% (
WorkflowExpressionMM) ;
<MM; <
stringMM< B
>MMB C
(MMC D
)MMD E
)MME F
;MMF G
setNN 
=>NN 
SetPropertyNN 
(NN 
valueNN $
)NN$ %
;NN% &
}OO 	
publicQQ 
overrideQQ 
IEnumerableQQ #
<QQ# $
OutcomeQQ$ +
>QQ+ ,
GetPossibleOutcomesQQ- @
(QQ@ A$
WorkflowExecutionContextQQA Y
workflowContextQQZ i
,QQi j
ActivityContextQQk z
activityContext	QQ{ ä
)
QQä ã
{RR 	
returnSS 
OutcomesSS 
(SS 
SSS 
[SS 
$strSS $
]SS$ %
,SS% &
SSS' (
[SS( )
$strSS) 1
]SS1 2
)SS2 3
;SS3 4
}TT 	
publicVV 
asyncVV 
overrideVV 
TaskVV "
<VV" ##
ActivityExecutionResultVV# :
>VV: ;
ExecuteAsyncVV< H
(VVH I$
WorkflowExecutionContextVVI a
workflowContextVVb q
,VVq r
ActivityContext	VVs Ç
activityContext
VVÉ í
)
VVí ì
{WW 	
ifXX 
(XX 

ShellScopeXX 
.XX 
ContextXX "
.XX" #
SettingsXX# +
.XX+ ,
NameXX, 0
!=XX1 3
ShellHelperXX4 ?
.XX? @
DefaultShellNameXX@ P
)XXP Q
{YY 
returnZZ 
OutcomesZZ 
(ZZ  
$strZZ  (
)ZZ( )
;ZZ) *
}[[ 
var]] 

tenantName]] 
=]] 
(]] 
await]] #
ExpressionEvaluator]]$ 7
.]]7 8
EvaluateAsync]]8 E
(]]E F

TenantName]]F P
,]]P Q
workflowContext]]R a
,]]a b
null]]c g
)]]g h
)]]h i
?]]i j
.]]j k
Trim]]k o
(]]o p
)]]p q
;]]q r
if__ 
(__ 
string__ 
.__ 
IsNullOrEmpty__ $
(__$ %

tenantName__% /
)__/ 0
)__0 1
{`` 
returnaa 
Outcomesaa 
(aa  
$straa  (
)aa( )
;aa) *
}bb 
ifdd 
(dd 
	ShellHostdd 
.dd 
TryGetSettingsdd (
(dd( )

tenantNamedd) 3
,dd3 4
outdd5 8
vardd9 <
shellSettingsdd= J
)ddJ K
)ddK L
{ee 
returnff 
Outcomesff 
(ff  
$strff  (
)ff( )
;ff) *
}gg 
varii 
requestUrlPrefixii  
=ii! "
(ii# $
awaitii$ )
ExpressionEvaluatorii* =
.ii= >
EvaluateAsyncii> K
(iiK L
RequestUrlPrefixiiL \
,ii\ ]
workflowContextii^ m
,iim n
nulliio s
)iis t
)iit u
?iiu v
.iiv w
Trimiiw {
(ii{ |
)ii| }
;ii} ~
varjj 
requestUrlHostjj 
=jj  
(jj! "
awaitjj" '
ExpressionEvaluatorjj( ;
.jj; <
EvaluateAsyncjj< I
(jjI J
RequestUrlHostjjJ X
,jjX Y
workflowContextjjZ i
,jji j
nulljjk o
)jjo p
)jjp q
?jjq r
.jjr s
Trimjjs w
(jjw x
)jjx y
;jjy z
varkk 
databaseProviderkk  
=kk! "
(kk# $
awaitkk$ )
ExpressionEvaluatorkk* =
.kk= >
EvaluateAsynckk> K
(kkK L
DatabaseProviderkkL \
,kk\ ]
workflowContextkk^ m
,kkm n
nullkko s
)kks t
)kkt u
?kku v
.kkv w
Trimkkw {
(kk{ |
)kk| }
;kk} ~
varll 
connectionStringll  
=ll! "
(ll# $
awaitll$ )
ExpressionEvaluatorll* =
.ll= >
EvaluateAsyncll> K
(llK L
ConnectionStringllL \
,ll\ ]
workflowContextll^ m
,llm n
nullllo s
)lls t
)llt u
?llu v
.llv w
Trimllw {
(ll{ |
)ll| }
;ll} ~
varmm 
tablePrefixmm 
=mm 
(mm 
awaitmm $
ExpressionEvaluatormm% 8
.mm8 9
EvaluateAsyncmm9 F
(mmF G
TablePrefixmmG R
,mmR S
workflowContextmmT c
,mmc d
nullmme i
)mmi j
)mmj k
?mmk l
.mml m
Trimmmm q
(mmq r
)mmr s
;mms t
varnn 

recipeNamenn 
=nn 
(nn 
awaitnn #
ExpressionEvaluatornn$ 7
.nn7 8
EvaluateAsyncnn8 E
(nnE F

RecipeNamennF P
,nnP Q
workflowContextnnR a
,nna b
nullnnc g
)nng h
)nnh i
?nni j
.nnj k
Trimnnk o
(nno p
)nnp q
;nnq r
shellSettingsqq 
=qq  
ShellSettingsManagerqq 0
.qq0 1!
CreateDefaultSettingsqq1 F
(qqF G
)qqG H
;qqH I
shellSettingsss 
.ss 
Namess 
=ss  

tenantNamess! +
;ss+ ,
ifuu 
(uu 
!uu 
stringuu 
.uu 
IsNullOrEmptyuu %
(uu% &
requestUrlHostuu& 4
)uu4 5
)uu5 6
{vv 
shellSettingsww 
.ww 
RequestUrlHostww ,
=ww- .
requestUrlHostww/ =
;ww= >
}xx 
ifzz 
(zz 
!zz 
stringzz 
.zz 
IsNullOrEmptyzz %
(zz% &
requestUrlPrefixzz& 6
)zz6 7
)zz7 8
{{{ 
shellSettings|| 
.|| 
RequestUrlPrefix|| .
=||/ 0
requestUrlPrefix||1 A
;||A B
}}} 
shellSettings 
. 
State 
=  !
TenantState" -
.- .
Uninitialized. ;
;; <
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
string
ÅÅ 
.
ÅÅ 
IsNullOrEmpty
ÅÅ %
(
ÅÅ% &
connectionString
ÅÅ& 6
)
ÅÅ6 7
)
ÅÅ7 8
{
ÇÇ 
shellSettings
ÉÉ 
[
ÉÉ 
$str
ÉÉ 0
]
ÉÉ0 1
=
ÉÉ2 3
connectionString
ÉÉ4 D
;
ÉÉD E
}
ÑÑ 
if
ÜÜ 
(
ÜÜ 
!
ÜÜ 
string
ÜÜ 
.
ÜÜ 
IsNullOrEmpty
ÜÜ %
(
ÜÜ% &
tablePrefix
ÜÜ& 1
)
ÜÜ1 2
)
ÜÜ2 3
{
áá 
shellSettings
àà 
[
àà 
$str
àà +
]
àà+ ,
=
àà- .
tablePrefix
àà/ :
;
àà: ;
}
ââ 
if
ãã 
(
ãã 
!
ãã 
string
ãã 
.
ãã 
IsNullOrEmpty
ãã %
(
ãã% &
databaseProvider
ãã& 6
)
ãã6 7
)
ãã7 8
{
åå 
shellSettings
çç 
[
çç 
$str
çç 0
]
çç0 1
=
çç2 3
databaseProvider
çç4 D
;
ççD E
}
éé 
if
êê 
(
êê 
!
êê 
string
êê 
.
êê 
IsNullOrEmpty
êê %
(
êê% &

recipeName
êê& 0
)
êê0 1
)
êê1 2
{
ëë 
shellSettings
íí 
[
íí 
$str
íí *
]
íí* +
=
íí, -

recipeName
íí. 8
;
íí8 9
}
ìì 
shellSettings
ïï 
[
ïï 
$str
ïï "
]
ïï" #
=
ïï$ %
Guid
ïï& *
.
ïï* +
NewGuid
ïï+ 2
(
ïï2 3
)
ïï3 4
.
ïï4 5
ToString
ïï5 =
(
ïï= >
)
ïï> ?
;
ïï? @
await
óó 
	ShellHost
óó 
.
óó &
UpdateShellSettingsAsync
óó 4
(
óó4 5
shellSettings
óó5 B
)
óóB C
;
óóC D
workflowContext
ôô 
.
ôô 

LastResult
ôô &
=
ôô' (
shellSettings
ôô) 6
;
ôô6 7
workflowContext
öö 
.
öö 
CorrelationId
öö )
=
öö* +
shellSettings
öö, 9
.
öö9 :
Name
öö: >
;
öö> ?
return
úú 
Outcomes
úú 
(
úú 
$str
úú "
)
úú" #
;
úú# $
}
ùù 	
}
ûû 
}üü ú(
ùD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Activities\DisableTenantTask.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

Activities( 2
{ 
public 

class 
DisableTenantTask "
:# $

TenantTask% /
{ 
public 
DisableTenantTask  
(  !!
IShellSettingsManager! 6 
shellSettingsManager7 K
,K L

IShellHostM W
	shellHostX a
,a b(
IWorkflowExpressionEvaluatorc !
expressionEvaluator
Ä ì
,
ì î&
IWorkflowScriptEvaluator
ï ≠
scriptEvaluator
Æ Ω
,
Ω æ
IStringLocalizer
ø œ
<
œ –
DisableTenantTask
– ·
>
· ‚
	localizer
„ Ï
)
Ï Ì
: 
base 
(  
shellSettingsManager '
,' (
	shellHost) 2
,2 3
expressionEvaluator4 G
,G H
scriptEvaluatorI X
,X Y
	localizerZ c
)c d
{ 	
} 	
public 
override 
string 
Name #
=>$ &
nameof' -
(- .
DisableTenantTask. ?
)? @
;@ A
public 
override 
LocalizedString '
Category( 0
=>1 3
S4 5
[5 6
$str6 >
]> ?
;? @
public 
override 
LocalizedString '
DisplayText( 3
=>4 6
S7 8
[8 9
$str9 N
]N O
;O P
public 
override 
IEnumerable #
<# $
Outcome$ +
>+ ,
GetPossibleOutcomes- @
(@ A$
WorkflowExecutionContextA Y
workflowContextZ i
,i j
ActivityContextk z
activityContext	{ ä
)
ä ã
{ 	
return 
Outcomes 
( 
S 
[ 
$str (
]( )
,) *
S+ ,
[, -
$str- 5
]5 6
)6 7
;7 8
} 	
public 
override 
async 
Task "
<" ##
ActivityExecutionResult# :
>: ;
ExecuteAsync< H
(H I$
WorkflowExecutionContextI a
workflowContextb q
,q r
ActivityContext	s Ç
activityContext
É í
)
í ì
{   	
if!! 
(!! 

ShellScope!! 
.!! 
Context!! "
.!!" #
Settings!!# +
.!!+ ,
Name!!, 0
!=!!1 3
ShellHelper!!4 ?
.!!? @
DefaultShellName!!@ P
)!!P Q
{"" 
return## 
Outcomes## 
(##  
$str##  (
)##( )
;##) *
}$$ 
var&& 

tenantName&& 
=&& 
(&& 
await&& #
ExpressionEvaluator&&$ 7
.&&7 8
EvaluateAsync&&8 E
(&&E F

TenantName&&F P
,&&P Q
workflowContext&&R a
,&&a b
null&&c g
)&&g h
)&&h i
?&&i j
.&&j k
Trim&&k o
(&&o p
)&&p q
;&&q r
if(( 
((( 

tenantName(( 
==(( 
ShellHelper(( )
.(() *
DefaultShellName((* :
)((: ;
{)) 
return** 
Outcomes** 
(**  
$str**  (
)**( )
;**) *
}++ 
if-- 
(-- 
!-- 
	ShellHost-- 
.-- 
TryGetSettings-- )
(--) *

tenantName--* 4
?--4 5
.--5 6
Trim--6 :
(--: ;
)--; <
,--< =
out--> A
var--B E
shellSettings--F S
)--S T
)--T U
{.. 
return// 
Outcomes// 
(//  
$str//  (
)//( )
;//) *
}00 
if22 
(22 
shellSettings22 
.22 
State22 #
!=22$ &
TenantState22' 2
.222 3
Running223 :
)22: ;
{33 
return44 
Outcomes44 
(44  
$str44  (
)44( )
;44) *
}55 
shellSettings77 
.77 
State77 
=77  !
TenantState77" -
.77- .
Disabled77. 6
;776 7
await88 
	ShellHost88 
.88 $
UpdateShellSettingsAsync88 4
(884 5
shellSettings885 B
)88B C
;88C D
return:: 
Outcomes:: 
(:: 
$str:: &
)::& '
;::' (
};; 	
}<< 
}== •%
úD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Activities\EnableTenantTask.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

Activities( 2
{ 
public 

class 
EnableTenantTask !
:" #

TenantTask$ .
{ 
public 
EnableTenantTask 
(  !
IShellSettingsManager  5 
shellSettingsManager6 J
,J K

IShellHostL V
	shellHostW `
,` a(
IWorkflowExpressionEvaluatorb ~ 
expressionEvaluator	 í
,
í ì&
IWorkflowScriptEvaluator
î ¨
scriptEvaluator
≠ º
,
º Ω
IStringLocalizer
æ Œ
<
Œ œ
EnableTenantTask
œ ﬂ
>
ﬂ ‡
	localizer
· Í
)
Í Î
: 
base 
(  
shellSettingsManager '
,' (
	shellHost) 2
,2 3
expressionEvaluator4 G
,G H
scriptEvaluatorI X
,X Y
	localizerZ c
)c d
{ 	
} 	
public 
override 
string 
Name #
=>$ &
nameof' -
(- .
EnableTenantTask. >
)> ?
;? @
public 
override 
LocalizedString '
Category( 0
=>1 3
S4 5
[5 6
$str6 >
]> ?
;? @
public 
override 
LocalizedString '
DisplayText( 3
=>4 6
S7 8
[8 9
$str9 M
]M N
;N O
public 
override 
IEnumerable #
<# $
Outcome$ +
>+ ,
GetPossibleOutcomes- @
(@ A$
WorkflowExecutionContextA Y
workflowContextZ i
,i j
ActivityContextk z
activityContext	{ ä
)
ä ã
{ 	
return 
Outcomes 
( 
S 
[ 
$str '
]' (
,( )
S* +
[+ ,
$str, 4
]4 5
)5 6
;6 7
} 	
public   
override   
async   
Task   "
<  " ##
ActivityExecutionResult  # :
>  : ;
ExecuteAsync  < H
(  H I$
WorkflowExecutionContext  I a
workflowContext  b q
,  q r
ActivityContext	  s Ç
activityContext
  É í
)
  í ì
{!! 	
if"" 
("" 

ShellScope"" 
."" 
Context"" "
.""" #
Settings""# +
.""+ ,
Name"", 0
!=""1 3
ShellHelper""4 ?
.""? @
DefaultShellName""@ P
)""P Q
{## 
return$$ 
Outcomes$$ 
($$  
$str$$  (
)$$( )
;$$) *
}%% 
var'' 

tenantName'' 
='' 
('' 
await'' #
ExpressionEvaluator''$ 7
.''7 8
EvaluateAsync''8 E
(''E F

TenantName''F P
,''P Q
workflowContext''R a
,''a b
null''c g
)''g h
)''h i
?''i j
.''j k
Trim''k o
(''o p
)''p q
;''q r
if)) 
()) 
!)) 
	ShellHost)) 
.)) 
TryGetSettings)) )
())) *

tenantName))* 4
,))4 5
out))6 9
var)): =
shellSettings))> K
)))K L
)))L M
{** 
return++ 
Outcomes++ 
(++  
$str++  (
)++( )
;++) *
},, 
if.. 
(.. 
shellSettings.. 
... 
State.. #
!=..$ &
TenantState..' 2
...2 3
Disabled..3 ;
)..; <
{// 
return00 
Outcomes00 
(00  
$str00  (
)00( )
;00) *
}11 
shellSettings33 
.33 
State33 
=33  !
TenantState33" -
.33- .
Running33. 5
;335 6
await44 
	ShellHost44 
.44 $
UpdateShellSettingsAsync44 4
(444 5
shellSettings445 B
)44B C
;44C D
return66 
Outcomes66 
(66 
$str66 %
)66% &
;66& '
}77 	
}88 
}99 ≤©
õD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Activities\SetupTenantTask.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

Activities( 2
{ 
public 

class 
SetupTenantTask  
:! "

TenantTask# -
{ 
private 
readonly 
IClock 
_clock  &
;& '
private 
readonly  
IUpdateModelAccessor - 
_updateModelAccessor. B
;B C
private 
readonly "
IEmailAddressValidator /"
_emailAddressValidator0 F
;F G
private 
readonly 
IdentityOptions (
_identityOptions) 9
;9 :
public 
SetupTenantTask 
( 
IClock 
clock 
,  
IUpdateModelAccessor  
updateModelAccessor! 4
,4 5"
IEmailAddressValidator   "!
emailAddressValidator  # 8
,  8 9
IOptions!! 
<!! 
IdentityOptions!! $
>!!$ %
identityOptions!!& 5
,!!5 6!
IShellSettingsManager"" ! 
shellSettingsManager""" 6
,""6 7

IShellHost## 
	shellHost##  
,##  !
ISetupService$$ 
setupService$$ &
,$$& '(
IWorkflowExpressionEvaluator%% (
expressionEvaluator%%) <
,%%< =$
IWorkflowScriptEvaluator&& $
scriptEvaluator&&% 4
,&&4 5
IStringLocalizer'' 
<'' 
SetupTenantTask'' ,
>'', -
	localizer''. 7
)''7 8
:(( 
base(( 
(((  
shellSettingsManager(( '
,((' (
	shellHost(() 2
,((2 3
expressionEvaluator((4 G
,((G H
scriptEvaluator((I X
,((X Y
	localizer((Z c
)((c d
{)) 	
SetupService** 
=** 
setupService** '
;**' (
_clock++ 
=++ 
clock++ 
;++  
_updateModelAccessor,,  
=,,! "
updateModelAccessor,,# 6
;,,6 7"
_emailAddressValidator-- "
=--# $!
emailAddressValidator--% :
;--: ;
_identityOptions.. 
=.. 
identityOptions.. .
.... /
Value../ 4
;..4 5
}// 	
	protected11 
ISetupService11 
SetupService11  ,
{11- .
get11/ 2
;112 3
}114 5
public33 
override33 
string33 
Name33 #
=>33$ &
nameof33' -
(33- .
SetupTenantTask33. =
)33= >
;33> ?
public55 
override55 
LocalizedString55 '
Category55( 0
=>551 3
S554 5
[555 6
$str556 >
]55> ?
;55? @
public77 
override77 
LocalizedString77 '
DisplayText77( 3
=>774 6
S777 8
[778 9
$str779 L
]77L M
;77M N
public99 
WorkflowExpression99 !
<99! "
string99" (
>99( )
SiteName99* 2
{:: 	
get;; 
=>;; 
GetProperty;; 
(;; 
(;;  
);;  !
=>;;" $
new;;% (
WorkflowExpression;;) ;
<;;; <
string;;< B
>;;B C
(;;C D
);;D E
);;E F
;;;F G
set<< 
=><< 
SetProperty<< 
(<< 
value<< $
)<<$ %
;<<% &
}== 	
public?? 
WorkflowExpression?? !
<??! "
string??" (
>??( )
AdminUsername??* 7
{@@ 	
getAA 
=>AA 
GetPropertyAA 
(AA 
(AA  
)AA  !
=>AA" $
newAA% (
WorkflowExpressionAA) ;
<AA; <
stringAA< B
>AAB C
(AAC D
)AAD E
)AAE F
;AAF G
setBB 
=>BB 
SetPropertyBB 
(BB 
valueBB $
)BB$ %
;BB% &
}CC 	
publicEE 
WorkflowExpressionEE !
<EE! "
stringEE" (
>EE( )

AdminEmailEE* 4
{FF 	
getGG 
=>GG 
GetPropertyGG 
(GG 
(GG  
)GG  !
=>GG" $
newGG% (
WorkflowExpressionGG) ;
<GG; <
stringGG< B
>GGB C
(GGC D
)GGD E
)GGE F
;GGF G
setHH 
=>HH 
SetPropertyHH 
(HH 
valueHH $
)HH$ %
;HH% &
}II 	
publicKK 
WorkflowExpressionKK !
<KK! "
stringKK" (
>KK( )
AdminPasswordKK* 7
{LL 	
getMM 
=>MM 
GetPropertyMM 
(MM 
(MM  
)MM  !
=>MM" $
newMM% (
WorkflowExpressionMM) ;
<MM; <
stringMM< B
>MMB C
(MMC D
)MMD E
)MME F
;MMF G
setNN 
=>NN 
SetPropertyNN 
(NN 
valueNN $
)NN$ %
;NN% &
}OO 	
publicQQ 
WorkflowExpressionQQ !
<QQ! "
stringQQ" (
>QQ( )
DatabaseProviderQQ* :
{RR 	
getSS 
=>SS 
GetPropertySS 
(SS 
(SS  
)SS  !
=>SS" $
newSS% (
WorkflowExpressionSS) ;
<SS; <
stringSS< B
>SSB C
(SSC D
)SSD E
)SSE F
;SSF G
setTT 
=>TT 
SetPropertyTT 
(TT 
valueTT $
)TT$ %
;TT% &
}UU 	
publicWW 
WorkflowExpressionWW !
<WW! "
stringWW" (
>WW( )$
DatabaseConnectionStringWW* B
{XX 	
getYY 
=>YY 
GetPropertyYY 
(YY 
(YY  
)YY  !
=>YY" $
newYY% (
WorkflowExpressionYY) ;
<YY; <
stringYY< B
>YYB C
(YYC D
)YYD E
)YYE F
;YYF G
setZZ 
=>ZZ 
SetPropertyZZ 
(ZZ 
valueZZ $
)ZZ$ %
;ZZ% &
}[[ 	
public]] 
WorkflowExpression]] !
<]]! "
string]]" (
>]]( )
DatabaseTablePrefix]]* =
{^^ 	
get__ 
=>__ 
GetProperty__ 
(__ 
(__  
)__  !
=>__" $
new__% (
WorkflowExpression__) ;
<__; <
string__< B
>__B C
(__C D
)__D E
)__E F
;__F G
set`` 
=>`` 
SetProperty`` 
(`` 
value`` $
)``$ %
;``% &
}aa 	
publiccc 
WorkflowExpressioncc !
<cc! "
stringcc" (
>cc( )

RecipeNamecc* 4
{dd 	
getee 
=>ee 
GetPropertyee 
(ee 
(ee  
)ee  !
=>ee" $
newee% (
WorkflowExpressionee) ;
<ee; <
stringee< B
>eeB C
(eeC D
)eeD E
)eeE F
;eeF G
setff 
=>ff 
SetPropertyff 
(ff 
valueff $
)ff$ %
;ff% &
}gg 	
publicii 
overrideii 
IEnumerableii #
<ii# $
Outcomeii$ +
>ii+ ,
GetPossibleOutcomesii- @
(ii@ A$
WorkflowExecutionContextiiA Y
workflowContextiiZ i
,iii j
ActivityContextiik z
activityContext	ii{ ä
)
iiä ã
{jj 	
returnkk 
Outcomeskk 
(kk 
Skk 
[kk 
$strkk $
]kk$ %
,kk% &
Skk' (
[kk( )
$strkk) 1
]kk1 2
)kk2 3
;kk3 4
}ll 	
publicnn 
overridenn 
asyncnn 
Tasknn "
<nn" ##
ActivityExecutionResultnn# :
>nn: ;
ExecuteAsyncnn< H
(nnH I$
WorkflowExecutionContextnnI a
workflowContextnnb q
,nnq r
ActivityContext	nns Ç
activityContext
nnÉ í
)
nní ì
{oo 	
ifpp 
(pp 

ShellScopepp 
.pp 
Contextpp "
.pp" #
Settingspp# +
.pp+ ,
Namepp, 0
!=pp1 3
ShellHelperpp4 ?
.pp? @
DefaultShellNamepp@ P
)ppP Q
{qq 
returnrr 
Outcomesrr 
(rr  
$strrr  (
)rr( )
;rr) *
}ss 
varuu 

tenantNameuu 
=uu 
(uu 
awaituu #
ExpressionEvaluatoruu$ 7
.uu7 8
EvaluateAsyncuu8 E
(uuE F

TenantNameuuF P
,uuP Q
workflowContextuuR a
,uua b
nulluuc g
)uug h
)uuh i
?uui j
.uuj k
Trimuuk o
(uuo p
)uup q
;uuq r
ifww 
(ww 
stringww 
.ww 
IsNullOrWhiteSpaceww )
(ww) *

tenantNameww* 4
)ww4 5
)ww5 6
{xx 
returnyy 
Outcomesyy 
(yy  
$stryy  (
)yy( )
;yy) *
}zz 
if|| 
(|| 
!|| 
	ShellHost|| 
.|| 
TryGetSettings|| )
(||) *

tenantName||* 4
,||4 5
out||6 9
var||: =
shellSettings||> K
)||K L
)||L M
{}} 
return~~ 
Outcomes~~ 
(~~  
$str~~  (
)~~( )
;~~) *
} 
if
ÅÅ 
(
ÅÅ 
shellSettings
ÅÅ 
.
ÅÅ 
State
ÅÅ #
==
ÅÅ$ &
TenantState
ÅÅ' 2
.
ÅÅ2 3
Running
ÅÅ3 :
)
ÅÅ: ;
{
ÇÇ 
return
ÉÉ 
Outcomes
ÉÉ 
(
ÉÉ  
$str
ÉÉ  (
)
ÉÉ( )
;
ÉÉ) *
}
ÑÑ 
if
ÜÜ 
(
ÜÜ 
shellSettings
ÜÜ 
.
ÜÜ 
State
ÜÜ #
!=
ÜÜ$ &
TenantState
ÜÜ' 2
.
ÜÜ2 3
Uninitialized
ÜÜ3 @
)
ÜÜ@ A
{
áá 
return
àà 
Outcomes
àà 
(
àà  
$str
àà  (
)
àà( )
;
àà) *
}
ââ 
var
ãã 
siteName
ãã 
=
ãã 
(
ãã 
await
ãã !!
ExpressionEvaluator
ãã" 5
.
ãã5 6
EvaluateAsync
ãã6 C
(
ããC D
SiteName
ããD L
,
ããL M
workflowContext
ããN ]
,
ãã] ^
null
ãã_ c
)
ããc d
)
ããd e
?
ããe f
.
ããf g
Trim
ããg k
(
ããk l
)
ããl m
;
ããm n
var
åå 
adminUsername
åå 
=
åå 
(
åå  !
await
åå! &!
ExpressionEvaluator
åå' :
.
åå: ;
EvaluateAsync
åå; H
(
ååH I
AdminUsername
ååI V
,
ååV W
workflowContext
ååX g
,
ååg h
null
ååi m
)
ååm n
)
åån o
?
ååo p
.
ååp q
Trim
ååq u
(
ååu v
)
ååv w
;
ååw x
var
çç 

adminEmail
çç 
=
çç 
(
çç 
await
çç #!
ExpressionEvaluator
çç$ 7
.
çç7 8
EvaluateAsync
çç8 E
(
ççE F

AdminEmail
ççF P
,
ççP Q
workflowContext
ççR a
,
çça b
null
ççc g
)
ççg h
)
ççh i
?
ççi j
.
ççj k
Trim
ççk o
(
çço p
)
ççp q
;
ççq r
if
èè 
(
èè 
string
èè 
.
èè 
IsNullOrEmpty
èè $
(
èè$ %
adminUsername
èè% 2
)
èè2 3
||
èè4 6
adminUsername
èè7 D
.
èèD E
Any
èèE H
(
èèH I
c
èèI J
=>
èèK M
!
èèN O
_identityOptions
èèO _
.
èè_ `
User
èè` d
.
èèd e'
AllowedUserNameCharacters
èèe ~
.
èè~ 
Containsèè á
(èèá à
cèèà â
)èèâ ä
)èèä ã
)èèã å
{
êê 
return
ëë 
Outcomes
ëë 
(
ëë  
$str
ëë  (
)
ëë( )
;
ëë) *
}
íí 
if
îî 
(
îî 
string
îî 
.
îî 
IsNullOrEmpty
îî $
(
îî$ %

adminEmail
îî% /
)
îî/ 0
||
îî1 3
!
îî4 5$
_emailAddressValidator
îî5 K
.
îîK L
Validate
îîL T
(
îîT U

adminEmail
îîU _
)
îî_ `
)
îî` a
{
ïï 
return
ññ 
Outcomes
ññ 
(
ññ  
$str
ññ  (
)
ññ( )
;
ññ) *
}
óó 
var
ôô 
adminPassword
ôô 
=
ôô 
(
ôô  !
await
ôô! &!
ExpressionEvaluator
ôô' :
.
ôô: ;
EvaluateAsync
ôô; H
(
ôôH I
AdminPassword
ôôI V
,
ôôV W
workflowContext
ôôX g
,
ôôg h
null
ôôi m
)
ôôm n
)
ôôn o
?
ôôo p
.
ôôp q
Trim
ôôq u
(
ôôu v
)
ôôv w
;
ôôw x
var
õõ 
databaseProvider
õõ  
=
õõ! "
(
õõ# $
await
õõ$ )!
ExpressionEvaluator
õõ* =
.
õõ= >
EvaluateAsync
õõ> K
(
õõK L
DatabaseProvider
õõL \
,
õõ\ ]
workflowContext
õõ^ m
,
õõm n
null
õõo s
)
õõs t
)
õõt u
?
õõu v
.
õõv w
Trim
õõw {
(
õõ{ |
)
õõ| }
;
õõ} ~
var
úú &
databaseConnectionString
úú (
=
úú) *
(
úú+ ,
await
úú, 1!
ExpressionEvaluator
úú2 E
.
úúE F
EvaluateAsync
úúF S
(
úúS T&
DatabaseConnectionString
úúT l
,
úúl m
workflowContext
úún }
,
úú} ~
nullúú É
)úúÉ Ñ
)úúÑ Ö
?úúÖ Ü
.úúÜ á
Trimúúá ã
(úúã å
)úúå ç
;úúç é
var
ùù !
databaseTablePrefix
ùù #
=
ùù$ %
(
ùù& '
await
ùù' ,!
ExpressionEvaluator
ùù- @
.
ùù@ A
EvaluateAsync
ùùA N
(
ùùN O!
DatabaseTablePrefix
ùùO b
,
ùùb c
workflowContext
ùùd s
,
ùùs t
null
ùùu y
)
ùùy z
)
ùùz {
?
ùù{ |
.
ùù| }
Trimùù} Å
(ùùÅ Ç
)ùùÇ É
;ùùÉ Ñ
var
ûû 

recipeName
ûû 
=
ûû 
(
ûû 
await
ûû #!
ExpressionEvaluator
ûû$ 7
.
ûû7 8
EvaluateAsync
ûû8 E
(
ûûE F

RecipeName
ûûF P
,
ûûP Q
workflowContext
ûûR a
,
ûûa b
null
ûûc g
)
ûûg h
)
ûûh i
?
ûûi j
.
ûûj k
Trim
ûûk o
(
ûûo p
)
ûûp q
;
ûûq r
if
†† 
(
†† 
string
†† 
.
†† 
IsNullOrEmpty
†† $
(
††$ %
databaseProvider
††% 5
)
††5 6
)
††6 7
{
°° 
databaseProvider
¢¢  
=
¢¢! "
shellSettings
¢¢# 0
[
¢¢0 1
$str
¢¢1 C
]
¢¢C D
;
¢¢D E
}
££ 
if
•• 
(
•• 
string
•• 
.
•• 
IsNullOrEmpty
•• $
(
••$ %&
databaseConnectionString
••% =
)
••= >
)
••> ?
{
¶¶ &
databaseConnectionString
ßß (
=
ßß) *
shellSettings
ßß+ 8
[
ßß8 9
$str
ßß9 K
]
ßßK L
;
ßßL M
}
®® 
if
™™ 
(
™™ 
string
™™ 
.
™™ 
IsNullOrEmpty
™™ $
(
™™$ %!
databaseTablePrefix
™™% 8
)
™™8 9
)
™™9 :
{
´´ !
databaseTablePrefix
¨¨ #
=
¨¨$ %
shellSettings
¨¨& 3
[
¨¨3 4
$str
¨¨4 A
]
¨¨A B
;
¨¨B C
}
≠≠ 
if
ØØ 
(
ØØ 
string
ØØ 
.
ØØ 
IsNullOrEmpty
ØØ $
(
ØØ$ %

recipeName
ØØ% /
)
ØØ/ 0
)
ØØ0 1
{
∞∞ 

recipeName
±± 
=
±± 
shellSettings
±± *
[
±±* +
$str
±±+ 7
]
±±7 8
;
±±8 9
}
≤≤ 
var
¥¥ 
recipes
¥¥ 
=
¥¥ 
await
¥¥ 
SetupService
¥¥  ,
.
¥¥, -"
GetSetupRecipesAsync
¥¥- A
(
¥¥A B
)
¥¥B C
;
¥¥C D
var
µµ 
recipe
µµ 
=
µµ 
recipes
µµ  
.
µµ  !
FirstOrDefault
µµ! /
(
µµ/ 0
r
µµ0 1
=>
µµ2 4
r
µµ5 6
.
µµ6 7
Name
µµ7 ;
==
µµ< >

recipeName
µµ? I
)
µµI J
;
µµJ K
var
∑∑ 
setupContext
∑∑ 
=
∑∑ 
new
∑∑ "
SetupContext
∑∑# /
{
∏∏ 
ShellSettings
ππ 
=
ππ 
shellSettings
ππ  -
,
ππ- .
EnabledFeatures
∫∫ 
=
∫∫  !
null
∫∫" &
,
∫∫& '
Errors
ªª 
=
ªª 
new
ªª 

Dictionary
ªª '
<
ªª' (
string
ªª( .
,
ªª. /
string
ªª0 6
>
ªª6 7
(
ªª7 8
)
ªª8 9
,
ªª9 :
Recipe
ºº 
=
ºº 
recipe
ºº 
,
ºº  

Properties
ΩΩ 
=
ΩΩ 
new
ΩΩ  

Dictionary
ΩΩ! +
<
ΩΩ+ ,
string
ΩΩ, 2
,
ΩΩ2 3
object
ΩΩ4 :
>
ΩΩ: ;
{
ææ 
{
øø 
SetupConstants
øø $
.
øø$ %
SiteName
øø% -
,
øø- .
siteName
øø/ 7
}
øø8 9
,
øø9 :
{
¿¿ 
SetupConstants
¿¿ $
.
¿¿$ %
AdminUsername
¿¿% 2
,
¿¿2 3
adminUsername
¿¿4 A
}
¿¿B C
,
¿¿C D
{
¡¡ 
SetupConstants
¡¡ $
.
¡¡$ %

AdminEmail
¡¡% /
,
¡¡/ 0

AdminEmail
¡¡1 ;
}
¡¡< =
,
¡¡= >
{
¬¬ 
SetupConstants
¬¬ $
.
¬¬$ %
AdminPassword
¬¬% 2
,
¬¬2 3
adminPassword
¬¬4 A
}
¬¬B C
,
¬¬C D
{
√√ 
SetupConstants
√√ $
.
√√$ %
SiteTimeZone
√√% 1
,
√√1 2
_clock
√√3 9
.
√√9 :
GetSystemTimeZone
√√: K
(
√√K L
)
√√L M
.
√√M N

TimeZoneId
√√N X
}
√√Y Z
,
√√Z [
{
ƒƒ 
SetupConstants
ƒƒ $
.
ƒƒ$ %
DatabaseProvider
ƒƒ% 5
,
ƒƒ5 6
databaseProvider
ƒƒ7 G
}
ƒƒH I
,
ƒƒI J
{
≈≈ 
SetupConstants
≈≈ $
.
≈≈$ %&
DatabaseConnectionString
≈≈% =
,
≈≈= >&
databaseConnectionString
≈≈? W
}
≈≈X Y
,
≈≈Y Z
{
∆∆ 
SetupConstants
∆∆ $
.
∆∆$ %&
DatabaseConnectionString
∆∆% =
,
∆∆= >!
databaseTablePrefix
∆∆? R
}
∆∆S T
,
∆∆T U
}
«« 
}
»» 
;
»» 
var
   
executionId
   
=
   
await
   #
SetupService
  $ 0
.
  0 1

SetupAsync
  1 ;
(
  ; <
setupContext
  < H
)
  H I
;
  I J
if
ÕÕ 
(
ÕÕ 
setupContext
ÕÕ 
.
ÕÕ 
Errors
ÕÕ #
.
ÕÕ# $
Any
ÕÕ$ '
(
ÕÕ' (
)
ÕÕ( )
)
ÕÕ) *
{
ŒŒ 
var
œœ 
updater
œœ 
=
œœ "
_updateModelAccessor
œœ 2
.
œœ2 3
ModelUpdater
œœ3 ?
;
œœ? @
foreach
—— 
(
—— 
var
—— 
error
—— "
in
——# %
setupContext
——& 2
.
——2 3
Errors
——3 9
)
——9 :
{
““ 
updater
”” 
.
”” 

ModelState
”” &
.
””& '
AddModelError
””' 4
(
””4 5
error
””5 :
.
””: ;
Key
””; >
,
””> ?
error
””@ E
.
””E F
Value
””F K
)
””K L
;
””L M
}
‘‘ 
return
÷÷ 
Outcomes
÷÷ 
(
÷÷  
$str
÷÷  (
)
÷÷( )
;
÷÷) *
}
◊◊ 
return
ŸŸ 
Outcomes
ŸŸ 
(
ŸŸ 
$str
ŸŸ "
)
ŸŸ" #
;
ŸŸ# $
}
⁄⁄ 	
}
€€ 
}‹‹ ƒ
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Activities\TenantActivity.cs
	namespace		 	
OrchardCore		
 
.		 
Tenants		 
.		 
	Workflows		 '
.		' (

Activities		( 2
{

 
public 

abstract 
class 
TenantActivity (
:) *
Activity+ 3
{ 
	protected 
readonly 
IStringLocalizer +
S, -
;- .
	protected 
TenantActivity  
(  !!
IShellSettingsManager! 6 
shellSettingsManager7 K
,K L

IShellHostM W
	shellHostX a
,a b(
IWorkflowExpressionEvaluatorc !
expressionEvaluator
Ä ì
,
ì î&
IWorkflowScriptEvaluator
ï ≠
scriptEvaluator
Æ Ω
,
Ω æ
IStringLocalizer
ø œ
	localizer
– Ÿ
)
Ÿ ⁄
{ 	 
ShellSettingsManager  
=! " 
shellSettingsManager# 7
;7 8
	ShellHost 
= 
	shellHost !
;! "
ExpressionEvaluator 
=  !
expressionEvaluator" 5
;5 6
ScriptEvaluator 
= 
scriptEvaluator -
;- .
S 
= 
	localizer 
; 
} 	
public 
WorkflowExpression !
<! "
string" (
>( )

TenantName* 4
{ 	
get 
=> 
GetProperty 
( 
(  
)  !
=>" $
new% (
WorkflowExpression) ;
<; <
string< B
>B C
(C D
)D E
)E F
;F G
set 
=> 
SetProperty 
( 
value $
)$ %
;% &
} 	
	protected !
IShellSettingsManager ' 
ShellSettingsManager( <
{= >
get? B
;B C
}D E
	protected 

IShellHost 
	ShellHost &
{' (
get) ,
;, -
}. /
	protected   (
IWorkflowExpressionEvaluator   .
ExpressionEvaluator  / B
{  C D
get  E H
;  H I
}  J K
	protected!! $
IWorkflowScriptEvaluator!! *
ScriptEvaluator!!+ :
{!!; <
get!!= @
;!!@ A
}!!B C
public## 
override## 
LocalizedString## '
Category##( 0
=>##1 3
S##4 5
[##5 6
$str##6 >
]##> ?
;##? @
public%% 
override%% 
IEnumerable%% #
<%%# $
Outcome%%$ +
>%%+ ,
GetPossibleOutcomes%%- @
(%%@ A$
WorkflowExecutionContext%%A Y
workflowContext%%Z i
,%%i j
ActivityContext%%k z
activityContext	%%{ ä
)
%%ä ã
{&& 	
return'' 
Outcomes'' 
('' 
S'' 
['' 
$str'' $
]''$ %
)''% &
;''& '
}(( 	
public** 
override** #
ActivityExecutionResult** /
Execute**0 7
(**7 8$
WorkflowExecutionContext**8 P
workflowContext**Q `
,**` a
ActivityContext**b q
activityContext	**r Å
)
**Å Ç
{++ 	
return,, 
Outcomes,, 
(,, 
$str,, "
),," #
;,,# $
}-- 	
}.. 
}// à

ñD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Activities\TenantTask.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

Activities( 2
{ 
public 

abstract 
class 

TenantTask $
:% &
TenantActivity' 5
,5 6
ITask7 <
{		 
	protected

 

TenantTask

 
(

 !
IShellSettingsManager

 2 
shellSettingsManager

3 G
,

G H

IShellHost

I S
	shellHost

T ]
,

] ^(
IWorkflowExpressionEvaluator

_ { 
expressionEvaluator	

| è
,


è ê&
IWorkflowScriptEvaluator


ë ©
scriptEvaluator


™ π
,


π ∫
IStringLocalizer


ª À
	localizer


Ã ’
)


’ ÷
: 
base 
(  
shellSettingsManager '
,' (
	shellHost) 2
,2 3
expressionEvaluator4 G
,G H
scriptEvaluatorI X
,X Y
	localizerZ c
)c d
{ 	
} 	
} 
} ¡$
¶D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Drivers\CreateTenantTaskDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (
Drivers( /
{ 
public 

class )
CreateTenantTaskDisplayDriver .
:/ 0#
TenantTaskDisplayDriver1 H
<H I
CreateTenantTaskI Y
,Y Z%
CreateTenantTaskViewModel[ t
>t u
{ 
	protected		 
override		 
void		 
EditActivity		  ,
(		, -
CreateTenantTask		- =
activity		> F
,		F G%
CreateTenantTaskViewModel		H a
model		b g
)		g h
{

 	
model 
.  
TenantNameExpression &
=' (
activity) 1
.1 2

TenantName2 <
.< =

Expression= G
;G H
model 
. &
RequestUrlPrefixExpression ,
=- .
activity/ 7
.7 8
RequestUrlPrefix8 H
.H I

ExpressionI S
;S T
model 
. $
RequestUrlHostExpression *
=+ ,
activity- 5
.5 6
RequestUrlHost6 D
.D E

ExpressionE O
;O P
model 
. &
DatabaseProviderExpression ,
=- .
activity/ 7
.7 8
DatabaseProvider8 H
.H I

ExpressionI S
;S T
model 
. &
ConnectionStringExpression ,
=- .
activity/ 7
.7 8
ConnectionString8 H
.H I

ExpressionI S
;S T
model 
. !
TablePrefixExpression '
=( )
activity* 2
.2 3
TablePrefix3 >
.> ?

Expression? I
;I J
model 
.  
RecipeNameExpression &
=' (
activity) 1
.1 2

RecipeName2 <
.< =

Expression= G
;G H
} 	
	protected 
override 
void 
UpdateActivity  .
(. /%
CreateTenantTaskViewModel/ H
modelI N
,N O
CreateTenantTaskP `
activitya i
)i j
{ 	
activity 
. 

TenantName 
=  !
new" %
WorkflowExpression& 8
<8 9
string9 ?
>? @
(@ A
modelA F
.F G 
TenantNameExpressionG [
)[ \
;\ ]
activity 
. 
RequestUrlPrefix %
=& '
new( +
WorkflowExpression, >
<> ?
string? E
>E F
(F G
modelG L
.L M&
RequestUrlPrefixExpressionM g
)g h
;h i
activity 
. 
RequestUrlHost #
=$ %
new& )
WorkflowExpression* <
<< =
string= C
>C D
(D E
modelE J
.J K$
RequestUrlHostExpressionK c
)c d
;d e
activity 
. 
DatabaseProvider %
=& '
new( +
WorkflowExpression, >
<> ?
string? E
>E F
(F G
modelG L
.L M&
DatabaseProviderExpressionM g
)g h
;h i
activity 
. 
ConnectionString %
=& '
new( +
WorkflowExpression, >
<> ?
string? E
>E F
(F G
modelG L
.L M&
ConnectionStringExpressionM g
)g h
;h i
activity 
. 
TablePrefix  
=! "
new# &
WorkflowExpression' 9
<9 :
string: @
>@ A
(A B
modelB G
.G H!
TablePrefixExpressionH ]
)] ^
;^ _
activity 
. 

RecipeName 
=  !
new" %
WorkflowExpression& 8
<8 9
string9 ?
>? @
(@ A
modelA F
.F G 
RecipeNameExpressionG [
)[ \
;\ ]
} 	
} 
} â
ßD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Drivers\DisableTenantTaskDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (
Drivers( /
{ 
public 

class *
DisableTenantTaskDisplayDriver /
:0 1#
TenantTaskDisplayDriver2 I
<I J
DisableTenantTaskJ [
,[ \&
DisableTenantTaskViewModel] w
>w x
{ 
	protected		 
override		 
void		 
EditActivity		  ,
(		, -
DisableTenantTask		- >
activity		? G
,		G H&
DisableTenantTaskViewModel		I c
model		d i
)		i j
{

 	
model 
.  
TenantNameExpression &
=' (
activity) 1
.1 2

TenantName2 <
.< =

Expression= G
;G H
} 	
	protected 
override 
void 
UpdateActivity  .
(. /&
DisableTenantTaskViewModel/ I
modelJ O
,O P
DisableTenantTaskQ b
activityc k
)k l
{ 	
activity 
. 

TenantName 
=  !
new" %
WorkflowExpression& 8
<8 9
string9 ?
>? @
(@ A
modelA F
.F G 
TenantNameExpressionG [
)[ \
;\ ]
} 	
} 
} Å
¶D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Drivers\EnableTenantTaskDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (
Drivers( /
{ 
public 

class )
EnableTenantTaskDisplayDriver .
:/ 0#
TenantTaskDisplayDriver1 H
<H I
EnableTenantTaskI Y
,Y Z%
EnableTenantTaskViewModel[ t
>t u
{ 
	protected		 
override		 
void		 
EditActivity		  ,
(		, -
EnableTenantTask		- =
activity		> F
,		F G%
EnableTenantTaskViewModel		H a
model		b g
)		g h
{

 	
model 
.  
TenantNameExpression &
=' (
activity) 1
.1 2

TenantName2 <
.< =

Expression= G
;G H
} 	
	protected 
override 
void 
UpdateActivity  .
(. /%
EnableTenantTaskViewModel/ H
modelI N
,N O
EnableTenantTaskP `
activitya i
)i j
{ 	
activity 
. 

TenantName 
=  !
new" %
WorkflowExpression& 8
<8 9
string9 ?
>? @
(@ A
modelA F
.F G 
TenantNameExpressionG [
)[ \
;\ ]
} 	
} 
} ≠,
•D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Drivers\SetupTenantTaskDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (
Drivers( /
{ 
public 

class (
SetupTenantTaskDisplayDriver -
:. /#
TenantTaskDisplayDriver0 G
<G H
SetupTenantTaskH W
,W X$
SetupTenantTaskViewModelY q
>q r
{ 
	protected		 
override		 
void		 
EditActivity		  ,
(		, -
SetupTenantTask		- <
activity		= E
,		E F$
SetupTenantTaskViewModel		G _
model		` e
)		e f
{

 	
model 
.  
TenantNameExpression &
=' (
activity) 1
.1 2

TenantName2 <
.< =

Expression= G
;G H
model 
. 
SiteNameExpression $
=% &
activity' /
./ 0
SiteName0 8
.8 9

Expression9 C
;C D
model 
. #
AdminUsernameExpression )
=* +
activity, 4
.4 5
AdminUsername5 B
.B C

ExpressionC M
;M N
model 
.  
AdminEmailExpression &
=' (
activity) 1
.1 2

AdminEmail2 <
.< =

Expression= G
;G H
model 
. #
AdminPasswordExpression )
=* +
activity, 4
.4 5
AdminPassword5 B
.B C

ExpressionC M
;M N
model 
. &
DatabaseProviderExpression ,
=- .
activity/ 7
.7 8
DatabaseProvider8 H
.H I

ExpressionI S
;S T
model 
. .
"DatabaseConnectionStringExpression 4
=5 6
activity7 ?
.? @$
DatabaseConnectionString@ X
.X Y

ExpressionY c
;c d
model 
. )
DatabaseTablePrefixExpression /
=0 1
activity2 :
.: ;
DatabaseTablePrefix; N
.N O

ExpressionO Y
;Y Z
model 
.  
RecipeNameExpression &
=' (
activity) 1
.1 2

RecipeName2 <
.< =

Expression= G
;G H
} 	
	protected 
override 
void 
UpdateActivity  .
(. /$
SetupTenantTaskViewModel/ G
modelH M
,M N
SetupTenantTaskO ^
activity_ g
)g h
{ 	
activity 
. 

TenantName 
=  !
new" %
WorkflowExpression& 8
<8 9
string9 ?
>? @
(@ A
modelA F
.F G 
TenantNameExpressionG [
)[ \
;\ ]
activity 
. 
SiteName 
= 
new  #
WorkflowExpression$ 6
<6 7
string7 =
>= >
(> ?
model? D
.D E
SiteNameExpressionE W
)W X
;X Y
activity 
. 
AdminUsername "
=# $
new% (
WorkflowExpression) ;
<; <
string< B
>B C
(C D
modelD I
.I J#
AdminUsernameExpressionJ a
)a b
;b c
activity 
. 

AdminEmail 
=  !
new" %
WorkflowExpression& 8
<8 9
string9 ?
>? @
(@ A
modelA F
.F G 
AdminEmailExpressionG [
)[ \
;\ ]
activity 
. 
AdminPassword "
=# $
new% (
WorkflowExpression) ;
<; <
string< B
>B C
(C D
modelD I
.I J#
AdminPasswordExpressionJ a
)a b
;b c
activity 
. 
DatabaseProvider %
=& '
new( +
WorkflowExpression, >
<> ?
string? E
>E F
(F G
modelG L
.L M&
DatabaseProviderExpressionM g
)g h
;h i
activity 
. $
DatabaseConnectionString -
=. /
new0 3
WorkflowExpression4 F
<F G
stringG M
>M N
(N O
modelO T
.T U.
"DatabaseConnectionStringExpressionU w
)w x
;x y
activity 
. 
DatabaseTablePrefix (
=) *
new+ .
WorkflowExpression/ A
<A B
stringB H
>H I
(I J
modelJ O
.O P)
DatabaseTablePrefixExpressionP m
)m n
;n o
activity   
.   

RecipeName   
=    !
new  " %
WorkflowExpression  & 8
<  8 9
string  9 ?
>  ? @
(  @ A
model  A F
.  F G 
RecipeNameExpression  G [
)  [ \
;  \ ]
}!! 	
}"" 
}## ‰
†D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Drivers\TenantTaskDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (
Drivers( /
{ 
public 

abstract 
class #
TenantTaskDisplayDriver 1
<1 2
	TActivity2 ;
,; <

TViewModel= G
>G H
:I J!
ActivityDisplayDriverK `
<` a
	TActivitya j
,j k

TViewModell v
>v w
where		 
	TActivity		 
:		 

TenantTask		 $
where		% *

TViewModel		+ 5
:		6 7
TenantTaskViewModel		8 K
<		K L
	TActivity		L U
>		U V
,		V W
new		X [
(		[ \
)		\ ]
{

 
public 
string 

TenantName  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
override 
IDisplayResult &
Display' .
(. /
	TActivity/ 8
activity9 A
)A B
{ 	
return 
Combine 
( 
Shape 
( 
$" 
{ 
typeof 
(  
	TActivity  )
)) *
.* +
Name+ /
}/ 0
_Fields_Thumbnail0 A
"A B
,B C
newD G
TenantTaskViewModelH [
<[ \
	TActivity\ e
>e f
(f g
activityg o
)o p
)p q
.q r
Locationr z
(z {
$str	{ Ü
,
Ü á
$str
à ë
)
ë í
,
í ì
Shape 
( 
$" 
{ 
typeof 
(  
	TActivity  )
)) *
.* +
Name+ /
}/ 0
_Fields_Design0 >
"> ?
,? @
newA D
TenantTaskViewModelE X
<X Y
	TActivityY b
>b c
(c d
activityd l
)l m
)m n
.n o
Locationo w
(w x
$str	x Ä
,
Ä Å
$str
Ç ã
)
ã å
) 
; 
} 	
} 
} €
àD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\Startup.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
{ 
[		 
RequireFeatures		 
(		 
$str		 ,
)		, -
]		- .
public

 

class

 
Startup

 
:

 
StartupBase

 &
{ 
public 
override 
void 
ConfigureServices .
(. /
IServiceCollection/ A
servicesB J
)J K
{ 	
services 
. 
AddActivity  
<  !
DisableTenantTask! 2
,2 3*
DisableTenantTaskDisplayDriver4 R
>R S
(S T
)T U
;U V
services 
. 
AddActivity  
<  !
EnableTenantTask! 1
,1 2)
EnableTenantTaskDisplayDriver3 P
>P Q
(Q R
)R S
;S T
services 
. 
AddActivity  
<  !
CreateTenantTask! 1
,1 2)
CreateTenantTaskDisplayDriver3 P
>P Q
(Q R
)R S
;S T
services 
. 
AddActivity  
<  !
SetupTenantTask! 0
,0 1(
SetupTenantTaskDisplayDriver2 N
>N O
(O P
)P Q
;Q R
} 	
} 
} È
•D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\ViewModels\CreateTenantTaskViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

ViewModels( 2
{ 
public 

class %
CreateTenantTaskViewModel *
:+ ,
TenantTaskViewModel- @
<@ A
CreateTenantTaskA Q
>Q R
{ 
public 
string !
DescriptionExpression +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public		 
string		 &
RequestUrlPrefixExpression		 0
{		1 2
get		3 6
;		6 7
set		8 ;
;		; <
}		= >
public 
string $
RequestUrlHostExpression .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
string &
DatabaseProviderExpression 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
string &
ConnectionStringExpression 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
string !
TablePrefixExpression +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
string  
RecipeNameExpression *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} º
¶D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\ViewModels\DisableTenantTaskViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

ViewModels( 2
{ 
public 

class &
DisableTenantTaskViewModel +
:, -
TenantTaskViewModel. A
<A B
DisableTenantTaskB S
>S T
{ 
} 
} π
•D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\ViewModels\EnableTenantTaskViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

ViewModels( 2
{ 
public 

class %
EnableTenantTaskViewModel *
:+ ,
TenantTaskViewModel- @
<@ A
EnableTenantTaskA Q
>Q R
{ 
} 
} ó
§D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\ViewModels\SetupTenantTaskViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

ViewModels( 2
{ 
public 

class $
SetupTenantTaskViewModel )
:* +
TenantTaskViewModel, ?
<? @
SetupTenantTask@ O
>O P
{ 
public 
string 
SiteNameExpression (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string #
AdminUsernameExpression -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public		 
string		  
AdminEmailExpression		 *
{		+ ,
get		- 0
;		0 1
set		2 5
;		5 6
}		7 8
public

 
string

 #
AdminPasswordExpression

 -
{

. /
get

0 3
;

3 4
set

5 8
;

8 9
}

: ;
public 
string &
DatabaseProviderExpression 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
string .
"DatabaseConnectionStringExpression 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 
string )
DatabaseTablePrefixExpression 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
public 
string  
RecipeNameExpression *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} ã	
üD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Tenants\Workflows\ViewModels\TenantTaskViewModel.cs
	namespace 	
OrchardCore
 
. 
Tenants 
. 
	Workflows '
.' (

ViewModels( 2
{ 
public 

class 
TenantTaskViewModel $
<$ %
T% &
>& '
:( )
ActivityViewModel* ;
<; <
T< =
>= >
where? D
TE F
:G H

TenantTaskI S
{ 
public 
string  
TenantNameExpression *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public

 
TenantTaskViewModel

 "
(

" #
)

# $
{ 	
} 	
public 
TenantTaskViewModel "
(" #
T# $
activity% -
)- .
{ 	
Activity 
= 
activity 
;  
} 	
} 
} 