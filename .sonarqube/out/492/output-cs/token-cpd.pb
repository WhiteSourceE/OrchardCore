˚ 
ÖD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\AdminMenu.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
{		 
public

 

class

 
	AdminMenu

 
:

 
INavigationProvider

 0
{ 
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public 
	AdminMenu 
( 
IStringLocalizer )
<) *
	AdminMenu* 3
>3 4
	localizer5 >
)> ?
{ 	
S 
= 
	localizer 
; 
} 	
public 
Task  
BuildNavigationAsync (
(( )
string) /
name0 4
,4 5
NavigationBuilder6 G
builderH O
)O P
{ 	
if 
( 
! 
String 
. 
Equals 
( 
name #
,# $
$str% ,
,, -
StringComparison. >
.> ?
OrdinalIgnoreCase? P
)P Q
)Q R
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
var 
adminControllerName #
=$ %
typeof& ,
(, -
AdminController- <
)< =
.= >
ControllerName> L
(L M
)M N
;N O
builder 
. 
Add 
( 
S 
[ 
$str #
]# $
,$ %
content& -
=>. 0
content1 8
. 
Add 
( 
S 
[ 
$str +
]+ ,
,, -
S. /
[/ 0
$str0 D
]D E
.E F
PrefixPositionF T
(T U
$strU X
)X Y
,Y Z
contentDefinition[ l
=>m o
contentDefinition	p Å
. 
Add 
( 
S 
[ 
$str *
]* +
,+ ,
S- .
[. /
$str/ >
]> ?
.? @
PrefixPosition@ N
(N O
$strO R
)R S
,S T
contentTypesU a
=>b d
contentTypese q
. 
Action 
(  
nameof  &
(& '
AdminController' 6
.6 7
List7 ;
); <
,< =
adminControllerName> Q
,Q R
newS V
{W X
areaY ]
=^ _
$str` z
}{ |
)| }
.   

Permission   #
(  # $
Permissions  $ /
.  / 0
ViewContentTypes  0 @
)  @ A
.!! 
LocalNav!! !
(!!! "
)!!" #
)!!# $
."" 
Add"" 
("" 
S"" 
["" 
$str"" *
]""* +
,""+ ,
S""- .
["". /
$str""/ >
]""> ?
.""? @
PrefixPosition""@ N
(""N O
$str""O R
)""R S
,""S T
contentParts""U a
=>""b d
contentParts""e q
.## 
Action## 
(##  
nameof##  &
(##& '
AdminController##' 6
.##6 7
	ListParts##7 @
)##@ A
,##A B
adminControllerName##C V
,##V W
new##X [
{##\ ]
area##^ b
=##c d
$str##e 
}
##Ä Å
)
##Å Ç
.$$ 

Permission$$ #
($$# $
Permissions$$$ /
.$$/ 0
ViewContentTypes$$0 @
)$$@ A
.%% 
LocalNav%% !
(%%! "
)%%" #
)%%# $
)&& 
)&& 
;&& 
return(( 
Task(( 
.(( 
CompletedTask(( %
;((% &
})) 	
}** 
}++ ö¯
óD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Controllers\AdminController.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Controllers# .
{ 
public 

class 
AdminController  
:! "

Controller# -
{ 
private 
readonly %
IContentDefinitionService 2%
_contentDefinitionService3 L
;L M
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
private 
readonly !
IAuthorizationService .!
_authorizationService/ D
;D E
private 
readonly 
IDocumentStore '
_documentStore( 6
;6 7
private 
readonly ,
 IContentDefinitionDisplayManager 9,
 _contentDefinitionDisplayManager: Z
;Z [
private 
readonly 
IHtmlLocalizer '
H( )
;) *
private 
readonly 
IStringLocalizer )
S* +
;+ ,
private   
readonly   
	INotifier   "
	_notifier  # ,
;  , -
private!! 
readonly!!  
IUpdateModelAccessor!! - 
_updateModelAccessor!!. B
;!!B C
public## 
AdminController## 
(## ,
 IContentDefinitionDisplayManager$$ ,+
contentDefinitionDisplayManager$$- L
,$$L M%
IContentDefinitionService%% %$
contentDefinitionService%%& >
,%%> ?%
IContentDefinitionManager&& %$
contentDefinitionManager&&& >
,&&> ?!
IAuthorizationService'' ! 
authorizationService''" 6
,''6 7
IDocumentStore(( 
documentStore(( (
,((( )
IHtmlLocalizer)) 
<)) 
AdminController)) *
>))* +
htmlLocalizer)), 9
,))9 :
IStringLocalizer** 
<** 
AdminController** ,
>**, -
stringLocalizer**. =
,**= >
	INotifier++ 
notifier++ 
,++  
IUpdateModelAccessor,,  
updateModelAccessor,,! 4
),,4 5
{-- 	
	_notifier.. 
=.. 
notifier..  
;..  !,
 _contentDefinitionDisplayManager// ,
=//- .+
contentDefinitionDisplayManager/// N
;//N O
_documentStore00 
=00 
documentStore00 *
;00* +!
_authorizationService11 !
=11" # 
authorizationService11$ 8
;118 9%
_contentDefinitionService22 %
=22& '$
contentDefinitionService22( @
;22@ A%
_contentDefinitionManager33 %
=33& '$
contentDefinitionManager33( @
;33@ A 
_updateModelAccessor44  
=44! "
updateModelAccessor44# 6
;446 7
H66 
=66 
htmlLocalizer66 
;66 
S77 
=77 
stringLocalizer77 
;77  
}88 	
public:: 
Task:: 
<:: 
ActionResult::  
>::  !
Index::" '
(::' (
)::( )
{;; 	
return<< 
List<< 
(<< 
)<< 
;<< 
}== 	
publicAA 
asyncAA 
TaskAA 
<AA 
ActionResultAA &
>AA& '
ListAA( ,
(AA, -
)AA- .
{BB 	
ifCC 
(CC 
!CC 
awaitCC !
_authorizationServiceCC ,
.CC, -
AuthorizeAsyncCC- ;
(CC; <
UserCC< @
,CC@ A
PermissionsCCB M
.CCM N
ViewContentTypesCCN ^
)CC^ _
)CC_ `
{DD 
returnEE 
ForbidEE 
(EE 
)EE 
;EE  
}FF 
returnHH 
ViewHH 
(HH 
$strHH 
,HH 
newHH  #%
ListContentTypesViewModelHH$ =
{II 
TypesJJ 
=JJ %
_contentDefinitionServiceJJ 1
.JJ1 2
GetTypesJJ2 :
(JJ: ;
)JJ; <
}KK 
)KK 
;KK 
}LL 	
publicNN 
asyncNN 
TaskNN 
<NN 
ActionResultNN &
>NN& '
CreateNN( .
(NN. /
stringNN/ 5

suggestionNN6 @
)NN@ A
{OO 	
ifPP 
(PP 
!PP 
awaitPP !
_authorizationServicePP ,
.PP, -
AuthorizeAsyncPP- ;
(PP; <
UserPP< @
,PP@ A
PermissionsPPB M
.PPM N
EditContentTypesPPN ^
)PP^ _
)PP_ `
{QQ 
returnRR 
ForbidRR 
(RR 
)RR 
;RR  
}SS 
returnUU 
ViewUU 
(UU 
newUU 
CreateTypeViewModelUU /
{UU0 1
DisplayNameUU2 =
=UU> ?

suggestionUU@ J
,UUJ K
NameUUL P
=UUQ R

suggestionUUS ]
.UU] ^

ToSafeNameUU^ h
(UUh i
)UUi j
}UUk l
)UUl m
;UUm n
}VV 	
[XX 	
HttpPostXX	 
,XX 

ActionNameXX 
(XX 
$strXX &
)XX& '
]XX' (
publicYY 
asyncYY 
TaskYY 
<YY 
ActionResultYY &
>YY& '

CreatePOSTYY( 2
(YY2 3
CreateTypeViewModelYY3 F
	viewModelYYG P
)YYP Q
{ZZ 	
if[[ 
([[ 
![[ 
await[[ !
_authorizationService[[ ,
.[[, -
AuthorizeAsync[[- ;
([[; <
User[[< @
,[[@ A
Permissions[[B M
.[[M N
EditContentTypes[[N ^
)[[^ _
)[[_ `
{\\ 
return]] 
Forbid]] 
(]] 
)]] 
;]]  
}^^ 
	viewModel`` 
.`` 
DisplayName`` !
=``" #
	viewModel``$ -
.``- .
DisplayName``. 9
?``9 :
.``: ;
Trim``; ?
(``? @
)``@ A
??``B D
String``E K
.``K L
Empty``L Q
;``Q R
	viewModelaa 
.aa 
Nameaa 
=aa 
	viewModelaa &
.aa& '
Nameaa' +
??aa, .
Stringaa/ 5
.aa5 6
Emptyaa6 ;
;aa; <
ifcc 
(cc 
Stringcc 
.cc 
IsNullOrWhiteSpacecc )
(cc) *
	viewModelcc* 3
.cc3 4
DisplayNamecc4 ?
)cc? @
)cc@ A
{dd 

ModelStateee 
.ee 
AddModelErroree (
(ee( )
$stree) 6
,ee6 7
See8 9
[ee9 :
$stree: \
]ee\ ]
)ee] ^
;ee^ _
}ff 
ifhh 
(hh %
_contentDefinitionServicehh )
.hh) *
	LoadTypeshh* 3
(hh3 4
)hh4 5
.hh5 6
Anyhh6 9
(hh9 :
thh: ;
=>hh< >
Stringhh? E
.hhE F
EqualshhF L
(hhL M
thhM N
.hhN O
DisplayNamehhO Z
.hhZ [
Trimhh[ _
(hh_ `
)hh` a
,hha b
	viewModelhhc l
.hhl m
DisplayNamehhm x
.hhx y
Trimhhy }
(hh} ~
)hh~ 
,	hh Ä
StringComparison
hhÅ ë
.
hhë í
OrdinalIgnoreCase
hhí £
)
hh£ §
)
hh§ •
)
hh• ¶
{ii 

ModelStatejj 
.jj 
AddModelErrorjj (
(jj( )
$strjj) 6
,jj6 7
Sjj8 9
[jj9 :
$strjj: m
]jjm n
)jjn o
;jjo p
}kk 
ifmm 
(mm 
Stringmm 
.mm 
IsNullOrWhiteSpacemm )
(mm) *
	viewModelmm* 3
.mm3 4
Namemm4 8
)mm8 9
)mm9 :
{nn 

ModelStateoo 
.oo 
AddModelErroroo (
(oo( )
$stroo) /
,oo/ 0
Soo1 2
[oo2 3
$stroo3 W
]ooW X
)ooX Y
;ooY Z
}pp 
ifrr 
(rr 
!rr 
Stringrr 
.rr 
IsNullOrWhiteSpacerr *
(rr* +
	viewModelrr+ 4
.rr4 5
Namerr5 9
)rr9 :
&&rr; =
!rr> ?
	viewModelrr? H
.rrH I
NamerrI M
[rrM N
$numrrN O
]rrO P
.rrP Q
IsLetterrrQ Y
(rrY Z
)rrZ [
)rr[ \
{ss 

ModelStatett 
.tt 
AddModelErrortt (
(tt( )
$strtt) /
,tt/ 0
Stt1 2
[tt2 3
$strtt3 a
]tta b
)ttb c
;ttc d
}uu 
ifww 
(ww 
!ww 
Stringww 
.ww 
Equalsww 
(ww 
	viewModelww (
.ww( )
Nameww) -
,ww- .
	viewModelww/ 8
.ww8 9
Nameww9 =
.ww= >

ToSafeNameww> H
(wwH I
)wwI J
,wwJ K
StringComparisonwwL \
.ww\ ]
OrdinalIgnoreCaseww] n
)wwn o
)wwo p
{xx 

ModelStateyy 
.yy 
AddModelErroryy (
(yy( )
$stryy) /
,yy/ 0
Syy1 2
[yy2 3
$stryy3 d
]yyd e
)yye f
;yyf g
}zz 
if|| 
(|| %
_contentDefinitionService|| )
.||) *
	LoadTypes||* 3
(||3 4
)||4 5
.||5 6
Any||6 9
(||9 :
t||: ;
=>||< >
String||? E
.||E F
Equals||F L
(||L M
t||M N
.||N O
Name||O S
.||S T
Trim||T X
(||X Y
)||Y Z
,||Z [
	viewModel||\ e
.||e f
Name||f j
.||j k
Trim||k o
(||o p
)||p q
,||q r
StringComparison	||s É
.
||É Ñ
OrdinalIgnoreCase
||Ñ ï
)
||ï ñ
)
||ñ ó
)
||ó ò
{}} 

ModelState~~ 
.~~ 
AddModelError~~ (
(~~( )
$str~~) /
,~~/ 0
S~~1 2
[~~2 3
$str~~3 h
]~~h i
)~~i j
;~~j k
} 
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 

ModelState
ÅÅ 
.
ÅÅ 
IsValid
ÅÅ #
)
ÅÅ# $
{
ÇÇ 
_documentStore
ÉÉ 
.
ÉÉ 
Cancel
ÉÉ %
(
ÉÉ% &
)
ÉÉ& '
;
ÉÉ' (
return
ÑÑ 
View
ÑÑ 
(
ÑÑ 
	viewModel
ÑÑ %
)
ÑÑ% &
;
ÑÑ& '
}
ÖÖ 
var
áá #
contentTypeDefinition
áá %
=
áá& ''
_contentDefinitionService
áá( A
.
ááA B
AddType
ááB I
(
ááI J
	viewModel
ááJ S
.
ááS T
Name
ááT X
,
ááX Y
	viewModel
ááZ c
.
áác d
DisplayName
áád o
)
ááo p
;
ááp q
var
ââ 
typeViewModel
ââ 
=
ââ 
new
ââ  #
EditTypeViewModel
ââ$ 5
(
ââ5 6#
contentTypeDefinition
ââ6 K
)
ââK L
;
ââL M
	_notifier
ãã 
.
ãã 
Success
ãã 
(
ãã 
H
ãã 
[
ãã  
$str
ãã  L
,
ããL M
typeViewModel
ããN [
.
ãã[ \
DisplayName
ãã\ g
]
ããg h
)
ããh i
;
ããi j
return
çç 
RedirectToAction
çç #
(
çç# $
$str
çç$ 0
,
çç0 1
new
çç2 5
{
çç6 7
id
çç8 :
=
çç; <
typeViewModel
çç= J
.
ççJ K
Name
ççK O
}
ççP Q
)
ççQ R
;
ççR S
}
éé 	
public
êê 
async
êê 
Task
êê 
<
êê 
ActionResult
êê &
>
êê& '
Edit
êê( ,
(
êê, -
string
êê- 3
id
êê4 6
)
êê6 7
{
ëë 	
if
íí 
(
íí 
!
íí 
await
íí #
_authorizationService
íí ,
.
íí, -
AuthorizeAsync
íí- ;
(
íí; <
User
íí< @
,
íí@ A
Permissions
ííB M
.
ííM N
EditContentTypes
ííN ^
)
íí^ _
)
íí_ `
{
ìì 
return
îî 
Forbid
îî 
(
îî 
)
îî 
;
îî  
}
ïï 
var
óó 
typeViewModel
óó 
=
óó '
_contentDefinitionService
óó  9
.
óó9 :
GetType
óó: A
(
óóA B
id
óóB D
)
óóD E
;
óóE F
if
ôô 
(
ôô 
typeViewModel
ôô 
==
ôô  
null
ôô! %
)
ôô% &
{
öö 
return
õõ 
NotFound
õõ 
(
õõ  
)
õõ  !
;
õõ! "
}
úú 
typeViewModel
ûû 
.
ûû 
Editor
ûû  
=
ûû! "
await
ûû# (.
 _contentDefinitionDisplayManager
ûû) I
.
ûûI J"
BuildTypeEditorAsync
ûûJ ^
(
ûû^ _
typeViewModel
ûû_ l
.
ûûl m
TypeDefinition
ûûm {
,
ûû{ |#
_updateModelAccessorûû} ë
.ûûë í
ModelUpdaterûûí û
)ûûû ü
;ûûü †
return
†† 
View
†† 
(
†† 
typeViewModel
†† %
)
††% &
;
††& '
}
°° 	
[
££ 	
HttpPost
££	 
,
££ 

ActionName
££ 
(
££ 
$str
££ $
)
££$ %
]
££% &
[
§§ 	
FormValueRequired
§§	 
(
§§ 
$str
§§ (
)
§§( )
]
§§) *
public
•• 
async
•• 
Task
•• 
<
•• 
ActionResult
•• &
>
••& '
EditPOST
••( 0
(
••0 1
string
••1 7
id
••8 :
,
••: ;
EditTypeViewModel
••< M
	viewModel
••N W
)
••W X
{
¶¶ 	
if
ßß 
(
ßß 
!
ßß 
await
ßß #
_authorizationService
ßß ,
.
ßß, -
AuthorizeAsync
ßß- ;
(
ßß; <
User
ßß< @
,
ßß@ A
Permissions
ßßB M
.
ßßM N
EditContentTypes
ßßN ^
)
ßß^ _
)
ßß_ `
{
®® 
return
©© 
Forbid
©© 
(
©© 
)
©© 
;
©©  
}
™™ 
var
¨¨ #
contentTypeDefinition
¨¨ %
=
¨¨& ''
_contentDefinitionManager
¨¨( A
.
¨¨A B 
LoadTypeDefinition
¨¨B T
(
¨¨T U
id
¨¨U W
)
¨¨W X
;
¨¨X Y
if
ÆÆ 
(
ÆÆ #
contentTypeDefinition
ÆÆ %
==
ÆÆ& (
null
ÆÆ) -
)
ÆÆ- .
{
ØØ 
return
∞∞ 
NotFound
∞∞ 
(
∞∞  
)
∞∞  !
;
∞∞! "
}
±± 
	viewModel
≥≥ 
.
≥≥ 
Settings
≥≥ 
=
≥≥  #
contentTypeDefinition
≥≥! 6
.
≥≥6 7
Settings
≥≥7 ?
;
≥≥? @
	viewModel
¥¥ 
.
¥¥ 
TypeDefinition
¥¥ $
=
¥¥% &#
contentTypeDefinition
¥¥' <
;
¥¥< =
	viewModel
µµ 
.
µµ 
DisplayName
µµ !
=
µµ" ##
contentTypeDefinition
µµ$ 9
.
µµ9 :
DisplayName
µµ: E
;
µµE F
	viewModel
∂∂ 
.
∂∂ 
Editor
∂∂ 
=
∂∂ 
await
∂∂ $.
 _contentDefinitionDisplayManager
∂∂% E
.
∂∂E F#
UpdateTypeEditorAsync
∂∂F [
(
∂∂[ \#
contentTypeDefinition
∂∂\ q
,
∂∂q r#
_updateModelAccessor∂∂s á
.∂∂á à
ModelUpdater∂∂à î
)∂∂î ï
;∂∂ï ñ
if
∏∏ 
(
∏∏ 
!
∏∏ 

ModelState
∏∏ 
.
∏∏ 
IsValid
∏∏ #
)
∏∏# $
{
ππ 
_documentStore
∫∫ 
.
∫∫ 
Cancel
∫∫ %
(
∫∫% &
)
∫∫& '
;
∫∫' (
return
ºº 
View
ºº 
(
ºº 
	viewModel
ºº %
)
ºº% &
;
ºº& '
}
ΩΩ 
else
ææ 
{
øø 
var
¿¿ !
ownedPartDefinition
¿¿ '
=
¿¿( )'
_contentDefinitionManager
¿¿* C
.
¿¿C D 
LoadPartDefinition
¿¿D V
(
¿¿V W#
contentTypeDefinition
¿¿W l
.
¿¿l m
Name
¿¿m q
)
¿¿q r
;
¿¿r s
if
¡¡ 
(
¡¡ !
ownedPartDefinition
¡¡ '
!=
¡¡( *
null
¡¡+ /
&&
¡¡0 2
	viewModel
¡¡3 <
.
¡¡< =
OrderedFieldNames
¡¡= N
!=
¡¡O Q
null
¡¡R V
)
¡¡V W
{
¬¬ '
_contentDefinitionService
√√ -
.
√√- ."
AlterPartFieldsOrder
√√. B
(
√√B C!
ownedPartDefinition
√√C V
,
√√V W
	viewModel
√√X a
.
√√a b
OrderedFieldNames
√√b s
)
√√s t
;
√√t u
}
ƒƒ '
_contentDefinitionService
≈≈ )
.
≈≈) *!
AlterTypePartsOrder
≈≈* =
(
≈≈= >#
contentTypeDefinition
≈≈> S
,
≈≈S T
	viewModel
≈≈U ^
.
≈≈^ _
OrderedPartNames
≈≈_ o
)
≈≈o p
;
≈≈p q
	_notifier
∆∆ 
.
∆∆ 
Success
∆∆ !
(
∆∆! "
H
∆∆" #
[
∆∆# $
$str
∆∆$ G
,
∆∆G H#
contentTypeDefinition
∆∆I ^
.
∆∆^ _
Name
∆∆_ c
]
∆∆c d
)
∆∆d e
;
∆∆e f
}
«« 
return
…… 
RedirectToAction
…… #
(
……# $
$str
……$ *
,
……* +
new
……, /
{
……0 1
id
……2 4
}
……5 6
)
……6 7
;
……7 8
}
   	
[
ÃÃ 	
HttpPost
ÃÃ	 
,
ÃÃ 

ActionName
ÃÃ 
(
ÃÃ 
$str
ÃÃ $
)
ÃÃ$ %
]
ÃÃ% &
[
ÕÕ 	
FormValueRequired
ÕÕ	 
(
ÕÕ 
$str
ÕÕ *
)
ÕÕ* +
]
ÕÕ+ ,
public
ŒŒ 
async
ŒŒ 
Task
ŒŒ 
<
ŒŒ 
ActionResult
ŒŒ &
>
ŒŒ& '
Delete
ŒŒ( .
(
ŒŒ. /
string
ŒŒ/ 5
id
ŒŒ6 8
)
ŒŒ8 9
{
œœ 	
if
–– 
(
–– 
!
–– 
await
–– #
_authorizationService
–– ,
.
––, -
AuthorizeAsync
––- ;
(
––; <
User
––< @
,
––@ A
Permissions
––B M
.
––M N
EditContentTypes
––N ^
)
––^ _
)
––_ `
{
—— 
return
““ 
Forbid
““ 
(
““ 
)
““ 
;
““  
}
”” 
var
’’ 
typeViewModel
’’ 
=
’’ '
_contentDefinitionService
’’  9
.
’’9 :
LoadType
’’: B
(
’’B C
id
’’C E
)
’’E F
;
’’F G
if
◊◊ 
(
◊◊ 
typeViewModel
◊◊ 
==
◊◊  
null
◊◊! %
)
◊◊% &
{
ÿÿ 
return
ŸŸ 
NotFound
ŸŸ 
(
ŸŸ  
)
ŸŸ  !
;
ŸŸ! "
}
⁄⁄ '
_contentDefinitionService
‹‹ %
.
‹‹% &

RemoveType
‹‹& 0
(
‹‹0 1
id
‹‹1 3
,
‹‹3 4
true
‹‹5 9
)
‹‹9 :
;
‹‹: ;
	_notifier
ﬁﬁ 
.
ﬁﬁ 
Success
ﬁﬁ 
(
ﬁﬁ 
H
ﬁﬁ 
[
ﬁﬁ  
$str
ﬁﬁ  ;
,
ﬁﬁ; <
typeViewModel
ﬁﬁ= J
.
ﬁﬁJ K
DisplayName
ﬁﬁK V
]
ﬁﬁV W
)
ﬁﬁW X
;
ﬁﬁX Y
return
‡‡ 
RedirectToAction
‡‡ #
(
‡‡# $
$str
‡‡$ *
)
‡‡* +
;
‡‡+ ,
}
·· 	
public
„„ 
async
„„ 
Task
„„ 
<
„„ 
ActionResult
„„ &
>
„„& '

AddPartsTo
„„( 2
(
„„2 3
string
„„3 9
id
„„: <
)
„„< =
{
‰‰ 	
if
ÂÂ 
(
ÂÂ 
!
ÂÂ 
await
ÂÂ #
_authorizationService
ÂÂ ,
.
ÂÂ, -
AuthorizeAsync
ÂÂ- ;
(
ÂÂ; <
User
ÂÂ< @
,
ÂÂ@ A
Permissions
ÂÂB M
.
ÂÂM N
EditContentTypes
ÂÂN ^
)
ÂÂ^ _
)
ÂÂ_ `
{
ÊÊ 
return
ÁÁ 
Forbid
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ  
}
ËË 
var
ÍÍ 
typeViewModel
ÍÍ 
=
ÍÍ '
_contentDefinitionService
ÍÍ  9
.
ÍÍ9 :
GetType
ÍÍ: A
(
ÍÍA B
id
ÍÍB D
)
ÍÍD E
;
ÍÍE F
if
ÏÏ 
(
ÏÏ 
typeViewModel
ÏÏ 
==
ÏÏ  
null
ÏÏ! %
)
ÏÏ% &
{
ÌÌ 
return
ÓÓ 
NotFound
ÓÓ 
(
ÓÓ  
)
ÓÓ  !
;
ÓÓ! "
}
ÔÔ 
var
ÒÒ 
typePartNames
ÒÒ 
=
ÒÒ 
new
ÒÒ  #
HashSet
ÒÒ$ +
<
ÒÒ+ ,
string
ÒÒ, 2
>
ÒÒ2 3
(
ÒÒ3 4
typeViewModel
ÒÒ4 A
.
ÒÒA B
TypeDefinition
ÒÒB P
.
ÒÒP Q
Parts
ÒÒQ V
.
ÒÒV W
Select
ÒÒW ]
(
ÒÒ] ^
p
ÒÒ^ _
=>
ÒÒ` b
p
ÒÒc d
.
ÒÒd e
PartDefinition
ÒÒe s
.
ÒÒs t
Name
ÒÒt x
)
ÒÒx y
)
ÒÒy z
;
ÒÒz {
var
ÛÛ 
	viewModel
ÛÛ 
=
ÛÛ 
new
ÛÛ 
AddPartsViewModel
ÛÛ  1
{
ÙÙ 
Type
ıı 
=
ıı 
typeViewModel
ıı $
,
ıı$ %
PartSelections
ˆˆ 
=
ˆˆ  '
_contentDefinitionService
ˆˆ! :
.
ˆˆ: ;
GetParts
ˆˆ; C
(
ˆˆC D
metadataPartsOnly
ˆˆD U
:
ˆˆU V
false
ˆˆW \
)
ˆˆ\ ]
.
˜˜ 
Where
˜˜ 
(
˜˜ 
cpd
˜˜ 
=>
˜˜ !
!
˜˜" #
typePartNames
˜˜# 0
.
˜˜0 1
Contains
˜˜1 9
(
˜˜9 :
cpd
˜˜: =
.
˜˜= >
Name
˜˜> B
)
˜˜B C
&&
˜˜D F
cpd
˜˜G J
.
˜˜J K
PartDefinition
˜˜K Y
!=
˜˜Z \
null
˜˜] a
?
˜˜b c
cpd
˜˜d g
.
˜˜g h
PartDefinition
˜˜h v
.
˜˜v w
GetSettings˜˜w Ç
<˜˜Ç É#
ContentPartSettings˜˜É ñ
>˜˜ñ ó
(˜˜ó ò
)˜˜ò ô
.˜˜ô ö

Attachable˜˜ö §
:˜˜• ¶
false˜˜ß ¨
)˜˜¨ ≠
.
¯¯ 
Select
¯¯ 
(
¯¯ 
cpd
¯¯ 
=>
¯¯  "
new
¯¯# &$
PartSelectionViewModel
¯¯' =
{
¯¯> ?
PartName
¯¯@ H
=
¯¯I J
cpd
¯¯K N
.
¯¯N O
Name
¯¯O S
,
¯¯S T
PartDisplayName
¯¯U d
=
¯¯e f
cpd
¯¯g j
.
¯¯j k
DisplayName
¯¯k v
,
¯¯v w
PartDescription¯¯x á
=¯¯à â
cpd¯¯ä ç
.¯¯ç é
Description¯¯é ô
}¯¯ö õ
)¯¯õ ú
.
˘˘ 
ToList
˘˘ 
(
˘˘ 
)
˘˘ 
}
˙˙ 
;
˙˙ 
return
¸¸ 
View
¸¸ 
(
¸¸ 
	viewModel
¸¸ !
)
¸¸! "
;
¸¸" #
}
˝˝ 	
public
ˇˇ 
async
ˇˇ 
Task
ˇˇ 
<
ˇˇ 
ActionResult
ˇˇ &
>
ˇˇ& '
AddReusablePartTo
ˇˇ( 9
(
ˇˇ9 :
string
ˇˇ: @
id
ˇˇA C
)
ˇˇC D
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
await
ÅÅ #
_authorizationService
ÅÅ ,
.
ÅÅ, -
AuthorizeAsync
ÅÅ- ;
(
ÅÅ; <
User
ÅÅ< @
,
ÅÅ@ A
Permissions
ÅÅB M
.
ÅÅM N
EditContentTypes
ÅÅN ^
)
ÅÅ^ _
)
ÅÅ_ `
{
ÇÇ 
return
ÉÉ 
Forbid
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ  
}
ÑÑ 
var
ÜÜ 
typeViewModel
ÜÜ 
=
ÜÜ '
_contentDefinitionService
ÜÜ  9
.
ÜÜ9 :
GetType
ÜÜ: A
(
ÜÜA B
id
ÜÜB D
)
ÜÜD E
;
ÜÜE F
if
àà 
(
àà 
typeViewModel
àà 
==
àà  
null
àà! %
)
àà% &
{
ââ 
return
ää 
NotFound
ää 
(
ää  
)
ää  !
;
ää! "
}
ãã 
var
çç 
reusableParts
çç 
=
çç '
_contentDefinitionService
çç  9
.
çç9 :
GetParts
çç: B
(
ççB C
metadataPartsOnly
ççC T
:
ççT U
false
ççV [
)
çç[ \
.
éé 
Where
éé 
(
éé 
cpd
éé 
=>
éé !
cpd
éé" %
.
éé% &
PartDefinition
éé& 4
!=
éé5 7
null
éé8 <
?
éé= >
(
èè 
cpd
èè 
.
èè 
PartDefinition
èè +
.
èè+ ,
GetSettings
èè, 7
<
èè7 8!
ContentPartSettings
èè8 K
>
èèK L
(
èèL M
)
èèM N
.
èèN O

Attachable
èèO Y
&&
èèZ \
cpd
êê 
.
êê 
PartDefinition
êê *
.
êê* +
GetSettings
êê+ 6
<
êê6 7!
ContentPartSettings
êê7 J
>
êêJ K
(
êêK L
)
êêL M
.
êêM N
Reusable
êêN V
)
êêV W
:
êêX Y
false
êêZ _
)
êê_ `
;
êê` a
var
íí 
	viewModel
íí 
=
íí 
new
íí &
AddReusablePartViewModel
íí  8
{
ìì 
Type
îî 
=
îî 
typeViewModel
îî $
,
îî$ %
PartSelections
ïï 
=
ïï  
reusableParts
ïï! .
.
ññ 
Select
ññ 
(
ññ 
cpd
ññ 
=>
ññ  "
new
ññ# &$
PartSelectionViewModel
ññ' =
{
ññ> ?
PartName
ññ@ H
=
ññI J
cpd
ññK N
.
ññN O
Name
ññO S
,
ññS T
PartDisplayName
ññU d
=
ññe f
cpd
ññg j
.
ññj k
DisplayName
ññk v
,
ññv w
PartDescriptionññx á
=ññà â
cpdññä ç
.ññç é
Descriptionññé ô
}ññö õ
)ññõ ú
.
óó 
ToList
óó 
(
óó 
)
óó 
,
óó 
SelectedPartName
òò  
=
òò! "
reusableParts
òò# 0
.
òò0 1
FirstOrDefault
òò1 ?
(
òò? @
)
òò@ A
?
òòA B
.
òòB C
Name
òòC G
}
ôô 
;
ôô 
return
õõ 
View
õõ 
(
õõ 
	viewModel
õõ !
)
õõ! "
;
õõ" #
}
úú 	
[
ûû 	
HttpPost
ûû	 
,
ûû 

ActionName
ûû 
(
ûû 
$str
ûû *
)
ûû* +
]
ûû+ ,
public
üü 
async
üü 
Task
üü 
<
üü 
ActionResult
üü &
>
üü& '
AddPartsToPOST
üü( 6
(
üü6 7
string
üü7 =
id
üü> @
)
üü@ A
{
†† 	
if
°° 
(
°° 
!
°° 
await
°° #
_authorizationService
°° ,
.
°°, -
AuthorizeAsync
°°- ;
(
°°; <
User
°°< @
,
°°@ A
Permissions
°°B M
.
°°M N
EditContentTypes
°°N ^
)
°°^ _
)
°°_ `
{
¢¢ 
return
££ 
Forbid
££ 
(
££ 
)
££ 
;
££  
}
§§ 
var
¶¶ 
typeViewModel
¶¶ 
=
¶¶ '
_contentDefinitionService
¶¶  9
.
¶¶9 :
LoadType
¶¶: B
(
¶¶B C
id
¶¶C E
)
¶¶E F
;
¶¶F G
if
®® 
(
®® 
typeViewModel
®® 
==
®®  
null
®®! %
)
®®% &
{
©© 
return
™™ 
NotFound
™™ 
(
™™  
)
™™  !
;
™™! "
}
´´ 
var
≠≠ 
	viewModel
≠≠ 
=
≠≠ 
new
≠≠ 
AddPartsViewModel
≠≠  1
(
≠≠1 2
)
≠≠2 3
;
≠≠3 4
if
ÆÆ 
(
ÆÆ 
!
ÆÆ 
await
ÆÆ !
TryUpdateModelAsync
ÆÆ *
(
ÆÆ* +
	viewModel
ÆÆ+ 4
)
ÆÆ4 5
)
ÆÆ5 6
{
ØØ 
return
∞∞ 
await
∞∞ 

AddPartsTo
∞∞ '
(
∞∞' (
id
∞∞( *
)
∞∞* +
;
∞∞+ ,
}
±± 
var
≥≥ 

partsToAdd
≥≥ 
=
≥≥ 
	viewModel
≥≥ &
.
≥≥& '
PartSelections
≥≥' 5
.
≥≥5 6
Where
≥≥6 ;
(
≥≥; <
ps
≥≥< >
=>
≥≥? A
ps
≥≥B D
.
≥≥D E

IsSelected
≥≥E O
)
≥≥O P
.
≥≥P Q
Select
≥≥Q W
(
≥≥W X
ps
≥≥X Z
=>
≥≥[ ]
ps
≥≥^ `
.
≥≥` a
PartName
≥≥a i
)
≥≥i j
;
≥≥j k
foreach
¥¥ 
(
¥¥ 
var
¥¥ 
	partToAdd
¥¥ "
in
¥¥# %

partsToAdd
¥¥& 0
)
¥¥0 1
{
µµ '
_contentDefinitionService
∂∂ )
.
∂∂) *
AddPartToType
∂∂* 7
(
∂∂7 8
	partToAdd
∂∂8 A
,
∂∂A B
typeViewModel
∂∂C P
.
∂∂P Q
Name
∂∂Q U
)
∂∂U V
;
∂∂V W
	_notifier
∑∑ 
.
∑∑ 
Success
∑∑ !
(
∑∑! "
H
∑∑" #
[
∑∑# $
$str
∑∑$ F
,
∑∑F G
	partToAdd
∑∑H Q
]
∑∑Q R
)
∑∑R S
;
∑∑S T
}
∏∏ 
if
∫∫ 
(
∫∫ 
!
∫∫ 

ModelState
∫∫ 
.
∫∫ 
IsValid
∫∫ #
)
∫∫# $
{
ªª 
_documentStore
ºº 
.
ºº 
Cancel
ºº %
(
ºº% &
)
ºº& '
;
ºº' (
return
ΩΩ 
await
ΩΩ 

AddPartsTo
ΩΩ '
(
ΩΩ' (
id
ΩΩ( *
)
ΩΩ* +
;
ΩΩ+ ,
}
ææ 
return
¿¿ 
RedirectToAction
¿¿ #
(
¿¿# $
$str
¿¿$ *
,
¿¿* +
new
¿¿, /
{
¿¿0 1
id
¿¿2 4
}
¿¿5 6
)
¿¿6 7
;
¿¿7 8
}
¡¡ 	
[
√√ 	
HttpPost
√√	 
,
√√ 

ActionName
√√ 
(
√√ 
$str
√√ 1
)
√√1 2
]
√√2 3
public
ƒƒ 
async
ƒƒ 
Task
ƒƒ 
<
ƒƒ 
ActionResult
ƒƒ &
>
ƒƒ& '#
AddReusablePartToPOST
ƒƒ( =
(
ƒƒ= >
string
ƒƒ> D
id
ƒƒE G
)
ƒƒG H
{
≈≈ 	
if
∆∆ 
(
∆∆ 
!
∆∆ 
await
∆∆ #
_authorizationService
∆∆ ,
.
∆∆, -
AuthorizeAsync
∆∆- ;
(
∆∆; <
User
∆∆< @
,
∆∆@ A
Permissions
∆∆B M
.
∆∆M N
EditContentTypes
∆∆N ^
)
∆∆^ _
)
∆∆_ `
{
«« 
return
»» 
Forbid
»» 
(
»» 
)
»» 
;
»»  
}
…… 
var
ÀÀ 
typeViewModel
ÀÀ 
=
ÀÀ '
_contentDefinitionService
ÀÀ  9
.
ÀÀ9 :
LoadType
ÀÀ: B
(
ÀÀB C
id
ÀÀC E
)
ÀÀE F
;
ÀÀF G
if
ÕÕ 
(
ÕÕ 
typeViewModel
ÕÕ 
==
ÕÕ  
null
ÕÕ! %
)
ÕÕ% &
{
ŒŒ 
return
œœ 
NotFound
œœ 
(
œœ  
)
œœ  !
;
œœ! "
}
–– 
var
““ 
	viewModel
““ 
=
““ 
new
““ &
AddReusablePartViewModel
““  8
(
““8 9
)
““9 :
;
““: ;
if
”” 
(
”” 
!
”” 
await
”” !
TryUpdateModelAsync
”” *
(
””* +
	viewModel
””+ 4
)
””4 5
)
””5 6
{
‘‘ 
return
’’ 
await
’’ 
AddReusablePartTo
’’ .
(
’’. /
id
’’/ 1
)
’’1 2
;
’’2 3
}
÷÷ 
	viewModel
ÿÿ 
.
ÿÿ 
DisplayName
ÿÿ !
=
ÿÿ" #
	viewModel
ÿÿ$ -
.
ÿÿ- .
DisplayName
ÿÿ. 9
?
ÿÿ9 :
.
ÿÿ: ;
Trim
ÿÿ; ?
(
ÿÿ? @
)
ÿÿ@ A
??
ÿÿB D
String
ÿÿE K
.
ÿÿK L
Empty
ÿÿL Q
;
ÿÿQ R
	viewModel
ŸŸ 
.
ŸŸ 
Name
ŸŸ 
=
ŸŸ 
	viewModel
ŸŸ &
.
ŸŸ& '
Name
ŸŸ' +
??
ŸŸ, .
String
ŸŸ/ 5
.
ŸŸ5 6
Empty
ŸŸ6 ;
;
ŸŸ; <
if
€€ 
(
€€ 
String
€€ 
.
€€  
IsNullOrWhiteSpace
€€ )
(
€€) *
	viewModel
€€* 3
.
€€3 4
DisplayName
€€4 ?
)
€€? @
)
€€@ A
{
‹‹ 

ModelState
›› 
.
›› 
AddModelError
›› (
(
››( )
$str
››) 6
,
››6 7
S
››8 9
[
››9 :
$str
››: \
]
››\ ]
)
››] ^
;
››^ _
}
ﬁﬁ 
if
‡‡ 
(
‡‡ 
typeViewModel
‡‡ 
.
‡‡ 
TypeDefinition
‡‡ ,
.
‡‡, -
Parts
‡‡- 2
.
‡‡2 3
Any
‡‡3 6
(
‡‡6 7
f
‡‡7 8
=>
‡‡9 ;
String
‡‡< B
.
‡‡B C
Equals
‡‡C I
(
‡‡I J
f
‡‡J K
.
‡‡K L
DisplayName
‡‡L W
(
‡‡W X
)
‡‡X Y
.
‡‡Y Z
Trim
‡‡Z ^
(
‡‡^ _
)
‡‡_ `
,
‡‡` a
	viewModel
‡‡b k
.
‡‡k l
DisplayName
‡‡l w
.
‡‡w x
Trim
‡‡x |
(
‡‡| }
)
‡‡} ~
,
‡‡~  
StringComparison‡‡Ä ê
.‡‡ê ë!
OrdinalIgnoreCase‡‡ë ¢
)‡‡¢ £
)‡‡£ §
)‡‡§ •
{
·· 

ModelState
‚‚ 
.
‚‚ 
AddModelError
‚‚ (
(
‚‚( )
$str
‚‚) 6
,
‚‚6 7
S
‚‚8 9
[
‚‚9 :
$str
‚‚: m
]
‚‚m n
)
‚‚n o
;
‚‚o p
}
„„ 
if
ÂÂ 
(
ÂÂ 
!
ÂÂ 
String
ÂÂ 
.
ÂÂ  
IsNullOrWhiteSpace
ÂÂ *
(
ÂÂ* +
	viewModel
ÂÂ+ 4
.
ÂÂ4 5
Name
ÂÂ5 9
)
ÂÂ9 :
&&
ÂÂ; =
!
ÂÂ> ?
	viewModel
ÂÂ? H
.
ÂÂH I
Name
ÂÂI M
[
ÂÂM N
$num
ÂÂN O
]
ÂÂO P
.
ÂÂP Q
IsLetter
ÂÂQ Y
(
ÂÂY Z
)
ÂÂZ [
)
ÂÂ[ \
{
ÊÊ 

ModelState
ÁÁ 
.
ÁÁ 
AddModelError
ÁÁ (
(
ÁÁ( )
$str
ÁÁ) /
,
ÁÁ/ 0
S
ÁÁ1 2
[
ÁÁ2 3
$str
ÁÁ3 a
]
ÁÁa b
)
ÁÁb c
;
ÁÁc d
}
ËË 
if
ÍÍ 
(
ÍÍ 
!
ÍÍ 
String
ÍÍ 
.
ÍÍ 
Equals
ÍÍ 
(
ÍÍ 
	viewModel
ÍÍ (
.
ÍÍ( )
Name
ÍÍ) -
,
ÍÍ- .
	viewModel
ÍÍ/ 8
.
ÍÍ8 9
Name
ÍÍ9 =
.
ÍÍ= >

ToSafeName
ÍÍ> H
(
ÍÍH I
)
ÍÍI J
,
ÍÍJ K
StringComparison
ÍÍL \
.
ÍÍ\ ]
OrdinalIgnoreCase
ÍÍ] n
)
ÍÍn o
)
ÍÍo p
{
ÎÎ 

ModelState
ÏÏ 
.
ÏÏ 
AddModelError
ÏÏ (
(
ÏÏ( )
$str
ÏÏ) /
,
ÏÏ/ 0
S
ÏÏ1 2
[
ÏÏ2 3
$str
ÏÏ3 d
]
ÏÏd e
)
ÏÏe f
;
ÏÏf g
}
ÌÌ 
if
ÔÔ 
(
ÔÔ 
String
ÔÔ 
.
ÔÔ  
IsNullOrWhiteSpace
ÔÔ )
(
ÔÔ) *
	viewModel
ÔÔ* 3
.
ÔÔ3 4
Name
ÔÔ4 8
)
ÔÔ8 9
)
ÔÔ9 :
{
 

ModelState
ÒÒ 
.
ÒÒ 
AddModelError
ÒÒ (
(
ÒÒ( )
$str
ÒÒ) /
,
ÒÒ/ 0
S
ÒÒ1 2
[
ÒÒ2 3
$str
ÒÒ3 W
]
ÒÒW X
)
ÒÒX Y
;
ÒÒY Z
}
ÚÚ 
if
ÙÙ 
(
ÙÙ 
typeViewModel
ÙÙ 
.
ÙÙ 
TypeDefinition
ÙÙ ,
.
ÙÙ, -
Parts
ÙÙ- 2
.
ÙÙ2 3
Any
ÙÙ3 6
(
ÙÙ6 7
f
ÙÙ7 8
=>
ÙÙ9 ;
String
ÙÙ< B
.
ÙÙB C
Equals
ÙÙC I
(
ÙÙI J
f
ÙÙJ K
.
ÙÙK L
Name
ÙÙL P
.
ÙÙP Q
Trim
ÙÙQ U
(
ÙÙU V
)
ÙÙV W
,
ÙÙW X
	viewModel
ÙÙY b
.
ÙÙb c
Name
ÙÙc g
.
ÙÙg h
Trim
ÙÙh l
(
ÙÙl m
)
ÙÙm n
,
ÙÙn o
StringComparisonÙÙp Ä
.ÙÙÄ Å!
OrdinalIgnoreCaseÙÙÅ í
)ÙÙí ì
)ÙÙì î
)ÙÙî ï
{
ıı 

ModelState
ˆˆ 
.
ˆˆ 
AddModelError
ˆˆ (
(
ˆˆ( )
$str
ˆˆ) /
,
ˆˆ/ 0
S
ˆˆ1 2
[
ˆˆ2 3
$str
ˆˆ3 h
]
ˆˆh i
)
ˆˆi j
;
ˆˆj k
}
˜˜ 
if
˘˘ 
(
˘˘ 
!
˘˘ 

ModelState
˘˘ 
.
˘˘ 
IsValid
˘˘ #
)
˘˘# $
{
˙˙ 
_documentStore
˚˚ 
.
˚˚ 
Cancel
˚˚ %
(
˚˚% &
)
˚˚& '
;
˚˚' (
return
¸¸ 
await
¸¸ 
AddReusablePartTo
¸¸ .
(
¸¸. /
id
¸¸/ 1
)
¸¸1 2
;
¸¸2 3
}
˝˝ 
var
ˇˇ 
	partToAdd
ˇˇ 
=
ˇˇ 
	viewModel
ˇˇ %
.
ˇˇ% &
SelectedPartName
ˇˇ& 6
;
ˇˇ6 7'
_contentDefinitionService
ÅÅ %
.
ÅÅ% &#
AddReusablePartToType
ÅÅ& ;
(
ÅÅ; <
	viewModel
ÅÅ< E
.
ÅÅE F
Name
ÅÅF J
,
ÅÅJ K
	viewModel
ÅÅL U
.
ÅÅU V
DisplayName
ÅÅV a
,
ÅÅa b
	viewModel
ÅÅc l
.
ÅÅl m
Description
ÅÅm x
,
ÅÅx y
	partToAddÅÅz É
,ÅÅÉ Ñ
typeViewModelÅÅÖ í
.ÅÅí ì
NameÅÅì ó
)ÅÅó ò
;ÅÅò ô
	_notifier
ÉÉ 
.
ÉÉ 
Success
ÉÉ 
(
ÉÉ 
H
ÉÉ 
[
ÉÉ  
$str
ÉÉ  B
,
ÉÉB C
	partToAdd
ÉÉD M
]
ÉÉM N
)
ÉÉN O
;
ÉÉO P
return
ÖÖ 
RedirectToAction
ÖÖ #
(
ÖÖ# $
$str
ÖÖ$ *
,
ÖÖ* +
new
ÖÖ, /
{
ÖÖ0 1
id
ÖÖ2 4
}
ÖÖ5 6
)
ÖÖ6 7
;
ÖÖ7 8
}
ÜÜ 	
[
àà 	
HttpPost
àà	 
,
àà 

ActionName
àà 
(
àà 
$str
àà *
)
àà* +
]
àà+ ,
public
ââ 
async
ââ 
Task
ââ 
<
ââ 
ActionResult
ââ &
>
ââ& '

RemovePart
ââ( 2
(
ââ2 3
string
ââ3 9
id
ââ: <
,
ââ< =
string
ââ> D
name
ââE I
)
ââI J
{
ää 	
if
ãã 
(
ãã 
!
ãã 
await
ãã #
_authorizationService
ãã ,
.
ãã, -
AuthorizeAsync
ãã- ;
(
ãã; <
User
ãã< @
,
ãã@ A
Permissions
ããB M
.
ããM N
EditContentTypes
ããN ^
)
ãã^ _
)
ãã_ `
{
åå 
return
çç 
Forbid
çç 
(
çç 
)
çç 
;
çç  
}
éé 
var
êê 
typeViewModel
êê 
=
êê '
_contentDefinitionService
êê  9
.
êê9 :
LoadType
êê: B
(
êêB C
id
êêC E
)
êêE F
;
êêF G
if
íí 
(
íí 
typeViewModel
íí 
==
íí  
null
íí! %
||
íí& (
!
íí) *
typeViewModel
íí* 7
.
íí7 8
TypeDefinition
íí8 F
.
ííF G
Parts
ííG L
.
ííL M
Any
ííM P
(
ííP Q
p
ííQ R
=>
ííS U
p
ííV W
.
ííW X
Name
ííX \
==
íí] _
name
íí` d
)
ííd e
)
ííe f
{
ìì 
return
îî 
NotFound
îî 
(
îî  
)
îî  !
;
îî! "
}
ïï '
_contentDefinitionService
óó %
.
óó% & 
RemovePartFromType
óó& 8
(
óó8 9
name
óó9 =
,
óó= >
id
óó? A
)
óóA B
;
óóB C
	_notifier
ôô 
.
ôô 
Success
ôô 
(
ôô 
H
ôô 
[
ôô  
$str
ôô  D
,
ôôD E
name
ôôF J
]
ôôJ K
)
ôôK L
;
ôôL M
return
õõ 
RedirectToAction
õõ #
(
õõ# $
$str
õõ$ *
,
õõ* +
new
õõ, /
{
õõ0 1
id
õõ2 4
}
õõ5 6
)
õõ6 7
;
õõ7 8
}
úú 	
public
¢¢ 
async
¢¢ 
Task
¢¢ 
<
¢¢ 
ActionResult
¢¢ &
>
¢¢& '
	ListParts
¢¢( 1
(
¢¢1 2
)
¢¢2 3
{
££ 	
if
§§ 
(
§§ 
!
§§ 
await
§§ #
_authorizationService
§§ ,
.
§§, -
AuthorizeAsync
§§- ;
(
§§; <
User
§§< @
,
§§@ A
Permissions
§§B M
.
§§M N
ViewContentTypes
§§N ^
)
§§^ _
)
§§_ `
{
•• 
return
¶¶ 
Forbid
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶  
}
ßß 
return
©© 
View
©© 
(
©© 
new
©© '
ListContentPartsViewModel
©© 5
{
™™ 
Parts
¨¨ 
=
¨¨ '
_contentDefinitionService
¨¨ 1
.
¨¨1 2
GetParts
¨¨2 :
(
¨¨: ;
true
¨¨; ?
)
¨¨T U
}
≠≠ 
)
≠≠ 
;
≠≠ 
}
ÆÆ 	
public
∞∞ 
async
∞∞ 
Task
∞∞ 
<
∞∞ 
ActionResult
∞∞ &
>
∞∞& '

CreatePart
∞∞( 2
(
∞∞2 3
string
∞∞3 9

suggestion
∞∞: D
)
∞∞D E
{
±± 	
if
≤≤ 
(
≤≤ 
!
≤≤ 
await
≤≤ #
_authorizationService
≤≤ ,
.
≤≤, -
AuthorizeAsync
≤≤- ;
(
≤≤; <
User
≤≤< @
,
≤≤@ A
Permissions
≤≤B M
.
≤≤M N
EditContentTypes
≤≤N ^
)
≤≤^ _
)
≤≤_ `
{
≥≥ 
return
¥¥ 
Forbid
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥  
}
µµ 
return
∑∑ 
View
∑∑ 
(
∑∑ 
new
∑∑ !
CreatePartViewModel
∑∑ /
{
∑∑0 1
Name
∑∑2 6
=
∑∑7 8

suggestion
∑∑9 C
.
∑∑C D

ToSafeName
∑∑D N
(
∑∑N O
)
∑∑O P
}
∑∑Q R
)
∑∑R S
;
∑∑S T
}
∏∏ 	
[
∫∫ 	
HttpPost
∫∫	 
,
∫∫ 

ActionName
∫∫ 
(
∫∫ 
$str
∫∫ *
)
∫∫* +
]
∫∫+ ,
public
ªª 
async
ªª 
Task
ªª 
<
ªª 
ActionResult
ªª &
>
ªª& '
CreatePartPOST
ªª( 6
(
ªª6 7!
CreatePartViewModel
ªª7 J
	viewModel
ªªK T
)
ªªT U
{
ºº 	
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 
await
ΩΩ #
_authorizationService
ΩΩ ,
.
ΩΩ, -
AuthorizeAsync
ΩΩ- ;
(
ΩΩ; <
User
ΩΩ< @
,
ΩΩ@ A
Permissions
ΩΩB M
.
ΩΩM N
EditContentTypes
ΩΩN ^
)
ΩΩ^ _
)
ΩΩ_ `
{
ææ 
return
øø 
Forbid
øø 
(
øø 
)
øø 
;
øø  
}
¿¿ 
	viewModel
¬¬ 
.
¬¬ 
Name
¬¬ 
=
¬¬ 
	viewModel
¬¬ &
.
¬¬& '
Name
¬¬' +
??
¬¬, .
String
¬¬/ 5
.
¬¬5 6
Empty
¬¬6 ;
;
¬¬; <
if
ƒƒ 
(
ƒƒ 
String
ƒƒ 
.
ƒƒ  
IsNullOrWhiteSpace
ƒƒ )
(
ƒƒ) *
	viewModel
ƒƒ* 3
.
ƒƒ3 4
Name
ƒƒ4 8
)
ƒƒ8 9
)
ƒƒ9 :
{
≈≈ 

ModelState
∆∆ 
.
∆∆ 
AddModelError
∆∆ (
(
∆∆( )
$str
∆∆) /
,
∆∆/ 0
S
∆∆1 2
[
∆∆2 3
$str
∆∆3 W
]
∆∆W X
)
∆∆X Y
;
∆∆Y Z
}
«« 
if
…… 
(
…… '
_contentDefinitionService
…… )
.
……) *
	LoadParts
……* 3
(
……3 4
false
……4 9
)
……9 :
.
……: ;
Any
……; >
(
……> ?
p
……? @
=>
……A C
String
……D J
.
……J K
Equals
……K Q
(
……Q R
p
……R S
.
……S T
Name
……T X
.
……X Y
Trim
……Y ]
(
……] ^
)
……^ _
,
……_ `
	viewModel
……a j
.
……j k
Name
……k o
.
……o p
Trim
……p t
(
……t u
)
……u v
,
……v w
StringComparison……x à
.……à â!
OrdinalIgnoreCase……â ö
)……ö õ
)……õ ú
)……ú ù
{
   

ModelState
ÀÀ 
.
ÀÀ 
AddModelError
ÀÀ (
(
ÀÀ( )
$str
ÀÀ) /
,
ÀÀ/ 0
S
ÀÀ1 2
[
ÀÀ2 3
$str
ÀÀ3 h
]
ÀÀh i
)
ÀÀi j
;
ÀÀj k
}
ÃÃ 
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
String
ŒŒ 
.
ŒŒ  
IsNullOrWhiteSpace
ŒŒ *
(
ŒŒ* +
	viewModel
ŒŒ+ 4
.
ŒŒ4 5
Name
ŒŒ5 9
)
ŒŒ9 :
&&
ŒŒ; =
!
ŒŒ> ?
	viewModel
ŒŒ? H
.
ŒŒH I
Name
ŒŒI M
[
ŒŒM N
$num
ŒŒN O
]
ŒŒO P
.
ŒŒP Q
IsLetter
ŒŒQ Y
(
ŒŒY Z
)
ŒŒZ [
)
ŒŒ[ \
{
œœ 

ModelState
–– 
.
–– 
AddModelError
–– (
(
––( )
$str
––) /
,
––/ 0
S
––1 2
[
––2 3
$str
––3 a
]
––a b
)
––b c
;
––c d
}
—— 
if
”” 
(
”” 
!
”” 
String
”” 
.
”” 
Equals
”” 
(
”” 
	viewModel
”” (
.
””( )
Name
””) -
,
””- .
	viewModel
””/ 8
.
””8 9
Name
””9 =
.
””= >

ToSafeName
””> H
(
””H I
)
””I J
,
””J K
StringComparison
””L \
.
””\ ]
OrdinalIgnoreCase
””] n
)
””n o
)
””o p
{
‘‘ 

ModelState
’’ 
.
’’ 
AddModelError
’’ (
(
’’( )
$str
’’) /
,
’’/ 0
S
’’1 2
[
’’2 3
$str
’’3 d
]
’’d e
)
’’e f
;
’’f g
}
÷÷ 
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 

ModelState
ÿÿ 
.
ÿÿ 
IsValid
ÿÿ #
)
ÿÿ# $
{
ŸŸ 
return
⁄⁄ 
View
⁄⁄ 
(
⁄⁄ 
	viewModel
⁄⁄ %
)
⁄⁄% &
;
⁄⁄& '
}
€€ 
var
›› 
partViewModel
›› 
=
›› '
_contentDefinitionService
››  9
.
››9 :
AddPart
››: A
(
››A B
	viewModel
››B K
)
››K L
;
››L M
if
ﬂﬂ 
(
ﬂﬂ 
partViewModel
ﬂﬂ 
==
ﬂﬂ  
null
ﬂﬂ! %
)
ﬂﬂ% &
{
‡‡ 
	_notifier
·· 
.
·· 
Information
·· %
(
··% &
H
··& '
[
··' (
$str
··( P
]
··P Q
)
··Q R
;
··R S
return
‚‚ 
View
‚‚ 
(
‚‚ 
	viewModel
‚‚ %
)
‚‚% &
;
‚‚& '
}
„„ 
	_notifier
ÂÂ 
.
ÂÂ 
Success
ÂÂ 
(
ÂÂ 
H
ÂÂ 
[
ÂÂ  
$str
ÂÂ  L
,
ÂÂL M
partViewModel
ÂÂN [
.
ÂÂ[ \
Name
ÂÂ\ `
]
ÂÂ` a
)
ÂÂa b
;
ÂÂb c
return
ÁÁ 
RedirectToAction
ÁÁ #
(
ÁÁ# $
$str
ÁÁ$ .
,
ÁÁ. /
new
ÁÁ0 3
{
ÁÁ4 5
id
ÁÁ6 8
=
ÁÁ9 :
partViewModel
ÁÁ; H
.
ÁÁH I
Name
ÁÁI M
}
ÁÁN O
)
ÁÁO P
;
ÁÁP Q
}
ËË 	
public
ÍÍ 
async
ÍÍ 
Task
ÍÍ 
<
ÍÍ 
ActionResult
ÍÍ &
>
ÍÍ& '
EditPart
ÍÍ( 0
(
ÍÍ0 1
string
ÍÍ1 7
id
ÍÍ8 :
)
ÍÍ: ;
{
ÎÎ 	
if
ÏÏ 
(
ÏÏ 
!
ÏÏ 
await
ÏÏ #
_authorizationService
ÏÏ ,
.
ÏÏ, -
AuthorizeAsync
ÏÏ- ;
(
ÏÏ; <
User
ÏÏ< @
,
ÏÏ@ A
Permissions
ÏÏB M
.
ÏÏM N
EditContentTypes
ÏÏN ^
)
ÏÏ^ _
)
ÏÏ_ `
{
ÌÌ 
return
ÓÓ 
Forbid
ÓÓ 
(
ÓÓ 
)
ÓÓ 
;
ÓÓ  
}
ÔÔ 
var
ÒÒ #
contentPartDefinition
ÒÒ %
=
ÒÒ& ''
_contentDefinitionManager
ÒÒ( A
.
ÒÒA B
GetPartDefinition
ÒÒB S
(
ÒÒS T
id
ÒÒT V
)
ÒÒV W
;
ÒÒW X
if
ÛÛ 
(
ÛÛ #
contentPartDefinition
ÛÛ %
==
ÛÛ& (
null
ÛÛ) -
)
ÛÛ- .
{
ÙÙ 
return
ıı 
NotFound
ıı 
(
ıı  
)
ıı  !
;
ıı! "
}
ˆˆ 
var
¯¯ 
	viewModel
¯¯ 
=
¯¯ 
new
¯¯ 
EditPartViewModel
¯¯  1
(
¯¯1 2#
contentPartDefinition
¯¯2 G
)
¯¯G H
;
¯¯H I
	viewModel
˘˘ 
.
˘˘ 
Editor
˘˘ 
=
˘˘ 
await
˘˘ $.
 _contentDefinitionDisplayManager
˘˘% E
.
˘˘E F"
BuildPartEditorAsync
˘˘F Z
(
˘˘Z [#
contentPartDefinition
˘˘[ p
,
˘˘p q#
_updateModelAccessor˘˘r Ü
.˘˘Ü á
ModelUpdater˘˘á ì
)˘˘ì î
;˘˘î ï
return
˚˚ 
View
˚˚ 
(
˚˚ 
	viewModel
˚˚ !
)
˚˚! "
;
˚˚" #
}
¸¸ 	
[
˛˛ 	
HttpPost
˛˛	 
,
˛˛ 

ActionName
˛˛ 
(
˛˛ 
$str
˛˛ (
)
˛˛( )
]
˛˛) *
[
ˇˇ 	
FormValueRequired
ˇˇ	 
(
ˇˇ 
$str
ˇˇ (
)
ˇˇ( )
]
ˇˇ) *
public
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
ActionResult
ÄÄ &
>
ÄÄ& '
EditPartPOST
ÄÄ( 4
(
ÄÄ4 5
string
ÄÄ5 ;
id
ÄÄ< >
,
ÄÄ> ?
string
ÄÄ@ F
[
ÄÄF G
]
ÄÄG H
orderedFieldNames
ÄÄI Z
)
ÄÄZ [
{
ÅÅ 	
if
ÇÇ 
(
ÇÇ 
!
ÇÇ 
await
ÇÇ #
_authorizationService
ÇÇ ,
.
ÇÇ, -
AuthorizeAsync
ÇÇ- ;
(
ÇÇ; <
User
ÇÇ< @
,
ÇÇ@ A
Permissions
ÇÇB M
.
ÇÇM N
EditContentTypes
ÇÇN ^
)
ÇÇ^ _
)
ÇÇ_ `
{
ÉÉ 
return
ÑÑ 
Forbid
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ  
}
ÖÖ 
var
áá #
contentPartDefinition
áá %
=
áá& ''
_contentDefinitionManager
áá( A
.
ááA B 
LoadPartDefinition
ááB T
(
ááT U
id
ááU W
)
ááW X
;
ááX Y
if
ââ 
(
ââ #
contentPartDefinition
ââ %
==
ââ& (
null
ââ) -
)
ââ- .
{
ää 
return
ãã 
NotFound
ãã 
(
ãã  
)
ãã  !
;
ãã! "
}
åå 
var
éé 
	viewModel
éé 
=
éé 
new
éé 
EditPartViewModel
éé  1
(
éé1 2#
contentPartDefinition
éé2 G
)
ééG H
;
ééH I
	viewModel
èè 
.
èè 
Editor
èè 
=
èè 
await
èè $.
 _contentDefinitionDisplayManager
èè% E
.
èèE F#
UpdatePartEditorAsync
èèF [
(
èè[ \#
contentPartDefinition
èè\ q
,
èèq r#
_updateModelAccessorèès á
.èèá à
ModelUpdaterèèà î
)èèî ï
;èèï ñ
if
ëë 
(
ëë 
!
ëë 

ModelState
ëë 
.
ëë 
IsValid
ëë #
)
ëë# $
{
íí 
_documentStore
ìì 
.
ìì 
Cancel
ìì %
(
ìì% &
)
ìì& '
;
ìì' (
return
îî 
View
îî 
(
îî 
	viewModel
îî %
)
îî% &
;
îî& '
}
ïï 
else
ññ 
{
óó '
_contentDefinitionService
òò )
.
òò) *"
AlterPartFieldsOrder
òò* >
(
òò> ?#
contentPartDefinition
òò? T
,
òòT U
orderedFieldNames
òòV g
)
òòg h
;
òòh i
	_notifier
ôô 
.
ôô 
Success
ôô !
(
ôô! "
H
ôô" #
[
ôô# $
$str
ôô$ N
,
ôôN O#
contentPartDefinition
ôôP e
.
ôôe f
Name
ôôf j
]
ôôj k
)
ôôk l
;
ôôl m
}
öö 
return
úú 
RedirectToAction
úú #
(
úú# $
$str
úú$ .
,
úú. /
new
úú0 3
{
úú4 5
id
úú6 8
}
úú9 :
)
úú: ;
;
úú; <
}
ùù 	
[
üü 	
HttpPost
üü	 
,
üü 

ActionName
üü 
(
üü 
$str
üü (
)
üü( )
]
üü) *
[
†† 	
FormValueRequired
††	 
(
†† 
$str
†† *
)
††* +
]
††+ ,
public
°° 
async
°° 
Task
°° 
<
°° 
ActionResult
°° &
>
°°& '

DeletePart
°°( 2
(
°°2 3
string
°°3 9
id
°°: <
)
°°< =
{
¢¢ 	
if
££ 
(
££ 
!
££ 
await
££ #
_authorizationService
££ ,
.
££, -
AuthorizeAsync
££- ;
(
££; <
User
££< @
,
££@ A
Permissions
££B M
.
££M N
EditContentTypes
££N ^
)
££^ _
)
££_ `
{
§§ 
return
•• 
Forbid
•• 
(
•• 
)
•• 
;
••  
}
¶¶ 
var
®® 
partViewModel
®® 
=
®® '
_contentDefinitionService
®®  9
.
®®9 :
LoadPart
®®: B
(
®®B C
id
®®C E
)
®®E F
;
®®F G
if
™™ 
(
™™ 
partViewModel
™™ 
==
™™  
null
™™! %
)
™™% &
{
´´ 
return
¨¨ 
NotFound
¨¨ 
(
¨¨  
)
¨¨  !
;
¨¨! "
}
≠≠ '
_contentDefinitionService
ØØ %
.
ØØ% &

RemovePart
ØØ& 0
(
ØØ0 1
id
ØØ1 3
)
ØØ3 4
;
ØØ4 5
	_notifier
±± 
.
±± 
Information
±± !
(
±±! "
H
±±" #
[
±±# $
$str
±±$ ?
,
±±? @
partViewModel
±±A N
.
±±N O
DisplayName
±±O Z
]
±±Z [
)
±±[ \
;
±±\ ]
return
≥≥ 
RedirectToAction
≥≥ #
(
≥≥# $
$str
≥≥$ /
)
≥≥/ 0
;
≥≥0 1
}
¥¥ 	
public
∂∂ 
async
∂∂ 
Task
∂∂ 
<
∂∂ 
ActionResult
∂∂ &
>
∂∂& '

AddFieldTo
∂∂( 2
(
∂∂2 3
string
∂∂3 9
id
∂∂: <
,
∂∂< =
string
∂∂> D
	returnUrl
∂∂E N
=
∂∂O P
null
∂∂Q U
)
∂∂U V
{
∑∑ 	
if
∏∏ 
(
∏∏ 
!
∏∏ 
await
∏∏ #
_authorizationService
∏∏ ,
.
∏∏, -
AuthorizeAsync
∏∏- ;
(
∏∏; <
User
∏∏< @
,
∏∏@ A
Permissions
∏∏B M
.
∏∏M N
EditContentTypes
∏∏N ^
)
∏∏^ _
)
∏∏_ `
{
ππ 
return
∫∫ 
Forbid
∫∫ 
(
∫∫ 
)
∫∫ 
;
∫∫  
}
ªª 
var
ΩΩ 
partViewModel
ΩΩ 
=
ΩΩ '
_contentDefinitionService
ΩΩ  9
.
ΩΩ9 :
LoadPart
ΩΩ: B
(
ΩΩB C
id
ΩΩC E
)
ΩΩE F
;
ΩΩF G
if
øø 
(
øø 
partViewModel
øø 
==
øø  
null
øø! %
)
øø% &
{
¿¿ 
return
¡¡ 
NotFound
¡¡ 
(
¡¡  
)
¡¡  !
;
¡¡! "
}
¬¬ 
var
ƒƒ 
	viewModel
ƒƒ 
=
ƒƒ 
new
ƒƒ 
AddFieldViewModel
ƒƒ  1
{
≈≈ 
Part
∆∆ 
=
∆∆ 
partViewModel
∆∆ $
.
∆∆$ %
PartDefinition
∆∆% 3
,
∆∆3 4
Fields
«« 
=
«« '
_contentDefinitionService
«« 2
.
««2 3
	GetFields
««3 <
(
««< =
)
««= >
.
««> ?
Select
««? E
(
««E F
x
««F G
=>
««H J
x
««K L
.
««L M
Name
««M Q
)
««Q R
.
««R S
OrderBy
««S Z
(
««Z [
x
««[ \
=>
««] _
x
««` a
)
««a b
.
««b c
ToList
««c i
(
««i j
)
««j k
}
»» 
;
»» 
ViewData
   
[
   
$str
    
]
    !
=
  " #
	returnUrl
  $ -
;
  - .
return
ÀÀ 
View
ÀÀ 
(
ÀÀ 
	viewModel
ÀÀ !
)
ÀÀ! "
;
ÀÀ" #
}
ÃÃ 	
[
ŒŒ 	
HttpPost
ŒŒ	 
,
ŒŒ 

ActionName
ŒŒ 
(
ŒŒ 
$str
ŒŒ *
)
ŒŒ* +
]
ŒŒ+ ,
public
œœ 
async
œœ 
Task
œœ 
<
œœ 
ActionResult
œœ &
>
œœ& '
AddFieldToPOST
œœ( 6
(
œœ6 7
AddFieldViewModel
œœ7 H
	viewModel
œœI R
,
œœR S
string
œœT Z
id
œœ[ ]
,
œœ] ^
string
œœ_ e
	returnUrl
œœf o
=
œœp q
null
œœr v
)
œœv w
{
–– 	
if
—— 
(
—— 
!
—— 
await
—— #
_authorizationService
—— ,
.
——, -
AuthorizeAsync
——- ;
(
——; <
User
——< @
,
——@ A
Permissions
——B M
.
——M N
EditContentTypes
——N ^
)
——^ _
)
——_ `
{
““ 
return
”” 
Forbid
”” 
(
”” 
)
”” 
;
””  
}
‘‘ 
var
÷÷ 
partViewModel
÷÷ 
=
÷÷ '
_contentDefinitionService
÷÷  9
.
÷÷9 :
LoadPart
÷÷: B
(
÷÷B C
id
÷÷C E
)
÷÷E F
;
÷÷F G
if
ÿÿ 
(
ÿÿ 
partViewModel
ÿÿ 
==
ÿÿ  
null
ÿÿ! %
)
ÿÿ% &
{
ŸŸ 
return
⁄⁄ 
NotFound
⁄⁄ 
(
⁄⁄  
)
⁄⁄  !
;
⁄⁄! "
}
€€ 
var
›› 
partDefinition
›› 
=
››  
partViewModel
››! .
.
››. /
PartDefinition
››/ =
;
››= >
	viewModel
ﬂﬂ 
.
ﬂﬂ 
DisplayName
ﬂﬂ !
=
ﬂﬂ" #
	viewModel
ﬂﬂ$ -
.
ﬂﬂ- .
DisplayName
ﬂﬂ. 9
?
ﬂﬂ9 :
.
ﬂﬂ: ;
Trim
ﬂﬂ; ?
(
ﬂﬂ? @
)
ﬂﬂ@ A
??
ﬂﬂB D
String
ﬂﬂE K
.
ﬂﬂK L
Empty
ﬂﬂL Q
;
ﬂﬂQ R
	viewModel
‡‡ 
.
‡‡ 
Name
‡‡ 
=
‡‡ 
	viewModel
‡‡ &
.
‡‡& '
Name
‡‡' +
??
‡‡, .
String
‡‡/ 5
.
‡‡5 6
Empty
‡‡6 ;
;
‡‡; <
if
‚‚ 
(
‚‚ 
String
‚‚ 
.
‚‚  
IsNullOrWhiteSpace
‚‚ )
(
‚‚) *
	viewModel
‚‚* 3
.
‚‚3 4
DisplayName
‚‚4 ?
)
‚‚? @
)
‚‚@ A
{
„„ 

ModelState
‰‰ 
.
‰‰ 
AddModelError
‰‰ (
(
‰‰( )
$str
‰‰) 6
,
‰‰6 7
S
‰‰8 9
[
‰‰9 :
$str
‰‰: \
]
‰‰\ ]
)
‰‰] ^
;
‰‰^ _
}
ÂÂ 
if
ÁÁ 
(
ÁÁ 
partDefinition
ÁÁ 
.
ÁÁ 
Fields
ÁÁ %
.
ÁÁ% &
Any
ÁÁ& )
(
ÁÁ) *
f
ÁÁ* +
=>
ÁÁ, .
String
ÁÁ/ 5
.
ÁÁ5 6
Equals
ÁÁ6 <
(
ÁÁ< =
f
ÁÁ= >
.
ÁÁ> ?
DisplayName
ÁÁ? J
(
ÁÁJ K
)
ÁÁK L
.
ÁÁL M
Trim
ÁÁM Q
(
ÁÁQ R
)
ÁÁR S
,
ÁÁS T
	viewModel
ÁÁU ^
.
ÁÁ^ _
DisplayName
ÁÁ_ j
.
ÁÁj k
Trim
ÁÁk o
(
ÁÁo p
)
ÁÁp q
,
ÁÁq r
StringComparisonÁÁs É
.ÁÁÉ Ñ!
OrdinalIgnoreCaseÁÁÑ ï
)ÁÁï ñ
)ÁÁñ ó
)ÁÁó ò
{
ËË 

ModelState
ÈÈ 
.
ÈÈ 
AddModelError
ÈÈ (
(
ÈÈ( )
$str
ÈÈ) 6
,
ÈÈ6 7
S
ÈÈ8 9
[
ÈÈ9 :
$str
ÈÈ: n
]
ÈÈn o
)
ÈÈo p
;
ÈÈp q
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
String
ÏÏ 
.
ÏÏ  
IsNullOrWhiteSpace
ÏÏ )
(
ÏÏ) *
	viewModel
ÏÏ* 3
.
ÏÏ3 4
Name
ÏÏ4 8
)
ÏÏ8 9
)
ÏÏ9 :
{
ÌÌ 

ModelState
ÓÓ 
.
ÓÓ 
AddModelError
ÓÓ (
(
ÓÓ( )
$str
ÓÓ) /
,
ÓÓ/ 0
S
ÓÓ1 2
[
ÓÓ2 3
$str
ÓÓ3 W
]
ÓÓW X
)
ÓÓX Y
;
ÓÓY Z
}
ÔÔ 
if
ÒÒ 
(
ÒÒ 
partDefinition
ÒÒ 
.
ÒÒ 
Fields
ÒÒ %
.
ÒÒ% &
Any
ÒÒ& )
(
ÒÒ) *
f
ÒÒ* +
=>
ÒÒ, .
String
ÒÒ/ 5
.
ÒÒ5 6
Equals
ÒÒ6 <
(
ÒÒ< =
f
ÒÒ= >
.
ÒÒ> ?
Name
ÒÒ? C
.
ÒÒC D
Trim
ÒÒD H
(
ÒÒH I
)
ÒÒI J
,
ÒÒJ K
	viewModel
ÒÒL U
.
ÒÒU V
Name
ÒÒV Z
.
ÒÒZ [
Trim
ÒÒ[ _
(
ÒÒ_ `
)
ÒÒ` a
,
ÒÒa b
StringComparison
ÒÒc s
.
ÒÒs t 
OrdinalIgnoreCaseÒÒt Ö
)ÒÒÖ Ü
)ÒÒÜ á
)ÒÒá à
{
ÚÚ 

ModelState
ÛÛ 
.
ÛÛ 
AddModelError
ÛÛ (
(
ÛÛ( )
$str
ÛÛ) /
,
ÛÛ/ 0
S
ÛÛ1 2
[
ÛÛ2 3
$str
ÛÛ3 i
]
ÛÛi j
)
ÛÛj k
;
ÛÛk l
}
ÙÙ 
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 
String
ˆˆ 
.
ˆˆ  
IsNullOrWhiteSpace
ˆˆ *
(
ˆˆ* +
	viewModel
ˆˆ+ 4
.
ˆˆ4 5
Name
ˆˆ5 9
)
ˆˆ9 :
&&
ˆˆ; =
!
ˆˆ> ?
	viewModel
ˆˆ? H
.
ˆˆH I
Name
ˆˆI M
[
ˆˆM N
$num
ˆˆN O
]
ˆˆO P
.
ˆˆP Q
IsLetter
ˆˆQ Y
(
ˆˆY Z
)
ˆˆZ [
)
ˆˆ[ \
{
˜˜ 

ModelState
¯¯ 
.
¯¯ 
AddModelError
¯¯ (
(
¯¯( )
$str
¯¯) /
,
¯¯/ 0
S
¯¯1 2
[
¯¯2 3
$str
¯¯3 a
]
¯¯a b
)
¯¯b c
;
¯¯c d
}
˘˘ 
if
˚˚ 
(
˚˚ 
!
˚˚ 
String
˚˚ 
.
˚˚ 
Equals
˚˚ 
(
˚˚ 
	viewModel
˚˚ (
.
˚˚( )
Name
˚˚) -
,
˚˚- .
	viewModel
˚˚/ 8
.
˚˚8 9
Name
˚˚9 =
.
˚˚= >

ToSafeName
˚˚> H
(
˚˚H I
)
˚˚I J
,
˚˚J K
StringComparison
˚˚L \
.
˚˚\ ]
OrdinalIgnoreCase
˚˚] n
)
˚˚n o
)
˚˚o p
{
¸¸ 

ModelState
˝˝ 
.
˝˝ 
AddModelError
˝˝ (
(
˝˝( )
$str
˝˝) /
,
˝˝/ 0
S
˝˝1 2
[
˝˝2 3
$str
˝˝3 d
]
˝˝d e
)
˝˝e f
;
˝˝f g
}
˛˛ 
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 

ModelState
ÄÄ 
.
ÄÄ 
IsValid
ÄÄ #
)
ÄÄ# $
{
ÅÅ 
	viewModel
ÇÇ 
.
ÇÇ 
Part
ÇÇ 
=
ÇÇ  
partDefinition
ÇÇ! /
;
ÇÇ/ 0
	viewModel
ÉÉ 
.
ÉÉ 
Fields
ÉÉ  
=
ÉÉ! "'
_contentDefinitionService
ÉÉ# <
.
ÉÉ< =
	GetFields
ÉÉ= F
(
ÉÉF G
)
ÉÉG H
.
ÉÉH I
Select
ÉÉI O
(
ÉÉO P
x
ÉÉP Q
=>
ÉÉR T
x
ÉÉU V
.
ÉÉV W
Name
ÉÉW [
)
ÉÉ[ \
.
ÉÉ\ ]
OrderBy
ÉÉ] d
(
ÉÉd e
x
ÉÉe f
=>
ÉÉg i
x
ÉÉj k
)
ÉÉk l
.
ÉÉl m
ToList
ÉÉm s
(
ÉÉs t
)
ÉÉt u
;
ÉÉu v
_documentStore
ÖÖ 
.
ÖÖ 
Cancel
ÖÖ %
(
ÖÖ% &
)
ÖÖ& '
;
ÖÖ' (
ViewData
áá 
[
áá 
$str
áá $
]
áá$ %
=
áá& '
	returnUrl
áá( 1
;
áá1 2
return
àà 
View
àà 
(
àà 
	viewModel
àà %
)
àà% &
;
àà& '
}
ââ '
_contentDefinitionService
ãã %
.
ãã% &
AddFieldToPart
ãã& 4
(
ãã4 5
	viewModel
ãã5 >
.
ãã> ?
Name
ãã? C
,
ããC D
	viewModel
ããE N
.
ããN O
DisplayName
ããO Z
,
ããZ [
	viewModel
ãã\ e
.
ããe f
FieldTypeName
ããf s
,
ããs t
partDefinitionããu É
.ããÉ Ñ
NameããÑ à
)ããà â
;ããâ ä
	_notifier
çç 
.
çç 
Success
çç 
(
çç 
H
çç 
[
çç  
$str
çç  C
,
ççC D
	viewModel
ççE N
.
ççN O
DisplayName
ççO Z
]
ççZ [
)
çç[ \
;
çç\ ]
if
èè 
(
èè 
!
èè 
String
èè 
.
èè 
IsNullOrEmpty
èè %
(
èè% &
	returnUrl
èè& /
)
èè/ 0
&&
èè1 3
Url
èè4 7
.
èè7 8

IsLocalUrl
èè8 B
(
èèB C
	returnUrl
èèC L
)
èèL M
)
èèM N
{
êê 
return
ëë 
Redirect
ëë 
(
ëë  
	returnUrl
ëë  )
)
ëë) *
;
ëë* +
}
íí 
else
ìì 
{
îî 
return
ïï 
RedirectToAction
ïï '
(
ïï' (
$str
ïï( 3
,
ïï3 4
new
ïï5 8
{
ïï9 :
id
ïï; =
,
ïï= >
	viewModel
ïï? H
.
ïïH I
Name
ïïI M
}
ïïN O
)
ïïO P
;
ïïP Q
}
ññ 
}
óó 	
public
ôô 
async
ôô 
Task
ôô 
<
ôô 
ActionResult
ôô &
>
ôô& '
	EditField
ôô( 1
(
ôô1 2
string
ôô2 8
id
ôô9 ;
,
ôô; <
string
ôô= C
name
ôôD H
,
ôôH I
string
ôôJ P
	returnUrl
ôôQ Z
=
ôô[ \
null
ôô] a
)
ôôa b
{
öö 	
if
õõ 
(
õõ 
!
õõ 
await
õõ #
_authorizationService
õõ ,
.
õõ, -
AuthorizeAsync
õõ- ;
(
õõ; <
User
õõ< @
,
õõ@ A
Permissions
õõB M
.
õõM N
EditContentTypes
õõN ^
)
õõ^ _
)
õõ_ `
{
úú 
return
ùù 
Forbid
ùù 
(
ùù 
)
ùù 
;
ùù  
}
ûû 
var
†† 
partViewModel
†† 
=
†† '
_contentDefinitionService
††  9
.
††9 :
GetPart
††: A
(
††A B
id
††B D
)
††D E
;
††E F
if
¢¢ 
(
¢¢ 
partViewModel
¢¢ 
==
¢¢  
null
¢¢! %
)
¢¢% &
{
££ 
return
§§ 
NotFound
§§ 
(
§§  
)
§§  !
;
§§! "
}
•• 
var
ßß !
partFieldDefinition
ßß #
=
ßß$ %
partViewModel
ßß& 3
.
ßß3 4
PartDefinition
ßß4 B
.
ßßB C
Fields
ßßC I
.
ßßI J
FirstOrDefault
ßßJ X
(
ßßX Y
x
ßßY Z
=>
ßß[ ]
x
ßß^ _
.
ßß_ `
Name
ßß` d
==
ßße g
name
ßßh l
)
ßßl m
;
ßßm n
if
©© 
(
©© !
partFieldDefinition
©© #
==
©©$ &
null
©©' +
)
©©+ ,
{
™™ 
return
´´ 
NotFound
´´ 
(
´´  
)
´´  !
;
´´! "
}
¨¨ 
var
ÆÆ 
	viewModel
ÆÆ 
=
ÆÆ 
new
ÆÆ  
EditFieldViewModel
ÆÆ  2
{
ØØ 
Name
∞∞ 
=
∞∞ !
partFieldDefinition
∞∞ *
.
∞∞* +
Name
∞∞+ /
,
∞∞/ 0
Editor
±± 
=
±± !
partFieldDefinition
±± ,
.
±±, -
Editor
±±- 3
(
±±3 4
)
±±4 5
,
±±5 6
DisplayMode
≤≤ 
=
≤≤ !
partFieldDefinition
≤≤ 1
.
≤≤1 2
DisplayMode
≤≤2 =
(
≤≤= >
)
≤≤> ?
,
≤≤? @
DisplayName
≥≥ 
=
≥≥ !
partFieldDefinition
≥≥ 1
.
≥≥1 2
DisplayName
≥≥2 =
(
≥≥= >
)
≥≥> ?
,
≥≥? @!
PartFieldDefinition
¥¥ #
=
¥¥$ %!
partFieldDefinition
¥¥& 9
,
¥¥9 :
Shape
µµ 
=
µµ 
await
µµ .
 _contentDefinitionDisplayManager
µµ >
.
µµ> ?'
BuildPartFieldEditorAsync
µµ? X
(
µµX Y!
partFieldDefinition
µµY l
,
µµl m#
_updateModelAccessorµµn Ç
.µµÇ É
ModelUpdaterµµÉ è
)µµè ê
}
∂∂ 
;
∂∂ 
ViewData
∏∏ 
[
∏∏ 
$str
∏∏  
]
∏∏  !
=
∏∏" #
	returnUrl
∏∏$ -
;
∏∏- .
return
ππ 
View
ππ 
(
ππ 
	viewModel
ππ !
)
ππ! "
;
ππ" #
}
∫∫ 	
[
ºº 	
HttpPost
ºº	 
,
ºº 

ActionName
ºº 
(
ºº 
$str
ºº )
)
ºº) *
]
ºº* +
[
ΩΩ 	
FormValueRequired
ΩΩ	 
(
ΩΩ 
$str
ΩΩ (
)
ΩΩ( )
]
ΩΩ) *
public
ææ 
async
ææ 
Task
ææ 
<
ææ 
ActionResult
ææ &
>
ææ& '
EditFieldPOST
ææ( 5
(
ææ5 6
string
ææ6 <
id
ææ= ?
,
ææ? @ 
EditFieldViewModel
ææA S
	viewModel
ææT ]
,
ææ] ^
string
ææ_ e
	returnUrl
ææf o
=
ææp q
null
æær v
)
ææv w
{
øø 	
if
¿¿ 
(
¿¿ 
!
¿¿ 
await
¿¿ #
_authorizationService
¿¿ ,
.
¿¿, -
AuthorizeAsync
¿¿- ;
(
¿¿; <
User
¿¿< @
,
¿¿@ A
Permissions
¿¿B M
.
¿¿M N
EditContentTypes
¿¿N ^
)
¿¿^ _
)
¿¿_ `
{
¡¡ 
return
¬¬ 
Forbid
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬  
}
√√ 
if
≈≈ 
(
≈≈ 
	viewModel
≈≈ 
==
≈≈ 
null
≈≈ !
)
≈≈! "
{
∆∆ 
return
«« 
NotFound
«« 
(
««  
)
««  !
;
««! "
}
»» 
var
   
partViewModel
   
=
   '
_contentDefinitionService
    9
.
  9 :
LoadPart
  : B
(
  B C
id
  C E
)
  E F
;
  F G
if
ÃÃ 
(
ÃÃ 
partViewModel
ÃÃ 
==
ÃÃ  
null
ÃÃ! %
)
ÃÃ% &
{
ÕÕ 
return
ŒŒ 
NotFound
ŒŒ 
(
ŒŒ  
)
ŒŒ  !
;
ŒŒ! "
}
œœ 
var
—— 
field
—— 
=
—— '
_contentDefinitionManager
—— 1
.
——1 2 
LoadPartDefinition
——2 D
(
——D E
id
——E G
)
——G H
.
——H I
Fields
——I O
.
——O P
FirstOrDefault
——P ^
(
——^ _
x
——_ `
=>
——a c
x
——d e
.
——e f
Name
——f j
==
——k m
	viewModel
——n w
.
——w x
Name
——x |
)
——| }
;
——} ~
if
”” 
(
”” 
field
”” 
==
”” 
null
”” 
)
”” 
{
‘‘ 
return
’’ 
NotFound
’’ 
(
’’  
)
’’  !
;
’’! "
}
÷÷ 
	viewModel
ÿÿ 
.
ÿÿ !
PartFieldDefinition
ÿÿ )
=
ÿÿ* +
field
ÿÿ, 1
;
ÿÿ1 2
if
⁄⁄ 
(
⁄⁄ 
field
⁄⁄ 
.
⁄⁄ 
DisplayName
⁄⁄ !
(
⁄⁄! "
)
⁄⁄" #
!=
⁄⁄$ &
	viewModel
⁄⁄' 0
.
⁄⁄0 1
DisplayName
⁄⁄1 <
)
⁄⁄< =
{
€€ 
	viewModel
›› 
.
›› 
DisplayName
›› %
=
››& '
	viewModel
››( 1
.
››1 2
DisplayName
››2 =
?
››= >
.
››> ?
Trim
››? C
(
››C D
)
››D E
??
››F H
String
››I O
.
››O P
Empty
››P U
;
››U V
if
ﬂﬂ 
(
ﬂﬂ 
String
ﬂﬂ 
.
ﬂﬂ  
IsNullOrWhiteSpace
ﬂﬂ -
(
ﬂﬂ- .
	viewModel
ﬂﬂ. 7
.
ﬂﬂ7 8
DisplayName
ﬂﬂ8 C
)
ﬂﬂC D
)
ﬂﬂD E
{
‡‡ 

ModelState
·· 
.
·· 
AddModelError
·· ,
(
··, -
$str
··- :
,
··: ;
S
··< =
[
··= >
$str
··> `
]
··` a
)
··a b
;
··b c
}
‚‚ 
if
‰‰ 
(
‰‰ '
_contentDefinitionService
‰‰ -
.
‰‰- .
LoadPart
‰‰. 6
(
‰‰6 7
partViewModel
‰‰7 D
.
‰‰D E
Name
‰‰E I
)
‰‰I J
.
‰‰J K
PartDefinition
‰‰K Y
.
‰‰Y Z
Fields
‰‰Z `
.
‰‰` a
Any
‰‰a d
(
‰‰d e
t
‰‰e f
=>
‰‰g i
t
‰‰j k
.
‰‰k l
Name
‰‰l p
!=
‰‰q s
	viewModel
‰‰t }
.
‰‰} ~
Name‰‰~ Ç
&&‰‰É Ö
String‰‰Ü å
.‰‰å ç
Equals‰‰ç ì
(‰‰ì î
t‰‰î ï
.‰‰ï ñ
DisplayName‰‰ñ °
(‰‰° ¢
)‰‰¢ £
.‰‰£ §
Trim‰‰§ ®
(‰‰® ©
)‰‰© ™
,‰‰™ ´
	viewModel‰‰¨ µ
.‰‰µ ∂
DisplayName‰‰∂ ¡
.‰‰¡ ¬
Trim‰‰¬ ∆
(‰‰∆ «
)‰‰« »
,‰‰» … 
StringComparison‰‰  ⁄
.‰‰⁄ €!
OrdinalIgnoreCase‰‰€ Ï
)‰‰Ï Ì
)‰‰Ì Ó
)‰‰Ó Ô
{
ÂÂ 

ModelState
ÊÊ 
.
ÊÊ 
AddModelError
ÊÊ ,
(
ÊÊ, -
$str
ÊÊ- :
,
ÊÊ: ;
S
ÊÊ< =
[
ÊÊ= >
$str
ÊÊ> r
]
ÊÊr s
)
ÊÊs t
;
ÊÊt u
}
ÁÁ 
if
ÈÈ 
(
ÈÈ 
!
ÈÈ 

ModelState
ÈÈ 
.
ÈÈ  
IsValid
ÈÈ  '
)
ÈÈ' (
{
ÍÍ 
	viewModel
ÏÏ 
.
ÏÏ 
Shape
ÏÏ #
=
ÏÏ$ %
await
ÏÏ& +.
 _contentDefinitionDisplayManager
ÏÏ, L
.
ÏÏL M(
UpdatePartFieldEditorAsync
ÏÏM g
(
ÏÏg h
field
ÏÏh m
,
ÏÏm n#
_updateModelAccessorÏÏo É
.ÏÏÉ Ñ
ModelUpdaterÏÏÑ ê
)ÏÏê ë
;ÏÏë í
_documentStore
ÌÌ "
.
ÌÌ" #
Cancel
ÌÌ# )
(
ÌÌ) *
)
ÌÌ* +
;
ÌÌ+ ,
ViewData
ÔÔ 
[
ÔÔ 
$str
ÔÔ (
]
ÔÔ( )
=
ÔÔ* +
	returnUrl
ÔÔ, 5
;
ÔÔ5 6
return
 
View
 
(
  
	viewModel
  )
)
) *
;
* +
}
ÒÒ 
	_notifier
ÛÛ 
.
ÛÛ 
Information
ÛÛ %
(
ÛÛ% &
H
ÛÛ& '
[
ÛÛ' (
$str
ÛÛ( F
,
ÛÛF G
	viewModel
ÛÛH Q
.
ÛÛQ R
DisplayName
ÛÛR ]
]
ÛÛ] ^
)
ÛÛ^ _
;
ÛÛ_ `
}
ÙÙ '
_contentDefinitionService
ˆˆ %
.
ˆˆ% &

AlterField
ˆˆ& 0
(
ˆˆ0 1
partViewModel
ˆˆ1 >
,
ˆˆ> ?
	viewModel
ˆˆ@ I
)
ˆˆI J
;
ˆˆJ K
field
˘˘ 
=
˘˘ '
_contentDefinitionManager
˘˘ -
.
˘˘- . 
LoadPartDefinition
˘˘. @
(
˘˘@ A
id
˘˘A C
)
˘˘C D
.
˘˘D E
Fields
˘˘E K
.
˘˘K L
FirstOrDefault
˘˘L Z
(
˘˘Z [
x
˘˘[ \
=>
˘˘] _
x
˘˘` a
.
˘˘a b
Name
˘˘b f
==
˘˘g i
	viewModel
˘˘j s
.
˘˘s t
Name
˘˘t x
)
˘˘x y
;
˘˘y z
	viewModel
˚˚ 
.
˚˚ 
Shape
˚˚ 
=
˚˚ 
await
˚˚ #.
 _contentDefinitionDisplayManager
˚˚$ D
.
˚˚D E(
UpdatePartFieldEditorAsync
˚˚E _
(
˚˚_ `
field
˚˚` e
,
˚˚e f"
_updateModelAccessor
˚˚g {
.
˚˚{ |
ModelUpdater˚˚| à
)˚˚à â
;˚˚â ä
if
˝˝ 
(
˝˝ 
!
˝˝ 

ModelState
˝˝ 
.
˝˝ 
IsValid
˝˝ #
)
˝˝# $
{
˛˛ 
_documentStore
ˇˇ 
.
ˇˇ 
Cancel
ˇˇ %
(
ˇˇ% &
)
ˇˇ& '
;
ˇˇ' (
ViewData
ÅÅ 
[
ÅÅ 
$str
ÅÅ $
]
ÅÅ$ %
=
ÅÅ& '
	returnUrl
ÅÅ( 1
;
ÅÅ1 2
return
ÇÇ 
View
ÇÇ 
(
ÇÇ 
	viewModel
ÇÇ %
)
ÇÇ% &
;
ÇÇ& '
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
	_notifier
ÜÜ 
.
ÜÜ 
Success
ÜÜ !
(
ÜÜ! "
H
ÜÜ" #
[
ÜÜ# $
$str
ÜÜ$ Q
,
ÜÜQ R
field
ÜÜS X
.
ÜÜX Y
DisplayName
ÜÜY d
(
ÜÜd e
)
ÜÜe f
]
ÜÜf g
)
ÜÜg h
;
ÜÜh i
}
áá 
if
ââ 
(
ââ 
!
ââ 
String
ââ 
.
ââ 
IsNullOrEmpty
ââ %
(
ââ% &
	returnUrl
ââ& /
)
ââ/ 0
&&
ââ1 3
Url
ââ4 7
.
ââ7 8

IsLocalUrl
ââ8 B
(
ââB C
	returnUrl
ââC L
)
ââL M
)
ââM N
{
ää 
return
ãã 
Redirect
ãã 
(
ãã  
	returnUrl
ãã  )
)
ãã) *
;
ãã* +
}
åå 
else
çç 
{
éé 
var
êê 
typeViewModel
êê !
=
êê" #'
_contentDefinitionService
êê$ =
.
êê= >
LoadType
êê> F
(
êêF G
id
êêG I
)
êêI J
;
êêJ K
if
ëë 
(
ëë 
typeViewModel
ëë !
!=
ëë" $
null
ëë% )
)
ëë) *
{
íí 
return
ìì 
RedirectToAction
ìì +
(
ìì+ ,
$str
ìì, 2
,
ìì2 3
new
ìì4 7
{
ìì8 9
id
ìì: <
}
ìì= >
)
ìì> ?
;
ìì? @
}
îî 
return
ññ 
RedirectToAction
ññ '
(
ññ' (
$str
ññ( 2
,
ññ2 3
new
ññ4 7
{
ññ8 9
id
ññ: <
}
ññ= >
)
ññ> ?
;
ññ? @
}
óó 
}
òò 	
[
öö 	
HttpPost
öö	 
,
öö 

ActionName
öö 
(
öö 
$str
öö /
)
öö/ 0
]
öö0 1
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
ActionResult
õõ &
>
õõ& '!
RemoveFieldFromPOST
õõ( ;
(
õõ; <
string
õõ< B
id
õõC E
,
õõE F
string
õõG M
name
õõN R
)
õõR S
{
úú 	
if
ùù 
(
ùù 
!
ùù 
await
ùù #
_authorizationService
ùù ,
.
ùù, -
AuthorizeAsync
ùù- ;
(
ùù; <
User
ùù< @
,
ùù@ A
Permissions
ùùB M
.
ùùM N
EditContentTypes
ùùN ^
)
ùù^ _
)
ùù_ `
{
ûû 
return
üü 
Forbid
üü 
(
üü 
)
üü 
;
üü  
}
†† 
var
¢¢ 
partViewModel
¢¢ 
=
¢¢ '
_contentDefinitionService
¢¢  9
.
¢¢9 :
LoadPart
¢¢: B
(
¢¢B C
id
¢¢C E
)
¢¢E F
;
¢¢F G
if
§§ 
(
§§ 
partViewModel
§§ 
==
§§  
null
§§! %
)
§§% &
{
•• 
return
¶¶ 
NotFound
¶¶ 
(
¶¶  
)
¶¶  !
;
¶¶! "
}
ßß 
var
©© 
field
©© 
=
©© 
partViewModel
©© %
.
©©% &
PartDefinition
©©& 4
.
©©4 5
Fields
©©5 ;
.
©©; <
FirstOrDefault
©©< J
(
©©J K
x
©©K L
=>
©©M O
x
©©P Q
.
©©Q R
Name
©©R V
==
©©W Y
name
©©Z ^
)
©©^ _
;
©©_ `
if
´´ 
(
´´ 
field
´´ 
==
´´ 
null
´´ 
)
´´ 
{
¨¨ 
return
≠≠ 
NotFound
≠≠ 
(
≠≠  
)
≠≠  !
;
≠≠! "
}
ÆÆ '
_contentDefinitionService
∞∞ %
.
∞∞% &!
RemoveFieldFromPart
∞∞& 9
(
∞∞9 :
name
∞∞: >
,
∞∞> ?
partViewModel
∞∞@ M
.
∞∞M N
Name
∞∞N R
)
∞∞R S
;
∞∞S T
	_notifier
≤≤ 
.
≤≤ 
Success
≤≤ 
(
≤≤ 
H
≤≤ 
[
≤≤  
$str
≤≤  E
,
≤≤E F
field
≤≤G L
.
≤≤L M
DisplayName
≤≤M X
(
≤≤X Y
)
≤≤Y Z
]
≤≤Z [
)
≤≤[ \
;
≤≤\ ]
if
¥¥ 
(
¥¥ '
_contentDefinitionService
¥¥ )
.
¥¥) *
LoadType
¥¥* 2
(
¥¥2 3
id
¥¥3 5
)
¥¥5 6
!=
¥¥7 9
null
¥¥: >
)
¥¥> ?
{
µµ 
return
∂∂ 
RedirectToAction
∂∂ '
(
∂∂' (
$str
∂∂( .
,
∂∂. /
new
∂∂0 3
{
∂∂4 5
id
∂∂6 8
}
∂∂9 :
)
∂∂: ;
;
∂∂; <
}
∑∑ 
return
ππ 
RedirectToAction
ππ #
(
ππ# $
$str
ππ$ .
,
ππ. /
new
ππ0 3
{
ππ4 5
id
ππ6 8
}
ππ9 :
)
ππ: ;
;
ππ; <
}
∫∫ 	
public
¿¿ 
async
¿¿ 
Task
¿¿ 
<
¿¿ 
ActionResult
¿¿ &
>
¿¿& '
EditTypePart
¿¿( 4
(
¿¿4 5
string
¿¿5 ;
id
¿¿< >
,
¿¿> ?
string
¿¿@ F
name
¿¿G K
)
¿¿K L
{
¡¡ 	
if
¬¬ 
(
¬¬ 
!
¬¬ 
await
¬¬ #
_authorizationService
¬¬ ,
.
¬¬, -
AuthorizeAsync
¬¬- ;
(
¬¬; <
User
¬¬< @
,
¬¬@ A
Permissions
¬¬B M
.
¬¬M N
EditContentTypes
¬¬N ^
)
¬¬^ _
)
¬¬_ `
{
√√ 
return
ƒƒ 
Forbid
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ  
}
≈≈ 
var
«« 
typeDefinition
«« 
=
««  '
_contentDefinitionManager
««! :
.
««: ;
GetTypeDefinition
««; L
(
««L M
id
««M O
)
««O P
;
««P Q
if
…… 
(
…… 
typeDefinition
…… 
==
…… !
null
……" &
)
……& '
{
   
return
ÀÀ 
NotFound
ÀÀ 
(
ÀÀ  
)
ÀÀ  !
;
ÀÀ! "
}
ÃÃ 
var
ŒŒ  
typePartDefinition
ŒŒ "
=
ŒŒ# $
typeDefinition
ŒŒ% 3
.
ŒŒ3 4
Parts
ŒŒ4 9
.
ŒŒ9 :
FirstOrDefault
ŒŒ: H
(
ŒŒH I
x
ŒŒI J
=>
ŒŒK M
x
ŒŒN O
.
ŒŒO P
Name
ŒŒP T
==
ŒŒU W
name
ŒŒX \
)
ŒŒ\ ]
;
ŒŒ] ^
if
–– 
(
––  
typePartDefinition
–– "
==
––# %
null
––& *
)
––* +
{
—— 
return
““ 
NotFound
““ 
(
““  
)
““  !
;
““! "
}
”” 
var
’’ 
typePartViewModel
’’ !
=
’’" #
new
’’$ '#
EditTypePartViewModel
’’( =
{
÷÷ 
Name
◊◊ 
=
◊◊  
typePartDefinition
◊◊ )
.
◊◊) *
Name
◊◊* .
,
◊◊. /
Editor
ÿÿ 
=
ÿÿ  
typePartDefinition
ÿÿ +
.
ÿÿ+ ,
Editor
ÿÿ, 2
(
ÿÿ2 3
)
ÿÿ3 4
,
ÿÿ4 5
DisplayMode
ŸŸ 
=
ŸŸ  
typePartDefinition
ŸŸ 0
.
ŸŸ0 1
DisplayMode
ŸŸ1 <
(
ŸŸ< =
)
ŸŸ= >
,
ŸŸ> ?
DisplayName
⁄⁄ 
=
⁄⁄  
typePartDefinition
⁄⁄ 0
.
⁄⁄0 1
DisplayName
⁄⁄1 <
(
⁄⁄< =
)
⁄⁄= >
,
⁄⁄> ?
Description
€€ 
=
€€  
typePartDefinition
€€ 0
.
€€0 1
Description
€€1 <
(
€€< =
)
€€= >
,
€€> ? 
TypePartDefinition
‹‹ "
=
‹‹# $ 
typePartDefinition
‹‹% 7
,
‹‹7 8
Shape
›› 
=
›› 
await
›› .
 _contentDefinitionDisplayManager
›› >
.
››> ?&
BuildTypePartEditorAsync
››? W
(
››W X 
typePartDefinition
››X j
,
››j k#
_updateModelAccessor››l Ä
.››Ä Å
ModelUpdater››Å ç
)››ç é
}
ﬁﬁ 
;
ﬁﬁ 
return
‡‡ 
View
‡‡ 
(
‡‡ 
typePartViewModel
‡‡ )
)
‡‡) *
;
‡‡* +
}
·· 	
[
„„ 	
HttpPost
„„	 
,
„„ 

ActionName
„„ 
(
„„ 
$str
„„ ,
)
„„, -
]
„„- .
[
‰‰ 	
FormValueRequired
‰‰	 
(
‰‰ 
$str
‰‰ (
)
‰‰( )
]
‰‰) *
public
ÂÂ 
async
ÂÂ 
Task
ÂÂ 
<
ÂÂ 
ActionResult
ÂÂ &
>
ÂÂ& '
EditTypePartPOST
ÂÂ( 8
(
ÂÂ8 9
string
ÂÂ9 ?
id
ÂÂ@ B
,
ÂÂB C#
EditTypePartViewModel
ÂÂD Y
	viewModel
ÂÂZ c
)
ÂÂc d
{
ÊÊ 	
if
ÁÁ 
(
ÁÁ 
!
ÁÁ 
await
ÁÁ #
_authorizationService
ÁÁ ,
.
ÁÁ, -
AuthorizeAsync
ÁÁ- ;
(
ÁÁ; <
User
ÁÁ< @
,
ÁÁ@ A
Permissions
ÁÁB M
.
ÁÁM N
EditContentTypes
ÁÁN ^
)
ÁÁ^ _
)
ÁÁ_ `
{
ËË 
return
ÈÈ 
Forbid
ÈÈ 
(
ÈÈ 
)
ÈÈ 
;
ÈÈ  
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
	viewModel
ÏÏ 
==
ÏÏ 
null
ÏÏ !
)
ÏÏ! "
{
ÌÌ 
return
ÓÓ 
NotFound
ÓÓ 
(
ÓÓ  
)
ÓÓ  !
;
ÓÓ! "
}
ÔÔ 
var
ÒÒ 
typeDefinition
ÒÒ 
=
ÒÒ  '
_contentDefinitionManager
ÒÒ! :
.
ÒÒ: ; 
LoadTypeDefinition
ÒÒ; M
(
ÒÒM N
id
ÒÒN P
)
ÒÒP Q
;
ÒÒQ R
if
ÛÛ 
(
ÛÛ 
typeDefinition
ÛÛ 
==
ÛÛ !
null
ÛÛ" &
)
ÛÛ& '
{
ÙÙ 
return
ıı 
NotFound
ıı 
(
ıı  
)
ıı  !
;
ıı! "
}
ˆˆ 
var
¯¯ 
part
¯¯ 
=
¯¯ 
typeDefinition
¯¯ %
.
¯¯% &
Parts
¯¯& +
.
¯¯+ ,
FirstOrDefault
¯¯, :
(
¯¯: ;
x
¯¯; <
=>
¯¯= ?
x
¯¯@ A
.
¯¯A B
Name
¯¯B F
==
¯¯G I
	viewModel
¯¯J S
.
¯¯S T
Name
¯¯T X
)
¯¯X Y
;
¯¯Y Z
if
˙˙ 
(
˙˙ 
part
˙˙ 
==
˙˙ 
null
˙˙ 
)
˙˙ 
{
˚˚ 
return
¸¸ 
NotFound
¸¸ 
(
¸¸  
)
¸¸  !
;
¸¸! "
}
˝˝ 
	viewModel
ˇˇ 
.
ˇˇ  
TypePartDefinition
ˇˇ (
=
ˇˇ) *
part
ˇˇ+ /
;
ˇˇ/ 0
if
ÅÅ 
(
ÅÅ 
part
ÅÅ 
.
ÅÅ 
PartDefinition
ÅÅ #
.
ÅÅ# $

IsReusable
ÅÅ$ .
(
ÅÅ. /
)
ÅÅ/ 0
)
ÅÅ0 1
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
part
ÉÉ 
.
ÉÉ 
DisplayName
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
!=
ÉÉ' )
	viewModel
ÉÉ* 3
.
ÉÉ3 4
DisplayName
ÉÉ4 ?
)
ÉÉ? @
{
ÑÑ 
	viewModel
ÜÜ 
.
ÜÜ 
DisplayName
ÜÜ )
=
ÜÜ* +
	viewModel
ÜÜ, 5
.
ÜÜ5 6
DisplayName
ÜÜ6 A
?
ÜÜA B
.
ÜÜB C
Trim
ÜÜC G
(
ÜÜG H
)
ÜÜH I
??
ÜÜJ L
String
ÜÜM S
.
ÜÜS T
Empty
ÜÜT Y
;
ÜÜY Z
if
àà 
(
àà 
String
àà 
.
àà  
IsNullOrWhiteSpace
àà 1
(
àà1 2
	viewModel
àà2 ;
.
àà; <
DisplayName
àà< G
)
ààG H
)
ààH I
{
ââ 

ModelState
ää "
.
ää" #
AddModelError
ää# 0
(
ää0 1
$str
ää1 >
,
ää> ?
S
ää@ A
[
ääA B
$str
ääB d
]
ääd e
)
ääe f
;
ääf g
}
ãã 
if
çç 
(
çç 
typeDefinition
çç &
.
çç& '
Parts
çç' ,
.
çç, -
Any
çç- 0
(
çç0 1
t
çç1 2
=>
çç3 5
t
çç6 7
.
çç7 8
Name
çç8 <
!=
çç= ?
	viewModel
çç@ I
.
ççI J
Name
ççJ N
&&
ççO Q
String
ççR X
.
ççX Y
Equals
ççY _
(
çç_ `
t
çç` a
.
çça b
DisplayName
ççb m
(
ççm n
)
ççn o
?
çço p
.
ççp q
Trim
ççq u
(
ççu v
)
ççv w
,
ççw x
	viewModelççy Ç
.ççÇ É
DisplayNameççÉ é
.ççé è
Trimççè ì
(ççì î
)ççî ï
,ççï ñ 
StringComparisonççó ß
.ççß ®!
OrdinalIgnoreCaseçç® π
)ççπ ∫
)çç∫ ª
)ççª º
{
éé 

ModelState
èè "
.
èè" #
AddModelError
èè# 0
(
èè0 1
$str
èè1 >
,
èè> ?
S
èè@ A
[
èèA B
$str
èèB u
]
èèu v
)
èèv w
;
èèw x
}
êê 
if
íí 
(
íí 
!
íí 

ModelState
íí #
.
íí# $
IsValid
íí$ +
)
íí+ ,
{
ìì 
	viewModel
îî !
.
îî! "
Shape
îî" '
=
îî( )
await
îî* /.
 _contentDefinitionDisplayManager
îî0 P
.
îîP Q'
UpdateTypePartEditorAsync
îîQ j
(
îîj k
part
îîk o
,
îîo p#
_updateModelAccessorîîq Ö
.îîÖ Ü
ModelUpdaterîîÜ í
)îîí ì
;îîì î
_documentStore
ïï &
.
ïï& '
Cancel
ïï' -
(
ïï- .
)
ïï. /
;
ïï/ 0
return
ññ 
View
ññ #
(
ññ# $
	viewModel
ññ$ -
)
ññ- .
;
ññ. /
}
óó 
}
òò 
}
ôô '
_contentDefinitionService
õõ %
.
õõ% &
AlterTypePart
õõ& 3
(
õõ3 4
	viewModel
õõ4 =
)
õõ= >
;
õõ> ?
part
ûû 
=
ûû '
_contentDefinitionManager
ûû ,
.
ûû, - 
LoadTypeDefinition
ûû- ?
(
ûû? @
id
ûû@ B
)
ûûB C
.
ûûC D
Parts
ûûD I
.
ûûI J
FirstOrDefault
ûûJ X
(
ûûX Y
x
ûûY Z
=>
ûû[ ]
x
ûû^ _
.
ûû_ `
Name
ûû` d
==
ûûe g
	viewModel
ûûh q
.
ûûq r
Name
ûûr v
)
ûûv w
;
ûûw x
	viewModel
†† 
.
†† 
Shape
†† 
=
†† 
await
†† #.
 _contentDefinitionDisplayManager
††$ D
.
††D E'
UpdateTypePartEditorAsync
††E ^
(
††^ _
part
††_ c
,
††c d"
_updateModelAccessor
††e y
.
††y z
ModelUpdater††z Ü
)††Ü á
;††á à
if
¢¢ 
(
¢¢ 
!
¢¢ 

ModelState
¢¢ 
.
¢¢ 
IsValid
¢¢ #
)
¢¢# $
{
££ 
_documentStore
§§ 
.
§§ 
Cancel
§§ %
(
§§% &
)
§§& '
;
§§' (
return
•• 
View
•• 
(
•• 
	viewModel
•• %
)
••% &
;
••& '
}
¶¶ 
else
ßß 
{
®® 
	_notifier
©© 
.
©© 
Success
©© !
(
©©! "
H
©©" #
[
©©# $
$str
©©$ P
,
©©P Q
part
©©R V
.
©©V W
DisplayName
©©W b
(
©©b c
)
©©c d
]
©©d e
)
©©e f
;
©©f g
}
™™ 
return
¨¨ 
RedirectToAction
¨¨ #
(
¨¨# $
$str
¨¨$ *
,
¨¨* +
new
¨¨, /
{
¨¨0 1
id
¨¨2 4
}
¨¨5 6
)
¨¨6 7
;
¨¨7 8
}
≠≠ 	
}
∞∞ 
}±± ”
®D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\ContentDefinitionDeploymentSource.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

Deployment# -
{ 
public		 

class		 -
!ContentDefinitionDeploymentSource		 2
:		3 4
IDeploymentSource		5 F
{

 
private 
readonly #
IContentDefinitionStore 0#
_contentDefinitionStore1 H
;H I
public -
!ContentDefinitionDeploymentSource 0
(0 1#
IContentDefinitionStore1 H"
contentDefinitionStoreI _
)_ `
{ 	#
_contentDefinitionStore #
=$ %"
contentDefinitionStore& <
;< =
} 	
public 
async 
Task &
ProcessDeploymentStepAsync 4
(4 5
DeploymentStep5 C
stepD H
,H I 
DeploymentPlanResultJ ^
result_ e
)e f
{ 	
if 
( 
! 
( 
step 
is +
ContentDefinitionDeploymentStep 9!
contentDefinitionStep: O
)O P
)P Q
{ 
return 
; 
} 
var '
contentTypeDefinitionRecord +
=, -
await. 3#
_contentDefinitionStore4 K
.K L&
LoadContentDefinitionAsyncL f
(f g
)g h
;h i
var 
contentTypes 
= !
contentDefinitionStep 4
.4 5

IncludeAll5 ?
? '
contentTypeDefinitionRecord -
.- .(
ContentTypeDefinitionRecords. J
: '
contentTypeDefinitionRecord -
.- .(
ContentTypeDefinitionRecords. J
. 
Where 
( 
x 
=> !
contentDefinitionStep  5
.5 6
ContentTypes6 B
.B C
ContainsC K
(K L
xL M
.M N
NameN R
)R S
)S T
;T U
var   
contentParts   
=   !
contentDefinitionStep   4
.  4 5

IncludeAll  5 ?
?!! '
contentTypeDefinitionRecord!! -
.!!- .(
ContentPartDefinitionRecords!!. J
:"" '
contentTypeDefinitionRecord"" -
.""- .(
ContentPartDefinitionRecords"". J
.## 
Where## 
(## 
x##  
=>##! #!
contentDefinitionStep##$ 9
.##9 :
ContentParts##: F
.##F G
Contains##G O
(##O P
x##P Q
.##Q R
Name##R V
)##V W
)##W X
;##X Y
result%% 
.%% 
Steps%% 
.%% 
Add%% 
(%% 
new%%  
JObject%%! (
(%%( )
new&& 
	JProperty&& 
(&& 
$str&& $
,&&$ %
$str&&& 9
)&&9 :
,&&: ;
new'' 
	JProperty'' 
('' 
$str'' ,
,'', -
JArray''. 4
.''4 5

FromObject''5 ?
(''? @
contentTypes''@ L
)''L M
)''M N
,''N O
new(( 
	JProperty(( 
((( 
$str(( ,
,((, -
JArray((. 4
.((4 5

FromObject((5 ?
(((? @
contentParts((@ L
)((L M
)((M N
))) 
))) 
;)) 
}** 	
}++ 
},, µ	
¶D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\ContentDefinitionDeploymentStep.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

Deployment# -
{ 
public 

class +
ContentDefinitionDeploymentStep 0
:1 2
DeploymentStep3 A
{		 
public

 +
ContentDefinitionDeploymentStep

 .
(

. /
)

/ 0
{ 	
Name 
= 
$str &
;& '
} 	
public 
bool 

IncludeAll 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
[ 
] 
ContentTypes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
[ 
] 
ContentParts $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} §$
¨D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\ContentDefinitionDeploymentStepDriver.cs
	namespace

 	
OrchardCore


 
.

 
ContentTypes

 "
.

" #

Deployment

# -
{ 
public 

class 1
%ContentDefinitionDeploymentStepDriver 6
:7 8
DisplayDriver9 F
<F G
DeploymentStepG U
,U V+
ContentDefinitionDeploymentStepW v
>v w
{ 
public 
override 
IDisplayResult &
Display' .
(. /+
ContentDefinitionDeploymentStep/ N
stepO S
)S T
{ 	
return 
Combine 
( 
View 
( 
$str I
,I J
stepK O
)O P
.P Q
LocationQ Y
(Y Z
$strZ c
,c d
$stre n
)n o
,o p
View 
( 
$str K
,K L
stepM Q
)Q R
.R S
LocationS [
([ \
$str\ g
,g h
$stri r
)r s
) 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,+
ContentDefinitionDeploymentStep, K
stepL P
)P Q
{ 	
return 

Initialize 
< *
ContentDefinitionStepViewModel <
>< =
(= >
$str> k
,k l
modelm r
=>s u
{ 
model 
. 
ContentParts "
=# $
step% )
.) *
ContentParts* 6
;6 7
model 
. 
ContentTypes "
=# $
step% )
.) *
ContentTypes* 6
;6 7
model 
. 

IncludeAll  
=! "
step# '
.' (

IncludeAll( 2
;2 3
} 
) 
. 
Location 
( 
$str !
)! "
;" #
} 	
public!! 
override!! 
async!! 
Task!! "
<!!" #
IDisplayResult!!# 1
>!!1 2
UpdateAsync!!3 >
(!!> ?+
ContentDefinitionDeploymentStep!!? ^
step!!_ c
,!!c d
IUpdateModel!!e q
updater!!r y
)!!y z
{"" 	
step$$ 
.$$ 
ContentTypes$$ 
=$$ 
Array$$  %
.$$% &
Empty$$& +
<$$+ ,
string$$, 2
>$$2 3
($$3 4
)$$4 5
;$$5 6
step%% 
.%% 
ContentParts%% 
=%% 
Array%%  %
.%%% &
Empty%%& +
<%%+ ,
string%%, 2
>%%2 3
(%%3 4
)%%4 5
;%%5 6
await'' 
updater'' 
.'' 
TryUpdateModelAsync'' -
(''- .
step(( 
,(( 
Prefix)) 
,)) 
x** 
=>** 
x** 
.** 
ContentTypes** #
,**# $
x++ 
=>++ 
x++ 
.++ 
ContentParts++ #
,++# $
x,, 
=>,, 
x,, 
.,, 

IncludeAll,, !
),,! "
;,," #
if// 
(// 
step// 
.// 

IncludeAll// 
)//  
{00 
step11 
.11 
ContentTypes11 !
=11" #
Array11$ )
.11) *
Empty11* /
<11/ 0
string110 6
>116 7
(117 8
)118 9
;119 :
step22 
.22 
ContentParts22 !
=22" #
Array22$ )
.22) *
Empty22* /
<22/ 0
string220 6
>226 7
(227 8
)228 9
;229 :
}33 
else44 
{55 
step66 
.66 
ContentParts66 !
=66" #
step66$ (
.66( )
ContentParts66) 5
.665 6
Distinct666 >
(66> ?
)66? @
.66@ A
ToArray66A H
(66H I
)66I J
;66J K
}77 
return99 
Edit99 
(99 
step99 
)99 
;99 
}:: 	
};; 
}<< •
ÆD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\DeleteContentDefinitionDeploymentSource.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

Deployment# -
{ 
public 

class 3
'DeleteContentDefinitionDeploymentSource 8
:9 :
IDeploymentSource; L
{ 
public		 
Task		 &
ProcessDeploymentStepAsync		 .
(		. /
DeploymentStep		/ =
step		> B
,		B C 
DeploymentPlanResult		D X
result		Y _
)		_ `
{

 	
if 
( 
! 
( 
step 
is 1
%DeleteContentDefinitionDeploymentStep ?'
deleteContentDefinitionStep@ [
)[ \
)\ ]
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
result 
. 
Steps 
. 
Add 
( 
new  
JObject! (
(( )
new 
	JProperty 
( 
$str $
,$ %
$str& ?
)? @
,@ A
new 
	JProperty 
( 
$str ,
,, -
JArray. 4
.4 5

FromObject5 ?
(? @'
deleteContentDefinitionStep@ [
.[ \
ContentTypes\ h
)h i
)i j
,j k
new 
	JProperty 
( 
$str ,
,, -
JArray. 4
.4 5

FromObject5 ?
(? @'
deleteContentDefinitionStep@ [
.[ \
ContentParts\ h
)h i
)i j
) 
) 
; 
return 
Task 
. 
CompletedTask %
;% &
} 	
} 
} Ò

¨D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\DeleteContentDefinitionDeploymentStep.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

Deployment# -
{ 
public		 

class		 1
%DeleteContentDefinitionDeploymentStep		 6
:		7 8
DeploymentStep		9 G
{

 
public 1
%DeleteContentDefinitionDeploymentStep 4
(4 5
)5 6
{ 	
Name 
= 
$str ,
;, -
} 	
public 
string 
[ 
] 
ContentTypes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
Array5 :
.: ;
Empty; @
<@ A
stringA G
>G H
(H I
)I J
;J K
public 
string 
[ 
] 
ContentParts $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
Array5 :
.: ;
Empty; @
<@ A
stringA G
>G H
(H I
)I J
;J K
} 
} ˇ 
≤D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\DeleteContentDefinitionDeploymentStepDriver.cs
	namespace		 	
OrchardCore		
 
.		 
ContentTypes		 "
.		" #

Deployment		# -
{

 
public 

class 7
+DeleteContentDefinitionDeploymentStepDriver <
:= >
DisplayDriver? L
<L M
DeploymentStepM [
,[ \2
%DeleteContentDefinitionDeploymentStep	] Ç
>
Ç É
{ 
public 
override 
IDisplayResult &
Display' .
(. /1
%DeleteContentDefinitionDeploymentStep/ T
stepU Y
)Y Z
{ 	
return 
Combine 
( 
View 
( 
$str O
,O P
stepQ U
)U V
.V W
LocationW _
(_ `
$str` i
,i j
$strk t
)t u
,u v
View 
( 
$str Q
,Q R
stepS W
)W X
.X Y
LocationY a
(a b
$strb m
,m n
$stro x
)x y
) 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,1
%DeleteContentDefinitionDeploymentStep, Q
stepR V
)V W
{ 	
return 

Initialize 
< 0
$DeleteContentDefinitionStepViewModel B
>B C
(C D
$strD w
,w x
modely ~
=>	 Å
{ 
model 
. 
ContentParts "
=# $
String% +
.+ ,
Join, 0
(0 1
$str1 5
,5 6
step7 ;
.; <
ContentParts< H
)H I
;I J
model 
. 
ContentTypes "
=# $
String% +
.+ ,
Join, 0
(0 1
$str1 5
,5 6
step7 ;
.; <
ContentTypes< H
)H I
;I J
} 
) 
. 
Location 
( 
$str !
)! "
;" #
} 	
public 
override 
async 
Task "
<" #
IDisplayResult# 1
>1 2
UpdateAsync3 >
(> ?1
%DeleteContentDefinitionDeploymentStep? d
stepe i
,i j
IUpdateModelk w
updaterx 
)	 Ä
{   	
var!! 
model!! 
=!! 
new!! 0
$DeleteContentDefinitionStepViewModel!! @
(!!@ A
)!!A B
;!!B C
if## 
(## 
await## 
updater## 
.## 
TryUpdateModelAsync## 1
(##1 2
model##2 7
,##7 8
Prefix##9 ?
)##? @
)##@ A
{$$ 
step%% 
.%% 
ContentTypes%% !
=%%" #
model%%$ )
.%%) *
ContentTypes%%* 6
.%%6 7
Split%%7 <
(%%< =
new%%= @
[%%@ A
]%%A B
{%%C D
$char%%E H
,%%H I
$char%%J M
}%%N O
,%%O P
StringSplitOptions%%Q c
.%%c d
RemoveEmptyEntries%%d v
)%%v w
;%%w x
step&& 
.&& 
ContentParts&& !
=&&" #
model&&$ )
.&&) *
ContentParts&&* 6
.&&6 7
Split&&7 <
(&&< =
new&&= @
[&&@ A
]&&A B
{&&C D
$char&&E H
,&&H I
$char&&J M
}&&N O
,&&O P
StringSplitOptions&&Q c
.&&c d
RemoveEmptyEntries&&d v
)&&v w
;&&w x
}'' 
return)) 
Edit)) 
()) 
step)) 
))) 
;)) 
}** 	
}++ 
},, í
ØD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\ReplaceContentDefinitionDeploymentSource.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

Deployment# -
{ 
public		 

class		 4
(ReplaceContentDefinitionDeploymentSource		 9
:		: ;
IDeploymentSource		< M
{

 
private 
readonly #
IContentDefinitionStore 0#
_contentDefinitionStore1 H
;H I
public 4
(ReplaceContentDefinitionDeploymentSource 7
(7 8#
IContentDefinitionStore8 O"
contentDefinitionStoreP f
)f g
{ 	#
_contentDefinitionStore #
=$ %"
contentDefinitionStore& <
;< =
} 	
public 
async 
Task &
ProcessDeploymentStepAsync 4
(4 5
DeploymentStep5 C
stepD H
,H I 
DeploymentPlanResultJ ^
result_ e
)e f
{ 	
if 
( 
! 
( 
step 
is 2
&ReplaceContentDefinitionDeploymentStep @(
replaceContentDefinitionStepA ]
)] ^
)^ _
{ 
return 
; 
} 
var '
contentTypeDefinitionRecord +
=, -
await. 3#
_contentDefinitionStore4 K
.K L&
LoadContentDefinitionAsyncL f
(f g
)g h
;h i
var 
contentTypes 
= (
replaceContentDefinitionStep ;
.; <

IncludeAll< F
? '
contentTypeDefinitionRecord -
.- .(
ContentTypeDefinitionRecords. J
: '
contentTypeDefinitionRecord -
.- .(
ContentTypeDefinitionRecords. J
. 
Where 
( 
x 
=> (
replaceContentDefinitionStep  <
.< =
ContentTypes= I
.I J
ContainsJ R
(R S
xS T
.T U
NameU Y
)Y Z
)Z [
;[ \
var   
contentParts   
=   (
replaceContentDefinitionStep   ;
.  ; <

IncludeAll  < F
?!! '
contentTypeDefinitionRecord!! -
.!!- .(
ContentPartDefinitionRecords!!. J
:"" '
contentTypeDefinitionRecord"" -
.""- .(
ContentPartDefinitionRecords"". J
.## 
Where## 
(## 
x##  
=>##! #(
replaceContentDefinitionStep##$ @
.##@ A
ContentParts##A M
.##M N
Contains##N V
(##V W
x##W X
.##X Y
Name##Y ]
)##] ^
)##^ _
;##_ `
result%% 
.%% 
Steps%% 
.%% 
Add%% 
(%% 
new%%  
JObject%%! (
(%%( )
new&& 
	JProperty&& 
(&& 
$str&& $
,&&$ %
$str&&& @
)&&@ A
,&&A B
new'' 
	JProperty'' 
('' 
$str'' ,
,'', -
JArray''. 4
.''4 5

FromObject''5 ?
(''? @
contentTypes''@ L
)''L M
)''M N
,''N O
new(( 
	JProperty(( 
((( 
$str(( ,
,((, -
JArray((. 4
.((4 5

FromObject((5 ?
(((? @
contentParts((@ L
)((L M
)((M N
))) 
))) 
;)) 
}** 	
}++ 
},,  	
≠D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\ReplaceContentDefinitionDeploymentStep.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

Deployment# -
{ 
public 

class 2
&ReplaceContentDefinitionDeploymentStep 7
:8 9
DeploymentStep: H
{ 
public 2
&ReplaceContentDefinitionDeploymentStep 5
(5 6
)6 7
{ 	
Name		 
=		 
$str		 -
;		- .
}

 	
public 
bool 

IncludeAll 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
[ 
] 
ContentTypes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
[ 
] 
ContentParts $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} ﬁ$
≥D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Deployment\ReplaceContentDefinitionDeploymentStepDriver.cs
	namespace

 	
OrchardCore


 
.

 
ContentTypes

 "
.

" #

Deployment

# -
{ 
public 

class 8
,ReplaceContentDefinitionDeploymentStepDriver =
:> ?
DisplayDriver@ M
<M N
DeploymentStepN \
,\ ]3
&ReplaceContentDefinitionDeploymentStep	^ Ñ
>
Ñ Ö
{ 
public 
override 
IDisplayResult &
Display' .
(. /2
&ReplaceContentDefinitionDeploymentStep/ U
stepV Z
)Z [
{ 	
return 
Combine 
( 
View 
( 
$str P
,P Q
stepR V
)V W
.W X
LocationX `
(` a
$stra j
,j k
$strl u
)u v
,v w
View 
( 
$str R
,R S
stepT X
)X Y
.Y Z
LocationZ b
(b c
$strc n
,n o
$strp y
)y z
) 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,2
&ReplaceContentDefinitionDeploymentStep, R
stepS W
)W X
{ 	
return 

Initialize 
< 1
%ReplaceContentDefinitionStepViewModel C
>C D
(D E
$strE y
,y z
model	{ Ä
=>
Å É
{ 
model 
. 
ContentParts "
=# $
step% )
.) *
ContentParts* 6
;6 7
model 
. 
ContentTypes "
=# $
step% )
.) *
ContentTypes* 6
;6 7
model 
. 

IncludeAll  
=! "
step# '
.' (

IncludeAll( 2
;2 3
} 
) 
. 
Location 
( 
$str !
)! "
;" #
} 	
public!! 
override!! 
async!! 
Task!! "
<!!" #
IDisplayResult!!# 1
>!!1 2
UpdateAsync!!3 >
(!!> ?2
&ReplaceContentDefinitionDeploymentStep!!? e
step!!f j
,!!j k
IUpdateModel!!l x
updater	!!y Ä
)
!!Ä Å
{"" 	
step$$ 
.$$ 
ContentTypes$$ 
=$$ 
Array$$  %
.$$% &
Empty$$& +
<$$+ ,
string$$, 2
>$$2 3
($$3 4
)$$4 5
;$$5 6
step%% 
.%% 
ContentParts%% 
=%% 
Array%%  %
.%%% &
Empty%%& +
<%%+ ,
string%%, 2
>%%2 3
(%%3 4
)%%4 5
;%%5 6
await'' 
updater'' 
.'' 
TryUpdateModelAsync'' -
(''- .
step(( 
,(( 
Prefix)) 
,)) 
x** 
=>** 
x** 
.** 
ContentTypes** #
,**# $
x++ 
=>++ 
x++ 
.++ 
ContentParts++ #
,++# $
x,, 
=>,, 
x,, 
.,, 

IncludeAll,, !
),,! "
;,," #
if// 
(// 
step// 
.// 

IncludeAll// 
)//  
{00 
step11 
.11 
ContentTypes11 !
=11" #
Array11$ )
.11) *
Empty11* /
<11/ 0
string110 6
>116 7
(117 8
)118 9
;119 :
step22 
.22 
ContentParts22 !
=22" #
Array22$ )
.22) *
Empty22* /
<22/ 0
string220 6
>226 7
(227 8
)228 9
;229 :
}33 
else44 
{55 
step66 
.66 
ContentParts66 !
=66" #
step66$ (
.66( )
ContentParts66) 5
.665 6
Distinct666 >
(66> ?
)66? @
.66@ A
ToArray66A H
(66H I
)66I J
;66J K
}77 
return99 
Edit99 
(99 
step99 
)99 
;99 
}:: 	
};; 
}<< Ñ`
ßD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Editors\ContentDefinitionDisplayCoordinator.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Editors# *
{		 
public

 

class

 /
#ContentDefinitionDisplayCoordinator

 4
:

5 6,
 IContentDefinitionDisplayHandler

7 W
{ 
private 
readonly 
IEnumerable $
<$ %/
#IContentTypeDefinitionDisplayDriver% H
>H I
_typeDisplayDriversJ ]
;] ^
private 
readonly 
IEnumerable $
<$ %3
'IContentTypePartDefinitionDisplayDriver% L
>L M#
_typePartDisplayDriversN e
;e f
private 
readonly 
IEnumerable $
<$ %/
#IContentPartDefinitionDisplayDriver% H
>H I
_partDisplayDriversJ ]
;] ^
private 
readonly 
IEnumerable $
<$ %4
(IContentPartFieldDefinitionDisplayDriver% M
>M N$
_partFieldDisplayDriversO g
;g h
private 
readonly 
ILogger  
_logger! (
;( )
public /
#ContentDefinitionDisplayCoordinator 2
(2 3
IEnumerable 
< /
#IContentTypeDefinitionDisplayDriver ;
>; <
typeDisplayDrivers= O
,O P
IEnumerable 
< 3
'IContentTypePartDefinitionDisplayDriver ?
>? @"
typePartDisplayDriversA W
,W X
IEnumerable 
< /
#IContentPartDefinitionDisplayDriver ;
>; <
partDisplayDrivers= O
,O P
IEnumerable 
< 4
(IContentPartFieldDefinitionDisplayDriver @
>@ A#
partFieldDisplayDriversB Y
,Y Z
ILogger 
< ,
 IContentDefinitionDisplayHandler 4
>4 5
logger6 <
)< =
{ 	$
_partFieldDisplayDrivers $
=% &#
partFieldDisplayDrivers' >
;> ?
_partDisplayDrivers 
=  !
partDisplayDrivers" 4
;4 5#
_typePartDisplayDrivers #
=$ %"
typePartDisplayDrivers& <
;< =
_typeDisplayDrivers 
=  !
typeDisplayDrivers" 4
;4 5
_logger 
= 
logger 
; 
} 	
public   
Task    
BuildTypeEditorAsync   (
(  ( )!
ContentTypeDefinition  ) >
model  ? D
,  D E
BuildEditorContext  F X
context  Y `
)  ` a
{!! 	
return"" 
_typeDisplayDrivers"" &
.""& '
InvokeAsync""' 2
(""2 3
async""3 8
(""9 :
contentDisplay"": H
,""H I
model""J O
,""O P
context""Q X
)""X Y
=>""Z \
{## 
var$$ 
result$$ 
=$$ 
await$$ "
contentDisplay$$# 1
.$$1 2
BuildEditorAsync$$2 B
($$B C
model$$C H
,$$H I
context$$J Q
)$$Q R
;$$R S
if%% 
(%% 
result%% 
!=%% 
null%% "
)%%" #
await&& 
result&&  
.&&  !

ApplyAsync&&! +
(&&+ ,
context&&, 3
)&&3 4
;&&4 5
}'' 
,'' 
model'' 
,'' 
context'' 
,'' 
_logger'' &
)''& '
;''' (
}(( 	
public** 
Task** !
UpdateTypeEditorAsync** )
(**) *!
ContentTypeDefinition*** ?
model**@ E
,**E F#
UpdateTypeEditorContext**G ^
context**_ f
)**f g
{++ 	
return,, 
_typeDisplayDrivers,, &
.,,& '
InvokeAsync,,' 2
(,,2 3
async,,3 8
(,,9 :
contentDisplay,,: H
,,,H I
model,,J O
,,,O P
context,,Q X
),,X Y
=>,,Z \
{-- 
var.. 
result.. 
=.. 
await.. "
contentDisplay..# 1
...1 2
UpdateEditorAsync..2 C
(..C D
model..D I
,..I J
context..K R
)..R S
;..S T
if// 
(// 
result// 
!=// 
null// "
)//" #
await00 
result00  
.00  !

ApplyAsync00! +
(00+ ,
context00, 3
)003 4
;004 5
}11 
,11 
model11 
,11 
context11 
,11 
_logger11 &
)11& '
;11' (
}22 	
public44 
Task44 $
BuildTypePartEditorAsync44 ,
(44, -%
ContentTypePartDefinition44- F
model44G L
,44L M
BuildEditorContext44N `
context44a h
)44h i
{55 	
return66 #
_typePartDisplayDrivers66 *
.66* +
InvokeAsync66+ 6
(666 7
async667 <
(66= >
contentDisplay66> L
,66L M
model66N S
,66S T
context66U \
)66\ ]
=>66^ `
{77 
var88 
result88 
=88 
await88 "
contentDisplay88# 1
.881 2
BuildEditorAsync882 B
(88B C
model88C H
,88H I
context88J Q
)88Q R
;88R S
if99 
(99 
result99 
!=99 
null99 "
)99" #
await:: 
result::  
.::  !

ApplyAsync::! +
(::+ ,
context::, 3
)::3 4
;::4 5
};; 
,;; 
model;; 
,;; 
context;; 
,;; 
_logger;; &
);;& '
;;;' (
}<< 	
public>> 
Task>> %
UpdateTypePartEditorAsync>> -
(>>- .%
ContentTypePartDefinition>>. G
model>>H M
,>>M N'
UpdateTypePartEditorContext>>O j
context>>k r
)>>r s
{?? 	
return@@ #
_typePartDisplayDrivers@@ *
.@@* +
InvokeAsync@@+ 6
(@@6 7
async@@7 <
(@@= >
contentDisplay@@> L
,@@L M
model@@N S
,@@S T
context@@U \
)@@\ ]
=>@@^ `
{AA 
varBB 
resultBB 
=BB 
awaitBB "
contentDisplayBB# 1
.BB1 2
UpdateEditorAsyncBB2 C
(BBC D
modelBBD I
,BBI J
contextBBK R
)BBR S
;BBS T
ifCC 
(CC 
resultCC 
!=CC 
nullCC "
)CC" #
awaitDD 
resultDD  
.DD  !

ApplyAsyncDD! +
(DD+ ,
contextDD, 3
)DD3 4
;DD4 5
}EE 
,EE 
modelEE 
,EE 
contextEE 
,EE 
_loggerEE &
)EE& '
;EE' (
}FF 	
publicHH 
TaskHH  
BuildPartEditorAsyncHH (
(HH( )!
ContentPartDefinitionHH) >
modelHH? D
,HHD E
BuildEditorContextHHF X
contextHHY `
)HH` a
{II 	
returnJJ 
_partDisplayDriversJJ &
.JJ& '
InvokeAsyncJJ' 2
(JJ2 3
asyncJJ3 8
(JJ9 :
contentDisplayJJ: H
,JJH I
modelJJJ O
,JJO P
contextJJQ X
)JJX Y
=>JJZ \
{KK 
varLL 
resultLL 
=LL 
awaitLL "
contentDisplayLL# 1
.LL1 2
BuildEditorAsyncLL2 B
(LLB C
modelLLC H
,LLH I
contextLLJ Q
)LLQ R
;LLR S
ifMM 
(MM 
resultMM 
!=MM 
nullMM "
)MM" #
awaitNN 
resultNN  
.NN  !

ApplyAsyncNN! +
(NN+ ,
contextNN, 3
)NN3 4
;NN4 5
}OO 
,OO 
modelOO 
,OO 
contextOO 
,OO 
_loggerOO &
)OO& '
;OO' (
}PP 	
publicRR 
TaskRR !
UpdatePartEditorAsyncRR )
(RR) *!
ContentPartDefinitionRR* ?
modelRR@ E
,RRE F#
UpdatePartEditorContextRRG ^
contextRR_ f
)RRf g
{SS 	
returnTT 
_partDisplayDriversTT &
.TT& '
InvokeAsyncTT' 2
(TT2 3
asyncTT3 8
(TT9 :
contentDisplayTT: H
,TTH I
modelTTJ O
,TTO P
contextTTQ X
)TTX Y
=>TTZ \
{UU 
varVV 
resultVV 
=VV 
awaitVV "
contentDisplayVV# 1
.VV1 2
UpdateEditorAsyncVV2 C
(VVC D
modelVVD I
,VVI J
contextVVK R
)VVR S
;VVS T
ifWW 
(WW 
resultWW 
!=WW 
nullWW "
)WW" #
awaitXX 
resultXX  
.XX  !

ApplyAsyncXX! +
(XX+ ,
contextXX, 3
)XX3 4
;XX4 5
}YY 
,YY 
modelYY 
,YY 
contextYY 
,YY 
_loggerYY &
)YY& '
;YY' (
}ZZ 	
public\\ 
async\\ 
Task\\ %
BuildPartFieldEditorAsync\\ 3
(\\3 4&
ContentPartFieldDefinition\\4 N
model\\O T
,\\T U
BuildEditorContext\\V h
context\\i p
)\\p q
{]] 	
await^^ $
_partFieldDisplayDrivers^^ *
.^^* +
InvokeAsync^^+ 6
(^^6 7
async^^7 <
(^^= >
contentDisplay^^> L
,^^L M
model^^N S
,^^S T
context^^U \
)^^\ ]
=>^^^ `
{__ 
var`` 
result`` 
=`` 
await`` "
contentDisplay``# 1
.``1 2
BuildEditorAsync``2 B
(``B C
model``C H
,``H I
context``J Q
)``Q R
;``R S
ifaa 
(aa 
resultaa 
!=aa 
nullaa "
)aa" #
awaitbb 
resultbb  
.bb  !

ApplyAsyncbb! +
(bb+ ,
contextbb, 3
)bb3 4
;bb4 5
}cc 
,cc 
modelcc 
,cc 
contextcc 
,cc 
_loggercc &
)cc& '
;cc' (
}dd 	
publicff 
asyncff 
Taskff &
UpdatePartFieldEditorAsyncff 4
(ff4 5&
ContentPartFieldDefinitionff5 O
modelffP U
,ffU V(
UpdatePartFieldEditorContextffW s
contextfft {
)ff{ |
{gg 	
awaithh $
_partFieldDisplayDrivershh *
.hh* +
InvokeAsynchh+ 6
(hh6 7
asynchh7 <
(hh= >
contentDisplayhh> L
,hhL M
modelhhN S
,hhS T
contexthhU \
)hh\ ]
=>hh^ `
{ii 
varjj 
resultjj 
=jj 
awaitjj "
contentDisplayjj# 1
.jj1 2
UpdateEditorAsyncjj2 C
(jjC D
modeljjD I
,jjI J
contextjjK R
)jjR S
;jjS T
ifkk 
(kk 
resultkk 
!=kk 
nullkk "
)kk" #
awaitll 
resultll  
.ll  !

ApplyAsyncll! +
(ll+ ,
contextll, 3
)ll3 4
;ll4 5
}mm 
,mm 
modelmm 
,mm 
contextmm 
,mm 
_loggermm &
)mm& '
;mm' (
}nn 	
}oo 
}pp ™
§D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Editors\ContentPartSettingsDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Editors# *
{ 
public		 

class		 ,
 ContentPartSettingsDisplayDriver		 1
:		2 3.
"ContentPartDefinitionDisplayDriver		4 V
{

 
public 
override 
IDisplayResult &
Edit' +
(+ ,!
ContentPartDefinition, A!
contentPartDefinitionB W
)W X
{ 	
return 

Initialize 
< (
ContentPartSettingsViewModel :
>: ;
(; <
$str< V
,V W
modelX ]
=>^ `
{ 
var 
settings 
= !
contentPartDefinition 4
.4 5
GetSettings5 @
<@ A
ContentPartSettingsA T
>T U
(U V
)V W
;W X
model 
. 

Attachable  
=! "
settings# +
.+ ,

Attachable, 6
;6 7
model 
. 
Reusable 
=  
settings! )
.) *
Reusable* 2
;2 3
model 
. 
Description !
=" #
settings$ ,
., -
Description- 8
;8 9
model 
. 
DisplayName !
=" #
settings$ ,
., -
DisplayName- 8
;8 9
model 
. !
ContentPartDefinition +
=, -!
contentPartDefinition. C
;C D
} 
) 
. 
Location 
( 
$str !
)! "
;" #
} 	
public 
override 
async 
Task "
<" #
IDisplayResult# 1
>1 2
UpdateAsync3 >
(> ?!
ContentPartDefinition? T!
contentPartDefinitionU j
,j k$
UpdatePartEditorContext	l É
context
Ñ ã
)
ã å
{ 	
var 
model 
= 
new (
ContentPartSettingsViewModel 8
(8 9
)9 :
;: ;
if 
( 
await 
context 
. 
Updater %
.% &
TryUpdateModelAsync& 9
(9 :
model: ?
,? @
PrefixA G
)G H
)H I
{ 
context 
. 
Builder 
.  

Attachable  *
(* +
model+ 0
.0 1

Attachable1 ;
); <
;< =
context   
.   
Builder   
.    
Reusable    (
(  ( )
model  ) .
.  . /
Reusable  / 7
)  7 8
;  8 9
context!! 
.!! 
Builder!! 
.!!  
WithDescription!!  /
(!!/ 0
model!!0 5
.!!5 6
Description!!6 A
)!!A B
;!!B C
context"" 
."" 
Builder"" 
.""  
WithDisplayName""  /
(""/ 0
model""0 5
.""5 6
DisplayName""6 A
)""A B
;""B C
}## 
return%% 
Edit%% 
(%% !
contentPartDefinition%% -
)%%- .
;%%. /
}&& 	
}'' 
}(( ¯
®D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Editors\ContentTypePartSettingsDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Editors# *
{ 
public 

class 0
$ContentTypePartSettingsDisplayDriver 5
:6 72
&ContentTypePartDefinitionDisplayDriver8 ^
{ 
public		 
override		 
IDisplayResult		 &
Edit		' +
(		+ ,%
ContentTypePartDefinition		, E
model		F K
,		K L
IUpdateModel		M Y
updater		Z a
)		a b
{

 	
return 
Shape 
( 
$str 7
,7 8
new9 <
ShapeViewModel= K
<K L%
ContentTypePartDefinitionL e
>e f
(f g
modelg l
)l m
)m n
.n o
Locationo w
(w x
$str	x Å
)
Å Ç
;
Ç É
} 	
} 
} é4
§D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Editors\ContentTypeSettingsDisplayDriver.cs
	namespace

 	
OrchardCore


 
.

 
ContentTypes

 "
.

" #
Editors

# *
{ 
public 

class ,
 ContentTypeSettingsDisplayDriver 1
:2 3.
"ContentTypeDefinitionDisplayDriver4 V
{ 
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public ,
 ContentTypeSettingsDisplayDriver /
(/ 0
IStringLocalizer0 @
<@ A,
 ContentTypeSettingsDisplayDriverA a
>a b
stringLocalizerc r
)r s
{ 	
S 
= 
stringLocalizer 
;  
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,!
ContentTypeDefinition, A!
contentTypeDefinitionB W
)W X
{ 	
return 

Initialize 
< (
ContentTypeSettingsViewModel :
>: ;
(; <
$str< V
,V W
modelX ]
=>^ `
{ 
var 
settings 
= !
contentTypeDefinition 4
.4 5
GetSettings5 @
<@ A
ContentTypeSettingsA T
>T U
(U V
)V W
;W X
model 
. 
	Creatable 
=  !
settings" *
.* +
	Creatable+ 4
;4 5
model 
. 
Listable 
=  
settings! )
.) *
Listable* 2
;2 3
model 
. 
	Draftable 
=  !
settings" *
.* +
	Draftable+ 4
;4 5
model 
. 
Versionable !
=" #
settings$ ,
., -
Versionable- 8
;8 9
model 
. 
	Securable 
=  !
settings" *
.* +
	Securable+ 4
;4 5
model   
.   

Stereotype    
=  ! "
settings  # +
.  + ,

Stereotype  , 6
;  6 7
}!! 
)!! 
.!! 
Location!! 
(!! 
$str!! #
)!!# $
;!!$ %
}"" 	
public$$ 
override$$ 
async$$ 
Task$$ "
<$$" #
IDisplayResult$$# 1
>$$1 2
UpdateAsync$$3 >
($$> ?!
ContentTypeDefinition$$? T!
contentTypeDefinition$$U j
,$$j k$
UpdateTypeEditorContext	$$l É
context
$$Ñ ã
)
$$ã å
{%% 	
var&& 
model&& 
=&& 
new&& (
ContentTypeSettingsViewModel&& 8
(&&8 9
)&&9 :
;&&: ;
if(( 
((( 
await(( 
context(( 
.(( 
Updater(( %
.((% &
TryUpdateModelAsync((& 9
(((9 :
model((: ?
,((? @
Prefix((A G
)((G H
)((H I
{)) 
context** 
.** 
Builder** 
.**  
	Creatable**  )
(**) *
model*** /
.**/ 0
	Creatable**0 9
)**9 :
;**: ;
context++ 
.++ 
Builder++ 
.++  
Listable++  (
(++( )
model++) .
.++. /
Listable++/ 7
)++7 8
;++8 9
context,, 
.,, 
Builder,, 
.,,  
	Draftable,,  )
(,,) *
model,,* /
.,,/ 0
	Draftable,,0 9
),,9 :
;,,: ;
context-- 
.-- 
Builder-- 
.--  
Versionable--  +
(--+ ,
model--, 1
.--1 2
Versionable--2 =
)--= >
;--> ?
context.. 
... 
Builder.. 
...  
	Securable..  )
(..) *
model..* /
.../ 0
	Securable..0 9
)..9 :
;..: ;
var// 

stereotype// 
=//  
model//! &
.//& '

Stereotype//' 1
?//1 2
.//2 3
Trim//3 7
(//7 8
)//8 9
;//9 :
context00 
.00 
Builder00 
.00  

Stereotype00  *
(00* +

stereotype00+ 5
)005 6
;006 7
if22 
(22 
!22 !
IsAlphaNumericOrEmpty22 *
(22* +

stereotype22+ 5
)225 6
)226 7
{33 
context44 
.44 
Updater44 #
.44# $

ModelState44$ .
.44. /
AddModelError44/ <
(44< =
nameof44= C
(44C D(
ContentTypeSettingsViewModel44D `
.44` a

Stereotype44a k
)44k l
,44l m
S44n o
[44o p
$str	44p ò
]
44ò ô
)
44ô ö
;
44ö õ
}55 
}66 
return88 
Edit88 
(88 !
contentTypeDefinition88 -
)88- .
;88. /
}99 	
private;; 
static;; 
bool;; !
IsAlphaNumericOrEmpty;; 1
(;;1 2
string;;2 8
value;;9 >
);;> ?
{<< 	
if== 
(== 
String== 
.== 
IsNullOrEmpty== $
(==$ %
value==% *
)==* +
)==+ ,
{>> 
return?? 
true?? 
;?? 
}@@ 
varBB 
startWithLetterBB 
=BB  !
charBB" &
.BB& '
IsLetterBB' /
(BB/ 0
valueBB0 5
[BB5 6
$numBB6 7
]BB7 8
)BB8 9
;BB9 :
returnDD 
valueDD 
.DD 
LengthDD 
==DD  "
$numDD# $
?EE 
startWithLetterEE !
:FF 
startWithLetterFF !
&&FF" $
valueFF% *
.FF* +
SkipFF+ /
(FF/ 0
$numFF0 1
)FF1 2
.FF2 3
AllFF3 6
(FF6 7
cFF7 8
=>FF9 ;
charFF< @
.FF@ A
IsLetterOrDigitFFA P
(FFP Q
cFFQ R
)FFR S
)FFS T
;FFT U
}GG 	
}HH 
}II ≥À
™D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Editors\DefaultContentDefinitionDisplayManager.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Editors# *
{ 
public 

class 2
&DefaultContentDefinitionDisplayManager 7
:8 9
BaseDisplayManager: L
,L M,
 IContentDefinitionDisplayManagerN n
{ 
private 
readonly 
IEnumerable $
<$ %,
 IContentDefinitionDisplayHandler% E
>E F
	_handlersG P
;P Q
private 
readonly 
IShapeTableManager +
_shapeTableManager, >
;> ?
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
private 
readonly 
IShapeFactory &
_shapeFactory' 4
;4 5
private 
readonly 
ILayoutAccessor (
_layoutAccessor) 8
;8 9
private 
readonly 
ILogger  
_logger! (
;( )
public 2
&DefaultContentDefinitionDisplayManager 5
(5 6
IEnumerable 
< ,
 IContentDefinitionDisplayHandler 8
>8 9
handlers: B
,B C
IShapeTableManager 
shapeTableManager 0
,0 1%
IContentDefinitionManager %$
contentDefinitionManager& >
,> ?
IShapeFactory 
shapeFactory &
,& '
IEnumerable 
< #
IShapePlacementProvider /
>/ 0
placementProviders1 C
,C D
ILogger 
< 2
&DefaultContentDefinitionDisplayManager :
>: ;
logger< B
,B C
ILayoutAccessor   
layoutAccessor   *
)!! 
:!! 
base!! 
(!! 
shapeFactory!! !
,!!! "
placementProviders!!# 5
)!!5 6
{"" 	
	_handlers## 
=## 
handlers##  
;##  !
_shapeTableManager$$ 
=$$  
shapeTableManager$$! 2
;$$2 3%
_contentDefinitionManager%% %
=%%& '$
contentDefinitionManager%%( @
;%%@ A
_shapeFactory&& 
=&& 
shapeFactory&& (
;&&( )
_layoutAccessor'' 
='' 
layoutAccessor'' ,
;'', -
_logger(( 
=(( 
logger(( 
;(( 
})) 	
public++ 
async++ 
Task++ 
<++ 
dynamic++ !
>++! " 
BuildTypeEditorAsync++# 7
(++7 8!
ContentTypeDefinition++8 M!
contentTypeDefinition++N c
,++c d
IUpdateModel++e q
updater++r y
,++y z
string	++{ Å
groupId
++Ç â
)
++â ä
{,, 	
if-- 
(-- !
contentTypeDefinition-- %
==--& (
null--) -
)--- .
{.. 
throw// 
new// !
ArgumentNullException// /
(/// 0
nameof//0 6
(//6 7!
contentTypeDefinition//7 L
)//L M
)//M N
;//N O
}00 
dynamic22 &
contentTypeDefinitionShape22 .
=22/ 0
await221 6#
CreateContentShapeAsync227 N
(22N O
$str22O k
)22k l
;22l m&
contentTypeDefinitionShape33 &
.33& '!
ContentTypeDefinition33' <
=33= >!
contentTypeDefinition33? T
;33T U
var55 
typeContext55 
=55 
new55 !
BuildEditorContext55" 4
(554 5&
contentTypeDefinitionShape66 *
,66* +
groupId77 
,77 
false88 
,88 
$str99 
,99 
_shapeFactory:: 
,:: 
await;; 
_layoutAccessor;; %
.;;% &
GetLayoutAsync;;& 4
(;;4 5
);;5 6
,;;6 7
updater<< 
)== 
;== 
await?? 
BindPlacementAsync?? $
(??$ %
typeContext??% 0
)??0 1
;??1 2
awaitAA 
	_handlersAA 
.AA 
InvokeAsyncAA '
(AA' (
(AA( )
handlerAA) 0
,AA0 1!
contentTypeDefinitionAA2 G
,AAG H
typeContextAAI T
)AAT U
=>AAV X
handlerAAY `
.AA` a 
BuildTypeEditorAsyncAAa u
(AAu v"
contentTypeDefinition	AAv ã
,
AAã å
typeContext
AAç ò
)
AAò ô
,
AAô ö#
contentTypeDefinition
AAõ ∞
,
AA∞ ±
typeContext
AA≤ Ω
,
AAΩ æ
_logger
AAø ∆
)
AA∆ «
;
AA« »
returnCC &
contentTypeDefinitionShapeCC -
;CC- .
}DD 	
publicFF 
asyncFF 
TaskFF 
<FF 
dynamicFF !
>FF! "!
UpdateTypeEditorAsyncFF# 8
(FF8 9!
ContentTypeDefinitionFF9 N!
contentTypeDefinitionFFO d
,FFd e
IUpdateModelFFf r
updaterFFs z
,FFz {
string	FF| Ç
groupId
FFÉ ä
)
FFä ã
{GG 	
ifHH 
(HH !
contentTypeDefinitionHH %
==HH& (
nullHH) -
)HH- .
{II 
throwJJ 
newJJ !
ArgumentNullExceptionJJ /
(JJ/ 0
nameofJJ0 6
(JJ6 7!
contentTypeDefinitionJJ7 L
)JJL M
)JJM N
;JJN O
}KK 
dynamicMM &
contentTypeDefinitionShapeMM .
=MM/ 0
awaitMM1 6#
CreateContentShapeAsyncMM7 N
(MMN O
$strMMO k
)MMk l
;MMl m&
contentTypeDefinitionShapeNN &
.NN& '!
ContentTypeDefinitionNN' <
=NN= >!
contentTypeDefinitionNN? T
;NNT U
varPP 
layoutPP 
=PP 
awaitPP 
_layoutAccessorPP .
.PP. /
GetLayoutAsyncPP/ =
(PP= >
)PP> ?
;PP? @
awaitRR %
_contentDefinitionManagerRR +
.RR+ ,$
AlterTypeDefinitionAsyncRR, D
(RRD E!
contentTypeDefinitionRRE Z
.RRZ [
NameRR[ _
,RR_ `
asyncRRa f
typeBuilderRRg r
=>RRs u
{SS 
varTT 
typeContextTT 
=TT  !
newTT" %#
UpdateTypeEditorContextTT& =
(TT= >
typeBuilderUU 
,UU  &
contentTypeDefinitionShapeVV .
,VV. /
groupIdWW 
,WW 
falseXX 
,XX 
_shapeFactoryYY !
,YY! "
layoutZZ 
,ZZ 
updater[[ 
)\\ 
;\\ 
await^^ 
BindPlacementAsync^^ (
(^^( )
typeContext^^) 4
)^^4 5
;^^5 6
await`` 
	_handlers`` 
.``  
InvokeAsync``  +
(``+ ,
(``, -
handler``- 4
,``4 5!
contentTypeDefinition``6 K
,``K L
typeContext``M X
)``X Y
=>``Z \
handler``] d
.``d e!
UpdateTypeEditorAsync``e z
(``z {"
contentTypeDefinition	``{ ê
,
``ê ë
typeContext
``í ù
)
``ù û
,
``û ü#
contentTypeDefinition
``† µ
,
``µ ∂
typeContext
``∑ ¬
,
``¬ √
_logger
``ƒ À
)
``À Ã
;
``Ã Õ
}aa 
)aa 
;aa 
returncc &
contentTypeDefinitionShapecc -
;cc- .
}dd 	
publicff 
asyncff 
Taskff 
<ff 
dynamicff !
>ff! " 
BuildPartEditorAsyncff# 7
(ff7 8!
ContentPartDefinitionff8 M!
contentPartDefinitionffN c
,ffc d
IUpdateModelffe q
updaterffr y
,ffy z
string	ff{ Å
groupId
ffÇ â
)
ffâ ä
{gg 	
ifhh 
(hh !
contentPartDefinitionhh %
==hh& (
nullhh) -
)hh- .
{ii 
throwjj 
newjj !
ArgumentNullExceptionjj /
(jj/ 0
nameofjj0 6
(jj6 7!
contentPartDefinitionjj7 L
)jjL M
)jjM N
;jjN O
}kk 
varmm &
contentPartDefinitionShapemm *
=mm+ ,
awaitmm- 2#
CreateContentShapeAsyncmm3 J
(mmJ K
$strmmK g
)mmg h
;mmh i
varoo 
partContextoo 
=oo 
newoo !
BuildEditorContextoo" 4
(oo4 5&
contentPartDefinitionShapepp *
,pp* +
groupIdqq 
,qq 
falserr 
,rr 
$strss 
,ss 
_shapeFactorytt 
,tt 
awaituu 
_layoutAccessoruu %
.uu% &
GetLayoutAsyncuu& 4
(uu4 5
)uu5 6
,uu6 7
updatervv 
)ww 
;ww 
awaityy 
BindPlacementAsyncyy $
(yy$ %
partContextyy% 0
)yy0 1
;yy1 2
await{{ 
	_handlers{{ 
.{{ 
InvokeAsync{{ '
({{' (
({{( )
handler{{) 0
,{{0 1!
contentPartDefinition{{2 G
,{{G H
partContext{{I T
){{T U
=>{{V X
handler{{Y `
.{{` a 
BuildPartEditorAsync{{a u
({{u v"
contentPartDefinition	{{v ã
,
{{ã å
partContext
{{ç ò
)
{{ò ô
,
{{ô ö#
contentPartDefinition
{{õ ∞
,
{{∞ ±
partContext
{{≤ Ω
,
{{Ω æ
_logger
{{ø ∆
)
{{∆ «
;
{{« »
return}} &
contentPartDefinitionShape}} -
;}}- .
}~~ 	
public
ÄÄ 
async
ÄÄ 
Task
ÄÄ 
<
ÄÄ 
dynamic
ÄÄ !
>
ÄÄ! "#
UpdatePartEditorAsync
ÄÄ# 8
(
ÄÄ8 9#
ContentPartDefinition
ÄÄ9 N#
contentPartDefinition
ÄÄO d
,
ÄÄd e
IUpdateModel
ÄÄf r
updater
ÄÄs z
,
ÄÄz {
stringÄÄ| Ç
groupIdÄÄÉ ä
)ÄÄä ã
{
ÅÅ 	
if
ÇÇ 
(
ÇÇ #
contentPartDefinition
ÇÇ %
==
ÇÇ& (
null
ÇÇ) -
)
ÇÇ- .
{
ÉÉ 
throw
ÑÑ 
new
ÑÑ #
ArgumentNullException
ÑÑ /
(
ÑÑ/ 0
nameof
ÑÑ0 6
(
ÑÑ6 7#
contentPartDefinition
ÑÑ7 L
)
ÑÑL M
)
ÑÑM N
;
ÑÑN O
}
ÖÖ 
var
áá (
contentPartDefinitionShape
áá *
=
áá+ ,
await
áá- 2%
CreateContentShapeAsync
áá3 J
(
ááJ K
$str
ááK g
)
áág h
;
ááh i%
UpdatePartEditorContext
ââ #
partContext
ââ$ /
=
ââ0 1
null
ââ2 6
;
ââ6 7
var
ää 
layout
ää 
=
ää 
await
ää 
_layoutAccessor
ää .
.
ää. /
GetLayoutAsync
ää/ =
(
ää= >
)
ää> ?
;
ää? @
await
åå '
_contentDefinitionManager
åå +
.
åå+ ,&
AlterPartDefinitionAsync
åå, D
(
ååD E#
contentPartDefinition
ååE Z
.
ååZ [
Name
åå[ _
,
åå_ `
async
ååa f
partBuilder
ååg r
=>
åås u
{
çç 
partContext
éé 
=
éé 
new
éé !%
UpdatePartEditorContext
éé" 9
(
éé9 :
partBuilder
èè 
,
èè  (
contentPartDefinitionShape
êê .
,
êê. /
groupId
ëë 
,
ëë 
false
íí 
,
íí 
_shapeFactory
ìì !
,
ìì! "
layout
îî 
,
îî 
updater
ïï 
)
ññ 
;
ññ 
await
òò  
BindPlacementAsync
òò (
(
òò( )
partContext
òò) 4
)
òò4 5
;
òò5 6
await
öö 
	_handlers
öö 
.
öö  
InvokeAsync
öö  +
(
öö+ ,
(
öö, -
handler
öö- 4
,
öö4 5#
contentPartDefinition
öö6 K
,
ööK L
partContext
ööM X
)
ööX Y
=>
ööZ \
handler
öö] d
.
ööd e#
UpdatePartEditorAsync
ööe z
(
ööz {$
contentPartDefinitionöö{ ê
,ööê ë
partContextööí ù
)ööù û
,ööû ü%
contentPartDefinitionöö† µ
,ööµ ∂
partContextöö∑ ¬
,öö¬ √
_loggerööƒ À
)ööÀ Ã
;ööÃ Õ
}
õõ 
)
õõ 
;
õõ 
return
ùù (
contentPartDefinitionShape
ùù -
;
ùù- .
}
ûû 	
public
†† 
async
†† 
Task
†† 
<
†† 
dynamic
†† !
>
††! "&
BuildTypePartEditorAsync
††# ;
(
††; <'
ContentTypePartDefinition
††< U'
contentTypePartDefinition
††V o
,
††o p
IUpdateModel
††q }
updater††~ Ö
,††Ö Ü
string††á ç
groupId††é ï
=††ñ ó
$str††ò ö
)††ö õ
{
°° 	
if
¢¢ 
(
¢¢ '
contentTypePartDefinition
¢¢ )
==
¢¢* ,
null
¢¢- 1
)
¢¢1 2
{
££ 
throw
§§ 
new
§§ #
ArgumentNullException
§§ /
(
§§/ 0
nameof
§§0 6
(
§§6 7'
contentTypePartDefinition
§§7 P
)
§§P Q
)
§§Q R
;
§§R S
}
•• 
dynamic
ßß %
typePartDefinitionShape
ßß +
=
ßß, -
await
ßß. 3%
CreateContentShapeAsync
ßß4 K
(
ßßK L
$str
ßßL l
)
ßßl m
;
ßßm n%
typePartDefinitionShape
®® #
.
®®# $
ContentPart
®®$ /
=
®®0 1'
contentTypePartDefinition
®®2 K
;
®®K L
var
™™ 
partContext
™™ 
=
™™ 
new
™™ ! 
BuildEditorContext
™™" 4
(
™™4 5%
typePartDefinitionShape
´´ '
,
´´' (
groupId
¨¨ 
,
¨¨ 
false
≠≠ 
,
≠≠ 
$str
ÆÆ 
,
ÆÆ 
_shapeFactory
ØØ 
,
ØØ 
await
∞∞ 
_layoutAccessor
∞∞ %
.
∞∞% &
GetLayoutAsync
∞∞& 4
(
∞∞4 5
)
∞∞5 6
,
∞∞6 7
updater
±± 
)
≤≤ 
;
≤≤ 
await
¥¥  
BindPlacementAsync
¥¥ $
(
¥¥$ %
partContext
¥¥% 0
)
¥¥0 1
;
¥¥1 2
await
∂∂ 
	_handlers
∂∂ 
.
∂∂ 
InvokeAsync
∂∂ '
(
∂∂' (
(
∂∂( )
handler
∂∂) 0
,
∂∂0 1'
contentTypePartDefinition
∂∂2 K
,
∂∂K L
partContext
∂∂M X
)
∂∂X Y
=>
∂∂Z \
handler
∂∂] d
.
∂∂d e&
BuildTypePartEditorAsync
∂∂e }
(
∂∂} ~(
contentTypePartDefinition∂∂~ ó
,∂∂ó ò
partContext∂∂ô §
)∂∂§ •
,∂∂• ¶)
contentTypePartDefinition∂∂ß ¿
,∂∂¿ ¡
partContext∂∂¬ Õ
,∂∂Õ Œ
_logger∂∂œ ÷
)∂∂÷ ◊
;∂∂◊ ÿ
return
∏∏ %
typePartDefinitionShape
∏∏ *
;
∏∏* +
}
ππ 	
public
ªª 
async
ªª 
Task
ªª 
<
ªª 
dynamic
ªª !
>
ªª! "'
UpdateTypePartEditorAsync
ªª# <
(
ªª< ='
ContentTypePartDefinition
ªª= V'
contentTypePartDefinition
ªªW p
,
ªªp q
IUpdateModel
ªªr ~
updaterªª Ü
,ªªÜ á
stringªªà é
groupIdªªè ñ
=ªªó ò
$strªªô õ
)ªªõ ú
{
ºº 	
if
ΩΩ 
(
ΩΩ '
contentTypePartDefinition
ΩΩ )
==
ΩΩ* ,
null
ΩΩ- 1
)
ΩΩ1 2
{
ææ 
throw
øø 
new
øø #
ArgumentNullException
øø /
(
øø/ 0
nameof
øø0 6
(
øø6 7'
contentTypePartDefinition
øø7 P
)
øøP Q
)
øøQ R
;
øøR S
}
¿¿ 
dynamic
¬¬ %
typePartDefinitionShape
¬¬ +
=
¬¬, -
await
¬¬. 3%
CreateContentShapeAsync
¬¬4 K
(
¬¬K L
$str
¬¬L l
)
¬¬l m
;
¬¬m n
var
√√ 
layout
√√ 
=
√√ 
await
√√ 
_layoutAccessor
√√ .
.
√√. /
GetLayoutAsync
√√/ =
(
√√= >
)
√√> ?
;
√√? @
await
≈≈ '
_contentDefinitionManager
≈≈ +
.
≈≈+ ,&
AlterTypeDefinitionAsync
≈≈, D
(
≈≈D E'
contentTypePartDefinition
≈≈E ^
.
≈≈^ _#
ContentTypeDefinition
≈≈_ t
.
≈≈t u
Name
≈≈u y
,
≈≈y z
typeBuilder≈≈{ Ü
=>≈≈á â
{
∆∆ 
return
«« 
typeBuilder
«« "
.
««" #
WithPartAsync
««# 0
(
««0 1'
contentTypePartDefinition
««1 J
.
««J K
Name
««K O
,
««O P
async
««Q V
typePartBuilder
««W f
=>
««g i
{
»» %
typePartDefinitionShape
…… +
.
……+ ,
ContentPart
……, 7
=
……8 9'
contentTypePartDefinition
……: S
;
……S T
var
ÀÀ 
partContext
ÀÀ #
=
ÀÀ$ %
new
ÀÀ& ))
UpdateTypePartEditorContext
ÀÀ* E
(
ÀÀE F
typePartBuilder
ÃÃ '
,
ÃÃ' (%
typePartDefinitionShape
ÕÕ /
,
ÕÕ/ 0
groupId
ŒŒ 
,
ŒŒ  
false
œœ 
,
œœ 
_shapeFactory
–– %
,
––% &
layout
—— 
,
—— 
updater
““ 
)
”” 
;
”” 
await
’’  
BindPlacementAsync
’’ ,
(
’’, -
partContext
’’- 8
)
’’8 9
;
’’9 :
await
◊◊ 
	_handlers
◊◊ #
.
◊◊# $
InvokeAsync
◊◊$ /
(
◊◊/ 0
(
◊◊0 1
handler
◊◊1 8
,
◊◊8 9'
contentTypePartDefinition
◊◊: S
,
◊◊S T
partContext
◊◊U `
)
◊◊` a
=>
◊◊b d
handler
◊◊e l
.
◊◊l m(
UpdateTypePartEditorAsync◊◊m Ü
(◊◊Ü á)
contentTypePartDefinition◊◊á †
,◊◊† °
partContext◊◊¢ ≠
)◊◊≠ Æ
,◊◊Æ Ø)
contentTypePartDefinition◊◊∞ …
,◊◊…  
partContext◊◊À ÷
,◊◊÷ ◊
_logger◊◊ÿ ﬂ
)◊◊ﬂ ‡
;◊◊‡ ·
}
ÿÿ 
)
ÿÿ 
;
ÿÿ 
}
ŸŸ 
)
ŸŸ 
;
ŸŸ 
return
€€ %
typePartDefinitionShape
€€ *
;
€€* +
}
‹‹ 	
public
ﬁﬁ 
async
ﬁﬁ 
Task
ﬁﬁ 
<
ﬁﬁ 
dynamic
ﬁﬁ !
>
ﬁﬁ! "'
BuildPartFieldEditorAsync
ﬁﬁ# <
(
ﬁﬁ< =(
ContentPartFieldDefinition
ﬁﬁ= W(
contentPartFieldDefinition
ﬁﬁX r
,
ﬁﬁr s
IUpdateModelﬁﬁt Ä
updaterﬁﬁÅ à
,ﬁﬁà â
stringﬁﬁä ê
groupIdﬁﬁë ò
=ﬁﬁô ö
$strﬁﬁõ ù
)ﬁﬁù û
{
ﬂﬂ 	
if
‡‡ 
(
‡‡ (
contentPartFieldDefinition
‡‡ *
==
‡‡+ -
null
‡‡. 2
)
‡‡2 3
{
·· 
throw
‚‚ 
new
‚‚ #
ArgumentNullException
‚‚ /
(
‚‚/ 0
nameof
‚‚0 6
(
‚‚6 7(
contentPartFieldDefinition
‚‚7 Q
)
‚‚Q R
)
‚‚R S
;
‚‚S T
}
„„ 
dynamic
ÂÂ &
partFieldDefinitionShape
ÂÂ ,
=
ÂÂ- .
await
ÂÂ/ 4%
CreateContentShapeAsync
ÂÂ5 L
(
ÂÂL M
$str
ÂÂM n
)
ÂÂn o
;
ÂÂo p&
partFieldDefinitionShape
ÊÊ $
.
ÊÊ$ %
ContentField
ÊÊ% 1
=
ÊÊ2 3(
contentPartFieldDefinition
ÊÊ4 N
;
ÊÊN O
var
ËË 
fieldContext
ËË 
=
ËË 
new
ËË " 
BuildEditorContext
ËË# 5
(
ËË5 6&
partFieldDefinitionShape
ÈÈ (
,
ÈÈ( )
groupId
ÍÍ 
,
ÍÍ 
false
ÎÎ 
,
ÎÎ 
$str
ÏÏ 
,
ÏÏ 
_shapeFactory
ÌÌ 
,
ÌÌ 
await
ÓÓ 
_layoutAccessor
ÓÓ %
.
ÓÓ% &
GetLayoutAsync
ÓÓ& 4
(
ÓÓ4 5
)
ÓÓ5 6
,
ÓÓ6 7
updater
ÔÔ 
)
 
;
 
await
ÚÚ  
BindPlacementAsync
ÚÚ $
(
ÚÚ$ %
fieldContext
ÚÚ% 1
)
ÚÚ1 2
;
ÚÚ2 3
await
ÙÙ 
	_handlers
ÙÙ 
.
ÙÙ 
InvokeAsync
ÙÙ '
(
ÙÙ' (
(
ÙÙ( )
handler
ÙÙ) 0
,
ÙÙ0 1(
contentPartFieldDefinition
ÙÙ2 L
,
ÙÙL M
fieldContext
ÙÙN Z
)
ÙÙZ [
=>
ÙÙ\ ^
handler
ÙÙ_ f
.
ÙÙf g(
BuildPartFieldEditorAsyncÙÙg Ä
(ÙÙÄ Å*
contentPartFieldDefinitionÙÙÅ õ
,ÙÙõ ú
fieldContextÙÙù ©
)ÙÙ© ™
,ÙÙ™ ´*
contentPartFieldDefinitionÙÙ¨ ∆
,ÙÙ∆ «
fieldContextÙÙ» ‘
,ÙÙ‘ ’
_loggerÙÙ÷ ›
)ÙÙ› ﬁ
;ÙÙﬁ ﬂ
return
ˆˆ &
partFieldDefinitionShape
ˆˆ +
;
ˆˆ+ ,
}
˜˜ 	
public
˘˘ 
async
˘˘ 
Task
˘˘ 
<
˘˘ 
dynamic
˘˘ !
>
˘˘! "(
UpdatePartFieldEditorAsync
˘˘# =
(
˘˘= >(
ContentPartFieldDefinition
˘˘> X(
contentPartFieldDefinition
˘˘Y s
,
˘˘s t
IUpdateModel˘˘u Å
updater˘˘Ç â
,˘˘â ä
string˘˘ã ë
groupId˘˘í ô
=˘˘ö õ
$str˘˘ú û
)˘˘û ü
{
˙˙ 	
if
˚˚ 
(
˚˚ (
contentPartFieldDefinition
˚˚ *
==
˚˚+ -
null
˚˚. 2
)
˚˚2 3
{
¸¸ 
throw
˝˝ 
new
˝˝ #
ArgumentNullException
˝˝ /
(
˝˝/ 0
nameof
˝˝0 6
(
˝˝6 7(
contentPartFieldDefinition
˝˝7 Q
)
˝˝Q R
)
˝˝R S
;
˝˝S T
}
˛˛ 
var
ÄÄ #
contentPartDefinition
ÄÄ %
=
ÄÄ& '(
contentPartFieldDefinition
ÄÄ( B
.
ÄÄB C
PartDefinition
ÄÄC Q
;
ÄÄQ R
dynamic
ÅÅ &
partFieldDefinitionShape
ÅÅ ,
=
ÅÅ- .
await
ÅÅ/ 4%
CreateContentShapeAsync
ÅÅ5 L
(
ÅÅL M
$str
ÅÅM n
)
ÅÅn o
;
ÅÅo p
var
ÉÉ 
layout
ÉÉ 
=
ÉÉ 
await
ÉÉ 
_layoutAccessor
ÉÉ .
.
ÉÉ. /
GetLayoutAsync
ÉÉ/ =
(
ÉÉ= >
)
ÉÉ> ?
;
ÉÉ? @
await
ÖÖ '
_contentDefinitionManager
ÖÖ +
.
ÖÖ+ ,&
AlterPartDefinitionAsync
ÖÖ, D
(
ÖÖD E#
contentPartDefinition
ÖÖE Z
.
ÖÖZ [
Name
ÖÖ[ _
,
ÖÖ_ `
partBuilder
ÖÖa l
=>
ÖÖm o
{
ÜÜ 
return
áá 
partBuilder
áá "
.
áá" #
WithFieldAsync
áá# 1
(
áá1 2(
contentPartFieldDefinition
áá2 L
.
ááL M
Name
ááM Q
,
ááQ R
async
ááS X
partFieldBuilder
ááY i
=>
ááj l
{
àà &
partFieldDefinitionShape
ââ ,
.
ââ, -
ContentField
ââ- 9
=
ââ: ;(
contentPartFieldDefinition
ââ< V
;
ââV W
var
ãã 
fieldContext
ãã $
=
ãã% &
new
ãã' **
UpdatePartFieldEditorContext
ãã+ G
(
ããG H
partFieldBuilder
åå (
,
åå( )&
partFieldDefinitionShape
çç 0
,
çç0 1
groupId
éé 
,
éé  
false
èè 
,
èè 
_shapeFactory
êê %
,
êê% &
layout
ëë 
,
ëë 
updater
íí 
)
ìì 
;
ìì 
await
ïï  
BindPlacementAsync
ïï ,
(
ïï, -
fieldContext
ïï- 9
)
ïï9 :
;
ïï: ;
await
óó 
	_handlers
óó #
.
óó# $
InvokeAsync
óó$ /
(
óó/ 0
(
óó0 1
handler
óó1 8
,
óó8 9(
contentPartFieldDefinition
óó: T
,
óóT U
fieldContext
óóV b
)
óób c
=>
óód f
handler
óóg n
.
óón o)
UpdatePartFieldEditorAsyncóóo â
(óóâ ä*
contentPartFieldDefinitionóóä §
,óó§ •
fieldContextóó¶ ≤
)óó≤ ≥
,óó≥ ¥*
contentPartFieldDefinitionóóµ œ
,óóœ –
fieldContextóó— ›
,óó› ﬁ
_loggeróóﬂ Ê
)óóÊ Á
;óóÁ Ë
}
òò 
)
òò 
;
òò 
}
ôô 
)
ôô 
;
ôô 
return
õõ &
partFieldDefinitionShape
õõ +
;
õõ+ ,
}
úú 	
}
ùù 
}ûû Ñ
£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Editors\DefaultContentTypeDisplayDriver.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Editors# *
{		 
public

 

class

 +
DefaultContentTypeDisplayDriver

 0
:

1 2.
"ContentTypeDefinitionDisplayDriver

3 U
{ 
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public +
DefaultContentTypeDisplayDriver .
(. /
IStringLocalizer/ ?
<? @+
DefaultContentTypeDisplayDriver@ _
>_ `
	localizera j
)j k
{ 	
S 
= 
	localizer 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,!
ContentTypeDefinition, A!
contentTypeDefinitionB W
)W X
{ 	
return 

Initialize 
<  
ContentTypeViewModel 2
>2 3
(3 4
$str4 F
,F G
modelH M
=>N P
{ 
model 
. 
DisplayName !
=" #!
contentTypeDefinition$ 9
.9 :
DisplayName: E
;E F
} 
) 
. 
Location 
( 
$str !
)! "
;" #
} 	
public 
override 
async 
Task "
<" #
IDisplayResult# 1
>1 2
UpdateAsync3 >
(> ?!
ContentTypeDefinition? T!
contentTypeDefinitionU j
,j k$
UpdateTypeEditorContext	l É
context
Ñ ã
)
ã å
{ 	
var 
model 
= 
new  
ContentTypeViewModel 0
(0 1
)1 2
;2 3
await 
context 
. 
Updater !
.! "
TryUpdateModelAsync" 5
(5 6
model6 ;
,; <
Prefix= C
)C D
;D E
context!! 
.!! 
Builder!! 
.!! 
DisplayedAs!! '
(!!' (
model!!( -
.!!- .
DisplayName!!. 9
)!!9 :
;!!: ;
if## 
(## 
String## 
.## 
IsNullOrWhiteSpace## )
(##) *
model##* /
.##/ 0
DisplayName##0 ;
)##; <
)##< =
{$$ 
context%% 
.%% 
Updater%% 
.%%  

ModelState%%  *
.%%* +
AddModelError%%+ 8
(%%8 9
$str%%9 F
,%%F G
S%%H I
[%%I J
$str%%J q
]%%q r
)%%r s
;%%s t
}&& 
return(( 
Edit(( 
((( !
contentTypeDefinition(( -
)((- .
;((. /
})) 	
}** 
}++ ì
∞D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\GraphQL\Drivers\GraphQLContentTypePartSettingsDriver.cs
	namespace

 	
OrchardCore


 
.

 
ContentTypes

 "
.

" #
GraphQL

# *
.

* +
Drivers

+ 2
{ 
public 

class 0
$GraphQLContentTypePartSettingsDriver 5
:6 72
&ContentTypePartDefinitionDisplayDriver8 ^
{ 
private 
readonly !
GraphQLContentOptions .
_contentOptions/ >
;> ?
public 0
$GraphQLContentTypePartSettingsDriver 3
(3 4
IOptions4 <
<< =!
GraphQLContentOptions= R
>R S
optionsAccessorT c
)c d
{ 	
_contentOptions 
= 
optionsAccessor -
.- .
Value. 3
;3 4
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,%
ContentTypePartDefinition, E%
contentTypePartDefinitionF _
)_ `
{ 	
if 
( %
contentTypePartDefinition )
.) *!
ContentTypeDefinition* ?
.? @
Name@ D
==E G%
contentTypePartDefinitionH a
.a b
PartDefinitionb p
.p q
Nameq u
)u v
{ 
return 
null 
; 
} 
return 

Initialize 
< 3
'GraphQLContentTypePartSettingsViewModel E
>E F
(F G
$strG l
,l m
modeln s
=>t v
{ 
model 
. 

Definition  
=! "%
contentTypePartDefinition# <
;< =
model 
. 
Options 
= 
_contentOptions  /
;/ 0
model   
.   
Settings   
=    %
contentTypePartDefinition  ! :
.  : ;
GetSettings  ; F
<  F G*
GraphQLContentTypePartSettings  G e
>  e f
(  f g
)  g h
;  h i
}!! 
)!! 
.!! 
Location!! 
(!! 
$str!! !
)!!! "
;!!" #
}"" 	
public$$ 
override$$ 
async$$ 
Task$$ "
<$$" #
IDisplayResult$$# 1
>$$1 2
UpdateAsync$$3 >
($$> ?%
ContentTypePartDefinition$$? X%
contentTypePartDefinition$$Y r
,$$r s(
UpdateTypePartEditorContext	$$t è
context
$$ê ó
)
$$ó ò
{%% 	
if&& 
(&& %
contentTypePartDefinition&& )
.&&) *!
ContentTypeDefinition&&* ?
.&&? @
Name&&@ D
==&&E G%
contentTypePartDefinition&&H a
.&&a b
PartDefinition&&b p
.&&p q
Name&&q u
)&&u v
{'' 
return(( 
null(( 
;(( 
})) 
var++ 
model++ 
=++ 
new++ 3
'GraphQLContentTypePartSettingsViewModel++ C
(++C D
)++D E
;++E F
await-- 
context-- 
.-- 
Updater-- !
.--! "
TryUpdateModelAsync--" 5
(--5 6
model--6 ;
,--; <
Prefix--= C
)--C D
;--D E
context// 
.// 
Builder// 
.// 
WithSettings// (
(//( )
model//) .
.//. /
Settings/// 7
)//7 8
;//8 9
return11 
Edit11 
(11 %
contentTypePartDefinition11 1
)111 2
;112 3
}22 	
}33 
}44 ⁄
ãD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\GraphQL\Startup.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
GraphQL# *
{ 
[ 
RequireFeatures 
( 
$str /
)/ 0
]0 1
public		 

class		 
Startup		 
:		 
StartupBase		 &
{

 
public 
override 
void 
ConfigureServices .
(. /
IServiceCollection/ A
servicesB J
)J K
{ 	
services 
. 
	AddScoped 
< 3
'IContentTypePartDefinitionDisplayDriver F
,F G0
$GraphQLContentTypePartSettingsDriverH l
>l m
(m n
)n o
;o p
} 	
} 
} ˛
∂D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\GraphQL\ViewModels\GraphQLContentTypePartSettingsViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
GraphQL# *
.* +

ViewModels+ 5
{ 
public 

class 3
'GraphQLContentTypePartSettingsViewModel 8
{ 
public		 !
GraphQLContentOptions		 $
Options		% ,
{		- .
get		/ 2
;		2 3
set		4 7
;		7 8
}		9 :
public

 *
GraphQLContentTypePartSettings

 -
Settings

. 6
{

7 8
get

9 <
;

< =
set

> A
;

A B
}

C D
public %
ContentTypePartDefinition (

Definition) 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
} 
} –
ÑD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Manifest.cs
[ 
assembly 	
:	 

Module 
( 
Name 
=	 

$str 
, 
Author 

= 
ManifestConstants 
. 
OrchardCoreTeam .
,. /
Website 
= 
ManifestConstants 
.  
OrchardCoreWebsite  2
,2 3
Version 
= 
ManifestConstants 
.  
OrchardCoreVersion  2
,2 3
Description 
= 
$str q
,q r
Dependencies		 
=		 
new		 
[		 
]		 
{		 
$str		 1
}		2 3
,		3 4
Category

 
=

 
$str

 #
) 
] Ì
áD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Permissions.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
{ 
public 

class 
Permissions 
: 
IPermissionProvider 2
{ 
public		 
static		 
readonly		 

Permission		 )
ViewContentTypes		* :
=		; <
new		= @

Permission		A K
(		K L
$str		L ^
,		^ _
$str		` u
)		u v
;		v w
public

 
static

 
readonly

 

Permission

 )
EditContentTypes

* :
=

; <
new

= @

Permission

A K
(

K L
$str

L ^
,

^ _
$str

` u
)

u v
;

v w
public 
Task 
< 
IEnumerable 
<  

Permission  *
>* +
>+ ,
GetPermissionsAsync- @
(@ A
)A B
{ 	
return 
Task 
. 

FromResult "
(" #
GetPermissions# 1
(1 2
)2 3
)3 4
;4 5
} 	
public 
IEnumerable 
<  
PermissionStereotype /
>/ 0!
GetDefaultStereotypes1 F
(F G
)G H
{ 	
return 
new 
[ 
] 
{ 
new  
PermissionStereotype (
{) *
Name 
= 
$str *
,* +
Permissions 
=  !
GetPermissions" 0
(0 1
)1 2
} 
} 
; 
} 	
private 
IEnumerable 
< 

Permission &
>& '
GetPermissions( 6
(6 7
)7 8
{ 	
return 
new 
[ 
] 
{ 
ViewContentTypes  
,  !
EditContentTypes    
}!! 
;!! 
}"" 	
}## 
}$$ ¸:
ùD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\RecipeSteps\ContentDefinitionStep.cs
	namespace		 	
OrchardCore		
 
.		 
ContentTypes		 "
.		" #
RecipeSteps		# .
{

 
public 

class !
ContentDefinitionStep &
:' (
IRecipeStepHandler) ;
{ 
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
public !
ContentDefinitionStep $
($ %%
IContentDefinitionManager% >$
contentDefinitionManager? W
)W X
{ 	%
_contentDefinitionManager %
=& '$
contentDefinitionManager( @
;@ A
} 	
public 
Task 
ExecuteAsync  
(  !"
RecipeExecutionContext! 7
context8 ?
)? @
{ 	
if 
( 
! 
String 
. 
Equals 
( 
context &
.& '
Name' +
,+ ,
$str- @
,@ A
StringComparisonB R
.R S
OrdinalIgnoreCaseS d
)d e
)e f
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
var 
step 
= 
context 
. 
Step #
.# $
ToObject$ ,
<, -&
ContentDefinitionStepModel- G
>G H
(H I
)I J
;J K
foreach   
(   
var   
contentType   $
in  % '
step  ( ,
.  , -
ContentTypes  - 9
)  9 :
{!! 
var"" 
newType"" 
="" %
_contentDefinitionManager"" 7
.""7 8
LoadTypeDefinition""8 J
(""J K
contentType""K V
.""V W
Name""W [
)""[ \
??## 
new## !
ContentTypeDefinition## 0
(##0 1
contentType##1 <
.##< =
Name##= A
,##A B
contentType##C N
.##N O
DisplayName##O Z
)##Z [
;##[ \
UpdateContentType%% !
(%%! "
newType%%" )
,%%) *
contentType%%+ 6
)%%6 7
;%%7 8
}&& 
foreach(( 
((( 
var(( 
contentPart(( $
in((% '
step((( ,
.((, -
ContentParts((- 9
)((9 :
{)) 
var** 
newPart** 
=** %
_contentDefinitionManager** 7
.**7 8
LoadPartDefinition**8 J
(**J K
contentPart**K V
.**V W
Name**W [
)**[ \
??++ 
new++ !
ContentPartDefinition++ 0
(++0 1
contentPart++1 <
.++< =
Name++= A
)++A B
;++B C
UpdateContentPart-- !
(--! "
newPart--" )
,--) *
contentPart--+ 6
)--6 7
;--7 8
}.. 
return00 
Task00 
.00 
CompletedTask00 %
;00% &
}11 	
private33 
void33 
UpdateContentType33 &
(33& '!
ContentTypeDefinition33' <
type33= A
,33A B'
ContentTypeDefinitionRecord33C ^
record33_ e
)33e f
{44 	%
_contentDefinitionManager55 %
.55% &
AlterTypeDefinition55& 9
(559 :
type55: >
.55> ?
Name55? C
,55C D
builder55E L
=>55M O
{66 
if77 
(77 
!77 
String77 
.77 
IsNullOrEmpty77 )
(77) *
record77* 0
.770 1
DisplayName771 <
)77< =
)77= >
{88 
builder99 
.99 
DisplayedAs99 '
(99' (
record99( .
.99. /
DisplayName99/ :
)99: ;
;99; <
builder:: 
.:: 
MergeSettings:: )
(::) *
record::* 0
.::0 1
Settings::1 9
)::9 :
;::: ;
};; 
foreach== 
(== 
var== 
part== !
in==" $
record==% +
.==+ ,,
 ContentTypePartDefinitionRecords==, L
)==L M
{>> 
builder?? 
.?? 
WithPart?? $
(??$ %
part??% )
.??) *
Name??* .
,??. /
part??0 4
.??4 5
PartName??5 =
,??= >
partBuilder??? J
=>??K M
partBuilder??N Y
.??Y Z
MergeSettings??Z g
(??g h
part??h l
.??l m
Settings??m u
)??u v
)??v w
;??w x
}@@ 
}AA 
)AA 
;AA 
}BB 	
privateDD 
voidDD 
UpdateContentPartDD &
(DD& '!
ContentPartDefinitionDD' <
partDD= A
,DDA B'
ContentPartDefinitionRecordDDC ^
recordDD_ e
)DDe f
{EE 	%
_contentDefinitionManagerFF %
.FF% &
AlterPartDefinitionFF& 9
(FF9 :
partFF: >
.FF> ?
NameFF? C
,FFC D
builderFFE L
=>FFM O
{GG 
builderHH 
.HH 
MergeSettingsHH %
(HH% &
recordHH& ,
.HH, -
SettingsHH- 5
)HH5 6
;HH6 7
foreachJJ 
(JJ 
varJJ 
fieldJJ "
inJJ# %
recordJJ& ,
.JJ, --
!ContentPartFieldDefinitionRecordsJJ- N
)JJN O
{KK 
builderLL 
.LL 
	WithFieldLL %
(LL% &
fieldLL& +
.LL+ ,
NameLL, 0
,LL0 1
fieldBuilderLL2 >
=>LL? A
{MM 
fieldBuilderNN $
.NN$ %
OfTypeNN% +
(NN+ ,
fieldNN, 1
.NN1 2
	FieldNameNN2 ;
)NN; <
;NN< =
fieldBuilderOO $
.OO$ %
MergeSettingsOO% 2
(OO2 3
fieldOO3 8
.OO8 9
SettingsOO9 A
)OOA B
;OOB C
}PP 
)PP 
;PP 
}QQ 
}RR 
)RR 
;RR 
}SS 	
privateUU 
classUU &
ContentDefinitionStepModelUU 0
{VV 	
publicWW '
ContentTypeDefinitionRecordWW .
[WW. /
]WW/ 0
ContentTypesWW1 =
{WW> ?
getWW@ C
;WWC D
setWWE H
;WWH I
}WWJ K
=WWL M
ArrayWWN S
.WWS T
EmptyWWT Y
<WWY Z'
ContentTypeDefinitionRecordWWZ u
>WWu v
(WWv w
)WWw x
;WWx y
publicXX '
ContentPartDefinitionRecordXX .
[XX. /
]XX/ 0
ContentPartsXX1 =
{XX> ?
getXX@ C
;XXC D
setXXE H
;XXH I
}XXJ K
=XXL M
ArrayXXN S
.XXS T
EmptyXXT Y
<XXY Z'
ContentPartDefinitionRecordXXZ u
>XXu v
(XXv w
)XXw x
;XXx y
}YY 	
}ZZ 
}[[ Ó
£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\RecipeSteps\DeleteContentDefinitionStep.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
RecipeSteps# .
{ 
public 

class '
DeleteContentDefinitionStep ,
:- .
IRecipeStepHandler/ A
{ 
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
public '
DeleteContentDefinitionStep *
(* +%
IContentDefinitionManager+ D$
contentDefinitionManagerE ]
)] ^
{ 	%
_contentDefinitionManager %
=& '$
contentDefinitionManager( @
;@ A
} 	
public 
Task 
ExecuteAsync  
(  !"
RecipeExecutionContext! 7
context8 ?
)? @
{ 	
if 
( 
! 
String 
. 
Equals 
( 
context &
.& '
Name' +
,+ ,
$str- F
,F G
StringComparisonH X
.X Y
OrdinalIgnoreCaseY j
)j k
)k l
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
var 
step 
= 
context 
. 
Step #
.# $
ToObject$ ,
<, -,
 DeleteContentDefinitionStepModel- M
>M N
(N O
)O P
;P Q
foreach 
( 
var 
contentType $
in% '
step( ,
., -
ContentTypes- 9
)9 :
{ %
_contentDefinitionManager!! )
.!!) * 
DeleteTypeDefinition!!* >
(!!> ?
contentType!!? J
)!!J K
;!!K L
}"" 
foreach$$ 
($$ 
var$$ 
contentPart$$ $
in$$% '
step$$( ,
.$$, -
ContentParts$$- 9
)$$9 :
{%% %
_contentDefinitionManager'' )
.'') * 
DeletePartDefinition''* >
(''> ?
contentPart''? J
)''J K
;''K L
}(( 
return** 
Task** 
.** 
CompletedTask** %
;**% &
}++ 	
private-- 
class-- ,
 DeleteContentDefinitionStepModel-- 6
{.. 	
public// 
string// 
[// 
]// 
ContentTypes// (
{//) *
get//+ .
;//. /
set//0 3
;//3 4
}//5 6
=//7 8
Array//9 >
.//> ?
Empty//? D
<//D E
string//E K
>//K L
(//L M
)//M N
;//N O
public00 
string00 
[00 
]00 
ContentParts00 (
{00) *
get00+ .
;00. /
set000 3
;003 4
}005 6
=007 8
Array009 >
.00> ?
Empty00? D
<00D E
string00E K
>00K L
(00L M
)00M N
;00N O
}11 	
}22 
}33 ß7
§D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\RecipeSteps\ReplaceContentDefinitionStep.cs
	namespace		 	
OrchardCore		
 
.		 
ContentTypes		 "
.		" #
RecipeSteps		# .
{

 
public 

class (
ReplaceContentDefinitionStep -
:. /
IRecipeStepHandler0 B
{ 
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
public (
ReplaceContentDefinitionStep +
(+ ,%
IContentDefinitionManager, E$
contentDefinitionManagerF ^
)^ _
{ 	%
_contentDefinitionManager %
=& '$
contentDefinitionManager( @
;@ A
} 	
public 
Task 
ExecuteAsync  
(  !"
RecipeExecutionContext! 7
context8 ?
)? @
{ 	
if 
( 
! 
String 
. 
Equals 
( 
context &
.& '
Name' +
,+ ,
$str- G
,G H
StringComparisonI Y
.Y Z
OrdinalIgnoreCaseZ k
)k l
)l m
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
var 
step 
= 
context 
. 
Step #
.# $
ToObject$ ,
<, --
!ReplaceContentDefinitionStepModel- N
>N O
(O P
)P Q
;Q R
foreach!! 
(!! 
var!! 
contentPart!! $
in!!% '
step!!( ,
.!!, -
ContentParts!!- 9
)!!9 :
{"" %
_contentDefinitionManager## )
.##) * 
DeletePartDefinition##* >
(##> ?
contentPart##? J
.##J K
Name##K O
)##O P
;##P Q
}$$ 
foreach&& 
(&& 
var&& 
contentType&& $
in&&% '
step&&( ,
.&&, -
ContentTypes&&- 9
)&&9 :
{'' %
_contentDefinitionManager(( )
.(() * 
DeleteTypeDefinition((* >
(((> ?
contentType((? J
.((J K
Name((K O
)((O P
;((P Q
AlterContentType))  
())  !
contentType))! ,
))), -
;))- .
}** 
foreach,, 
(,, 
var,, 
contentPart,, $
in,,% '
step,,( ,
.,,, -
ContentParts,,- 9
),,9 :
{-- 
AlterContentPart..  
(..  !
contentPart..! ,
).., -
;..- .
}// 
return11 
Task11 
.11 
CompletedTask11 %
;11% &
}22 	
private44 
void44 
AlterContentType44 %
(44% &'
ContentTypeDefinitionRecord44& A
record44B H
)44H I
{55 	%
_contentDefinitionManager66 %
.66% &
AlterTypeDefinition66& 9
(669 :
record66: @
.66@ A
Name66A E
,66E F
builder66G N
=>66O Q
{77 
if88 
(88 
!88 
String88 
.88 
IsNullOrEmpty88 )
(88) *
record88* 0
.880 1
DisplayName881 <
)88< =
)88= >
{99 
builder:: 
.:: 
DisplayedAs:: '
(::' (
record::( .
.::. /
DisplayName::/ :
)::: ;
;::; <
builder;; 
.;; 
MergeSettings;; )
(;;) *
record;;* 0
.;;0 1
Settings;;1 9
);;9 :
;;;: ;
}<< 
foreach>> 
(>> 
var>> 
part>> !
in>>" $
record>>% +
.>>+ ,,
 ContentTypePartDefinitionRecords>>, L
)>>L M
{?? 
builder@@ 
.@@ 
WithPart@@ $
(@@$ %
part@@% )
.@@) *
Name@@* .
,@@. /
part@@0 4
.@@4 5
PartName@@5 =
,@@= >
partBuilder@@? J
=>@@K M
partBuilder@@N Y
.@@Y Z
MergeSettings@@Z g
(@@g h
part@@h l
.@@l m
Settings@@m u
)@@u v
)@@v w
;@@w x
}AA 
}BB 
)BB 
;BB 
}CC 	
privateEE 
voidEE 
AlterContentPartEE %
(EE% &'
ContentPartDefinitionRecordEE& A
recordEEB H
)EEH I
{FF 	%
_contentDefinitionManagerGG %
.GG% &
AlterPartDefinitionGG& 9
(GG9 :
recordGG: @
.GG@ A
NameGGA E
,GGE F
builderGGG N
=>GGO Q
{HH 
builderII 
.II 
MergeSettingsII %
(II% &
recordII& ,
.II, -
SettingsII- 5
)II5 6
;II6 7
foreachKK 
(KK 
varKK 
fieldKK "
inKK# %
recordKK& ,
.KK, --
!ContentPartFieldDefinitionRecordsKK- N
)KKN O
{LL 
builderMM 
.MM 
	WithFieldMM %
(MM% &
fieldMM& +
.MM+ ,
NameMM, 0
,MM0 1
fieldBuilderMM2 >
=>MM? A
{NN 
fieldBuilderOO $
.OO$ %
OfTypeOO% +
(OO+ ,
fieldOO, 1
.OO1 2
	FieldNameOO2 ;
)OO; <
;OO< =
fieldBuilderPP $
.PP$ %
MergeSettingsPP% 2
(PP2 3
fieldPP3 8
.PP8 9
SettingsPP9 A
)PPA B
;PPB C
}QQ 
)QQ 
;QQ 
}RR 
}SS 
)SS 
;SS 
}TT 	
privateVV 
classVV -
!ReplaceContentDefinitionStepModelVV 7
{WW 	
publicXX '
ContentTypeDefinitionRecordXX .
[XX. /
]XX/ 0
ContentTypesXX1 =
{XX> ?
getXX@ C
;XXC D
setXXE H
;XXH I
}XXJ K
=XXL M
ArrayXXN S
.XXS T
EmptyXXT Y
<XXY Z'
ContentTypeDefinitionRecordXXZ u
>XXu v
(XXv w
)XXw x
;XXx y
publicYY '
ContentPartDefinitionRecordYY .
[YY. /
]YY/ 0
ContentPartsYY1 =
{YY> ?
getYY@ C
;YYC D
setYYE H
;YYH I
}YYJ K
=YYL M
ArrayYYN S
.YYS T
EmptyYYT Y
<YYY Z'
ContentPartDefinitionRecordYYZ u
>YYu v
(YYv w
)YYw x
;YYx y
}ZZ 	
}[[ 
}\\ Éò
ùD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Services\ContentDefinitionService.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Services# +
{ 
public 

class $
ContentDefinitionService )
:* +%
IContentDefinitionService, E
{ 
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
private 
readonly 
IEnumerable $
<$ %*
IContentDefinitionEventHandler% C
>C D+
_contentDefinitionEventHandlersE d
;d e
private 
readonly 
IEnumerable $
<$ %
Type% )
>) *
_contentPartTypes+ <
;< =
private 
readonly 
IEnumerable $
<$ %
Type% )
>) *
_contentFieldTypes+ =
;= >
private 
readonly 
IStringLocalizer )
S* +
;+ ,
private 
readonly 
ILogger  
_logger! (
;( )
public $
ContentDefinitionService '
(' (%
IContentDefinitionManager )$
contentDefinitionManager* B
,B C
IEnumerable 
< *
IContentDefinitionEventHandler :
>: ;*
contentDefinitionEventHandlers< Z
,Z [
IEnumerable 
< 
ContentPart '
>' (
contentParts) 5
,5 6
IEnumerable 
< 
ContentField (
>( )
contentFields* 7
,7 8
IOptions   
<   
ContentOptions   '
>  ' (
contentOptions  ) 7
,  7 8
ILogger!! 
<!! %
IContentDefinitionService!! 1
>!!1 2
logger!!3 9
,!!9 :
IStringLocalizer""  
<""  !$
ContentDefinitionService""! 9
>""9 :
	localizer""; D
)""D E
{## 	%
_contentDefinitionManager$$ %
=$$& '$
contentDefinitionManager$$( @
;$$@ A+
_contentDefinitionEventHandlers%% +
=%%, -*
contentDefinitionEventHandlers%%. L
;%%L M
foreach'' 
('' 
var'' 
element''  
in''! #
contentParts''$ 0
.''0 1
Select''1 7
(''7 8
x''8 9
=>'': <
x''= >
.''> ?
GetType''? F
(''F G
)''G H
)''H I
)''I J
{(( 
logger)) 
.)) 

LogWarning)) !
())! "
$str	))" Ç
,
))Ç É
element
))Ñ ã
)
))ã å
;
))å ç
}** 
foreach,, 
(,, 
var,, 
element,,  
in,,! #
contentFields,,$ 1
.,,1 2
Select,,2 8
(,,8 9
x,,9 :
=>,,; =
x,,> ?
.,,? @
GetType,,@ G
(,,G H
),,H I
),,I J
),,J K
{-- 
logger.. 
... 

LogWarning.. !
(..! "
$str	.." Ö
,
..Ö Ü
element
..á é
)
..é è
;
..è ê
}// 
_contentPartTypes22 
=22 
contentParts22  ,
.22, -
Select22- 3
(223 4
cp224 6
=>227 9
cp22: <
.22< =
GetType22= D
(22D E
)22E F
)22F G
.33 
Union33 
(33 
contentOptions33 %
.33% &
Value33& +
.33+ ,
ContentPartOptions33, >
.33> ?
Select33? E
(33E F
cpo33F I
=>33J L
cpo33M P
.33P Q
Type33Q U
)33U V
)33V W
;33W X
_contentFieldTypes66 
=66  
contentFields66! .
.66. /
Select66/ 5
(665 6
cf666 8
=>669 ;
cf66< >
.66> ?
GetType66? F
(66F G
)66G H
)66H I
.77 
Union77 
(77 
contentOptions77 %
.77% &
Value77& +
.77+ ,
ContentFieldOptions77, ?
.77? @
Select77@ F
(77F G
cfo77G J
=>77K M
cfo77N Q
.77Q R
Type77R V
)77V W
)77W X
;77X Y
_logger99 
=99 
logger99 
;99 
S:: 
=:: 
	localizer:: 
;:: 
};; 	
public== 
IEnumerable== 
<== 
EditTypeViewModel== ,
>==, -
	LoadTypes==. 7
(==7 8
)==8 9
{>> 	
return?? %
_contentDefinitionManager?? ,
.@@ 
LoadTypeDefinitions@@ $
(@@$ %
)@@% &
.AA 
SelectAA 
(AA 
ctdAA 
=>AA 
newAA "
EditTypeViewModelAA# 4
(AA4 5
ctdAA5 8
)AA8 9
)AA9 :
.BB 
OrderByBB 
(BB 
mBB 
=>BB 
mBB 
.BB  
DisplayNameBB  +
)BB+ ,
;BB, -
}CC 	
publicEE 
IEnumerableEE 
<EE 
EditTypeViewModelEE ,
>EE, -
GetTypesEE. 6
(EE6 7
)EE7 8
{FF 	
returnGG %
_contentDefinitionManagerGG ,
.HH 
ListTypeDefinitionsHH $
(HH$ %
)HH% &
.II 
SelectII 
(II 
ctdII 
=>II 
newII "
EditTypeViewModelII# 4
(II4 5
ctdII5 8
)II8 9
)II9 :
.JJ 
OrderByJJ 
(JJ 
mJJ 
=>JJ 
mJJ 
.JJ  
DisplayNameJJ  +
)JJ+ ,
;JJ, -
}KK 	
publicMM 
EditTypeViewModelMM  
LoadTypeMM! )
(MM) *
stringMM* 0
nameMM1 5
)MM5 6
{NN 	
varOO !
contentTypeDefinitionOO %
=OO& '%
_contentDefinitionManagerOO( A
.OOA B
LoadTypeDefinitionOOB T
(OOT U
nameOOU Y
)OOY Z
;OOZ [
ifQQ 
(QQ !
contentTypeDefinitionQQ %
==QQ& (
nullQQ) -
)QQ- .
{RR 
returnSS 
nullSS 
;SS 
}TT 
returnVV 
newVV 
EditTypeViewModelVV (
(VV( )!
contentTypeDefinitionVV) >
)VV> ?
;VV? @
}WW 	
publicYY 
EditTypeViewModelYY  
GetTypeYY! (
(YY( )
stringYY) /
nameYY0 4
)YY4 5
{ZZ 	
var[[ !
contentTypeDefinition[[ %
=[[& '%
_contentDefinitionManager[[( A
.[[A B
GetTypeDefinition[[B S
([[S T
name[[T X
)[[X Y
;[[Y Z
if]] 
(]] !
contentTypeDefinition]] %
==]]& (
null]]) -
)]]- .
{^^ 
return__ 
null__ 
;__ 
}`` 
returnbb 
newbb 
EditTypeViewModelbb (
(bb( )!
contentTypeDefinitionbb) >
)bb> ?
;bb? @
}cc 	
publicee !
ContentTypeDefinitionee $
AddTypeee% ,
(ee, -
stringee- 3
nameee4 8
,ee8 9
stringee: @
displayNameeeA L
)eeL M
{ff 	
ifgg 
(gg 
Stringgg 
.gg 
IsNullOrWhiteSpacegg )
(gg) *
displayNamegg* 5
)gg5 6
)gg6 7
{hh 
throwii 
newii 
ArgumentExceptionii +
(ii+ ,
nameofii, 2
(ii2 3
displayNameii3 >
)ii> ?
)ii? @
;ii@ A
}jj 
ifll 
(ll 
Stringll 
.ll 
IsNullOrWhiteSpacell )
(ll) *
namell* .
)ll. /
)ll/ 0
{mm 
namenn 
=nn 2
&GenerateContentTypeNameFromDisplayNamenn =
(nn= >
displayNamenn> I
)nnI J
;nnJ K
}oo 
elsepp 
{qq 
ifrr 
(rr 
!rr 
namerr 
[rr 
$numrr 
]rr 
.rr 
IsLetterrr %
(rr% &
)rr& '
)rr' (
{ss 
throwtt 
newtt 
ArgumentExceptiontt /
(tt/ 0
$strtt0 \
,tt\ ]
$strtt^ d
)ttd e
;tte f
}uu 
ifvv 
(vv 
!vv 
Stringvv 
.vv 
Equalsvv "
(vv" #
namevv# '
,vv' (
namevv) -
.vv- .

ToSafeNamevv. 8
(vv8 9
)vv9 :
,vv: ;
StringComparisonvv< L
.vvL M
OrdinalIgnoreCasevvM ^
)vv^ _
)vv_ `
{ww 
throwxx 
newxx 
ArgumentExceptionxx /
(xx/ 0
$strxx0 _
,xx_ `
$strxxa g
)xxg h
;xxh i
}yy 
}zz 
while|| 
(|| %
_contentDefinitionManager|| ,
.||, -
LoadTypeDefinition||- ?
(||? @
name||@ D
)||D E
!=||F H
null||I M
)||M N
{}} 
name~~ 
=~~ 
VersionName~~ "
(~~" #
name~~# '
)~~' (
;~~( )
} 
var
ÅÅ #
contentTypeDefinition
ÅÅ %
=
ÅÅ& '
new
ÅÅ( +#
ContentTypeDefinition
ÅÅ, A
(
ÅÅA B
name
ÅÅB F
,
ÅÅF G
displayName
ÅÅH S
)
ÅÅS T
;
ÅÅT U'
_contentDefinitionManager
ÉÉ %
.
ÉÉ% &!
StoreTypeDefinition
ÉÉ& 9
(
ÉÉ9 :#
contentTypeDefinition
ÉÉ: O
)
ÉÉO P
;
ÉÉP Q'
_contentDefinitionManager
ÖÖ %
.
ÖÖ% &!
AlterTypeDefinition
ÖÖ& 9
(
ÖÖ9 :
name
ÖÖ: >
,
ÖÖ> ?
builder
ÖÖ@ G
=>
ÖÖH J
builder
ÖÖK R
.
ÖÖR S
WithPart
ÖÖS [
(
ÖÖ[ \
name
ÖÖ\ `
)
ÖÖ` a
)
ÖÖa b
;
ÖÖb c'
_contentDefinitionManager
ÜÜ %
.
ÜÜ% &!
AlterTypeDefinition
ÜÜ& 9
(
ÜÜ9 :
name
ÜÜ: >
,
ÜÜ> ?
cfg
ÜÜ@ C
=>
ÜÜD F
cfg
ÜÜG J
.
ÜÜJ K
	Creatable
ÜÜK T
(
ÜÜT U
)
ÜÜU V
.
ÜÜV W
	Draftable
ÜÜW `
(
ÜÜ` a
)
ÜÜa b
.
ÜÜb c
Versionable
ÜÜc n
(
ÜÜn o
)
ÜÜo p
.
ÜÜp q
Listable
ÜÜq y
(
ÜÜy z
)
ÜÜz {
.
ÜÜ{ |
	SecurableÜÜ| Ö
(ÜÜÖ Ü
)ÜÜÜ á
)ÜÜá à
;ÜÜà â-
_contentDefinitionEventHandlers
àà +
.
àà+ ,
Invoke
àà, 2
(
àà2 3
(
àà3 4
handler
àà4 ;
,
àà; <
context
àà= D
)
ààD E
=>
ààF H
handler
ààI P
.
ààP Q 
ContentTypeCreated
ààQ c
(
ààc d
context
ààd k
)
ààk l
,
ààl m
new
ààn q(
ContentTypeCreatedContextààr ã
{ààå ç%
ContentTypeDefinitionààé £
=àà§ •%
contentTypeDefinitionàà¶ ª
}ààº Ω
,ààΩ æ
_loggerààø ∆
)àà∆ «
;àà« »
return
ää #
contentTypeDefinition
ää (
;
ää( )
}
ãã 	
public
çç 
void
çç 

RemoveType
çç 
(
çç 
string
çç %
name
çç& *
,
çç* +
bool
çç, 0
deleteContent
çç1 >
)
çç> ?
{
éé 	
var
êê 
typeDefinition
êê 
=
êê  '
_contentDefinitionManager
êê! :
.
êê: ; 
LoadTypeDefinition
êê; M
(
êêM N
name
êêN R
)
êêR S
;
êêS T
var
ëë 
partDefinitions
ëë 
=
ëë  !
typeDefinition
ëë" 0
.
ëë0 1
Parts
ëë1 6
.
ëë6 7
ToArray
ëë7 >
(
ëë> ?
)
ëë? @
;
ëë@ A
foreach
íí 
(
íí 
var
íí 
partDefinition
íí '
in
íí( *
partDefinitions
íí+ :
)
íí: ;
{
ìì  
RemovePartFromType
îî "
(
îî" #
partDefinition
îî# 1
.
îî1 2
PartDefinition
îî2 @
.
îî@ A
Name
îîA E
,
îîE F
name
îîG K
)
îîK L
;
îîL M
if
óó 
(
óó 
partDefinition
óó "
.
óó" #
PartDefinition
óó# 1
.
óó1 2
Name
óó2 6
==
óó7 9
name
óó: >
)
óó> ?
{
òò 

RemovePart
ôô 
(
ôô 
name
ôô #
)
ôô# $
;
ôô$ %
}
öö 
}
õõ '
_contentDefinitionManager
ùù %
.
ùù% &"
DeleteTypeDefinition
ùù& :
(
ùù: ;
name
ùù; ?
)
ùù? @
;
ùù@ A-
_contentDefinitionEventHandlers
üü +
.
üü+ ,
Invoke
üü, 2
(
üü2 3
(
üü3 4
handler
üü4 ;
,
üü; <
context
üü= D
)
üüD E
=>
üüF H
handler
üüI P
.
üüP Q 
ContentTypeRemoved
üüQ c
(
üüc d
context
üüd k
)
üük l
,
üül m
new
üün q(
ContentTypeRemovedContextüür ã
{üüå ç%
ContentTypeDefinitionüüé £
=üü§ •
typeDefinitionüü¶ ¥
}üüµ ∂
,üü∂ ∑
_loggerüü∏ ø
)üüø ¿
;üü¿ ¡
}
†† 	
public
¢¢ 
void
¢¢ 
AddPartToType
¢¢ !
(
¢¢! "
string
¢¢" (
partName
¢¢) 1
,
¢¢1 2
string
¢¢3 9
typeName
¢¢: B
)
¢¢B C
{
££ 	'
_contentDefinitionManager
§§ %
.
§§% &!
AlterTypeDefinition
§§& 9
(
§§9 :
typeName
§§: B
,
§§B C
typeBuilder
§§D O
=>
§§P R
typeBuilder
§§S ^
.
§§^ _
WithPart
§§_ g
(
§§g h
partName
§§h p
)
§§p q
)
§§q r
;
§§r s-
_contentDefinitionEventHandlers
•• +
.
••+ ,
Invoke
••, 2
(
••2 3
(
••3 4
handler
••4 ;
,
••; <
context
••= D
)
••D E
=>
••F H
handler
••I P
.
••P Q!
ContentPartAttached
••Q d
(
••d e
context
••e l
)
••l m
,
••m n
new
••o r)
ContentPartAttachedContext••s ç
{••é è
ContentTypeName••ê ü
=••† °
typeName••¢ ™
,••™ ´
ContentPartName••¨ ª
=••º Ω
partName••æ ∆
}••« »
,••» …
_logger••  —
)••— “
;••“ ”
}
¶¶ 	
public
®® 
void
®® #
AddReusablePartToType
®® )
(
®®) *
string
®®* 0
name
®®1 5
,
®®5 6
string
®®7 =
displayName
®®> I
,
®®I J
string
®®K Q
description
®®R ]
,
®®] ^
string
®®_ e
partName
®®f n
,
®®n o
string
®®p v
typeName
®®w 
)®® Ä
{
©© 	'
_contentDefinitionManager
™™ %
.
™™% &!
AlterTypeDefinition
™™& 9
(
™™9 :
typeName
™™: B
,
™™B C
typeBuilder
™™D O
=>
™™P R
typeBuilder
™™S ^
.
™™^ _
WithPart
™™_ g
(
™™g h
name
™™h l
,
™™l m
partName
™™n v
,
™™v w
cfg
™™x {
=>
™™| ~
{
´´ 
cfg
¨¨ 
.
¨¨ 
WithDisplayName
¨¨ #
(
¨¨# $
displayName
¨¨$ /
)
¨¨/ 0
;
¨¨0 1
cfg
≠≠ 
.
≠≠ 
WithDescription
≠≠ #
(
≠≠# $
description
≠≠$ /
)
≠≠/ 0
;
≠≠0 1
}
ÆÆ 
)
ÆÆ 
)
ÆÆ 
;
ÆÆ -
_contentDefinitionEventHandlers
∞∞ +
.
∞∞+ ,
Invoke
∞∞, 2
(
∞∞2 3
(
∞∞3 4
handler
∞∞4 ;
,
∞∞; <
context
∞∞= D
)
∞∞D E
=>
∞∞F H
handler
∞∞I P
.
∞∞P Q!
ContentPartAttached
∞∞Q d
(
∞∞d e
context
∞∞e l
)
∞∞l m
,
∞∞m n
new
∞∞o r)
ContentPartAttachedContext∞∞s ç
{∞∞é è
ContentTypeName∞∞ê ü
=∞∞† °
typeName∞∞¢ ™
,∞∞™ ´
ContentPartName∞∞¨ ª
=∞∞º Ω
partName∞∞æ ∆
}∞∞« »
,∞∞» …
_logger∞∞  —
)∞∞— “
;∞∞“ ”
}
±± 	
public
≥≥ 
void
≥≥  
RemovePartFromType
≥≥ &
(
≥≥& '
string
≥≥' -
partName
≥≥. 6
,
≥≥6 7
string
≥≥8 >
typeName
≥≥? G
)
≥≥G H
{
¥¥ 	'
_contentDefinitionManager
µµ %
.
µµ% &!
AlterTypeDefinition
µµ& 9
(
µµ9 :
typeName
µµ: B
,
µµB C
typeBuilder
µµD O
=>
µµP R
typeBuilder
µµS ^
.
µµ^ _

RemovePart
µµ_ i
(
µµi j
partName
µµj r
)
µµr s
)
µµs t
;
µµt u-
_contentDefinitionEventHandlers
∂∂ +
.
∂∂+ ,
Invoke
∂∂, 2
(
∂∂2 3
(
∂∂3 4
handler
∂∂4 ;
,
∂∂; <
context
∂∂= D
)
∂∂D E
=>
∂∂F H
handler
∂∂I P
.
∂∂P Q!
ContentPartDetached
∂∂Q d
(
∂∂d e
context
∂∂e l
)
∂∂l m
,
∂∂m n
new
∂∂o r)
ContentPartDetachedContext∂∂s ç
{∂∂é è
ContentTypeName∂∂ê ü
=∂∂† °
typeName∂∂¢ ™
,∂∂™ ´
ContentPartName∂∂¨ ª
=∂∂º Ω
partName∂∂æ ∆
}∂∂« »
,∂∂» …
_logger∂∂  —
)∂∂— “
;∂∂“ ”
}
∑∑ 	
public
ππ 
IEnumerable
ππ 
<
ππ 
EditPartViewModel
ππ ,
>
ππ, -
	LoadParts
ππ. 7
(
ππ7 8
bool
ππ8 <
metadataPartsOnly
ππ= N
)
ππN O
{
∫∫ 	
var
ªª 
	typeNames
ªª 
=
ªª 
new
ªª 
HashSet
ªª  '
<
ªª' (
string
ªª( .
>
ªª. /
(
ªª/ 0
	LoadTypes
ªª0 9
(
ªª9 :
)
ªª: ;
.
ªª; <
Select
ªª< B
(
ªªB C
ctd
ªªC F
=>
ªªG I
ctd
ªªJ M
.
ªªM N
Name
ªªN R
)
ªªR S
)
ªªS T
;
ªªT U
var
øø 
userContentParts
øø  
=
øø! "'
_contentDefinitionManager
øø# <
.
øø< =!
LoadPartDefinitions
øø= P
(
øøP Q
)
øøQ R
.
¿¿ 
Where
¿¿ 
(
¿¿ 
cpd
¿¿ 
=>
¿¿ 
!
¿¿ 
	typeNames
¿¿ (
.
¿¿( )
Contains
¿¿) 1
(
¿¿1 2
cpd
¿¿2 5
.
¿¿5 6
Name
¿¿6 :
)
¿¿: ;
)
¿¿; <
.
¡¡ 
Select
¡¡ 
(
¡¡ 
cpd
¡¡ 
=>
¡¡ 
new
¡¡ "
EditPartViewModel
¡¡# 4
(
¡¡4 5
cpd
¡¡5 8
)
¡¡8 9
)
¡¡9 :
.
¬¬ 
ToDictionary
¬¬ 
(
¬¬ 
k
√√ 
=>
√√ 
k
√√ 
.
√√ 
Name
√√ 
,
√√  
v
ƒƒ 
=>
ƒƒ 
v
ƒƒ 
)
ƒƒ 
;
ƒƒ 
var
«« 
codeDefinedParts
««  
=
««! "
metadataPartsOnly
««# 4
?
»» 

Enumerable
»» 
.
»» 
Empty
»» "
<
»»" #
EditPartViewModel
»»# 4
>
»»4 5
(
»»5 6
)
»»6 7
:
…… 
_contentPartTypes
…… #
.
   
Where
   
(
   
cpd
   "
=>
  # %
!
  & '
userContentParts
  ' 7
.
  7 8
ContainsKey
  8 C
(
  C D
cpd
  D G
.
  G H
Name
  H L
)
  L M
)
  M N
.
ÀÀ 
Select
ÀÀ 
(
ÀÀ  
cpi
ÀÀ  #
=>
ÀÀ$ &
new
ÀÀ' *
EditPartViewModel
ÀÀ+ <
{
ÀÀ= >
Name
ÀÀ? C
=
ÀÀD E
cpi
ÀÀF I
.
ÀÀI J
Name
ÀÀJ N
,
ÀÀN O
DisplayName
ÀÀP [
=
ÀÀ\ ]
cpi
ÀÀ^ a
.
ÀÀa b
Name
ÀÀb f
}
ÀÀg h
)
ÀÀh i
.
ÃÃ 
ToList
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ 
return
œœ 
codeDefinedParts
œœ #
.
–– 
Union
–– 
(
–– 
userContentParts
–– '
.
––' (
Values
––( .
)
––. /
.
—— 
OrderBy
—— 
(
—— 
m
—— 
=>
—— 
m
—— 
.
——  
DisplayName
——  +
)
——+ ,
;
——, -
}
““ 	
public
‘‘ 
IEnumerable
‘‘ 
<
‘‘ 
EditPartViewModel
‘‘ ,
>
‘‘, -
GetParts
‘‘. 6
(
‘‘6 7
bool
‘‘7 ;
metadataPartsOnly
‘‘< M
)
‘‘M N
{
’’ 	
var
÷÷ 
	typeNames
÷÷ 
=
÷÷ 
new
÷÷ 
HashSet
÷÷  '
<
÷÷' (
string
÷÷( .
>
÷÷. /
(
÷÷/ 0
GetTypes
÷÷0 8
(
÷÷8 9
)
÷÷9 :
.
÷÷: ;
Select
÷÷; A
(
÷÷A B
ctd
÷÷B E
=>
÷÷F H
ctd
÷÷I L
.
÷÷L M
Name
÷÷M Q
)
÷÷Q R
)
÷÷R S
;
÷÷S T
var
⁄⁄ 
userContentParts
⁄⁄  
=
⁄⁄! "'
_contentDefinitionManager
⁄⁄# <
.
⁄⁄< =!
ListPartDefinitions
⁄⁄= P
(
⁄⁄P Q
)
⁄⁄Q R
.
€€ 
Where
€€ 
(
€€ 
cpd
€€ 
=>
€€ 
!
€€ 
	typeNames
€€ (
.
€€( )
Contains
€€) 1
(
€€1 2
cpd
€€2 5
.
€€5 6
Name
€€6 :
)
€€: ;
)
€€; <
.
‹‹ 
Select
‹‹ 
(
‹‹ 
cpd
‹‹ 
=>
‹‹ 
new
‹‹ "
EditPartViewModel
‹‹# 4
(
‹‹4 5
cpd
‹‹5 8
)
‹‹8 9
)
‹‹9 :
.
›› 
ToDictionary
›› 
(
›› 
k
ﬁﬁ 
=>
ﬁﬁ 
k
ﬁﬁ 
.
ﬁﬁ 
Name
ﬁﬁ 
,
ﬁﬁ  
v
ﬂﬂ 
=>
ﬂﬂ 
v
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
var
‚‚ 
codeDefinedParts
‚‚  
=
‚‚! "
metadataPartsOnly
‚‚# 4
?
„„ 

Enumerable
„„ 
.
„„ 
Empty
„„ "
<
„„" #
EditPartViewModel
„„# 4
>
„„4 5
(
„„5 6
)
„„6 7
:
‰‰ 
_contentPartTypes
‰‰ #
.
ÂÂ 
Where
ÂÂ 
(
ÂÂ 
cpd
ÂÂ "
=>
ÂÂ# %
!
ÂÂ& '
userContentParts
ÂÂ' 7
.
ÂÂ7 8
ContainsKey
ÂÂ8 C
(
ÂÂC D
cpd
ÂÂD G
.
ÂÂG H
Name
ÂÂH L
)
ÂÂL M
)
ÂÂM N
.
ÊÊ 
Select
ÊÊ 
(
ÊÊ  
cpi
ÊÊ  #
=>
ÊÊ$ &
new
ÊÊ' *
EditPartViewModel
ÊÊ+ <
{
ÊÊ= >
Name
ÊÊ? C
=
ÊÊD E
cpi
ÊÊF I
.
ÊÊI J
Name
ÊÊJ N
,
ÊÊN O
DisplayName
ÊÊP [
=
ÊÊ\ ]
cpi
ÊÊ^ a
.
ÊÊa b
Name
ÊÊb f
}
ÊÊg h
)
ÊÊh i
.
ÁÁ 
ToList
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ 
return
ÍÍ 
codeDefinedParts
ÍÍ #
.
ÎÎ 
Union
ÎÎ 
(
ÎÎ 
userContentParts
ÎÎ '
.
ÎÎ' (
Values
ÎÎ( .
)
ÎÎ. /
.
ÏÏ 
OrderBy
ÏÏ 
(
ÏÏ 
m
ÏÏ 
=>
ÏÏ 
m
ÏÏ 
.
ÏÏ  
DisplayName
ÏÏ  +
)
ÏÏ+ ,
;
ÏÏ, -
}
ÌÌ 	
public
ÔÔ 
EditPartViewModel
ÔÔ  
LoadPart
ÔÔ! )
(
ÔÔ) *
string
ÔÔ* 0
name
ÔÔ1 5
)
ÔÔ5 6
{
 	
var
ÒÒ #
contentPartDefinition
ÒÒ %
=
ÒÒ& ''
_contentDefinitionManager
ÒÒ( A
.
ÒÒA B 
LoadPartDefinition
ÒÒB T
(
ÒÒT U
name
ÒÒU Y
)
ÒÒY Z
;
ÒÒZ [
if
ÛÛ 
(
ÛÛ #
contentPartDefinition
ÛÛ %
==
ÛÛ& (
null
ÛÛ) -
)
ÛÛ- .
{
ÙÙ 
var
ıı #
contentTypeDefinition
ıı )
=
ıı* +'
_contentDefinitionManager
ıı, E
.
ııE F 
LoadTypeDefinition
ııF X
(
ııX Y
name
ııY ]
)
ıı] ^
;
ıı^ _
if
˜˜ 
(
˜˜ #
contentTypeDefinition
˜˜ )
==
˜˜* ,
null
˜˜- 1
)
˜˜1 2
{
¯¯ 
return
˘˘ 
null
˘˘ 
;
˘˘  
}
˙˙ #
contentPartDefinition
¸¸ %
=
¸¸& '
new
¸¸( +#
ContentPartDefinition
¸¸, A
(
¸¸A B
name
¸¸B F
)
¸¸F G
;
¸¸G H
}
˝˝ 
var
ˇˇ 
	viewModel
ˇˇ 
=
ˇˇ 
new
ˇˇ 
EditPartViewModel
ˇˇ  1
(
ˇˇ1 2#
contentPartDefinition
ˇˇ2 G
)
ˇˇG H
;
ˇˇH I
return
ÅÅ 
	viewModel
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
EditPartViewModel
ÑÑ  
GetPart
ÑÑ! (
(
ÑÑ( )
string
ÑÑ) /
name
ÑÑ0 4
)
ÑÑ4 5
{
ÖÖ 	
var
ÜÜ #
contentPartDefinition
ÜÜ %
=
ÜÜ& ''
_contentDefinitionManager
ÜÜ( A
.
ÜÜA B
GetPartDefinition
ÜÜB S
(
ÜÜS T
name
ÜÜT X
)
ÜÜX Y
;
ÜÜY Z
if
àà 
(
àà #
contentPartDefinition
àà %
==
àà& (
null
àà) -
)
àà- .
{
ââ 
var
ää #
contentTypeDefinition
ää )
=
ää* +'
_contentDefinitionManager
ää, E
.
ääE F
GetTypeDefinition
ääF W
(
ääW X
name
ääX \
)
ää\ ]
;
ää] ^
if
åå 
(
åå #
contentTypeDefinition
åå )
==
åå* ,
null
åå- 1
)
åå1 2
{
çç 
return
éé 
null
éé 
;
éé  
}
èè #
contentPartDefinition
ëë %
=
ëë& '
new
ëë( +#
ContentPartDefinition
ëë, A
(
ëëA B
name
ëëB F
)
ëëF G
;
ëëG H
}
íí 
var
îî 
	viewModel
îî 
=
îî 
new
îî 
EditPartViewModel
îî  1
(
îî1 2#
contentPartDefinition
îî2 G
)
îîG H
;
îîH I
return
ññ 
	viewModel
ññ 
;
ññ 
}
óó 	
public
ôô 
EditPartViewModel
ôô  
AddPart
ôô! (
(
ôô( )!
CreatePartViewModel
ôô) <
partViewModel
ôô= J
)
ôôJ K
{
öö 	
var
õõ 
name
õõ 
=
õõ 
partViewModel
õõ $
.
õõ$ %
Name
õõ% )
;
õõ) *
if
ùù 
(
ùù '
_contentDefinitionManager
ùù )
.
ùù) * 
LoadPartDefinition
ùù* <
(
ùù< =
name
ùù= A
)
ùùA B
!=
ùùC E
null
ùùF J
)
ùùJ K
throw
ûû 
new
ûû 
	Exception
ûû #
(
ûû# $
S
ûû$ %
[
ûû% &
$str
ûû& W
,
ûûW X
name
ûûY ]
]
ûû] ^
)
ûû^ _
;
ûû_ `
if
†† 
(
†† 
!
†† 
string
†† 
.
†† 
IsNullOrEmpty
†† %
(
††% &
name
††& *
)
††* +
)
††+ ,
{
°° '
_contentDefinitionManager
¢¢ )
.
¢¢) *!
AlterPartDefinition
¢¢* =
(
¢¢= >
name
¢¢> B
,
¢¢B C
builder
¢¢D K
=>
¢¢L N
builder
¢¢O V
.
¢¢V W

Attachable
¢¢W a
(
¢¢a b
)
¢¢b c
)
¢¢c d
;
¢¢d e
var
££ 
partDefinition
££ "
=
££# $'
_contentDefinitionManager
££% >
.
££> ? 
LoadPartDefinition
££? Q
(
££Q R
name
££R V
)
££V W
;
££W X-
_contentDefinitionEventHandlers
§§ /
.
§§/ 0
Invoke
§§0 6
(
§§6 7
(
§§7 8
handler
§§8 ?
,
§§? @
context
§§A H
)
§§H I
=>
§§J L
handler
§§M T
.
§§T U 
ContentPartCreated
§§U g
(
§§g h
context
§§h o
)
§§o p
,
§§p q
new
§§r u(
ContentPartCreatedContext§§v è
{§§ê ë%
ContentPartDefinition§§í ß
=§§® ©
partDefinition§§™ ∏
}§§π ∫
,§§∫ ª
_logger§§º √
)§§√ ƒ
;§§ƒ ≈
return
•• 
new
•• 
EditPartViewModel
•• ,
(
••, -
partDefinition
••- ;
)
••; <
;
••< =
}
¶¶ 
return
®® 
null
®® 
;
®® 
}
©© 	
public
´´ 
void
´´ 

RemovePart
´´ 
(
´´ 
string
´´ %
name
´´& *
)
´´* +
{
¨¨ 	
var
≠≠ 
partDefinition
≠≠ 
=
≠≠  '
_contentDefinitionManager
≠≠! :
.
≠≠: ; 
LoadPartDefinition
≠≠; M
(
≠≠M N
name
≠≠N R
)
≠≠R S
;
≠≠S T
if
ØØ 
(
ØØ 
partDefinition
ØØ 
==
ØØ !
null
ØØ" &
)
ØØ& '
{
∞∞ 
return
≤≤ 
;
≤≤ 
}
≥≥ 
var
µµ 
fieldDefinitions
µµ  
=
µµ! "
partDefinition
µµ# 1
.
µµ1 2
Fields
µµ2 8
.
µµ8 9
ToArray
µµ9 @
(
µµ@ A
)
µµA B
;
µµB C
foreach
∂∂ 
(
∂∂ 
var
∂∂ 
fieldDefinition
∂∂ (
in
∂∂) +
fieldDefinitions
∂∂, <
)
∂∂< =
{
∑∑ !
RemoveFieldFromPart
∏∏ #
(
∏∏# $
fieldDefinition
∏∏$ 3
.
∏∏3 4
Name
∏∏4 8
,
∏∏8 9
name
∏∏: >
)
∏∏> ?
;
∏∏? @
}
ππ '
_contentDefinitionManager
ªª %
.
ªª% &"
DeletePartDefinition
ªª& :
(
ªª: ;
name
ªª; ?
)
ªª? @
;
ªª@ A-
_contentDefinitionEventHandlers
ºº +
.
ºº+ ,
Invoke
ºº, 2
(
ºº2 3
(
ºº3 4
handler
ºº4 ;
,
ºº; <
context
ºº= D
)
ººD E
=>
ººF H
handler
ººI P
.
ººP Q 
ContentPartRemoved
ººQ c
(
ººc d
context
ººd k
)
ººk l
,
ººl m
new
ººn q(
ContentPartRemovedContextººr ã
{ººå ç%
ContentPartDefinitionººé £
=ºº§ •
partDefinitionºº¶ ¥
}ººµ ∂
,ºº∂ ∑
_loggerºº∏ ø
)ººø ¿
;ºº¿ ¡
}
ΩΩ 	
public
øø 
IEnumerable
øø 
<
øø 
Type
øø 
>
øø  
	GetFields
øø! *
(
øø* +
)
øø+ ,
{
¿¿ 	
return
¡¡  
_contentFieldTypes
¡¡ %
;
¡¡% &
}
¬¬ 	
public
ƒƒ 
void
ƒƒ 
AddFieldToPart
ƒƒ "
(
ƒƒ" #
string
ƒƒ# )
	fieldName
ƒƒ* 3
,
ƒƒ3 4
string
ƒƒ5 ;
fieldTypeName
ƒƒ< I
,
ƒƒI J
string
ƒƒK Q
partName
ƒƒR Z
)
ƒƒZ [
{
≈≈ 	
AddFieldToPart
∆∆ 
(
∆∆ 
	fieldName
∆∆ $
,
∆∆$ %
	fieldName
∆∆& /
,
∆∆/ 0
fieldTypeName
∆∆1 >
,
∆∆> ?
partName
∆∆@ H
)
∆∆H I
;
∆∆I J
}
«« 	
public
…… 
void
…… 
AddFieldToPart
…… "
(
……" #
string
……# )
	fieldName
……* 3
,
……3 4
string
……5 ;
displayName
……< G
,
……G H
string
……I O
fieldTypeName
……P ]
,
……] ^
string
……_ e
partName
……f n
)
……n o
{
   	
if
ÀÀ 
(
ÀÀ 
String
ÀÀ 
.
ÀÀ 
IsNullOrEmpty
ÀÀ $
(
ÀÀ$ %
	fieldName
ÀÀ% .
)
ÀÀ. /
)
ÀÀ/ 0
{
ÃÃ 
throw
ÕÕ 
new
ÕÕ 
ArgumentException
ÕÕ +
(
ÕÕ+ ,
nameof
ÕÕ, 2
(
ÕÕ2 3
	fieldName
ÕÕ3 <
)
ÕÕ< =
)
ÕÕ= >
;
ÕÕ> ?
}
ŒŒ 
var
–– 
partDefinition
–– 
=
––  '
_contentDefinitionManager
––! :
.
––: ; 
LoadPartDefinition
––; M
(
––M N
partName
––N V
)
––V W
;
––W X
var
—— 
typeDefinition
—— 
=
——  '
_contentDefinitionManager
——! :
.
——: ; 
LoadTypeDefinition
——; M
(
——M N
partName
——N V
)
——V W
;
——W X
if
‘‘ 
(
‘‘ 
typeDefinition
‘‘ 
!=
‘‘ !
null
‘‘" &
)
‘‘& '
{
’’ '
_contentDefinitionManager
÷÷ )
.
÷÷) *!
AlterTypeDefinition
÷÷* =
(
÷÷= >
partName
÷÷> F
,
÷÷F G
builder
÷÷H O
=>
÷÷P R
builder
÷÷S Z
.
÷÷Z [
WithPart
÷÷[ c
(
÷÷c d
partName
÷÷d l
)
÷÷l m
)
÷÷m n
;
÷÷n o
}
◊◊ 
	fieldName
ŸŸ 
=
ŸŸ 
	fieldName
ŸŸ !
.
ŸŸ! "

ToSafeName
ŸŸ" ,
(
ŸŸ, -
)
ŸŸ- .
;
ŸŸ. /'
_contentDefinitionManager
€€ %
.
€€% &!
AlterPartDefinition
€€& 9
(
€€9 :
partName
€€: B
,
€€B C
partBuilder
‹‹ 
=>
‹‹ 
partBuilder
‹‹ *
.
‹‹* +
	WithField
‹‹+ 4
(
‹‹4 5
	fieldName
‹‹5 >
,
‹‹> ?
fieldBuilder
‹‹@ L
=>
‹‹M O
fieldBuilder
‹‹P \
.
‹‹\ ]
OfType
‹‹] c
(
‹‹c d
fieldTypeName
‹‹d q
)
‹‹q r
.
‹‹r s
WithDisplayName‹‹s Ç
(‹‹Ç É
displayName‹‹É é
)‹‹é è
)‹‹è ê
)‹‹ê ë
;‹‹ë í-
_contentDefinitionEventHandlers
ﬁﬁ +
.
ﬁﬁ+ ,
Invoke
ﬁﬁ, 2
(
ﬁﬁ2 3
(
ﬁﬁ3 4
handler
ﬁﬁ4 ;
,
ﬁﬁ; <
context
ﬁﬁ= D
)
ﬁﬁD E
=>
ﬁﬁF H
handler
ﬁﬁI P
.
ﬁﬁP Q"
ContentFieldAttached
ﬁﬁQ e
(
ﬁﬁe f
context
ﬁﬁf m
)
ﬁﬁm n
,
ﬁﬁn o
new
ﬁﬁp s*
ContentFieldAttachedContextﬁﬁt è
{
ﬂﬂ 
ContentPartName
‡‡ 
=
‡‡  !
partName
‡‡" *
,
‡‡* +"
ContentFieldTypeName
·· $
=
··% &
fieldTypeName
··' 4
,
··4 5
ContentFieldName
‚‚  
=
‚‚! "
	fieldName
‚‚# ,
,
‚‚, -%
ContentFieldDisplayName
„„ '
=
„„( )
displayName
„„* 5
}
‰‰ 
,
‰‰ 
_logger
‰‰ 
)
‰‰ 
;
‰‰ 
}
ÂÂ 	
public
ÁÁ 
void
ÁÁ !
RemoveFieldFromPart
ÁÁ '
(
ÁÁ' (
string
ÁÁ( .
	fieldName
ÁÁ/ 8
,
ÁÁ8 9
string
ÁÁ: @
partName
ÁÁA I
)
ÁÁI J
{
ËË 	'
_contentDefinitionManager
ÈÈ %
.
ÈÈ% &!
AlterPartDefinition
ÈÈ& 9
(
ÈÈ9 :
partName
ÈÈ: B
,
ÈÈB C
typeBuilder
ÈÈD O
=>
ÈÈP R
typeBuilder
ÈÈS ^
.
ÈÈ^ _
RemoveField
ÈÈ_ j
(
ÈÈj k
	fieldName
ÈÈk t
)
ÈÈt u
)
ÈÈu v
;
ÈÈv w-
_contentDefinitionEventHandlers
ÍÍ +
.
ÍÍ+ ,
Invoke
ÍÍ, 2
(
ÍÍ2 3
(
ÍÍ3 4
handler
ÍÍ4 ;
,
ÍÍ; <
context
ÍÍ= D
)
ÍÍD E
=>
ÍÍF H
handler
ÍÍI P
.
ÍÍP Q"
ContentFieldDetached
ÍÍQ e
(
ÍÍe f
context
ÍÍf m
)
ÍÍm n
,
ÍÍn o
new
ÍÍp s*
ContentFieldDetachedContextÍÍt è
{
ÎÎ 
ContentPartName
ÏÏ 
=
ÏÏ  !
partName
ÏÏ" *
,
ÏÏ* +
ContentFieldName
ÌÌ  
=
ÌÌ! "
	fieldName
ÌÌ# ,
}
ÓÓ 
,
ÓÓ 
_logger
ÓÓ 
)
ÓÓ 
;
ÓÓ 
}
ÔÔ 	
public
ÒÒ 
void
ÒÒ 

AlterField
ÒÒ 
(
ÒÒ 
EditPartViewModel
ÒÒ 0
partViewModel
ÒÒ1 >
,
ÒÒ> ? 
EditFieldViewModel
ÒÒ@ R
fieldViewModel
ÒÒS a
)
ÒÒa b
{
ÚÚ 	'
_contentDefinitionManager
ÛÛ %
.
ÛÛ% &!
AlterPartDefinition
ÛÛ& 9
(
ÛÛ9 :
partViewModel
ÛÛ: G
.
ÛÛG H
Name
ÛÛH L
,
ÛÛL M
partBuilder
ÛÛN Y
=>
ÛÛZ \
{
ÙÙ 
partBuilder
ıı 
.
ıı 
	WithField
ıı %
(
ıı% &
fieldViewModel
ıı& 4
.
ıı4 5
Name
ıı5 9
,
ıı9 :
fieldBuilder
ıı; G
=>
ııH J
{
ˆˆ 
fieldBuilder
˜˜  
.
˜˜  !
WithDisplayName
˜˜! 0
(
˜˜0 1
fieldViewModel
˜˜1 ?
.
˜˜? @
DisplayName
˜˜@ K
)
˜˜K L
;
˜˜L M
fieldBuilder
¯¯  
.
¯¯  !

WithEditor
¯¯! +
(
¯¯+ ,
fieldViewModel
¯¯, :
.
¯¯: ;
Editor
¯¯; A
)
¯¯A B
;
¯¯B C
fieldBuilder
˘˘  
.
˘˘  !
WithDisplayMode
˘˘! 0
(
˘˘0 1
fieldViewModel
˘˘1 ?
.
˘˘? @
DisplayMode
˘˘@ K
)
˘˘K L
;
˘˘L M
}
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 	
public
˛˛ 
void
˛˛ 
AlterTypePart
˛˛ !
(
˛˛! "#
EditTypePartViewModel
˛˛" 7
typePartViewModel
˛˛8 I
)
˛˛I J
{
ˇˇ 	
var
ÄÄ 
typeDefinition
ÄÄ 
=
ÄÄ  
typePartViewModel
ÄÄ! 2
.
ÄÄ2 3 
TypePartDefinition
ÄÄ3 E
.
ÄÄE F#
ContentTypeDefinition
ÄÄF [
;
ÄÄ[ \'
_contentDefinitionManager
ÇÇ %
.
ÇÇ% &!
AlterTypeDefinition
ÇÇ& 9
(
ÇÇ9 :
typeDefinition
ÇÇ: H
.
ÇÇH I
Name
ÇÇI M
,
ÇÇM N
type
ÇÇO S
=>
ÇÇT V
{
ÉÉ 
type
ÑÑ 
.
ÑÑ 
WithPart
ÑÑ 
(
ÑÑ 
typePartViewModel
ÑÑ /
.
ÑÑ/ 0
Name
ÑÑ0 4
,
ÑÑ4 5
typePartViewModel
ÑÑ6 G
.
ÑÑG H 
TypePartDefinition
ÑÑH Z
.
ÑÑZ [
PartDefinition
ÑÑ[ i
,
ÑÑi j
part
ÑÑk o
=>
ÑÑp r
{
ÖÖ 
part
ÜÜ 
.
ÜÜ 
WithDisplayName
ÜÜ (
(
ÜÜ( )
typePartViewModel
ÜÜ) :
.
ÜÜ: ;
DisplayName
ÜÜ; F
)
ÜÜF G
;
ÜÜG H
part
áá 
.
áá 
WithDescription
áá (
(
áá( )
typePartViewModel
áá) :
.
áá: ;
Description
áá; F
)
ááF G
;
ááG H
part
àà 
.
àà 

WithEditor
àà #
(
àà# $
typePartViewModel
àà$ 5
.
àà5 6
Editor
àà6 <
)
àà< =
;
àà= >
part
ââ 
.
ââ 
WithDisplayMode
ââ (
(
ââ( )
typePartViewModel
ââ) :
.
ââ: ;
DisplayMode
ââ; F
)
ââF G
;
ââG H
}
ää 
)
ää 
;
ää 
}
ãã 
)
ãã 
;
ãã 
}
åå 	
public
éé 
void
éé !
AlterTypePartsOrder
éé '
(
éé' (#
ContentTypeDefinition
éé( =
typeDefinition
éé> L
,
ééL M
string
ééN T
[
ééT U
]
ééU V
	partNames
ééW `
)
éé` a
{
èè 	'
_contentDefinitionManager
êê %
.
êê% &!
AlterTypeDefinition
êê& 9
(
êê9 :
typeDefinition
êê: H
.
êêH I
Name
êêI M
,
êêM N
type
êêO S
=>
êêT V
{
ëë 
for
íí 
(
íí 
var
íí 
i
íí 
=
íí 
$num
íí 
;
íí 
i
íí  !
<
íí" #
	partNames
íí$ -
.
íí- .
Length
íí. 4
;
íí4 5
i
íí6 7
++
íí7 9
)
íí9 :
{
ìì 
var
îî 
partDefinition
îî &
=
îî' (
typeDefinition
îî) 7
.
îî7 8
Parts
îî8 =
.
îî= >
FirstOrDefault
îî> L
(
îîL M
x
îîM N
=>
îîO Q
x
îîR S
.
îîS T
Name
îîT X
==
îîY [
	partNames
îî\ e
[
îîe f
i
îîf g
]
îîg h
)
îîh i
;
îîi j
type
ïï 
.
ïï 
WithPart
ïï !
(
ïï! "
	partNames
ïï" +
[
ïï+ ,
i
ïï, -
]
ïï- .
,
ïï. /
partDefinition
ïï0 >
.
ïï> ?
PartDefinition
ïï? M
,
ïïM N
part
ïïO S
=>
ïïT V
{
ññ 
part
óó 
.
óó 
MergeSettings
óó *
<
óó* +%
ContentTypePartSettings
óó+ B
>
óóB C
(
óóC D
x
óóD E
=>
óóF H
x
óóI J
.
óóJ K
Position
óóK S
=
óóT U
i
óóV W
.
óóW X
ToString
óóX `
(
óó` a
)
óóa b
)
óób c
;
óóc d
}
òò 
)
òò 
;
òò 
}
ôô 
}
öö 
)
öö 
;
öö 
}
õõ 	
public
ùù 
void
ùù "
AlterPartFieldsOrder
ùù (
(
ùù( )#
ContentPartDefinition
ùù) >
partDefinition
ùù? M
,
ùùM N
string
ùùO U
[
ùùU V
]
ùùV W

fieldNames
ùùX b
)
ùùb c
{
ûû 	'
_contentDefinitionManager
üü %
.
üü% &!
AlterPartDefinition
üü& 9
(
üü9 :
partDefinition
üü: H
.
üüH I
Name
üüI M
,
üüM N
type
üüO S
=>
üüT V
{
†† 
for
°° 
(
°° 
var
°° 
i
°° 
=
°° 
$num
°° 
;
°° 
i
°°  !
<
°°" #

fieldNames
°°$ .
.
°°. /
Length
°°/ 5
;
°°5 6
i
°°7 8
++
°°8 :
)
°°: ;
{
¢¢ 
var
££ 
fieldDefinition
££ '
=
££( )
partDefinition
££* 8
.
££8 9
Fields
££9 ?
.
££? @
FirstOrDefault
££@ N
(
££N O
x
££O P
=>
££Q S
x
££T U
.
££U V
Name
££V Z
==
££[ ]

fieldNames
££^ h
[
££h i
i
££i j
]
££j k
)
££k l
;
££l m
type
§§ 
.
§§ 
	WithField
§§ "
(
§§" #

fieldNames
§§# -
[
§§- .
i
§§. /
]
§§/ 0
,
§§0 1
field
§§2 7
=>
§§8 :
{
•• 
field
¶¶ 
.
¶¶ 
MergeSettings
¶¶ +
<
¶¶+ ,&
ContentPartFieldSettings
¶¶, D
>
¶¶D E
(
¶¶E F
x
¶¶F G
=>
¶¶H J
x
¶¶K L
.
¶¶L M
Position
¶¶M U
=
¶¶V W
i
¶¶X Y
.
¶¶Y Z
ToString
¶¶Z b
(
¶¶b c
)
¶¶c d
)
¶¶d e
;
¶¶e f
}
ßß 
)
ßß 
;
ßß 
}
®® 
}
©© 
)
©© 
;
©© 
}
™™ 	
public
¨¨ 
string
¨¨ 4
&GenerateContentTypeNameFromDisplayName
¨¨ <
(
¨¨< =
string
¨¨= C
displayName
¨¨D O
)
¨¨O P
{
≠≠ 	
displayName
ÆÆ 
=
ÆÆ 
displayName
ÆÆ %
.
ÆÆ% &

ToSafeName
ÆÆ& 0
(
ÆÆ0 1
)
ÆÆ1 2
;
ÆÆ2 3
while
∞∞ 
(
∞∞ '
_contentDefinitionManager
∞∞ ,
.
∞∞, - 
LoadTypeDefinition
∞∞- ?
(
∞∞? @
displayName
∞∞@ K
)
∞∞K L
!=
∞∞M O
null
∞∞P T
)
∞∞T U
displayName
±± 
=
±± 
VersionName
±± )
(
±±) *
displayName
±±* 5
)
±±5 6
;
±±6 7
return
≥≥ 
displayName
≥≥ 
;
≥≥ 
}
¥¥ 	
public
∂∂ 
string
∂∂ .
 GenerateFieldNameFromDisplayName
∂∂ 6
(
∂∂6 7
string
∂∂7 =
partName
∂∂> F
,
∂∂F G
string
∂∂H N
displayName
∂∂O Z
)
∂∂Z [
{
∑∑ 	
IEnumerable
∏∏ 
<
∏∏ (
ContentPartFieldDefinition
∏∏ 2
>
∏∏2 3
fieldDefinitions
∏∏4 D
;
∏∏D E
var
∫∫ 
part
∫∫ 
=
∫∫ '
_contentDefinitionManager
∫∫ 0
.
∫∫0 1 
LoadPartDefinition
∫∫1 C
(
∫∫C D
partName
∫∫D L
)
∫∫L M
;
∫∫M N
displayName
ªª 
=
ªª 
displayName
ªª %
.
ªª% &

ToSafeName
ªª& 0
(
ªª0 1
)
ªª1 2
;
ªª2 3
if
ΩΩ 
(
ΩΩ 
part
ΩΩ 
==
ΩΩ 
null
ΩΩ 
)
ΩΩ 
{
ææ 
var
øø 
type
øø 
=
øø '
_contentDefinitionManager
øø 4
.
øø4 5 
LoadTypeDefinition
øø5 G
(
øøG H
partName
øøH P
)
øøP Q
;
øøQ R
if
¡¡ 
(
¡¡ 
type
¡¡ 
==
¡¡ 
null
¡¡  
)
¡¡  !
{
¬¬ 
throw
√√ 
new
√√ 
ArgumentException
√√ /
(
√√/ 0
$str
√√0 J
+
√√K L
partName
√√M U
)
√√U V
;
√√V W
}
ƒƒ 
var
∆∆ 
typePart
∆∆ 
=
∆∆ 
type
∆∆ #
.
∆∆# $
Parts
∆∆$ )
.
∆∆) *
FirstOrDefault
∆∆* 8
(
∆∆8 9
x
∆∆9 :
=>
∆∆; =
x
∆∆> ?
.
∆∆? @
PartDefinition
∆∆@ N
.
∆∆N O
Name
∆∆O S
==
∆∆T V
partName
∆∆W _
)
∆∆_ `
;
∆∆` a
if
…… 
(
…… 
typePart
…… 
==
…… 
null
……  $
)
……$ %
{
   
return
ÀÀ 
displayName
ÀÀ &
;
ÀÀ& '
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
fieldDefinitions
œœ $
=
œœ% &
typePart
œœ' /
.
œœ/ 0
PartDefinition
œœ0 >
.
œœ> ?
Fields
œœ? E
.
œœE F
ToArray
œœF M
(
œœM N
)
œœN O
;
œœO P
}
–– 
}
—— 
else
““ 
{
”” 
fieldDefinitions
‘‘  
=
‘‘! "
part
‘‘# '
.
‘‘' (
Fields
‘‘( .
.
‘‘. /
ToArray
‘‘/ 6
(
‘‘6 7
)
‘‘7 8
;
‘‘8 9
}
’’ 
while
◊◊ 
(
◊◊ 
fieldDefinitions
◊◊ #
.
◊◊# $
Any
◊◊$ '
(
◊◊' (
x
◊◊( )
=>
◊◊* ,
String
◊◊- 3
.
◊◊3 4
Equals
◊◊4 :
(
◊◊: ;
displayName
◊◊; F
.
◊◊F G
Trim
◊◊G K
(
◊◊K L
)
◊◊L M
,
◊◊M N
x
◊◊O P
.
◊◊P Q
Name
◊◊Q U
.
◊◊U V
Trim
◊◊V Z
(
◊◊Z [
)
◊◊[ \
,
◊◊\ ]
StringComparison
◊◊^ n
.
◊◊n o 
OrdinalIgnoreCase◊◊o Ä
)◊◊Ä Å
)◊◊Å Ç
)◊◊Ç É
displayName
ÿÿ 
=
ÿÿ 
VersionName
ÿÿ )
(
ÿÿ) *
displayName
ÿÿ* 5
)
ÿÿ5 6
;
ÿÿ6 7
return
⁄⁄ 
displayName
⁄⁄ 
;
⁄⁄ 
}
€€ 	
private
›› 
static
›› 
string
›› 
VersionName
›› )
(
››) *
string
››* 0
name
››1 5
)
››5 6
{
ﬁﬁ 	
int
ﬂﬂ 
version
ﬂﬂ 
;
ﬂﬂ 
var
‡‡ 
	nameParts
‡‡ 
=
‡‡ 
name
‡‡  
.
‡‡  !
Split
‡‡! &
(
‡‡& '
$char
‡‡' *
,
‡‡* + 
StringSplitOptions
‡‡, >
.
‡‡> ? 
RemoveEmptyEntries
‡‡? Q
)
‡‡Q R
;
‡‡R S
if
‚‚ 
(
‚‚ 
	nameParts
‚‚ 
.
‚‚ 
Length
‚‚  
>
‚‚! "
$num
‚‚# $
&&
‚‚% '
int
‚‚( +
.
‚‚+ ,
TryParse
‚‚, 4
(
‚‚4 5
	nameParts
‚‚5 >
.
‚‚> ?
Last
‚‚? C
(
‚‚C D
)
‚‚D E
,
‚‚E F
out
‚‚G J
version
‚‚K R
)
‚‚R S
)
‚‚S T
{
„„ 
version
‰‰ 
=
‰‰ 
version
‰‰ !
>
‰‰" #
$num
‰‰$ %
?
‰‰& '
++
‰‰( *
version
‰‰* 1
:
‰‰2 3
$num
‰‰4 5
;
‰‰5 6
name
ÊÊ 
=
ÊÊ 
string
ÊÊ 
.
ÊÊ 
Join
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# &
,
ÊÊ& '
	nameParts
ÊÊ( 1
.
ÊÊ1 2
Take
ÊÊ2 6
(
ÊÊ6 7
	nameParts
ÊÊ7 @
.
ÊÊ@ A
Length
ÊÊA G
-
ÊÊH I
$num
ÊÊJ K
)
ÊÊK L
)
ÊÊL M
;
ÊÊM N
}
ÁÁ 
else
ËË 
{
ÈÈ 
version
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
return
ÌÌ 
string
ÌÌ 
.
ÌÌ 
Format
ÌÌ  
(
ÌÌ  !
$str
ÌÌ! *
,
ÌÌ* +
name
ÌÌ, 0
,
ÌÌ0 1
version
ÌÌ2 9
)
ÌÌ9 :
;
ÌÌ: ;
}
ÓÓ 	
}
ÔÔ 
} ∫
üD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Services\DefaultStereotypesProvider.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Services# +
{ 
public 

class &
DefaultStereotypesProvider +
:, - 
IStereotypesProvider. B
{ 
private 
readonly %
IContentDefinitionService 2%
_contentDefinitionService3 L
;L M
public		 &
DefaultStereotypesProvider		 )
(		) *%
IContentDefinitionService		* C$
contentDefinitionService		D \
)		\ ]
{

 	%
_contentDefinitionService %
=& '$
contentDefinitionService( @
;@ A
} 	
public 
IEnumerable 
< !
StereotypeDescription 0
>0 1
GetStereotypes2 @
(@ A
)A B
{ 	
var 
stereotypes 
= %
_contentDefinitionService 7
.7 8
GetTypes8 @
(@ A
)A B
.B C
WhereC H
(H I
xI J
=>K M
xN O
.O P
SettingsP X
[X Y
$strY e
]e f
!=g i
nullj n
)n o
.o p
Selectp v
(v w
xw x
=>y {
x| }
.} ~
Settings	~ Ü
[
Ü á
$str
á ì
]
ì î
.
î ï
ToString
ï ù
(
ù û
)
û ü
)
ü †
.
† °
Distinct
° ©
(
© ™
)
™ ´
;
´ ¨
return 
stereotypes 
. 
Select %
(% &
x& '
=>( *
new+ .!
StereotypeDescription/ D
{E F
DisplayNameG R
=S T
xU V
,V W

StereotypeX b
=c d
xe f
}g h
)h i
;i j
} 	
} 
} ˙(
ûD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Services\IContentDefinitionService.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Services# +
{ 
public 

	interface %
IContentDefinitionService .
{		 
IEnumerable

 
<

 
EditTypeViewModel

 %
>

% &
	LoadTypes

' 0
(

0 1
)

1 2
;

2 3
IEnumerable 
< 
EditTypeViewModel %
>% &
GetTypes' /
(/ 0
)0 1
;1 2
EditTypeViewModel 
LoadType "
(" #
string# )
name* .
). /
;/ 0
EditTypeViewModel 
GetType !
(! "
string" (
name) -
)- .
;. /!
ContentTypeDefinition 
AddType %
(% &
string& ,
name- 1
,1 2
string3 9
displayName: E
)E F
;F G
void 

RemoveType 
( 
string 
name #
,# $
bool% )
deleteContent* 7
)7 8
;8 9
void 
AddPartToType 
( 
string !
partName" *
,* +
string, 2
typeName3 ;
); <
;< =
void !
AddReusablePartToType "
(" #
string# )
name* .
,. /
string0 6
displayName7 B
,B C
stringD J
descriptionK V
,V W
stringX ^
partName_ g
,g h
stringi o
typeNamep x
)x y
;y z
void 
RemovePartFromType 
(  
string  &
partName' /
,/ 0
string1 7
typeName8 @
)@ A
;A B
string 2
&GenerateContentTypeNameFromDisplayName 5
(5 6
string6 <
displayName= H
)H I
;I J
string ,
 GenerateFieldNameFromDisplayName /
(/ 0
string0 6
partName7 ?
,? @
stringA G
displayNameH S
)S T
;T U
IEnumerable 
< 
EditPartViewModel %
>% &
	LoadParts' 0
(0 1
bool1 5
metadataPartsOnly6 G
)G H
;H I
IEnumerable 
< 
EditPartViewModel %
>% &
GetParts' /
(/ 0
bool0 4
metadataPartsOnly5 F
)F G
;G H
EditPartViewModel 
LoadPart "
(" #
string# )
name* .
). /
;/ 0
EditPartViewModel 
GetPart !
(! "
string" (
name) -
)- .
;. /
EditPartViewModel 
AddPart !
(! "
CreatePartViewModel" 5
partViewModel6 C
)C D
;D E
void 

RemovePart 
( 
string 
name #
)# $
;$ %
IEnumerable 
< 
Type 
> 
	GetFields #
(# $
)$ %
;% &
void 
AddFieldToPart 
( 
string "
	fieldName# ,
,, -
string. 4
fieldTypeName5 B
,B C
stringD J
partNameK S
)S T
;T U
void 
AddFieldToPart 
( 
string "
	fieldName# ,
,, -
string. 4
displayName5 @
,@ A
stringB H
fieldTypeNameI V
,V W
stringX ^
partName_ g
)g h
;h i
void   
RemoveFieldFromPart    
(    !
string  ! '
	fieldName  ( 1
,  1 2
string  3 9
partName  : B
)  B C
;  C D
void!! 

AlterField!! 
(!! 
EditPartViewModel!! )
partViewModel!!* 7
,!!7 8
EditFieldViewModel!!9 K
fieldViewModel!!L Z
)!!Z [
;!![ \
void## 
AlterTypePart## 
(## !
EditTypePartViewModel## 0
partViewModel##1 >
)##> ?
;##? @
void%% 
AlterTypePartsOrder%%  
(%%  !!
ContentTypeDefinition%%! 6
typeDefinition%%7 E
,%%E F
string%%G M
[%%M N
]%%N O
	partNames%%P Y
)%%Y Z
;%%Z [
void&&  
AlterPartFieldsOrder&& !
(&&! "!
ContentPartDefinition&&" 7
partDefinition&&8 F
,&&F G
string&&H N
[&&N O
]&&O P

fieldNames&&Q [
)&&[ \
;&&\ ]
}'' 
}(( Â
ôD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Services\IStereotypesProvider.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Services# +
{ 
public 

	interface  
IStereotypesProvider )
{ 
IEnumerable 
< !
StereotypeDescription )
>) *
GetStereotypes+ 9
(9 :
): ;
;; <
} 
public

 

class

 !
StereotypeDescription

 &
{ 
public 
string 

Stereotype  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ‚
ñD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Services\StereotypeService.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #
Services# +
{ 
public 

	interface 
IStereotypeService '
{ 
IEnumerable 
< !
StereotypeDescription )
>) *
GetStereotypes+ 9
(9 :
): ;
;; <
}		 
public 

class 
StereotypeService "
:# $
IStereotypeService% 7
{ 
private 
readonly 
IEnumerable $
<$ % 
IStereotypesProvider% 9
>9 :

_providers; E
;E F
public 
StereotypeService  
(  !
IEnumerable! ,
<, - 
IStereotypesProvider- A
>A B
	providersC L
)L M
{ 	

_providers 
= 
	providers "
;" #
} 	
public 
IEnumerable 
< !
StereotypeDescription 0
>0 1
GetStereotypes2 @
(@ A
)A B
{ 	
return 

_providers 
. 

SelectMany (
(( )
x) *
=>+ -
x. /
./ 0
GetStereotypes0 >
(> ?
)? @
)@ A
;A B
} 	
} 
} Ä~
ÉD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\Startup.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
{ 
public 

class 
Startup 
: 
StartupBase &
{ 
private 
readonly 
AdminOptions %
_adminOptions& 3
;3 4
public 
Startup 
( 
IOptions 
<  
AdminOptions  ,
>, -
adminOptions. :
): ;
{ 	
_adminOptions 
= 
adminOptions (
.( )
Value) .
;. /
} 	
public 
override 
void 
ConfigureServices .
(. /
IServiceCollection/ A
servicesB J
)J K
{   	
services!! 
.!! 
	AddScoped!! 
<!! 
IPermissionProvider!! 2
,!!2 3
Permissions!!4 ?
>!!? @
(!!@ A
)!!A B
;!!B C
services"" 
."" 
	AddScoped"" 
<"" 
INavigationProvider"" 2
,""2 3
	AdminMenu""4 =
>""= >
(""> ?
)""? @
;""@ A
services## 
.## 
	AddScoped## 
<## %
IContentDefinitionService## 8
,##8 9$
ContentDefinitionService##: R
>##R S
(##S T
)##T U
;##U V
services$$ 
.$$ 
	AddScoped$$ 
<$$  
IStereotypesProvider$$ 3
,$$3 4&
DefaultStereotypesProvider$$5 O
>$$O P
($$P Q
)$$Q R
;$$R S
services%% 
.%% 
	AddScoped%% 
<%% 
IStereotypeService%% 1
,%%1 2
StereotypeService%%3 D
>%%D E
(%%E F
)%%F G
;%%G H
services&& 
.&& 
	AddScoped&& 
<&& ,
 IContentDefinitionDisplayHandler&& ?
,&&? @/
#ContentDefinitionDisplayCoordinator&&A d
>&&d e
(&&e f
)&&f g
;&&g h
services'' 
.'' 
	AddScoped'' 
<'' ,
 IContentDefinitionDisplayManager'' ?
,''? @2
&DefaultContentDefinitionDisplayManager''A g
>''g h
(''h i
)''i j
;''j k
services(( 
.(( 
	AddScoped(( 
<(( /
#IContentPartDefinitionDisplayDriver(( B
,((B C,
 ContentPartSettingsDisplayDriver((D d
>((d e
(((e f
)((f g
;((g h
services)) 
.)) 
	AddScoped)) 
<)) /
#IContentTypeDefinitionDisplayDriver)) B
,))B C,
 ContentTypeSettingsDisplayDriver))D d
>))d e
())e f
)))f g
;))g h
services** 
.** 
	AddScoped** 
<** /
#IContentTypeDefinitionDisplayDriver** B
,**B C+
DefaultContentTypeDisplayDriver**D c
>**c d
(**d e
)**e f
;**f g
services++ 
.++ 
	AddScoped++ 
<++ 3
'IContentTypePartDefinitionDisplayDriver++ F
,++F G0
$ContentTypePartSettingsDisplayDriver++H l
>++l m
(++m n
)++n o
;++o p
services// 
.// "
AddRecipeExecutionStep// +
<//+ ,!
ContentDefinitionStep//, A
>//A B
(//B C
)//C D
;//D E
services00 
.00 "
AddRecipeExecutionStep00 +
<00+ ,(
ReplaceContentDefinitionStep00, H
>00H I
(00I J
)00J K
;00K L
services11 
.11 "
AddRecipeExecutionStep11 +
<11+ ,'
DeleteContentDefinitionStep11, G
>11G H
(11H I
)11I J
;11J K
}22 	
public44 
override44 
void44 
	Configure44 &
(44& '
IApplicationBuilder44' :
builder44; B
,44B C!
IEndpointRouteBuilder44D Y
routes44Z `
,44` a
IServiceProvider44b r
serviceProvider	44s Ç
)
44Ç É
{55 	
var66 
adminControllerName66 #
=66$ %
typeof66& ,
(66, -
AdminController66- <
)66< =
.66= >
ControllerName66> L
(66L M
)66M N
;66N O
routes88 
.88 "
MapAreaControllerRoute88 )
(88) *
name99 
:99 
$str99 !
,99! "
areaName:: 
::: 
$str:: 4
,::4 5
pattern;; 
:;; 
_adminOptions;; &
.;;& '
AdminUrlPrefix;;' 5
+;;6 7
$str;;8 _
,;;_ `
defaults<< 
:<< 
new<< 
{<< 

controller<<  *
=<<+ ,
adminControllerName<<- @
,<<@ A
action<<B H
=<<I J
nameof<<K Q
(<<Q R
AdminController<<R a
.<<a b
	EditField<<b k
)<<k l
}<<m n
)== 
;== 
routes?? 
.?? "
MapAreaControllerRoute?? )
(??) *
name@@ 
:@@ 
$str@@ "
,@@" #
areaNameAA 
:AA 
$strAA 4
,AA4 5
patternBB 
:BB 
_adminOptionsBB &
.BB& '
AdminUrlPrefixBB' 5
+BB6 7
$strBB8 N
,BBN O
defaultsCC 
:CC 
newCC 
{CC 

controllerCC  *
=CC+ ,
adminControllerNameCC- @
,CC@ A
actionCCB H
=CCI J
nameofCCK Q
(CCQ R
AdminControllerCCR a
.CCa b
CreateCCb h
)CCh i
}CCj k
)DD 
;DD 
routesFF 
.FF "
MapAreaControllerRouteFF )
(FF) *
nameGG 
:GG 
$strGG #
,GG# $
areaNameHH 
:HH 
$strHH 4
,HH4 5
patternII 
:II 
_adminOptionsII &
.II& '
AdminUrlPrefixII' 5
+II6 7
$strII8 X
,IIX Y
defaultsJJ 
:JJ 
newJJ 
{JJ 

controllerJJ  *
=JJ+ ,
adminControllerNameJJ- @
,JJ@ A
actionJJB H
=JJI J
nameofJJK Q
(JJQ R
AdminControllerJJR a
.JJa b

AddFieldToJJb l
)JJl m
}JJn o
)KK 
;KK 
routesMM 
.MM "
MapAreaControllerRouteMM )
(MM) *
nameNN 
:NN 
$strNN "
,NN" #
areaNameOO 
:OO 
$strOO 4
,OO4 5
patternPP 
:PP 
_adminOptionsPP &
.PP& '
AdminUrlPrefixPP' 5
+PP6 7
$strPP8 W
,PPW X
defaultsQQ 
:QQ 
newQQ 
{QQ 

controllerQQ  *
=QQ+ ,
adminControllerNameQQ- @
,QQ@ A
actionQQB H
=QQI J
nameofQQK Q
(QQQ R
AdminControllerQQR a
.QQa b

AddPartsToQQb l
)QQl m
}QQn o
)RR 
;RR 
routesTT 
.TT "
MapAreaControllerRouteTT )
(TT) *
nameUU 
:UU 
$strUU )
,UU) *
areaNameVV 
:VV 
$strVV 4
,VV4 5
patternWW 
:WW 
_adminOptionsWW &
.WW& '
AdminUrlPrefixWW' 5
+WW6 7
$strWW8 ^
,WW^ _
defaultsXX 
:XX 
newXX 
{XX 

controllerXX  *
=XX+ ,
adminControllerNameXX- @
,XX@ A
actionXXB H
=XXI J
nameofXXK Q
(XXQ R
AdminControllerXXR a
.XXa b
AddReusablePartToXXb s
)XXs t
}XXu v
)YY 
;YY 
routes[[ 
.[[ "
MapAreaControllerRoute[[ )
([[) *
name\\ 
:\\ 
$str\\  
,\\  !
areaName]] 
:]] 
$str]] 4
,]]4 5
pattern^^ 
:^^ 
_adminOptions^^ &
.^^& '
AdminUrlPrefix^^' 5
+^^6 7
$str^^8 Q
,^^Q R
defaults__ 
:__ 
new__ 
{__ 

controller__  *
=__+ ,
adminControllerName__- @
,__@ A
action__B H
=__I J
nameof__K Q
(__Q R
AdminController__R a
.__a b
Edit__b f
)__f g
}__h i
)`` 
;`` 
routesbb 
.bb "
MapAreaControllerRoutebb )
(bb) *
namecc 
:cc 
$strcc $
,cc$ %
areaNamedd 
:dd 
$strdd 4
,dd4 5
patternee 
:ee 
_adminOptionsee &
.ee& '
AdminUrlPrefixee' 5
+ee6 7
$stree8 e
,eee f
defaultsff 
:ff 
newff 
{ff 

controllerff  *
=ff+ ,
adminControllerNameff- @
,ff@ A
actionffB H
=ffI J
nameofffK Q
(ffQ R
AdminControllerffR a
.ffa b
EditTypePartffb n
)ffn o
}ffp q
)gg 
;gg 
routesii 
.ii "
MapAreaControllerRouteii )
(ii) *
namejj 
:jj 
$strjj  
,jj  !
areaNamekk 
:kk 
$strkk 4
,kk4 5
patternll 
:ll 
_adminOptionsll &
.ll& '
AdminUrlPrefixll' 5
+ll6 7
$strll8 Q
,llQ R
defaultsmm 
:mm 
newmm 
{mm 

controllermm  *
=mm+ ,
adminControllerNamemm- @
,mm@ A
actionmmB H
=mmI J
nameofmmK Q
(mmQ R
AdminControllermmR a
.mma b
EditPartmmb j
)mmj k
}mml m
)nn 
;nn 
routespp 
.pp "
MapAreaControllerRoutepp )
(pp) *
nameqq 
:qq 
$strqq (
,qq( )
areaNamerr 
:rr 
$strrr 4
,rr4 5
patternss 
:ss 
_adminOptionsss &
.ss& '
AdminUrlPrefixss' 5
+ss6 7
$strss8 L
,ssL M
defaultstt 
:tt 
newtt 
{tt 

controllertt  *
=tt+ ,
adminControllerNamett- @
,tt@ A
actionttB H
=ttI J
nameofttK Q
(ttQ R
AdminControllerttR a
.tta b
Listttb f
)ttf g
}tth i
)uu 
;uu 
routesww 
.ww "
MapAreaControllerRouteww )
(ww) *
namexx 
:xx 
$strxx (
,xx( )
areaNameyy 
:yy 
$stryy 4
,yy4 5
patternzz 
:zz 
_adminOptionszz &
.zz& '
AdminUrlPrefixzz' 5
+zz6 7
$strzz8 Q
,zzQ R
defaults{{ 
:{{ 
new{{ 
{{{ 

controller{{  *
={{+ ,
adminControllerName{{- @
,{{@ A
action{{B H
={{I J
nameof{{K Q
({{Q R
AdminController{{R a
.{{a b
	ListParts{{b k
){{k l
}{{m n
)|| 
;|| 
routes~~ 
.~~ "
MapAreaControllerRoute~~ )
(~~) *
name 
: 
$str "
," #
areaName
ÄÄ 
:
ÄÄ 
$str
ÄÄ 4
,
ÄÄ4 5
pattern
ÅÅ 
:
ÅÅ 
_adminOptions
ÅÅ &
.
ÅÅ& '
AdminUrlPrefix
ÅÅ' 5
+
ÅÅ6 7
$str
ÅÅ8 g
,
ÅÅg h
defaults
ÇÇ 
:
ÇÇ 
new
ÇÇ 
{
ÇÇ 

controller
ÇÇ  *
=
ÇÇ+ ,!
adminControllerName
ÇÇ- @
,
ÇÇ@ A
action
ÇÇB H
=
ÇÇI J
nameof
ÇÇK Q
(
ÇÇQ R
AdminController
ÇÇR a
.
ÇÇa b

RemovePart
ÇÇb l
)
ÇÇl m
}
ÇÇn o
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
}
ÖÖ 
[
áá 
RequireFeatures
áá 
(
áá 
$str
áá -
)
áá- .
]
áá. /
public
àà 

class
àà 
DeploymentStartup
àà "
:
àà# $
StartupBase
àà% 0
{
ââ 
public
ää 
override
ää 
void
ää 
ConfigureServices
ää .
(
ää. / 
IServiceCollection
ää/ A
services
ääB J
)
ääJ K
{
ãã 	
services
åå 
.
åå 
AddTransient
åå !
<
åå! "
IDeploymentSource
åå" 3
,
åå3 4/
!ContentDefinitionDeploymentSource
åå5 V
>
ååV W
(
ååW X
)
ååX Y
;
ååY Z
services
çç 
.
çç 
AddSingleton
çç !
<
çç! "$
IDeploymentStepFactory
çç" 8
>
çç8 9
(
çç9 :
new
çç: =#
DeploymentStepFactory
çç> S
<
ççS T-
ContentDefinitionDeploymentStep
ççT s
>
ççs t
(
ççt u
)
ççu v
)
ççv w
;
ççw x
services
éé 
.
éé 
	AddScoped
éé 
<
éé 
IDisplayDriver
éé -
<
éé- .
DeploymentStep
éé. <
>
éé< =
,
éé= >3
%ContentDefinitionDeploymentStepDriver
éé? d
>
ééd e
(
éée f
)
ééf g
;
éég h
services
êê 
.
êê 
AddTransient
êê !
<
êê! "
IDeploymentSource
êê" 3
,
êê3 46
(ReplaceContentDefinitionDeploymentSource
êê5 ]
>
êê] ^
(
êê^ _
)
êê_ `
;
êê` a
services
ëë 
.
ëë 
AddSingleton
ëë !
<
ëë! "$
IDeploymentStepFactory
ëë" 8
>
ëë8 9
(
ëë9 :
new
ëë: =#
DeploymentStepFactory
ëë> S
<
ëëS T4
&ReplaceContentDefinitionDeploymentStep
ëëT z
>
ëëz {
(
ëë{ |
)
ëë| }
)
ëë} ~
;
ëë~ 
services
íí 
.
íí 
	AddScoped
íí 
<
íí 
IDisplayDriver
íí -
<
íí- .
DeploymentStep
íí. <
>
íí< =
,
íí= >:
,ReplaceContentDefinitionDeploymentStepDriver
íí? k
>
íík l
(
ííl m
)
íím n
;
íín o
services
îî 
.
îî 
AddTransient
îî !
<
îî! "
IDeploymentSource
îî" 3
,
îî3 45
'DeleteContentDefinitionDeploymentSource
îî5 \
>
îî\ ]
(
îî] ^
)
îî^ _
;
îî_ `
services
ïï 
.
ïï 
AddSingleton
ïï !
<
ïï! "$
IDeploymentStepFactory
ïï" 8
>
ïï8 9
(
ïï9 :
new
ïï: =#
DeploymentStepFactory
ïï> S
<
ïïS T3
%DeleteContentDefinitionDeploymentStep
ïïT y
>
ïïy z
(
ïïz {
)
ïï{ |
)
ïï| }
;
ïï} ~
services
ññ 
.
ññ 
	AddScoped
ññ 
<
ññ 
IDisplayDriver
ññ -
<
ññ- .
DeploymentStep
ññ. <
>
ññ< =
,
ññ= >9
+DeleteContentDefinitionDeploymentStepDriver
ññ? j
>
ññj k
(
ññk l
)
ññl m
;
ññm n
}
óó 	
}
òò 
}ôô û
™D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewComponents\SelectContentTypesViewComponent.cs
	namespace		 	
OrchardCore		
 
.		 
ContentTypes		 "
.		" #
ViewComponents		# 1
{

 
public 

class +
SelectContentTypesViewComponent 0
:1 2
ViewComponent3 @
{ 
private 
readonly %
IContentDefinitionManager 2%
_contentDefinitionManager3 L
;L M
public +
SelectContentTypesViewComponent .
(. /%
IContentDefinitionManager/ H$
contentDefinitionManagerI a
)a b
{ 	%
_contentDefinitionManager %
=& '$
contentDefinitionManager( @
;@ A
} 	
public  
IViewComponentResult #
Invoke$ *
(* +
IEnumerable+ 6
<6 7
string7 =
>= > 
selectedContentTypes? S
,S T
stringU [
htmlName\ d
,d e
stringf l

stereotypem w
)w x
{ 	
if 
(  
selectedContentTypes $
==% '
null( ,
), -
{  
selectedContentTypes $
=% &
new' *
string+ 1
[1 2
$num2 3
]3 4
;4 5
} 
var 
contentTypes 
=  
ContentTypeSelection 3
.3 4
Build4 9
(9 :%
_contentDefinitionManager: S
,S T 
selectedContentTypesU i
)i j
;j k
if 
( 
! 
String 
. 
IsNullOrEmpty %
(% &

stereotype& 0
)0 1
)1 2
{ 
contentTypes 
= 
contentTypes +
.   
Where   
(   
x   
=>   
x    !
.  ! "!
ContentTypeDefinition  " 7
.  7 8
GetSettings  8 C
<  C D
ContentTypeSettings  D W
>  W X
(  X Y
)  Y Z
.  Z [

Stereotype  [ e
==  f h

stereotype  i s
)  s t
.!! 
ToArray!! 
(!! 
)!! 
;!! 
}"" 
var$$ 
model$$ 
=$$ 
new$$ '
SelectContentTypesViewModel$$ 7
{%% 
HtmlName&& 
=&& 
htmlName&& #
,&&# $!
ContentTypeSelections'' %
=''& '
contentTypes''( 4
}(( 
;(( 
return** 
View** 
(** 
model** 
)** 
;** 
}++ 	
},, 
}-- í
òD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\AddFieldViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 
AddFieldViewModel "
{		 
public

 
AddFieldViewModel

  
(

  !
)

! "
{ 	
Fields 
= 
new 
List 
< 
string $
>$ %
(% &
)& '
;' (
} 	
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 
FieldTypeName #
{$ %
get& )
;) *
set+ .
;. /
}0 1
["" 	
	BindNever""	 
]"" 
public## !
ContentPartDefinition## $
Part##% )
{##* +
get##, /
;##/ 0
set##1 4
;##4 5
}##6 7
[(( 	
	BindNever((	 
](( 
public)) 
List)) 
<)) 
string)) 
>)) 
Fields)) "
{))# $
get))% (
;))( )
set))* -
;))- .
}))/ 0
}** 
}++ Ã
òD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\AddPartsViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 
AddPartsViewModel "
{ 
public 
AddPartsViewModel  
(  !
)! "
{ 	
PartSelections		 
=		 
new		  
List		! %
<		% &"
PartSelectionViewModel		& <
>		< =
(		= >
)		> ?
;		? @
}

 	
public 
EditTypeViewModel  
Type! %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
List 
< "
PartSelectionViewModel *
>* +
PartSelections, :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
public 

class $
AddReusablePartViewModel )
{ 
public $
AddReusablePartViewModel '
(' (
)( )
{ 	
PartSelections 
= 
new  
List! %
<% &"
PartSelectionViewModel& <
>< =
(= >
)> ?
;? @
} 	
public 
EditTypeViewModel  
Type! %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
List 
< "
PartSelectionViewModel *
>* +
PartSelections, :
{; <
get= @
;@ A
setB E
;E F
}G H
public 
string 
SelectedPartName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
public 

class "
PartSelectionViewModel '
{   
public!! 
string!! 
PartName!! 
{!!  
get!!! $
;!!$ %
set!!& )
;!!) *
}!!+ ,
public"" 
string"" 
PartDisplayName"" %
{""& '
get""( +
;""+ ,
set""- 0
;""0 1
}""2 3
public## 
string## 
PartDescription## %
{##& '
get##( +
;##+ ,
set##- 0
;##0 1
}##2 3
public$$ 
bool$$ 

IsSelected$$ 
{$$  
get$$! $
;$$$ %
set$$& )
;$$) *
}$$+ ,
}%% 
}&& ﬂ
•D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ContentDefinitionStepViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class *
ContentDefinitionStepViewModel /
{ 
public 
string 
[ 
] 
ContentTypes $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
[ 
] 
ContentParts $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 
bool		 

IncludeAll		 
{		  
get		! $
;		$ %
internal		& .
set		/ 2
;		2 3
}		4 5
}

 
} é

£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ContentPartSettingsViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class (
ContentPartSettingsViewModel -
{ 
public 
bool 

Attachable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public		 
bool		 
Reusable		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
string

 
Description

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
	BindNever	 
] 
public !
ContentPartDefinition $!
ContentPartDefinition% :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
} ”

£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ContentTypeSettingsViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class (
ContentTypeSettingsViewModel -
{ 
public 
bool 
	Creatable 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
Listable 
{ 
get "
;" #
set$ '
;' (
}) *
public 
bool 
	Draftable 
{ 
get  #
;# $
set% (
;( )
}* +
public 
bool 
Versionable 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
bool		 
	Securable		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
string

 

Stereotype

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
} 
} º
õD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ContentTypeViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class  
ContentTypeViewModel %
{ 
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ≥
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\CreatePartViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 
CreatePartViewModel $
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
} 
} “
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\CreateTypeViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 
CreateTypeViewModel $
{ 
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ˝
´D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\DeleteContentDefinitionStepViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 0
$DeleteContentDefinitionStepViewModel 5
{ 
public 
string 
ContentTypes "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
ContentParts "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
}		 ¸
ôD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\EditFieldViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 
EditFieldViewModel #
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
] 
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
	BindNever	 
] 
public &
ContentPartFieldDefinition )
PartFieldDefinition* =
{> ?
get@ C
;C D
setE H
;H I
}J K
[ 	
	BindNever	 
] 
public 
dynamic 
Shape 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Editor 
{ 
get "
;" #
set$ '
;' (
}) *
public"" 
string"" 
DisplayMode"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
}## 
}$$ ≥
òD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\EditPartViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public		 

class		 
EditPartViewModel		 "
{

 
public 
EditPartViewModel  
(  !
)! "
{ 	
} 	
public 
EditPartViewModel  
(  !!
ContentPartDefinition! 6!
contentPartDefinition7 L
)L M
{ 	
Name 
= !
contentPartDefinition (
.( )
Name) -
;- .
PartDefinition 
= !
contentPartDefinition 2
;2 3
} 	
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
private 
string 
_displayName #
;# $
[ 	
Required	 
] 
public 
string 
DisplayName !
{ 	
get 
{ 
return 
! 
string  
.  !
IsNullOrWhiteSpace! 3
(3 4
_displayName4 @
)@ A
?B C
_displayNameD P
:Q R
NameS W
.W X
TrimEndX _
(_ `
$str` f
)f g
.g h
CamelFriendlyh u
(u v
)v w
;w x
}y z
set 
{ 
_displayName 
=  
value! &
;& '
}( )
} 	
public   
string   
Description   !
{!! 	
get"" 
{"" 
return"" 
PartDefinition"" '
.""' (
GetSettings""( 3
<""3 4
ContentPartSettings""4 G
>""G H
(""H I
)""I J
.""J K
Description""K V
;""V W
}""X Y
set## 
{## 
PartDefinition##  
.##  !
GetSettings##! ,
<##, -
ContentPartSettings##- @
>##@ A
(##A B
)##B C
.##C D
Description##D O
=##P Q
value##R W
;##W X
}##Y Z
}$$ 	
[&& 	
	BindNever&&	 
]&& 
public'' !
ContentPartDefinition'' $
PartDefinition''% 3
{''4 5
get''6 9
;''9 :
private''; B
set''C F
;''F G
}''H I
[)) 	
	BindNever))	 
])) 
public** 
dynamic** 
Editor** 
{** 
get**  #
;**# $
set**% (
;**( )
}*** +
}++ 
},, Î
úD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\EditTypePartViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class !
EditTypePartViewModel &
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
	BindNever	 
] 
public %
ContentTypePartDefinition (
TypePartDefinition) ;
{< =
get> A
;A B
setC F
;F G
}H I
[ 	
	BindNever	 
] 
public 
dynamic 
Shape 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Editor 
{ 
get "
;" #
set$ '
;' (
}) *
public"" 
string"" 
DisplayMode"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
}## 
}$$ ∆
òD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\EditTypeViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 
EditTypeViewModel "
{ 
public		 
EditTypeViewModel		  
(		  !
)		! "
{

 	
Settings 
= 
new 
JObject "
(" #
)# $
;$ %
} 	
public 
EditTypeViewModel  
(  !!
ContentTypeDefinition! 6!
contentTypeDefinition7 L
)L M
{ 	
Name 
= !
contentTypeDefinition (
.( )
Name) -
;- .
DisplayName 
= !
contentTypeDefinition /
./ 0
DisplayName0 ;
;; <
Settings 
= !
contentTypeDefinition ,
., -
Settings- 5
;5 6
TypeDefinition 
= !
contentTypeDefinition 2
;2 3
} 	
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
DisplayName !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
[ 
] 
OrderedFieldNames )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
[ 
] 
OrderedPartNames (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	
	BindNever	 
] 
public 
JObject 
Settings 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
	BindNever	 
] 
public !
ContentTypeDefinition $
TypeDefinition% 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
[!! 	
	BindNever!!	 
]!! 
public"" 
dynamic"" 
Editor"" 
{"" 
get""  #
;""# $
set""% (
;""( )
}""* +
}## 
}$$ ∑
†D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ListContentPartsViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class %
ListContentPartsViewModel *
{ 
[ 	
	BindNever	 
] 
public		 
IEnumerable		 
<		 
EditPartViewModel		 ,
>		, -
Parts		. 3
{		4 5
get		6 9
;		9 :
set		; >
;		> ?
}		@ A
}

 
} ∑
†D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ListContentTypesViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class %
ListContentTypesViewModel *
{ 
[ 	
	BindNever	 
] 
public		 
IEnumerable		 
<		 
EditTypeViewModel		 ,
>		, -
Types		. 3
{		4 5
get		6 9
;		9 :
set		; >
;		> ?
}		@ A
}

 
} ˙
¨D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\ReplaceContentDefinitionStepViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class 1
%ReplaceContentDefinitionStepViewModel 6
:7 8*
ContentDefinitionStepViewModel9 W
{ 
} 
} £
¢D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.ContentTypes\ViewModels\SelectContentTypesViewModel.cs
	namespace 	
OrchardCore
 
. 
ContentTypes "
." #

ViewModels# -
{ 
public 

class '
SelectContentTypesViewModel ,
{		 
public

 
string

 
HtmlName

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public  
ContentTypeSelection #
[# $
]$ %!
ContentTypeSelections& ;
{< =
get> A
;A B
setC F
;F G
}H I
} 
public 

class  
ContentTypeSelection %
{ 
public 
bool 

IsSelected 
{  
get! $
;$ %
set& )
;) *
}+ ,
public !
ContentTypeDefinition $!
ContentTypeDefinition% :
{; <
get= @
;@ A
setB E
;E F
}G H
public 
static  
ContentTypeSelection *
[* +
]+ ,
Build- 2
(2 3%
IContentDefinitionManager3 L$
contentDefinitionManagerM e
,e f
IEnumerableg r
<r s
strings y
>y z!
selectedContentTypes	{ è
)
è ê
{ 	
var 
contentTypes 
= $
contentDefinitionManager 7
. 
ListTypeDefinitions $
($ %
)% &
. 
Select 
( 
x 
=> 
new  
ContentTypeSelection ,
{ 

IsSelected "
=# $ 
selectedContentTypes% 9
.9 :
Contains: B
(B C
xC D
.D E
NameE I
)I J
,J K!
ContentTypeDefinition -
=. /
x0 1
} 
) 
. 
OrderBy 
( 
type 
=>  
type! %
.% &!
ContentTypeDefinition& ;
.; <
DisplayName< G
)G H
. 
ToArray 
( 
) 
; 
return   
contentTypes   
;    
}!! 	
}"" 
}## 