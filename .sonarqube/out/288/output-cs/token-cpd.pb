Ç
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\ContentRootPoFileLocationProvider.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{		 
public 

class -
!ContentRootPoFileLocationProvider 2
:3 4-
!ILocalizationFileLocationProvider5 V
{ 
private 
readonly 
IFileProvider &
_fileProvider' 4
;4 5
private 
readonly 
string 
_resourcesContainer  3
;3 4
public -
!ContentRootPoFileLocationProvider 0
(0 1
IHostEnvironment1 A
hostingEnvironmentB T
,T U
IOptionsV ^
<^ _
LocalizationOptions_ r
>r s 
localizationOptions	t á
)
á à
{ 	
_fileProvider 
= 
hostingEnvironment .
.. /#
ContentRootFileProvider/ F
;F G
_resourcesContainer 
=  !
localizationOptions" 5
.5 6
Value6 ;
.; <
ResourcesPath< I
;I J
} 	
public 
IEnumerable 
< 
	IFileInfo $
>$ %
GetLocations& 2
(2 3
string3 9
cultureName: E
)E F
{ 	
yield   
return   
_fileProvider   &
.  & '
GetFileInfo  ' 2
(  2 3
Path  3 7
.  7 8
Combine  8 ?
(  ? @
_resourcesContainer  @ S
,  S T
cultureName  U `
+  a b
$str  c h
)  h i
)  i j
;  j k
}!! 	
}"" 
}## ∏R
¨D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\DataAnnotations\DataAnnotationsDefaultErrorMessages.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
DataAnnotations# 2
{ 
internal 
sealed 
class /
#DataAnnotationsDefaultErrorMessages =
{		 
private

 
readonly

 
IStringLocalizer

 )
S

* +
=

, -
null

. 2
;

2 3
private /
#DataAnnotationsDefaultErrorMessages 3
(3 4
)4 5
{ 	
} 	
public 
string U
IAssociatedMetadataTypeTypeDescriptorMetadataTypeContainsUnknownProperties _
=>` b
Sc d
[d e
$str	e ±
]
± ≤
;
≤ ≥
public 
string )
AttributeStoreUnknownProperty 3
=>4 6
S7 8
[8 9
$str9 y
]y z
;z {
public 
string "
CommonPropertyNotFound ,
=>- /
S0 1
[1 2
$str2 \
]\ ]
;] ^
public 
string %
CompareAttributeMustMatch /
=>0 2
S3 4
[4 5
$str5 T
]T U
;U V
public 
string +
CompareAttributeUnknownProperty 5
=>6 8
S9 :
[: ;
$str; a
]a b
;b c
public 
string &
CreditCardAttributeInvalid 0
=>1 3
S4 5
[5 6
$str6 h
]h i
;i j
public 
string E
9CustomValidationAttributeMethodMustReturnValidationResult O
=>P R
SS T
[T U
$str	U ≠
]
≠ Æ
;
Æ Ø
public 
string 3
'CustomValidationAttributeMethodNotFound =
=>> @
SA B
[B C
$str	C ©
]
© ™
;
™ ´
public!! 
string!! 3
'CustomValidationAttributeMethodRequired!! =
=>!!> @
S!!A B
[!!B C
$str!!C |
]!!| }
;!!} ~
public## 
string## 4
(CustomValidationAttributeMethodSignature## >
=>##? A
S##B C
[##C D
$str	##D º
]
##º Ω
;
##Ω æ
public%% 
string%% 9
-CustomValidationAttributeTypeConversionFailed%% C
=>%%D F
S%%G H
[%%H I
$str	%%I ú
]
%%ú ù
;
%%ù û
public'' 
string'' 5
)CustomValidationAttributeTypeMustBePublic'' ?
=>''@ B
S''C D
[''D E
$str''E w
]''w x
;''x y
public)) 
string)) 4
(CustomValidationAttributeValidationError)) >
=>))? A
S))B C
[))C D
$str))D W
]))W X
;))X Y
public++ 
string++ :
.CustomValidationAttributeValidatorTypeRequired++ D
=>++E G
S++H I
[++I J
$str	++J ä
]
++ä ã
;
++ã å
public-- 
string-- 0
$DataTypeAttributeEmptyDataTypeString-- :
=>--; =
S--> ?
[--? @
$str--@ u
]--u v
;--v w
public// 
string// *
DisplayAttributePropertyNotSet// 4
=>//5 7
S//8 9
[//9 :
$str	//: Ñ
]
//Ñ Ö
;
//Ö Ü
public11 
string11 (
EmailAddressAttributeInvalid11 2
=>113 5
S116 7
[117 8
$str118 f
]11f g
;11g h
public33 
string33 1
%EnumDataTypeAttributeTypeCannotBeNull33 ;
=>33< >
S33? @
[33@ A
$str33A ~
]33~ 
;	33 Ä
public55 
string55 4
(EnumDataTypeAttributeTypeNeedsToBeAnEnum55 >
=>55? A
S55B C
[55C D
$str55D |
]55| }
;55} ~
public77 
string77 *
FileExtensionsAttributeInvalid77 4
=>775 7
S778 9
[779 :
$str	77: Ä
]
77Ä Å
;
77Å Ç
public99 
string99 /
#LocalizableStringLocalizationFailed99 9
=>99: <
S99= >
[99> ?
$str	99? ﬂ
]
99ﬂ ‡
;
99‡ ·
public;; 
string;; .
"MaxLengthAttributeInvalidMaxLength;; 8
=>;;9 ;
S;;< =
[;;= >
$str	;;> ı
]
;;ı ˆ
;
;;ˆ ˜
public== 
string== -
!MaxLengthAttributeValidationError== 7
=>==8 :
S==; <
[==< =
$str	=== ã
]
==ã å
;
==å ç
public?? 
string?? 1
%MetadataTypeAttributeTypeCannotBeNull?? ;
=>??< >
S??? @
[??@ A
$str??A d
]??d e
;??e f
publicAA 
stringAA .
"MinLengthAttributeInvalidMinLengthAA 8
=>AA9 ;
SAA< =
[AA= >
$str	AA> Ñ
]
AAÑ Ö
;
AAÖ Ü
publicCC 
stringCC -
!MinLengthAttributeValidationErrorCC 7
=>CC8 :
SCC; <
[CC< =
$str	CC= ã
]
CCã å
;
CCå ç
publicEE 
stringEE +
LengthAttributeInvalidValueTypeEE 5
=>EE6 8
SEE9 :
[EE: ;
$strEE; 
]	EE Ä
;
EEÄ Å
publicGG 
stringGG !
PhoneAttributeInvalidGG +
=>GG, .
SGG/ 0
[GG0 1
$strGG1 ]
]GG] ^
;GG^ _
publicII 
stringII 5
)RangeAttributeArbitraryTypeNotIComparableII ?
=>II@ B
SIIC D
[IID E
$strIIE g
]IIg h
;IIh i
publicKK 
stringKK +
RangeAttributeMinGreaterThanMaxKK 5
=>KK6 8
SKK9 :
[KK: ;
$str	KK; é
]
KKé è
;
KKè ê
publicMM 
stringMM *
RangeAttributeMustSetMinAndMaxMM 4
=>MM5 7
SMM8 9
[MM9 :
$strMM: g
]MMg h
;MMh i
publicOO 
stringOO ,
 RangeAttributeMustSetOperandTypeOO 6
=>OO7 9
SOO: ;
[OO; <
$str	OO< è
]
OOè ê
;
OOê ë
publicQQ 
stringQQ )
RangeAttributeValidationErrorQQ 3
=>QQ4 6
SQQ7 8
[QQ8 9
$strQQ9 e
]QQe f
;QQf g
publicSS 
stringSS )
RegexAttributeValidationErrorSS 3
=>SS4 6
SSS7 8
[SS8 9
$strSS9 q
]SSq r
;SSr s
publicUU 
stringUU 2
&RegularExpressionAttributeEmptyPatternUU <
=>UU= ?
SUU@ A
[UUA B
$strUUB z
]UUz {
;UU{ |
publicWW 
stringWW ,
 RequiredAttributeValidationErrorWW 6
=>WW7 9
SWW: ;
[WW; <
$strWW< X
]WWX Y
;WWY Z
publicYY 
stringYY 1
%StringLengthAttributeInvalidMaxLengthYY ;
=>YY< >
SYY? @
[YY@ A
$strYYA t
]YYt u
;YYu v
public[[ 
string[[ 0
$StringLengthAttributeValidationError[[ :
=>[[; =
S[[> ?
[[[? @
$str[[@ ~
][[~ 
;	[[ Ä
public]] 
string]] @
4StringLengthAttributeValidationErrorIncludingMinimum]] J
=>]]K M
S]]N O
[]]O P
$str	]]P ™
]
]]™ ´
;
]]´ ¨
public__ 
string__ ?
3UIHintImplementationControlParameterKeyIsNotAString__ I
=>__J L
S__M N
[__N O
$str	__O ¬
]
__¬ √
;
__√ ƒ
publicaa 
stringaa 9
-UIHintImplementationControlParameterKeyIsNullaa C
=>aaD F
SaaG H
[aaH I
$str	aaI £
]
aa£ §
;
aa§ •
publiccc 
stringcc E
9UIHintImplementationControlParameterKeyOccursMoreThanOncecc O
=>ccP R
SccS T
[ccT U
$str	ccU †
]
cc† °
;
cc° ¢
publicee 
stringee A
5UIHintImplementationNeedEvenNumberOfControlParametersee K
=>eeL N
SeeO P
[eeP Q
$str	eeQ Å
]
eeÅ Ç
;
eeÇ É
publicgg 
stringgg 
UrlAttributeInvalidgg )
=>gg* ,
Sgg- .
[gg. /
$strgg/ v
]ggv w
;ggw x
publicii 
stringii ?
3ValidationAttributeCannotSetErrorMessageAndResourceii I
=>iiJ L
SiiM N
[iiN O
$str	iiO °
]
ii° ¢
;
ii¢ £
publickk 
stringkk 4
(ValidationAttributeIsValidNotImplementedkk >
=>kk? A
SkkB C
[kkC D
$str	kkD Ñ
]
kkÑ Ö
;
kkÖ Ü
publicmm 
stringmm B
6ValidationAttributeNeedBothResourceTypeAndResourceNamemm L
=>mmM O
SmmP Q
[mmQ R
$str	mmR ∞
]
mm∞ ±
;
mm± ≤
publicoo 
stringoo <
0ValidationAttributeResourcePropertyNotStringTypeoo F
=>ooG I
SooJ K
[ooK L
$str	ooL ç
]
ooç é
;
ooé è
publicqq 
stringqq >
2ValidationAttributeResourceTypeDoesNotHavePropertyqq H
=>qqI K
SqqL M
[qqM N
$str	qqN †
]
qq† °
;
qq° ¢
publicss 
stringss .
"ValidationAttributeValidationErrorss 8
=>ss9 ;
Sss< =
[ss= >
$strss> Y
]ssY Z
;ssZ [
publicuu 
stringuu ?
3ValidatorInstanceMustMatchValidationContextInstanceuu I
=>uuJ L
SuuM N
[uuN O
$str	uuO ß
]
uuß ®
;
uu® ©
publicww 
stringww +
ValidatorPropertyValueWrongTypeww 5
=>ww6 8
Sww9 :
[ww: ;
$strww; p
]wwp q
;wwq r
}xx 
}yy ÷£
íD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\DefaultPluralRuleProvider.cs
	namespace 	
OrchardCore
 
. 
Localization "
{ 
public 

class %
DefaultPluralRuleProvider *
:+ ,
IPluralRuleProvider- @
{ 
private 
static 

Dictionary !
<! "
string" (
,( )%
PluralizationRuleDelegate* C
>C D
RulesE J
;J K
static %
DefaultPluralRuleProvider (
(( )
)) *
{ 	
Rules 
= 
new 

Dictionary "
<" #
string# )
,) *%
PluralizationRuleDelegate+ D
>D E
(E F
)F G
;G H
AddRule 
( 
new 
[ 
] 
{ 
$str  
,  !
$str" &
,& '
$str( -
,- .
$str/ 3
,3 4
$str5 9
,9 :
$str; ?
,? @
$strA E
,E F
$strG L
,L M
$strN R
,R S
$strT X
,X Y
$strZ ^
,^ _
$str` d
,d e
$strf j
,j k
$strl p
,p q
$strr v
,v w
$strx |
,| }
$str	~ É
,
É Ñ
$str
Ö â
,
â ä
$str
ã è
,
è ê
$str
ë ï
,
ï ñ
$str
ó õ
,
õ ú
$str
ù °
,
° ¢
$str
£ ß
,
ß ®
$str
© ≠
}
Æ Ø
,
Ø ∞
n
± ≤
=>
≥ µ
$num
∂ ∑
)
∑ ∏
;
∏ π
AddRule 
( 
new 
[ 
] 
{ 
$str !
,! "
$str# '
,' (
$str) -
,- .
$str/ 4
,4 5
$str6 :
,: ;
$str< A
,A B
$strC G
,G H
$strI N
,N O
$strP T
,T U
$strV [
,[ \
$str] a
,a b
$strc g
,g h
$stri m
,m n
$stro v
,v w
$strx |
,| }
$str	~ Ç
,
Ç É
$str
Ñ à
,
à â
$str
ä é
,
é è
$str
ê î
}
ï ñ
,
ñ ó
n
ò ô
=>
ö ú
(
ù û
n
û ü
>
† °
$num
¢ £
?
§ •
$num
¶ ß
:
® ©
$num
™ ´
)
´ ¨
)
¨ ≠
;
≠ Æ
AddRule 
( 
new 
[ 
] 
{ 
$str  
,  !
$str" &
,& '
$str( -
,- .
$str/ 3
,3 4
$str5 :
,: ;
$str< @
,@ A
$strB F
,F G
$strH L
,L M
$strN S
,S T
$strU Y
,Y Z
$str[ _
,_ `
$stra e
,e f
$strg l
,l m
$strn r
,r s
$strt x
,x y
$strz ~
,~ 
$str
Ä Ñ
,
Ñ Ö
$str
Ü ç
,
ç é
$str
è ì
,
ì î
$str
ï ô
,
ô ö
$str
õ ü
,
ü †
$str
° •
,
• ¶
$str
ß ´
,
´ ¨
$str
≠ ≤
,
≤ ≥
$str
¥ ∏
,
∏ π
$str
∫ æ
,
æ ø
$str
¿ ƒ
,
ƒ ≈
$str
∆  
,
  À
$str
Ã –
,
– —
$str
“ ÷
,
÷ ◊
$str
ÿ ›
,
› ﬁ
$str
ﬂ „
,
„ ‰
$str
Â È
,
È Í
$str
Î Ô
,
Ô 
$str
Ò ı
,
ı ˆ
$str
˜ ˚
,
˚ ¸
$str
˝ Å
,
Å Ç
$str
É á
,
á à
$str
â ç
,
ç é
$str
è î
,
î ï
$str
ñ ö
,
ö õ
$str
ú †
,
† °
$str
¢ ß
,
ß ®
$str
© ≠
,
≠ Æ
$str
Ø ¥
,
¥ µ
$str
∂ ª
,
ª º
$str
Ω ¡
,
¡ ¬
$str
√ «
,
« »
$str
… Õ
,
Õ Œ
$str
œ ”
,
” ‘
$str
’ Ÿ
,
Ÿ ⁄
$str
€ ‡
,
‡ ·
$str
‚ Ê
,
Ê Á
$str
Ë Ï
,
Ï Ì
$str
Ó Û
,
Û Ù
$str
ı ˙
,
˙ ˚
$str
¸ Ä
,
Ä Å
$str
Ç Ü
,
Ü á
$str
à å
,
å ç
$str
é í
,
í ì
$str
î ô
,
ô ö
$str
õ †
,
† °
$str
¢ ¶
,
¶ ß
$str
® ¨
,
¨ ≠
$str
Æ ≤
,
≤ ≥
$str
¥ ∏
,
∏ π
$str
∫ ø
,
ø ¿
$str
¡ ≈
,
≈ ∆
$str
« À
,
À Ã
$str
Õ —
,
— “
$str
” ◊
,
◊ ÿ
$str
Ÿ ›
,
› ﬁ
$str
ﬂ „
,
„ ‰
$str
Â È
,
È Í
$str
Î Ô
}
 Ò
,
Ò Ú
n
Û Ù
=>
ı ˜
(
¯ ˘
n
˘ ˙
!=
˚ ˝
$num
˛ ˇ
?
Ä Å
$num
Ç É
:
Ñ Ö
$num
Ü á
)
á à
)
à â
;
â ä
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
n* +
%, -
$num. 0
!=1 3
$num4 5
||6 8
n9 :
%; <
$num= @
==A C
$numD F
?G H
$numI J
:K L
$numM N
)N O
)O P
;P Q
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
n* +
!=, .
$num/ 0
?1 2
$num3 4
:5 6
$num7 8
)8 9
)9 :
;: ;
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
n* +
==, .
$num/ 0
||1 3
n4 5
%6 7
$num8 :
==; =
$num> ?
?@ A
$numB C
:D E
$numF G
)G H
)H I
;I J
AddRule 
( 
new 
[ 
] 
{ 
$str  
,  !
$str" &
,& '
$str( ,
,, -
$str. 2
}3 4
,4 5
n6 7
=>8 :
(; <
n< =
%> ?
$num@ B
==C E
$numF G
&&H J
nK L
%M N
$numO R
!=S U
$numV X
?Y Z
$num[ \
:] ^
n_ `
%a b
$numc e
>=f h
$numi j
&&k m
nn o
%p q
$numr t
<=u w
$numx y
&&z |
(} ~
n~ 
%
Ä Å
$num
Ç Ö
<
Ü á
$num
à ä
||
ã ç
n
é è
%
ê ë
$num
í ï
>=
ñ ò
$num
ô õ
)
õ ú
?
ù û
$num
ü †
:
° ¢
$num
£ §
)
§ •
)
• ¶
;
¶ ß
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
(* +
n+ ,
==- /
$num0 1
)1 2
?3 4
$num5 6
:7 8
(9 :
n: ;
>=< >
$num? @
&&A C
nD E
<=F H
$numI J
)J K
?L M
$numN O
:P Q
$numR S
)S T
)T U
;U V
AddRule 
( 
new 
[ 
] 
{ 
$str !
,! "
$str# '
}( )
,) *
n+ ,
=>- /
(0 1
(1 2
n2 3
==4 6
$num7 8
)8 9
?: ;
$num< =
:> ?
n@ A
%B C
$numD F
>=G I
$numJ K
&&L N
nO P
%Q R
$numS U
<=V X
$numY Z
&&[ ]
(^ _
n_ `
%a b
$numc f
<g h
$numi k
||l n
no p
%q r
$nums v
>=w y
$numz |
)| }
?~ 
$num
Ä Å
:
Ç É
$num
Ñ Ö
)
Ö Ü
)
Ü á
;
á à
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
n* +
%, -
$num. 0
==1 3
$num4 5
&&6 8
n9 :
%; <
$num= @
!=A C
$numD F
?G H
$numI J
:K L
nM N
!=O Q
$numR S
?T U
$numV W
:X Y
$numZ [
)[ \
)\ ]
;] ^
AddRule 
( 
new 
[ 
] 
{ 
$str !
}" #
,# $
n% &
=>' )
(* +
n+ ,
==- /
$num0 1
?2 3
$num4 5
:6 7
n8 9
==: <
$num= >
?? @
$numA B
:C D
$numE F
)F G
)G H
;H I
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
n* +
==, .
$num/ 0
?1 2
$num3 4
:5 6
(7 8
n8 9
==: <
$num= >
||? A
(B C
nC D
%E F
$numG J
>K L
$numM N
&&O Q
nR S
%T U
$numV Y
<Z [
$num\ ^
)^ _
)_ `
?a b
$numc d
:e f
$numg h
)h i
)i j
;j k
AddRule 
( 
new 
[ 
] 
{ 
$str  
}! "
," #
n$ %
=>& (
() *
(* +
n+ ,
==- /
$num0 1
)1 2
?3 4
$num5 6
:7 8
(9 :
n: ;
==< >
$num? @
)@ A
?B C
$numD E
:F G
(H I
nI J
!=K M
$numN O
&&P R
nS T
!=U W
$numX Z
)Z [
?\ ]
$num^ _
:` a
$numb c
)c d
)d e
;e f
AddRule   
(   
new   
[   
]   
{   
$str    
}  ! "
,  " #
n  $ %
=>  & (
(  ) *
(  * +
n  + ,
==  - /
$num  0 1
||  2 4
n  5 6
==  7 9
$num  : <
)  < =
?  > ?
$num  @ A
:  B C
(  D E
n  E F
==  G I
$num  J K
||  L N
n  O P
==  Q S
$num  T V
)  V W
?  X Y
$num  Z [
:  \ ]
(  ^ _
n  _ `
>  a b
$num  c d
&&  e g
n  h i
<  j k
$num  l n
)  n o
?  p q
$num  r s
:  t u
$num  v w
)  w x
)  x y
;  y z
AddRule!! 
(!! 
new!! 
[!! 
]!! 
{!! 
$str!!  
}!!! "
,!!" #
n!!$ %
=>!!& (
(!!) *
(!!* +
n!!+ ,
==!!- /
$num!!0 1
)!!1 2
?!!3 4
$num!!5 6
:!!7 8
(!!9 :
n!!: ;
==!!< >
$num!!? @
)!!@ A
?!!B C
$num!!D E
:!!F G
(!!H I
n!!I J
==!!K M
$num!!N O
)!!O P
?!!Q R
$num!!S T
:!!U V
$num!!W X
)!!X Y
)!!Y Z
;!!Z [
AddRule"" 
("" 
new"" 
["" 
]"" 
{"" 
$str""  
}""! "
,""" #
n""$ %
=>""& (
("") *
n""* +
=="", .
$num""/ 0
?""1 2
$num""3 4
:""5 6
n""7 8
==""9 ;
$num""< =
||""> @
(""A B
n""B C
%""D E
$num""F I
>""J K
$num""L M
&&""N P
n""Q R
%""S T
$num""U X
<""Y Z
$num""[ ]
)""] ^
?""_ `
$num""a b
:""c d
(""e f
n""f g
%""h i
$num""j m
>""n o
$num""p r
&&""s u
n""v w
%""x y
$num""z }
<""~ 
$num
""Ä Ç
)
""Ç É
?
""Ñ Ö
$num
""Ü á
:
""à â
$num
""ä ã
)
""ã å
)
""å ç
;
""ç é
AddRule## 
(## 
new## 
[## 
]## 
{## 
$str##  
}##! "
,##" #
n##$ %
=>##& (
(##) *
n##* +
%##, -
$num##. 1
==##2 4
$num##5 6
?##7 8
$num##9 :
:##; <
n##= >
%##? @
$num##A D
==##E G
$num##H I
?##J K
$num##L M
:##N O
n##P Q
%##R S
$num##T W
==##X Z
$num##[ \
||##] _
n##` a
%##b c
$num##d g
==##h j
$num##k l
?##m n
$num##o p
:##q r
$num##s t
)##t u
)##u v
;##v w
AddRule$$ 
($$ 
new$$ 
[$$ 
]$$ 
{$$ 
$str$$  
,$$  !
$str$$" &
,$$& '
$str$$( ,
}$$- .
,$$. /
n$$0 1
=>$$2 4
($$5 6
n$$6 7
%$$8 9
$num$$: <
==$$= ?
$num$$@ A
&&$$B D
n$$E F
%$$G H
$num$$I L
!=$$M O
$num$$P R
?$$S T
$num$$U V
:$$W X
n$$Y Z
%$$[ \
$num$$] _
>=$$` b
$num$$c d
&&$$e g
n$$h i
%$$j k
$num$$l n
<=$$o q
$num$$r s
&&$$t v
($$w x
n$$x y
%$$z {
$num$$| 
<
$$Ä Å
$num
$$Ç Ñ
||
$$Ö á
n
$$à â
%
$$ä ã
$num
$$å è
>=
$$ê í
$num
$$ì ï
)
$$ï ñ
?
$$ó ò
$num
$$ô ö
:
$$õ ú
$num
$$ù û
)
$$û ü
)
$$ü †
;
$$† °
AddRule%% 
(%% 
new%% 
[%% 
]%% 
{%% 
$str%%  
}%%! "
,%%" #
n%%$ %
=>%%& (
(%%) *
(%%* +
n%%+ ,
==%%- /
$num%%0 1
)%%1 2
?%%3 4
$num%%5 6
:%%7 8
(%%9 :
n%%: ;
>=%%< >
$num%%? @
&&%%A C
n%%D E
<=%%F H
$num%%I J
)%%J K
?%%L M
$num%%N O
:%%P Q
$num%%R S
)%%S T
)%%T U
;%%U V
AddRule&& 
(&& 
new&& 
[&& 
]&& 
{&& 
$str&&  
}&&! "
,&&" #
n&&$ %
=>&&& (
(&&) *
n&&* +
==&&, .
$num&&/ 0
?&&1 2
$num&&3 4
:&&5 6
n&&7 8
==&&9 ;
$num&&< =
?&&> ?
$num&&@ A
:&&B C
(&&D E
n&&E F
>&&G H
$num&&I J
&&&&K M
n&&N O
<&&P Q
$num&&R S
)&&S T
?&&U V
$num&&W X
:&&Y Z
(&&[ \
n&&\ ]
>&&^ _
$num&&` a
&&&&b d
n&&e f
<&&g h
$num&&i k
)&&k l
?&&m n
$num&&o p
:&&q r
$num&&s t
)&&t u
)&&u v
;&&v w
AddRule'' 
('' 
new'' 
['' 
]'' 
{'' 
$str''  
}''! "
,''" #
n''$ %
=>''& (
('') *
n''* +
=='', .
$num''/ 0
?''1 2
$num''3 4
:''5 6
n''7 8
==''9 ;
$num''< =
?''> ?
$num''@ A
:''B C
n''D E
==''F H
$num''I J
?''K L
$num''M N
:''O P
n''Q R
%''S T
$num''U X
>=''Y [
$num''\ ]
&&''^ `
n''a b
%''c d
$num''e h
<=''i k
$num''l n
?''o p
$num''q r
:''s t
n''u v
%''w x
$num''y |
>=''} 
$num
''Ä Ç
?
''É Ñ
$num
''Ö Ü
:
''á à
$num
''â ä
)
''ä ã
)
''ã å
;
''å ç
}(( 	
public++ 
int++ 
Order++ 
=>++ 
$num++ 
;++ 
public.. 
bool.. 

TryGetRule.. 
(.. 
CultureInfo.. *
culture..+ 2
,..2 3
out..4 7%
PluralizationRuleDelegate..8 Q
rule..R V
)..V W
{// 	
var00 
cultureForPlural00  
=00! "
GetBaseCulture00# 1
(001 2
culture002 9
)009 :
;00: ;
if22 
(22 
Rules22 
.22 
TryGetValue22 !
(22! "
cultureForPlural22" 2
.222 3
Name223 7
,227 8
out229 <
rule22= A
)22A B
)22B C
{33 
return44 
true44 
;44 
}55 
return77 
false77 
;77 
}88 	
private:: 
static:: 
void:: 
AddRule:: #
(::# $
string::$ *
[::* +
]::+ ,
cultures::- 5
,::5 6%
PluralizationRuleDelegate::7 P
rule::Q U
)::U V
{;; 	
foreach<< 
(<< 
var<< 
culture<<  
in<<! #
cultures<<$ ,
)<<, -
{== 
Rules>> 
.>> 
Add>> 
(>> 
culture>> !
,>>! "
rule>># '
)>>' (
;>>( )
}?? 
}@@ 	
privateCC 
CultureInfoCC 
GetBaseCultureCC *
(CC* +
CultureInfoCC+ 6
cultureCC7 >
)CC> ?
{DD 	
varEE 
returnCultureEE 
=EE 
cultureEE  '
;EE' (
whileGG 
(GG 
returnCultureGG  
.GG  !
ParentGG! '
.GG' (
NameGG( ,
!=GG- /
$strGG0 2
)GG2 3
{HH 
returnCultureII 
=II 
returnCultureII  -
.II- .
ParentII. 4
;II4 5
}JJ 
returnLL 
returnCultureLL  
;LL  !
}MM 	
}NN 
}OO ˚
´D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\Extensions\LocalizationServiceCollectionExtensions.cs
	namespace 	
	Microsoft
 
. 

Extensions 
. 
DependencyInjection 2
{		 
public 

static 
class 3
'LocalizationServiceCollectionExtensions ?
{ 
public 
static 
IServiceCollection ()
AddPortableObjectLocalization) F
(F G
thisG K
IServiceCollectionL ^
services_ g
)g h
{ 	
return )
AddPortableObjectLocalization 0
(0 1
services1 9
,9 :
null; ?
)? @
;@ A
} 	
public 
static 
IServiceCollection ()
AddPortableObjectLocalization) F
(F G
thisG K
IServiceCollectionL ^
services_ g
,g h
Actioni o
<o p 
LocalizationOptions	p É
>
É Ñ
setupAction
Ö ê
)
ê ë
{ 	
services 
. 
AddSingleton !
<! "
IPluralRuleProvider" 5
,5 6%
DefaultPluralRuleProvider7 P
>P Q
(Q R
)R S
;S T
services   
.   
AddSingleton   !
<  ! " 
ITranslationProvider  " 6
,  6 7'
PoFilesTranslationsProvider  8 S
>  S T
(  T U
)  U V
;  V W
services!! 
.!! 
AddSingleton!! !
<!!! "-
!ILocalizationFileLocationProvider!!" C
,!!C D-
!ContentRootPoFileLocationProvider!!E f
>!!f g
(!!g h
)!!h i
;!!i j
services"" 
."" 
AddSingleton"" !
<""! " 
ILocalizationManager""" 6
,""6 7
LocalizationManager""8 K
>""K L
(""L M
)""M N
;""N O
services## 
.## 
AddSingleton## !
<##! "#
IStringLocalizerFactory##" 9
,##9 :0
$PortableObjectStringLocalizerFactory##; _
>##_ `
(##` a
)##a b
;##b c
services$$ 
.$$ 
AddSingleton$$ !
<$$! "!
IHtmlLocalizerFactory$$" 7
,$$7 8.
"PortableObjectHtmlLocalizerFactory$$9 [
>$$[ \
($$\ ]
)$$] ^
;$$^ _
services%% 
.%% 
TryAddTransient%% $
(%%$ %
typeof%%% +
(%%+ ,
IStringLocalizer%%, <
<%%< =
>%%= >
)%%> ?
,%%? @
typeof%%A G
(%%G H
StringLocalizer%%H W
<%%W X
>%%X Y
)%%Y Z
)%%Z [
;%%[ \
if'' 
('' 
setupAction'' 
!='' 
null'' #
)''# $
{(( 
services)) 
.)) 
	Configure)) "
())" #
setupAction))# .
))). /
;))/ 0
}** 
return,, 
services,, 
;,, 
}-- 	
}.. 
}// å 
åD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\LocalizationManager.cs
	namespace 	
OrchardCore
 
. 
Localization "
{		 
public 

class 
LocalizationManager $
:% & 
ILocalizationManager' ;
{ 
private 
const 
string 
CacheKeyPrefix +
=, -
$str. B
;B C
private 
static %
PluralizationRuleDelegate 0
DefaultPluralRule1 B
=C D
nE F
=>G I
(J K
nK L
!=M O
$numP Q
?R S
$numT U
:V W
$numX Y
)Y Z
;Z [
private 
readonly 
IList 
< 
IPluralRuleProvider 2
>2 3 
_pluralRuleProviders4 H
;H I
private 
readonly  
ITranslationProvider - 
_translationProvider. B
;B C
private 
readonly 
IMemoryCache %
_cache& ,
;, -
public 
LocalizationManager "
(" #
IEnumerable 
< 
IPluralRuleProvider +
>+ ,
pluralRuleProviders- @
,@ A 
ITranslationProvider  
translationProvider! 4
,4 5
IMemoryCache   
cache   
)   
{!! 	 
_pluralRuleProviders""  
=""! "
pluralRuleProviders""# 6
.""6 7
OrderBy""7 >
(""> ?
o""? @
=>""A C
o""D E
.""E F
Order""F K
)""K L
.""L M
ToArray""M T
(""T U
)""U V
;""V W 
_translationProvider##  
=##! "
translationProvider### 6
;##6 7
_cache$$ 
=$$ 
cache$$ 
;$$ 
}%% 	
public(( 
CultureDictionary((  
GetDictionary((! .
(((. /
CultureInfo((/ :
culture((; B
)((B C
{)) 	
var** 
cachedDictionary**  
=**! "
_cache**# )
.**) *
GetOrCreate*** 5
(**5 6
CacheKeyPrefix**6 D
+**E F
culture**G N
.**N O
Name**O S
,**S T
k**U V
=>**W Y
new**Z ]
Lazy**^ b
<**b c
CultureDictionary**c t
>**t u
(**u v
(**v w
)**w x
=>**y {
{++ 
var,, 
rule,, 
=,, 
DefaultPluralRule,, ,
;,,, -
foreach.. 
(.. 
var.. 
provider.. %
in..& ( 
_pluralRuleProviders..) =
)..= >
{// 
if00 
(00 
provider00  
.00  !

TryGetRule00! +
(00+ ,
culture00, 3
,003 4
out005 8
rule009 =
)00= >
)00> ?
{11 
break22 
;22 
}33 
}44 
var66 

dictionary66 
=66  
new66! $
CultureDictionary66% 6
(666 7
culture667 >
.66> ?
Name66? C
,66C D
rule66E I
??66J L
DefaultPluralRule66M ^
)66^ _
;66_ ` 
_translationProvider77 $
.77$ %
LoadTranslations77% 5
(775 6
culture776 =
.77= >
Name77> B
,77B C

dictionary77D N
)77N O
;77O P
return99 

dictionary99 !
;99! "
}:: 
,::  
LazyThreadSafetyMode:: #
.::# $#
ExecutionAndPublication::$ ;
)::; <
)::< =
;::= >
return<< 
cachedDictionary<< #
.<<# $
Value<<$ )
;<<) *
}== 	
}>> 
}?? à
£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\PortableObject\PoFilesTranslationsProvider.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{ 
public		 

class		 '
PoFilesTranslationsProvider		 ,
:		- . 
ITranslationProvider		/ C
{

 
private 
readonly -
!ILocalizationFileLocationProvider :$
_poFilesLocationProvider; S
;S T
private 
readonly 
PoParser !
_parser" )
;) *
public '
PoFilesTranslationsProvider *
(* +-
!ILocalizationFileLocationProvider+ L"
poFileLocationProviderM c
)c d
{ 	$
_poFilesLocationProvider $
=% &"
poFileLocationProvider' =
;= >
_parser 
= 
new 
PoParser "
(" #
)# $
;$ %
} 	
public 
void 
LoadTranslations $
($ %
string% +
cultureName, 7
,7 8
CultureDictionary9 J

dictionaryK U
)U V
{ 	
foreach 
( 
var 
fileInfo !
in" $$
_poFilesLocationProvider% =
.= >
GetLocations> J
(J K
cultureNameK V
)V W
)W X
{  
LoadFileToDictionary $
($ %
fileInfo% -
,- .

dictionary/ 9
)9 :
;: ;
} 
} 	
private!! 
void!!  
LoadFileToDictionary!! )
(!!) *
	IFileInfo!!* 3
fileInfo!!4 <
,!!< =
CultureDictionary!!> O

dictionary!!P Z
)!!Z [
{"" 	
if## 
(## 
fileInfo## 
.## 
Exists## 
&&##  "
!### $
fileInfo##$ ,
.##, -
IsDirectory##- 8
)##8 9
{$$ 
using%% 
(%% 
var%% 
stream%% !
=%%" #
fileInfo%%$ ,
.%%, -
CreateReadStream%%- =
(%%= >
)%%> ?
)%%? @
{&& 
using'' 
('' 
var'' 
reader'' %
=''& '
new''( +
StreamReader'', 8
(''8 9
stream''9 ?
)''? @
)''@ A
{(( 

dictionary)) "
.))" #
MergeTranslations))# 4
())4 5
_parser))5 <
.))< =
Parse))= B
())B C
reader))C I
)))I J
)))J K
;))K L
}** 
}++ 
},, 
}-- 	
}.. 
}// ˜Ç
êD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\PortableObject\PoParser.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{ 
public 

class 
PoParser 
{ 
private 
static 
readonly 

Dictionary  *
<* +
char+ /
,/ 0
char1 5
>5 6
_escapeTranslations7 J
=K L
newM P

DictionaryQ [
<[ \
char\ `
,` a
charb f
>f g
{h i
{ 
$char 
, 
$char 
} 
, 
{ 
$char 
, 
$char 
} 
, 
{ 
$char 
, 
$char 
} 
} 	
;	 

public 
IEnumerable 
< #
CultureDictionaryRecord 2
>2 3
Parse4 9
(9 :

TextReader: D
readerE K
)K L
{ 	
var 
entryBuilder 
= 
new "#
DictionaryRecordBuilder# :
(: ;
); <
;< =
string 
line 
; 
while 
( 
( 
line 
= 
reader !
.! "
ReadLine" *
(* +
)+ ,
), -
!=. 0
null1 5
)5 6
{ 
( 
var 
context 
, 
var !
content" )
)) *
=+ ,
	ParseLine- 6
(6 7
line7 ;
); <
;< =
if!! 
(!! 
context!! 
==!! 
	PoContext!! (
.!!( )
Other!!) .
)!!. /
{"" 
continue## 
;## 
}$$ 
if'' 
('' 
('' 
context'' 
=='' 
	PoContext''  )
.'') *
	MessageId''* 3
||''4 6
context''7 >
==''? A
	PoContext''B K
.''K L
MessageContext''L Z
)''Z [
&&''\ ^
entryBuilder''_ k
.''k l
ShouldFlushRecord''l }
)''} ~
{(( 
yield)) 
return))  
entryBuilder))! -
.))- .
BuildRecordAndReset)). A
())A B
)))B C
;))C D
}** 
entryBuilder,, 
.,, 
Set,,  
(,,  !
context,,! (
,,,( )
content,,* 1
),,1 2
;,,2 3
}-- 
if// 
(// 
entryBuilder// 
.// 
ShouldFlushRecord// .
)//. /
{00 
yield11 
return11 
entryBuilder11 )
.11) *
BuildRecordAndReset11* =
(11= >
)11> ?
;11? @
}22 
}33 	
private55 
string55 
Unescape55 
(55  
string55  &
str55' *
)55* +
{66 	
StringBuilder77 
sb77 
=77 
null77 #
;77# $
var88 
escaped88 
=88 
false88 
;88  
for99 
(99 
var99 
i99 
=99 
$num99 
;99 
i99 
<99 
str99  #
.99# $
Length99$ *
;99* +
i99, -
++99- /
)99/ 0
{:: 
var;; 
c;; 
=;; 
str;; 
[;; 
i;; 
];; 
;;; 
if<< 
(<< 
escaped<< 
)<< 
{== 
if>> 
(>> 
sb>> 
==>> 
null>> "
)>>" #
{?? 
sb@@ 
=@@ 
new@@  
StringBuilder@@! .
(@@. /
str@@/ 2
.@@2 3
Length@@3 9
)@@9 :
;@@: ;
ifAA 
(AA 
iAA 
>AA 
$numAA  !
)AA! "
{BB 
sbCC 
.CC 
AppendCC %
(CC% &
strCC& )
.CC) *
	SubstringCC* 3
(CC3 4
$numCC4 5
,CC5 6
iCC7 8
-CC9 :
$numCC; <
)CC< =
)CC= >
;CC> ?
}DD 
}EE 
charFF 
	unescapedFF "
;FF" #
ifGG 
(GG 
_escapeTranslationsGG +
.GG+ ,
TryGetValueGG, 7
(GG7 8
cGG8 9
,GG9 :
outGG; >
	unescapedGG? H
)GGH I
)GGI J
{HH 
sbII 
.II 
AppendII !
(II! "
	unescapedII" +
)II+ ,
;II, -
}JJ 
elseKK 
{LL 
sbNN 
.NN 
AppendNN !
(NN! "
cNN" #
)NN# $
;NN$ %
}OO 
escapedPP 
=PP 
falsePP #
;PP# $
}QQ 
elseRR 
{SS 
ifTT 
(TT 
cTT 
==TT 
$charTT !
)TT! "
{UU 
escapedVV 
=VV  !
trueVV" &
;VV& '
}WW 
elseXX 
ifXX 
(XX 
sbXX 
!=XX  "
nullXX# '
)XX' (
{YY 
sbZZ 
.ZZ 
AppendZZ !
(ZZ! "
cZZ" #
)ZZ# $
;ZZ$ %
}[[ 
}\\ 
}]] 
return^^ 
sb^^ 
==^^ 
null^^ 
?^^ 
str^^  #
:^^$ %
sb^^& (
.^^( )
ToString^^) 1
(^^1 2
)^^2 3
;^^3 4
}__ 	
privateaa 
stringaa 
	TrimQuoteaa  
(aa  !
stringaa! '
straa( +
)aa+ ,
{bb 	
ifcc 
(cc 
strcc 
.cc 

StartsWithcc 
(cc 
$charcc #
)cc# $
&&cc% '
strcc( +
.cc+ ,
EndsWithcc, 4
(cc4 5
$charcc5 9
)cc9 :
)cc: ;
{dd 
ifee 
(ee 
stree 
.ee 
Lengthee 
==ee !
$numee" #
)ee# $
{ff 
returngg 
$strgg 
;gg 
}hh 
returnjj 
strjj 
.jj 
	Substringjj $
(jj$ %
$numjj% &
,jj& '
strjj( +
.jj+ ,
Lengthjj, 2
-jj3 4
$numjj5 6
)jj6 7
;jj7 8
}kk 
returnmm 
strmm 
;mm 
}nn 	
privatepp 
(pp 
	PoContextpp 
contextpp "
,pp" #
stringpp$ *
contentpp+ 2
)pp2 3
	ParseLinepp4 =
(pp= >
stringpp> D
lineppE I
)ppI J
{qq 	
ifrr 
(rr 
linerr 
.rr 

StartsWithrr 
(rr  
$charrr  $
)rr$ %
)rr% &
{ss 
returntt 
(tt 
	PoContexttt !
.tt! "
Texttt" &
,tt& '
Unescapett( 0
(tt0 1
	TrimQuotett1 :
(tt: ;
linett; ?
.tt? @
Trimtt@ D
(ttD E
)ttE F
)ttF G
)ttG H
)ttH I
;ttI J
}uu 
varww 
keyAndValueww 
=ww 
lineww "
.ww" #
Splitww# (
(ww( )
nullww) -
,ww- .
$numww/ 0
)ww0 1
;ww1 2
ifxx 
(xx 
keyAndValuexx 
.xx 
Lengthxx "
!=xx# %
$numxx& '
)xx' (
{yy 
returnzz 
(zz 
	PoContextzz !
.zz! "
Otherzz" '
,zz' (
stringzz) /
.zz/ 0
Emptyzz0 5
)zz5 6
;zz6 7
}{{ 
var}} 
content}} 
=}} 
Unescape}} "
(}}" #
	TrimQuote}}# ,
(}}, -
keyAndValue}}- 8
[}}8 9
$num}}9 :
]}}: ;
.}}; <
Trim}}< @
(}}@ A
)}}A B
)}}B C
)}}C D
;}}D E
switch~~ 
(~~ 
keyAndValue~~ 
[~~  
$num~~  !
]~~! "
)~~" #
{ 
case
ÄÄ 
$str
ÄÄ 
:
ÄÄ 
return
ÄÄ  &
(
ÄÄ' (
	PoContext
ÄÄ( 1
.
ÄÄ1 2
MessageContext
ÄÄ2 @
,
ÄÄ@ A
content
ÄÄB I
)
ÄÄI J
;
ÄÄJ K
case
ÅÅ 
$str
ÅÅ 
:
ÅÅ 
return
ÅÅ $
(
ÅÅ% &
	PoContext
ÅÅ& /
.
ÅÅ/ 0
	MessageId
ÅÅ0 9
,
ÅÅ9 :
content
ÅÅ; B
)
ÅÅB C
;
ÅÅC D
case
ÇÇ 
var
ÇÇ 
key
ÇÇ 
when
ÇÇ !
key
ÇÇ" %
.
ÇÇ% &

StartsWith
ÇÇ& 0
(
ÇÇ0 1
$str
ÇÇ1 9
,
ÇÇ9 :
StringComparison
ÇÇ; K
.
ÇÇK L
Ordinal
ÇÇL S
)
ÇÇS T
:
ÇÇT U
return
ÇÇV \
(
ÇÇ] ^
	PoContext
ÇÇ^ g
.
ÇÇg h
Translation
ÇÇh s
,
ÇÇs t
content
ÇÇu |
)
ÇÇ| }
;
ÇÇ} ~
default
ÉÉ 
:
ÉÉ 
return
ÉÉ 
(
ÉÉ  !
	PoContext
ÉÉ! *
.
ÉÉ* +
Other
ÉÉ+ 0
,
ÉÉ0 1
content
ÉÉ2 9
)
ÉÉ9 :
;
ÉÉ: ;
}
ÑÑ 
}
ÖÖ 	
private
áá 
class
áá %
DictionaryRecordBuilder
áá -
{
àà 	
private
ââ 
List
ââ 
<
ââ 
string
ââ 
>
ââ  
_values
ââ! (
;
ââ( )
private
ää 
IEnumerable
ää 
<
ää  
string
ää  &
>
ää& '
_validValues
ää( 4
=>
ää5 7
_values
ää8 ?
.
ää? @
Where
ää@ E
(
ääE F
value
ääF K
=>
ääL N
!
ääO P
string
ääP V
.
ääV W
IsNullOrEmpty
ääW d
(
ääd e
value
ääe j
)
ääj k
)
ääk l
;
ääl m
private
ãã 
	PoContext
ãã 
_context
ãã &
;
ãã& '
public
çç 
string
çç 
	MessageId
çç #
{
çç$ %
get
çç& )
;
çç) *
private
çç+ 2
set
çç3 6
;
çç6 7
}
çç8 9
public
éé 
string
éé 
MessageContext
éé (
{
éé) *
get
éé+ .
;
éé. /
private
éé0 7
set
éé8 ;
;
éé; <
}
éé= >
public
êê 
IEnumerable
êê 
<
êê 
string
êê %
>
êê% &
Values
êê' -
=>
êê. 0
_values
êê1 8
;
êê8 9
public
íí 
bool
íí 
IsValid
íí 
=>
íí  "
!
íí# $
string
íí$ *
.
íí* +
IsNullOrEmpty
íí+ 8
(
íí8 9
	MessageId
íí9 B
)
ííB C
&&
ííD F
_validValues
ííG S
.
ííS T
Any
ííT W
(
ííW X
)
ííX Y
;
ííY Z
public
ìì 
bool
ìì 
ShouldFlushRecord
ìì )
=>
ìì* ,
IsValid
ìì- 4
&&
ìì5 7
_context
ìì8 @
==
ììA C
	PoContext
ììD M
.
ììM N
Translation
ììN Y
;
ììY Z
public
ïï %
DictionaryRecordBuilder
ïï *
(
ïï* +
)
ïï+ ,
{
ññ 
_values
óó 
=
óó 
new
óó 
List
óó "
<
óó" #
string
óó# )
>
óó) *
(
óó* +
)
óó+ ,
;
óó, -
}
òò 
public
öö 
void
öö 
Set
öö 
(
öö 
	PoContext
öö %
context
öö& -
,
öö- .
string
öö/ 5
text
öö6 :
)
öö: ;
{
õõ 
switch
úú 
(
úú 
context
úú 
)
úú  
{
ùù 
case
ûû 
	PoContext
ûû "
.
ûû" #
	MessageId
ûû# ,
:
ûû, -
{
üü 
if
¢¢ 
(
¢¢  
string
¢¢  &
.
¢¢& '
IsNullOrEmpty
¢¢' 4
(
¢¢4 5
	MessageId
¢¢5 >
)
¢¢> ?
)
¢¢? @
{
££ 
_values
§§  '
.
§§' (
Clear
§§( -
(
§§- .
)
§§. /
;
§§/ 0
}
•• 
	MessageId
ßß %
=
ßß& '
text
ßß( ,
;
ßß, -
break
®® !
;
®®! "
}
©© 
case
™™ 
	PoContext
™™ "
.
™™" #
MessageContext
™™# 1
:
™™1 2
MessageContext
™™3 A
=
™™B C
text
™™D H
;
™™H I
break
™™J O
;
™™O P
case
´´ 
	PoContext
´´ "
.
´´" #
Translation
´´# .
:
´´. /
_values
´´0 7
.
´´7 8
Add
´´8 ;
(
´´; <
text
´´< @
)
´´@ A
;
´´A B
break
´´C H
;
´´H I
case
¨¨ 
	PoContext
¨¨ "
.
¨¨" #
Text
¨¨# '
:
¨¨' (

AppendText
¨¨) 3
(
¨¨3 4
text
¨¨4 8
)
¨¨8 9
;
¨¨9 :
return
¨¨; A
;
¨¨A B
}
≠≠ 
_context
ØØ 
=
ØØ 
context
ØØ "
;
ØØ" #
}
∞∞ 
private
≤≤ 
void
≤≤ 

AppendText
≤≤ #
(
≤≤# $
string
≤≤$ *
text
≤≤+ /
)
≤≤/ 0
{
≥≥ 
switch
¥¥ 
(
¥¥ 
_context
¥¥  
)
¥¥  !
{
µµ 
case
∂∂ 
	PoContext
∂∂ "
.
∂∂" #
	MessageId
∂∂# ,
:
∂∂, -
	MessageId
∂∂. 7
+=
∂∂8 :
text
∂∂; ?
;
∂∂? @
break
∂∂A F
;
∂∂F G
case
∑∑ 
	PoContext
∑∑ "
.
∑∑" #
MessageContext
∑∑# 1
:
∑∑1 2
MessageContext
∑∑3 A
+=
∑∑B D
text
∑∑E I
;
∑∑I J
break
∑∑K P
;
∑∑P Q
case
∏∏ 
	PoContext
∏∏ "
.
∏∏" #
Translation
∏∏# .
:
∏∏. /
if
ππ 
(
ππ 
_values
ππ #
.
ππ# $
Count
ππ$ )
>
ππ* +
$num
ππ, -
)
ππ- .
{
∫∫ 
_values
ªª #
[
ªª# $
_values
ªª$ +
.
ªª+ ,
Count
ªª, 1
-
ªª2 3
$num
ªª4 5
]
ªª5 6
+=
ªª7 9
text
ªª: >
;
ªª> ?
}
ºº 
break
ΩΩ 
;
ΩΩ 
}
ææ 
}
øø 
public
¡¡ %
CultureDictionaryRecord
¡¡ *!
BuildRecordAndReset
¡¡+ >
(
¡¡> ?
)
¡¡? @
{
¬¬ 
if
√√ 
(
√√ 
!
√√ 
IsValid
√√ 
)
√√ 
{
ƒƒ 
return
≈≈ 
null
≈≈ 
;
≈≈  
}
∆∆ 
var
»» 
result
»» 
=
»» 
new
»»  %
CultureDictionaryRecord
»»! 8
(
»»8 9
	MessageId
»»9 B
,
»»B C
MessageContext
»»D R
,
»»R S
_validValues
»»T `
.
»»` a
ToArray
»»a h
(
»»h i
)
»»i j
)
»»j k
;
»»k l
	MessageId
   
=
   
null
    
;
    !
MessageContext
ÀÀ 
=
ÀÀ  
null
ÀÀ! %
;
ÀÀ% &
_values
ÃÃ 
.
ÃÃ 
Clear
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ  
return
ŒŒ 
result
ŒŒ 
;
ŒŒ 
}
œœ 
}
–– 	
private
““ 
enum
““ 
	PoContext
““ 
{
”” 	
	MessageId
‘‘ 
,
‘‘ 
MessageContext
’’ 
,
’’ 
Translation
÷÷ 
,
÷÷ 
Text
◊◊ 
,
◊◊ 
Other
ÿÿ 
}
ŸŸ 	
}
⁄⁄ 
}€€ †
£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\PortableObject\PortableObjectHtmlLocalizer.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{ 
public		 

class		 '
PortableObjectHtmlLocalizer		 ,
:		- .
HtmlLocalizer		/ <
{

 
private 
readonly 
IStringLocalizer )

_localizer* 4
;4 5
public '
PortableObjectHtmlLocalizer *
(* +
IStringLocalizer+ ;
	localizer< E
)E F
:G H
baseI M
(M N
	localizerN W
)W X
{ 	

_localizer 
= 
	localizer "
;" #
} 	
public 
override 
LocalizedHtmlString +
this, 0
[0 1
string1 7
name8 <
]< =
=> 
ToHtmlString 
( 

_localizer &
[& '
name' +
]+ ,
), -
;- .
public 
override 
LocalizedHtmlString +
this, 0
[0 1
string1 7
name8 <
,< =
params> D
objectE K
[K L
]L M
	argumentsN W
]W X
{ 	
get 
{ 
if)) 
()) 

_localizer)) 
is)) !"
IPluralStringLocalizer))" 8
pluralLocalizer))9 H
&&))I K
	arguments))L U
.))U V
Length))V \
==))] _
$num))` a
&&))b d
	arguments))e n
[))n o
$num))o p
]))p q
is))r t"
PluralizationArgument	))u ä
pluralArgument
))ã ô
)
))ô ö
{** 
var,, 
(,, 
translation,, $
,,,$ %
argumentsWithCount,,& 8
),,8 9
=,,: ;
pluralLocalizer,,< K
.,,K L
GetTranslation,,L Z
(,,Z [
name,,[ _
,,,_ `
	arguments,,a j
),,j k
;,,k l
return// 
ToHtmlString// '
(//' (
translation//( 3
,//3 4
argumentsWithCount//5 G
)//G H
;//H I
}00 
return22 
ToHtmlString22 #
(22# $

_localizer22$ .
[22. /
name22/ 3
]223 4
,224 5
	arguments226 ?
)22? @
;22@ A
}33 
}44 	
}55 
}66 ›
™D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\PortableObject\PortableObjectHtmlLocalizerFactory.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{ 
public

 

class

 .
"PortableObjectHtmlLocalizerFactory

 3
:

4 5!
IHtmlLocalizerFactory

6 K
{ 
private 
readonly #
IStringLocalizerFactory 0#
_stringLocalizerFactory1 H
;H I
public .
"PortableObjectHtmlLocalizerFactory 1
(1 2#
IStringLocalizerFactory2 I"
stringLocalizerFactoryJ `
)` a
{ 	#
_stringLocalizerFactory #
=$ %"
stringLocalizerFactory& <
;< =
} 	
public 
IHtmlLocalizer 
Create $
($ %
Type% )
resourceSource* 8
)8 9
{ 	
return 
new '
PortableObjectHtmlLocalizer 2
(2 3#
_stringLocalizerFactory3 J
.J K
CreateK Q
(Q R
resourceSourceR `
)` a
)a b
;b c
} 	
public 
IHtmlLocalizer 
Create $
($ %
string% +
baseName, 4
,4 5
string6 <
location= E
)E F
{ 	
var   
index   
=   
$num   
;   
if!! 
(!! 
baseName!! 
.!! 

StartsWith!! #
(!!# $
location!!$ ,
,!!, -
StringComparison!!. >
.!!> ?
OrdinalIgnoreCase!!? P
)!!P Q
)!!Q R
{"" 
index## 
=## 
location##  
.##  !
Length##! '
;##' (
}$$ 
if&& 
(&& 
baseName&& 
.&& 
Length&& 
>&&  !
index&&" '
&&&&( *
baseName&&+ 3
[&&3 4
index&&4 9
]&&9 :
==&&; =
$char&&> A
)&&A B
{'' 
index(( 
+=(( 
$num(( 
;(( 
})) 
if++ 
(++ 
baseName++ 
.++ 
Length++ 
>++  !
index++" '
&&++( *
baseName+++ 3
.++3 4
IndexOf++4 ;
(++; <
$str++< D
,++D E
index++F K
,++K L
StringComparison++M ]
.++] ^
Ordinal++^ e
)++e f
==++g i
index++j o
)++o p
{,, 
index-- 
+=-- 
$str-- !
.--! "
Length--" (
;--( )
}.. 
var00 
relativeName00 
=00 
baseName00 '
.00' (
	Substring00( 1
(001 2
index002 7
)007 8
;008 9
return22 
new22 '
PortableObjectHtmlLocalizer22 2
(222 3#
_stringLocalizerFactory223 J
.22J K
Create22K Q
(22Q R
baseName22R Z
,22Z [
location22\ d
)22d e
)22e f
;22f g
}33 	
}44 
}55 ¬á
•D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\PortableObject\PortableObjectStringLocalizer.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{		 
public 

class )
PortableObjectStringLocalizer .
:/ 0"
IPluralStringLocalizer1 G
{ 
private 
readonly  
ILocalizationManager - 
_localizationManager. B
;B C
private 
readonly 
bool $
_fallBackToParentCulture 6
;6 7
private 
readonly 
ILogger  
_logger! (
;( )
private 
string 
_context 
;  
public )
PortableObjectStringLocalizer ,
(, -
string 
context 
,  
ILocalizationManager  
localizationManager! 4
,4 5
bool #
fallBackToParentCulture (
,( )
ILogger 
logger 
) 
{   	
_context!! 
=!! 
context!! 
;!!  
_localizationManager""  
=""! "
localizationManager""# 6
;""6 7$
_fallBackToParentCulture## $
=##% &#
fallBackToParentCulture##' >
;##> ?
_logger$$ 
=$$ 
logger$$ 
;$$ 
}%% 	
public(( 
LocalizedString(( 
this(( #
[((# $
string(($ *
name((+ /
]((/ 0
{)) 	
get** 
{++ 
if,, 
(,, 
name,, 
==,, 
null,,  
),,  !
{-- 
throw.. 
new.. !
ArgumentNullException.. 3
(..3 4
nameof..4 :
(..: ;
name..; ?
)..? @
)..@ A
;..A B
}// 
var11 
translation11 
=11  !
GetTranslation11" 0
(110 1
name111 5
,115 6
_context117 ?
,11? @
CultureInfo11A L
.11L M
CurrentUICulture11M ]
,11] ^
null11_ c
)11c d
;11d e
return33 
new33 
LocalizedString33 *
(33* +
name33+ /
,33/ 0
translation331 <
??33= ?
name33@ D
,33D E
translation33F Q
==33R T
null33U Y
)33Y Z
;33Z [
}44 
}55 	
public88 
LocalizedString88 
this88 #
[88# $
string88$ *
name88+ /
,88/ 0
params881 7
object888 >
[88> ?
]88? @
	arguments88A J
]88J K
{99 	
get:: 
{;; 
var<< 
(<< 
translation<<  
,<<  !
argumentsWithCount<<" 4
)<<4 5
=<<6 7
GetTranslation<<8 F
(<<F G
name<<G K
,<<K L
	arguments<<M V
)<<V W
;<<W X
var== 
	formatted== 
=== 
string==  &
.==& '
Format==' -
(==- .
translation==. 9
.==9 :
Value==: ?
,==? @
argumentsWithCount==A S
)==S T
;==T U
return?? 
new?? 
LocalizedString?? *
(??* +
name??+ /
,??/ 0
	formatted??1 :
,??: ;
translation??< G
.??G H
ResourceNotFound??H X
)??X Y
;??Y Z
}@@ 
}AA 	
publicDD 
IEnumerableDD 
<DD 
LocalizedStringDD *
>DD* +
GetAllStringsDD, 9
(DD9 :
boolDD: >!
includeParentCulturesDD? T
)DDT U
{EE 	
varFF 
cultureFF 
=FF 
CultureInfoFF %
.FF% &
CurrentUICultureFF& 6
;FF6 7
returnHH !
includeParentCulturesHH (
?II -
!GetAllStringsFromCultureHierarchyII 3
(II3 4
cultureII4 ;
)II; <
:JJ 
GetAllStringsJJ 
(JJ  
cultureJJ  '
)JJ' (
;JJ( )
}KK 	
[MM 	
ObsoleteMM	 
(MM 
$strMM [
)MM[ \
]MM\ ]
publicNN 
IStringLocalizerNN 
WithCultureNN  +
(NN+ ,
CultureInfoNN, 7
cultureNN8 ?
)NN? @
=>NNA C
thisNND H
;NNH I
publicQQ 
(QQ 
LocalizedStringQQ 
,QQ  
objectQQ! '
[QQ' (
]QQ( )
)QQ) *
GetTranslationQQ+ 9
(QQ9 :
stringQQ: @
nameQQA E
,QQE F
paramsQQG M
objectQQN T
[QQT U
]QQU V
	argumentsQQW `
)QQ` a
{RR 	
ifSS 
(SS 
nameSS 
==SS 
nullSS 
)SS 
{TT 
throwUU 
newUU !
ArgumentNullExceptionUU /
(UU/ 0
nameofUU0 6
(UU6 7
nameUU7 ;
)UU; <
)UU< =
;UU= >
}VV 
ifYY 
(YY 
	argumentsYY 
.YY 
LengthYY  
==YY! #
$numYY$ %
&&YY& (
	argumentsYY) 2
[YY2 3
$numYY3 4
]YY4 5
isYY6 8!
PluralizationArgumentYY9 N
pluralArgumentYYO ]
)YY] ^
{ZZ 
var[[ 
translation[[ 
=[[  !
GetTranslation[[" 0
([[0 1
name[[1 5
,[[5 6
_context[[7 ?
,[[? @
CultureInfo[[A L
.[[L M
CurrentUICulture[[M ]
,[[] ^
pluralArgument[[_ m
.[[m n
Count[[n s
)[[s t
;[[t u
object]] 
[]] 
]]] 
argumentsWithCount]] +
;]]+ ,
if__ 
(__ 
pluralArgument__ "
.__" #
	Arguments__# ,
.__, -
Length__- 3
>__4 5
$num__6 7
)__7 8
{`` 
argumentsWithCountaa &
=aa' (
newaa) ,
objectaa- 3
[aa3 4
pluralArgumentaa4 B
.aaB C
	ArgumentsaaC L
.aaL M
LengthaaM S
+aaT U
$numaaV W
]aaW X
;aaX Y
argumentsWithCountbb &
[bb& '
$numbb' (
]bb( )
=bb* +
pluralArgumentbb, :
.bb: ;
Countbb; @
;bb@ A
Arraycc 
.cc 
Copycc 
(cc 
pluralArgumentcc -
.cc- .
	Argumentscc. 7
,cc7 8
$numcc9 :
,cc: ;
argumentsWithCountcc< N
,ccN O
$numccP Q
,ccQ R
pluralArgumentccS a
.cca b
	Argumentsccb k
.cck l
Lengthccl r
)ccr s
;ccs t
}dd 
elseee 
{ff 
argumentsWithCountgg &
=gg' (
newgg) ,
objectgg- 3
[gg3 4
]gg4 5
{gg6 7
pluralArgumentgg8 F
.ggF G
CountggG L
}ggM N
;ggN O
}hh 
translationjj 
=jj 
translationjj )
??jj* ,
GetTranslationjj- ;
(jj; <
pluralArgumentjj< J
.jjJ K
FormsjjK P
,jjP Q
CultureInfojjR ]
.jj] ^
CurrentUICulturejj^ n
,jjn o
pluralArgumentjjp ~
.jj~ 
Count	jj Ñ
)
jjÑ Ö
;
jjÖ Ü
returnll 
(ll 
newll 
LocalizedStringll +
(ll+ ,
namell, 0
,ll0 1
translationll2 =
,ll= >
translationll? J
==llK M
nullllN R
)llR S
,llS T
argumentsWithCountllU g
)llg h
;llh i
}mm 
elsenn 
{oo 
varpp 
translationpp 
=pp  !
thispp" &
[pp& '
namepp' +
]pp+ ,
;pp, -
returnqq 
(qq 
newqq 
LocalizedStringqq +
(qq+ ,
nameqq, 0
,qq0 1
translationqq2 =
,qq= >
translationqq? J
.qqJ K
ResourceNotFoundqqK [
)qq[ \
,qq\ ]
	argumentsqq^ g
)qqg h
;qqh i
}rr 
}ss 	
privateuu 
IEnumerableuu 
<uu 
LocalizedStringuu +
>uu+ ,
GetAllStringsuu- :
(uu: ;
CultureInfouu; F
cultureuuG N
)uuN O
{vv 	
varww 

dictionaryww 
=ww  
_localizationManagerww 1
.ww1 2
GetDictionaryww2 ?
(ww? @
cultureww@ G
)wwG H
;wwH I
foreachyy 
(yy 
varyy 
translationyy $
inyy% '

dictionaryyy( 2
.yy2 3
Translationsyy3 ?
)yy? @
{zz 
yield{{ 
return{{ 
new{{  
LocalizedString{{! 0
({{0 1
translation{{1 <
.{{< =
Key{{= @
,{{@ A
translation{{B M
.{{M N
Value{{N S
.{{S T
FirstOrDefault{{T b
({{b c
){{c d
){{d e
;{{e f
}|| 
}}} 	
private 
IEnumerable 
< 
LocalizedString +
>+ ,-
!GetAllStringsFromCultureHierarchy- N
(N O
CultureInfoO Z
culture[ b
)b c
{
ÄÄ 	
var
ÅÅ 
currentCulture
ÅÅ 
=
ÅÅ  
culture
ÅÅ! (
;
ÅÅ( )
var
ÇÇ !
allLocalizedStrings
ÇÇ #
=
ÇÇ$ %
new
ÇÇ& )
List
ÇÇ* .
<
ÇÇ. /
LocalizedString
ÇÇ/ >
>
ÇÇ> ?
(
ÇÇ? @
)
ÇÇ@ A
;
ÇÇA B
do
ÑÑ 
{
ÖÖ 
var
ÜÜ 
localizedStrings
ÜÜ $
=
ÜÜ% &
GetAllStrings
ÜÜ' 4
(
ÜÜ4 5
currentCulture
ÜÜ5 C
)
ÜÜC D
;
ÜÜD E
if
àà 
(
àà 
localizedStrings
àà $
!=
àà% '
null
àà( ,
)
àà, -
{
ââ 
foreach
ää 
(
ää 
var
ää  
localizedString
ää! 0
in
ää1 3
localizedStrings
ää4 D
)
ääD E
{
ãã 
if
åå 
(
åå 
!
åå !
allLocalizedStrings
åå 0
.
åå0 1
Any
åå1 4
(
åå4 5
ls
åå5 7
=>
åå8 :
ls
åå; =
.
åå= >
Name
åå> B
==
ååC E
localizedString
ååF U
.
ååU V
Name
ååV Z
)
ååZ [
)
åå[ \
{
çç !
allLocalizedStrings
éé /
.
éé/ 0
Add
éé0 3
(
éé3 4
localizedString
éé4 C
)
ééC D
;
ééD E
}
èè 
}
êê 
}
ëë 
currentCulture
ìì 
=
ìì  
currentCulture
ìì! /
.
ìì/ 0
Parent
ìì0 6
;
ìì6 7
}
îî 
while
îî 
(
îî 
currentCulture
îî #
!=
îî$ &
currentCulture
îî' 5
.
îî5 6
Parent
îî6 <
)
îî< =
;
îî= >
return
ññ !
allLocalizedStrings
ññ &
;
ññ& '
}
óó 	
private
ôô 
string
ôô 
GetTranslation
ôô %
(
ôô% &
string
ôô& ,
[
ôô, -
]
ôô- .
pluralForms
ôô/ :
,
ôô: ;
CultureInfo
ôô< G
culture
ôôH O
,
ôôO P
int
ôôQ T
?
ôôT U
count
ôôV [
)
ôô[ \
{
öö 	
var
õõ 

dictionary
õõ 
=
õõ "
_localizationManager
õõ 1
.
õõ1 2
GetDictionary
õõ2 ?
(
õõ? @
culture
õõ@ G
)
õõG H
;
õõH I
var
ùù 

pluralForm
ùù 
=
ùù 
count
ùù "
.
ùù" #
HasValue
ùù# +
?
ùù, -

dictionary
ùù. 8
.
ùù8 9

PluralRule
ùù9 C
(
ùùC D
count
ùùD I
.
ùùI J
Value
ùùJ O
)
ùùO P
:
ùùQ R
$num
ùùS T
;
ùùT U
if
üü 
(
üü 

pluralForm
üü 
>=
üü 
pluralForms
üü )
.
üü) *
Length
üü* 0
)
üü0 1
{
†† 
if
°° 
(
°° 
_logger
°° 
.
°° 
	IsEnabled
°° %
(
°°% &
LogLevel
°°& .
.
°°. /
Warning
°°/ 6
)
°°6 7
)
°°7 8
{
¢¢ 
_logger
££ 
.
££ 

LogWarning
££ &
(
££& '
$str££' ¨
,££¨ ≠

pluralForm££Æ ∏
,££∏ π
String££∫ ¿
.££¿ ¡
Join££¡ ≈
(££≈ ∆
$str££∆  
,££  À
pluralForms££Ã ◊
)££◊ ÿ
)££ÿ Ÿ
;££Ÿ ⁄
}
§§ 
return
ßß 
pluralForms
ßß "
[
ßß" #
pluralForms
ßß# .
.
ßß. /
Length
ßß/ 5
-
ßß6 7
$num
ßß8 9
]
ßß9 :
;
ßß: ;
}
®® 
return
™™ 
pluralForms
™™ 
[
™™ 

pluralForm
™™ )
]
™™) *
;
™™* +
}
´´ 	
private
≠≠ 
string
≠≠ 
GetTranslation
≠≠ %
(
≠≠% &
string
≠≠& ,
name
≠≠- 1
,
≠≠1 2
string
≠≠3 9
context
≠≠: A
,
≠≠A B
CultureInfo
≠≠C N
culture
≠≠O V
,
≠≠V W
int
≠≠X [
?
≠≠[ \
count
≠≠] b
)
≠≠b c
{
ÆÆ 	
string
ØØ 
translation
ØØ 
=
ØØ  
null
ØØ! %
;
ØØ% &
try
∞∞ 
{
±± 
if
≤≤ 
(
≤≤ &
_fallBackToParentCulture
≤≤ ,
)
≤≤, -
{
≥≥ 
do
¥¥ 
{
µµ 
if
∂∂ 
(
∂∂  
ExtractTranslation
∂∂ .
(
∂∂. /
)
∂∂/ 0
!=
∂∂1 3
null
∂∂4 8
)
∂∂8 9
{
∑∑ 
break
∏∏ !
;
∏∏! "
}
ππ 
culture
ªª 
=
ªª  !
culture
ªª" )
.
ªª) *
Parent
ªª* 0
;
ªª0 1
}
ºº 
while
ΩΩ 
(
ΩΩ 
culture
ΩΩ "
!=
ΩΩ# %
CultureInfo
ΩΩ& 1
.
ΩΩ1 2
InvariantCulture
ΩΩ2 B
)
ΩΩB C
;
ΩΩC D
}
ææ 
else
øø 
{
¿¿  
ExtractTranslation
¡¡ &
(
¡¡& '
)
¡¡' (
;
¡¡( )
}
¬¬ 
string
ƒƒ  
ExtractTranslation
ƒƒ )
(
ƒƒ) *
)
ƒƒ* +
{
≈≈ 
var
∆∆ 

dictionary
∆∆ "
=
∆∆# $"
_localizationManager
∆∆% 9
.
∆∆9 :
GetDictionary
∆∆: G
(
∆∆G H
culture
∆∆H O
)
∆∆O P
;
∆∆P Q
if
»» 
(
»» 

dictionary
»» "
!=
»»# %
null
»»& *
)
»»* +
{
…… 
var
ÀÀ 
key
ÀÀ 
=
ÀÀ  !%
CultureDictionaryRecord
ÀÀ" 9
.
ÀÀ9 :
GetKey
ÀÀ: @
(
ÀÀ@ A
name
ÀÀA E
,
ÀÀE F
context
ÀÀG N
)
ÀÀN O
;
ÀÀO P
translation
ÃÃ #
=
ÃÃ$ %

dictionary
ÃÃ& 0
[
ÃÃ0 1
key
ÃÃ1 4
,
ÃÃ4 5
count
ÃÃ6 ;
]
ÃÃ; <
;
ÃÃ< =
if
ŒŒ 
(
ŒŒ 
context
ŒŒ #
!=
ŒŒ$ &
null
ŒŒ' +
&&
ŒŒ, .
translation
ŒŒ/ :
==
ŒŒ; =
null
ŒŒ> B
)
ŒŒB C
{
œœ 
key
—— 
=
——  !%
CultureDictionaryRecord
——" 9
.
——9 :
GetKey
——: @
(
——@ A
name
——A E
,
——E F
null
——G K
)
——K L
;
——L M
translation
““ '
=
““( )

dictionary
““* 4
[
““4 5
key
““5 8
,
““8 9
count
““: ?
]
““? @
;
““@ A
}
”” 
}
‘‘ 
return
÷÷ 
translation
÷÷ &
;
÷÷& '
}
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ )
PluralFormNotFoundException
ŸŸ .
ex
ŸŸ/ 1
)
ŸŸ1 2
{
⁄⁄ 
_logger
€€ 
.
€€ 

LogWarning
€€ "
(
€€" #
ex
€€# %
.
€€% &
Message
€€& -
)
€€- .
;
€€. /
}
‹‹ 
return
ﬁﬁ 
translation
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 	
}
‡‡ 
}·· ı*
¨D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Localization.Core\PortableObject\PortableObjectStringLocalizerFactory.cs
	namespace 	
OrchardCore
 
. 
Localization "
." #
PortableObject# 1
{ 
public 

class 0
$PortableObjectStringLocalizerFactory 5
:6 7#
IStringLocalizerFactory8 O
{ 
private 
readonly  
ILocalizationManager - 
_localizationManager. B
;B C
private 
readonly 
bool $
_fallBackToParentCulture 6
;6 7
private 
readonly 
ILogger  
_logger! (
;( )
public 0
$PortableObjectStringLocalizerFactory 3
(3 4 
ILocalizationManager  
localizationManager! 4
,4 5
IOptions 
< &
RequestLocalizationOptions /
>/ 0&
requestLocalizationOptions1 K
,K L
ILogger 
< 0
$PortableObjectStringLocalizerFactory 8
>8 9
logger: @
)@ A
{ 	 
_localizationManager  
=! "
localizationManager# 6
;6 7$
_fallBackToParentCulture $
=% &&
requestLocalizationOptions' A
.A B
ValueB G
.G H&
FallBackToParentUICulturesH b
;b c
_logger 
= 
logger 
; 
}   	
public## 
IStringLocalizer## 
Create##  &
(##& '
Type##' +
resourceSource##, :
)##: ;
{$$ 	
var%% 
resourceFullName%%  
=%%! "
resourceSource%%# 1
.%%1 2
FullName%%2 :
;%%: ;
resourceFullName&& 
=&&  
TryFixInnerClassPath&& 3
(&&3 4
resourceFullName&&4 D
)&&D E
;&&E F
return(( 
new(( )
PortableObjectStringLocalizer(( 4
(((4 5
resourceFullName((5 E
,((E F 
_localizationManager((G [
,(([ \$
_fallBackToParentCulture((] u
,((u v
_logger((w ~
)((~ 
;	(( Ä
})) 	
public,, 
IStringLocalizer,, 
Create,,  &
(,,& '
string,,' -
baseName,,. 6
,,,6 7
string,,8 >
location,,? G
),,G H
{-- 	
baseName.. 
=..  
TryFixInnerClassPath.. +
(..+ ,
baseName.., 4
)..4 5
;..5 6
var00 
index00 
=00 
$num00 
;00 
if11 
(11 
baseName11 
.11 

StartsWith11 #
(11# $
location11$ ,
,11, -
StringComparison11. >
.11> ?
OrdinalIgnoreCase11? P
)11P Q
)11Q R
{22 
index33 
=33 
location33  
.33  !
Length33! '
;33' (
}44 
if66 
(66 
baseName66 
.66 
Length66 
>66  !
index66" '
&&66( *
baseName66+ 3
[663 4
index664 9
]669 :
==66; =
$char66> A
)66A B
{77 
index88 
+=88 
$num88 
;88 
}99 
if;; 
(;; 
baseName;; 
.;; 
Length;; 
>;;  !
index;;" '
&&;;( *
baseName;;+ 3
.;;3 4
IndexOf;;4 ;
(;;; <
$str;;< D
,;;D E
index;;F K
,;;K L
StringComparison;;M ]
.;;] ^
Ordinal;;^ e
);;e f
==;;g i
index;;j o
);;o p
{<< 
index== 
+=== 
$str== !
.==! "
Length==" (
;==( )
}>> 
var@@ 
relativeName@@ 
=@@ 
baseName@@ '
.@@' (
	Substring@@( 1
(@@1 2
index@@2 7
)@@7 8
;@@8 9
returnBB 
newBB )
PortableObjectStringLocalizerBB 4
(BB4 5
relativeNameBB5 A
,BBA B 
_localizationManagerBBC W
,BBW X$
_fallBackToParentCultureBBY q
,BBq r
_loggerBBs z
)BBz {
;BB{ |
}CC 	
privateFF 
stringFF  
TryFixInnerClassPathFF +
(FF+ ,
stringFF, 2
contextFF3 :
)FF: ;
{GG 	
constHH 
charHH 
innerClassSeparatorHH *
=HH+ ,
$charHH- 0
;HH0 1
varII 
pathII 
=II 
contextII 
;II 
ifJJ 
(JJ 
contextJJ 
.JJ 
ContainsJJ  
(JJ  !
innerClassSeparatorJJ! 4
)JJ4 5
)JJ5 6
{KK 
pathLL 
=LL 
contextLL 
.LL 
ReplaceLL &
(LL& '
innerClassSeparatorLL' :
,LL: ;
$charLL< ?
)LL? @
;LL@ A
}MM 
returnOO 
pathOO 
;OO 
}PP 	
}QQ 
}RR 