Ê
ÉD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\AdminMenu.cs
	namespace 	
OrchardCore
 
. 

Placements  
{ 
public 

class 
	AdminMenu 
: 
INavigationProvider 0
{		 
private

 
readonly

 
IStringLocalizer

 )
S

* +
;

+ ,
public 
	AdminMenu 
( 
IStringLocalizer )
<) *
	AdminMenu* 3
>3 4
	localizer5 >
)> ?
{ 	
S 
= 
	localizer 
; 
} 	
public 
Task  
BuildNavigationAsync (
(( )
string) /
name0 4
,4 5
NavigationBuilder6 G
builderH O
)O P
{ 	
if 
( 
! 
String 
. 
Equals 
( 
name #
,# $
$str% ,
,, -
StringComparison. >
.> ?
OrdinalIgnoreCase? P
)P Q
)Q R
{ 
return 
Task 
. 
CompletedTask )
;) *
} 
builder 
. 
Add 
( 
S 
[ 
$str 
]  
,  !
design" (
=>) +
design, 2
. 
Add 
( 
S 
[ 
$str '
]' (
,( )
$str* 6
,6 7
import8 >
=>? A
importB H
. 
Action 
(  
$str  '
,' (
$str) 0
,0 1
new2 5
{6 7
area8 <
== >
$str? W
}X Y
)Y Z
. 

Permission #
(# $
Permissions$ /
./ 0
ManagePlacements0 @
)@ A
. 
LocalNav !
(! "
)" #
) 
) 
; 
return!! 
Task!! 
.!! 
CompletedTask!! %
;!!% &
}"" 	
}## 
}$$ “˘
ïD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Controllers\AdminController.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Controllers! ,
{ 
public 

class 
AdminController  
:! "

Controller# -
{ 
private 
readonly 
ILogger  
_logger! (
;( )
private 
readonly !
IAuthorizationService .!
_authorizationService/ D
;D E
private 
readonly 
PlacementsManager *
_placementsManager+ =
;= >
private 
readonly 
IHtmlLocalizer '
H( )
;) *
private 
readonly 
IStringLocalizer )
S* +
;+ ,
private   
readonly   
	INotifier   "
	_notifier  # ,
;  , -
private!! 
readonly!! 
ISiteService!! %
_siteService!!& 2
;!!2 3
private"" 
readonly"" 
dynamic""  
New""! $
;""$ %
public$$ 
AdminController$$ 
($$ 
ILogger%% 
<%% 
AdminController%% #
>%%# $
logger%%% +
,%%+ ,!
IAuthorizationService&& ! 
authorizationService&&" 6
,&&6 7
PlacementsManager'' 
placementsManager'' /
,''/ 0
IHtmlLocalizer(( 
<(( 
AdminController(( *
>((* +
htmlLocalizer((, 9
,((9 :
IStringLocalizer)) 
<)) 
AdminController)) ,
>)), -
stringLocalizer)). =
,))= >
	INotifier** 
notifier** 
,** 
ISiteService++ 
siteService++ $
,++$ %
IShapeFactory,, 
shapeFactory,, &
),,& '
{-- 	
_logger.. 
=.. 
logger.. 
;.. !
_authorizationService// !
=//" # 
authorizationService//$ 8
;//8 9
_placementsManager00 
=00  
placementsManager00! 2
;002 3
	_notifier11 
=11 
notifier11  
;11  !
_siteService22 
=22 
siteService22 &
;22& '
New44 
=44 
shapeFactory44 
;44 
H55 
=55 
htmlLocalizer55 
;55 
S66 
=66 
stringLocalizer66 
;66  
}77 	
public99 
async99 
Task99 
<99 
IActionResult99 '
>99' (
Index99) .
(99. /
ContentOptions99/ =
options99> E
,99E F
PagerParameters99G V
pagerParameters99W f
)99f g
{:: 	
if;; 
(;; 
!;; 
await;; !
_authorizationService;; ,
.;;, -
AuthorizeAsync;;- ;
(;;; <
User;;< @
,;;@ A
Permissions;;B M
.;;M N
ManagePlacements;;N ^
);;^ _
);;_ `
{<< 
return== 
Forbid== 
(== 
)== 
;==  
}>> 
var@@ 
siteSettings@@ 
=@@ 
await@@ $
_siteService@@% 1
.@@1 2 
GetSiteSettingsAsync@@2 F
(@@F G
)@@G H
;@@H I
varAA 
pagerAA 
=AA 
newAA 
PagerAA !
(AA! "
pagerParametersAA" 1
,AA1 2
siteSettingsAA3 ?
.AA? @
PageSizeAA@ H
)AAH I
;AAI J
varCC 

shapeTypesCC 
=CC 
awaitCC "
_placementsManagerCC# 5
.CC5 6$
ListShapePlacementsAsyncCC6 N
(CCN O
)CCO P
;CCP Q
varEE 
	shapeListEE 
=EE 

shapeTypesEE &
.EE& '
SelectEE' -
(EE- .
entryEE. 3
=>EE4 6
newEE7 :#
ShapePlacementViewModelEE; R
{FF 
	ShapeTypeGG 
=GG 
entryGG !
.GG! "
KeyGG" %
}HH 
)HH 
.HH 
ToListHH 
(HH 
)HH 
;HH 
ifJJ 
(JJ 
!JJ 
stringJJ 
.JJ 
IsNullOrWhiteSpaceJJ *
(JJ* +
optionsJJ+ 2
.JJ2 3
SearchJJ3 9
)JJ9 :
)JJ: ;
{KK 
	shapeListLL 
=LL 
	shapeListLL %
.LL% &
WhereLL& +
(LL+ ,
xLL, -
=>LL. 0
xLL1 2
.LL2 3
	ShapeTypeLL3 <
.LL< =
ContainsLL= E
(LLE F
optionsLLF M
.LLM N
SearchLLN T
,LLT U
StringComparisonLLV f
.LLf g
OrdinalIgnoreCaseLLg x
)LLx y
)LLy z
.LLz {
ToList	LL{ Å
(
LLÅ Ç
)
LLÇ É
;
LLÉ Ñ
}MM 
varOO 
countOO 
=OO 
	shapeListOO !
.OO! "
CountOO" '
(OO' (
)OO( )
;OO) *
	shapeListQQ 
=QQ 
	shapeListQQ !
.QQ! "
OrderByQQ" )
(QQ) *
xQQ* +
=>QQ, .
xQQ/ 0
.QQ0 1
	ShapeTypeQQ1 :
)QQ: ;
.RR 
SkipRR 
(RR 
pagerRR 
.RR 
GetStartIndexRR )
(RR) *
)RR* +
)RR+ ,
.SS 
TakeSS 
(SS 
pagerSS 
.SS 
PageSizeSS $
)SS$ %
.SS% &
ToListSS& ,
(SS, -
)SS- .
;SS. /
varUU 

pagerShapeUU 
=UU 
(UU 
awaitUU #
NewUU$ '
.UU' (
PagerUU( -
(UU- .
pagerUU. 3
)UU3 4
)UU4 5
.UU5 6
TotalItemCountUU6 D
(UUD E
countUUE J
)UUJ K
;UUK L
varWW 
modelWW 
=WW 
newWW (
ListShapePlacementsViewModelWW 8
{XX 
ShapePlacementsYY 
=YY  !
	shapeListYY" +
,YY+ ,
PagerZZ 
=ZZ 

pagerShapeZZ "
,ZZ" #
Options[[ 
=[[ 
options[[ !
,[[! "
}\\ 
;\\ 
model^^ 
.^^ 
Options^^ 
.^^ 
ContentsBulkAction^^ ,
=^^- .
new^^/ 2
List^^3 7
<^^7 8
SelectListItem^^8 F
>^^F G
(^^G H
)^^H I
{^^J K
new__ 
SelectListItem__ "
(__" #
)__# $
{__% &
Text__' +
=__, -
S__. /
[__/ 0
$str__0 8
]__8 9
,__9 :
Value__; @
=__A B
nameof__C I
(__I J
ContentsBulkAction__J \
.__\ ]
Remove__] c
)__c d
}__e f
}`` 
;`` 
returnbb 
Viewbb 
(bb 
$strbb 
,bb  
modelbb! &
)bb& '
;bb' (
}cc 	
[ee 	
HttpPostee	 
,ee 

ActionNameee 
(ee 
$stree %
)ee% &
]ee& '
[ff 	
FormValueRequiredff	 
(ff 
$strff *
)ff* +
]ff+ ,
publicgg 
ActionResultgg 
IndexFilterPOSTgg +
(gg+ ,(
ListShapePlacementsViewModelgg, H
modelggI N
)ggN O
{hh 	
returnii 
RedirectToActionii #
(ii# $
$strii$ +
,ii+ ,
newii- 0 
RouteValueDictionaryii1 E
{iiF G
{jj 
$strjj "
,jj" #
modeljj$ )
.jj) *
Optionsjj* 1
.jj1 2
Searchjj2 8
}jj9 :
}kk 
)kk 
;kk 
}ll 	
publicnn 
asyncnn 
Tasknn 
<nn 
IActionResultnn '
>nn' (
Createnn) /
(nn/ 0
stringnn0 6

suggestionnn7 A
,nnA B
stringnnC I
	returnUrlnnJ S
=nnT U
nullnnV Z
)nnZ [
{oo 	
ifpp 
(pp 
!pp 
awaitpp !
_authorizationServicepp ,
.pp, -
AuthorizeAsyncpp- ;
(pp; <
Userpp< @
,pp@ A
PermissionsppB M
.ppM N
ManagePlacementsppN ^
)pp^ _
)pp_ `
{qq 
returnrr 
Forbidrr 
(rr 
)rr 
;rr  
}ss 
varuu 
templateuu 
=uu 
newuu 
PlacementNodeuu ,
[uu, -
]uu- .
{uu/ 0
newuu1 4
PlacementNodeuu5 B
(uuB C
)uuC D
}uuE F
;uuF G
varww 
	viewModelww 
=ww 
newww '
EditShapePlacementViewModelww  ;
{xx 
Creatingyy 
=yy 
trueyy 
,yy  
	ShapeTypezz 
=zz 

suggestionzz &
,zz& '
Nodes{{ 
={{ 
JsonConvert{{ #
.{{# $
SerializeObject{{$ 3
({{3 4
template{{4 <
,{{< =

Formatting{{> H
.{{H I
Indented{{I Q
){{Q R
}|| 
;|| 
ViewData~~ 
[~~ 
$str~~  
]~~  !
=~~" #
	returnUrl~~$ -
;~~- .
return 
View 
( 
$str 
, 
	viewModel  )
)) *
;* +
}
ÄÄ 	
public
ÇÇ 
async
ÇÇ 
Task
ÇÇ 
<
ÇÇ 
IActionResult
ÇÇ '
>
ÇÇ' (
Edit
ÇÇ) -
(
ÇÇ- .
string
ÇÇ. 4
	shapeType
ÇÇ5 >
,
ÇÇ> ?
string
ÇÇ@ F
displayType
ÇÇG R
=
ÇÇS T
null
ÇÇU Y
,
ÇÇY Z
string
ÇÇ[ a
contentType
ÇÇb m
=
ÇÇn o
null
ÇÇp t
,
ÇÇt u
string
ÇÇv |
contentPartÇÇ} à
=ÇÇâ ä
nullÇÇã è
,ÇÇè ê
stringÇÇë ó
differentiatorÇÇò ¶
=ÇÇß ®
nullÇÇ© ≠
,ÇÇ≠ Æ
stringÇÇØ µ
	returnUrlÇÇ∂ ø
=ÇÇ¿ ¡
nullÇÇ¬ ∆
)ÇÇ∆ «
{
ÉÉ 	
if
ÑÑ 
(
ÑÑ 
!
ÑÑ 
await
ÑÑ #
_authorizationService
ÑÑ ,
.
ÑÑ, -
AuthorizeAsync
ÑÑ- ;
(
ÑÑ; <
User
ÑÑ< @
,
ÑÑ@ A
Permissions
ÑÑB M
.
ÑÑM N
ManagePlacements
ÑÑN ^
)
ÑÑ^ _
)
ÑÑ_ `
{
ÖÖ 
return
ÜÜ 
Forbid
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ  
}
áá 
var
ââ 
placementNodes
ââ 
=
ââ  
(
ââ! "
await
ââ" ' 
_placementsManager
ââ( :
.
ââ: ;%
GetShapePlacementsAsync
ââ; R
(
ââR S
	shapeType
ââS \
)
ââ\ ]
)
ââ] ^
?
ââ^ _
.
ââ_ `
ToList
ââ` f
(
ââf g
)
ââg h
??
ââi k
new
ââl o
List
ââp t
<
âât u
PlacementNodeââu Ç
>ââÇ É
(ââÉ Ñ
)ââÑ Ö
;ââÖ Ü
if
ãã 
(
ãã 
!
ãã 
placementNodes
ãã 
.
ãã  
Any
ãã  #
(
ãã# $
)
ãã$ %
||
ãã& (
ShouldCreateNode
ãã) 9
(
ãã9 :
placementNodes
ãã: H
,
ããH I
displayType
ããJ U
,
ããU V
contentType
ããW b
,
ããb c
contentPart
ããd o
,
ãão p
differentiator
ããq 
)ãã Ä
)ããÄ Å
{
åå 
var
çç 
generatedNode
çç !
=
çç" #
new
çç$ '
PlacementNode
çç( 5
{
éé 
DisplayType
èè 
=
èè  !
displayType
èè" -
,
èè- .
Differentiator
êê "
=
êê# $
differentiator
êê% 3
}
ëë 
;
ëë 
if
íí 
(
íí 
!
íí 
string
íí 
.
íí 
IsNullOrEmpty
íí )
(
íí) *
contentType
íí* 5
)
íí5 6
)
íí6 7
{
ìì 
generatedNode
îî !
.
îî! "
Filters
îî" )
.
îî) *
Add
îî* -
(
îî- .
$str
îî. ;
,
îî; <
new
îî= @
JArray
îîA G
(
îîG H
contentType
îîH S
)
îîS T
)
îîT U
;
îîU V
}
ïï 
if
ññ 
(
ññ 
!
ññ 
string
ññ 
.
ññ 
IsNullOrEmpty
ññ )
(
ññ) *
contentPart
ññ* 5
)
ññ5 6
)
ññ6 7
{
óó 
generatedNode
òò !
.
òò! "
Filters
òò" )
.
òò) *
Add
òò* -
(
òò- .
$str
òò. ;
,
òò; <
new
òò= @
JArray
òòA G
(
òòG H
contentPart
òòH S
)
òòS T
)
òòT U
;
òòU V
}
ôô 
placementNodes
õõ 
.
õõ 
Add
õõ "
(
õõ" #
generatedNode
õõ# 0
)
õõ0 1
;
õõ1 2
}
úú 
var
ûû 
	viewModel
ûû 
=
ûû 
new
ûû )
EditShapePlacementViewModel
ûû  ;
{
üü 
	ShapeType
†† 
=
†† 
	shapeType
†† %
,
††% &
Nodes
°° 
=
°° 
JsonConvert
°° #
.
°°# $
SerializeObject
°°$ 3
(
°°3 4
placementNodes
°°4 B
,
°°B C

Formatting
°°D N
.
°°N O
Indented
°°O W
)
°°W X
}
¢¢ 
;
¢¢ 
ViewData
§§ 
[
§§ 
$str
§§  
]
§§  !
=
§§" #
	returnUrl
§§$ -
;
§§- .
return
•• 
View
•• 
(
•• 
	viewModel
•• !
)
••! "
;
••" #
}
¶¶ 	
[
®® 	
HttpPost
®®	 
,
®® 

ActionName
®® 
(
®® 
$str
®® $
)
®®$ %
]
®®% &
public
©© 
async
©© 
Task
©© 
<
©© 
IActionResult
©© '
>
©©' (
Edit
©©) -
(
©©- .)
EditShapePlacementViewModel
©©. I
	viewModel
©©J S
,
©©S T
string
©©U [
submit
©©\ b
,
©©b c
string
©©d j
	returnUrl
©©k t
=
©©u v
null
©©w {
)
©©{ |
{
™™ 	
if
´´ 
(
´´ 
!
´´ 
await
´´ #
_authorizationService
´´ ,
.
´´, -
AuthorizeAsync
´´- ;
(
´´; <
User
´´< @
,
´´@ A
Permissions
´´B M
.
´´M N
ManagePlacements
´´N ^
)
´´^ _
)
´´_ `
{
¨¨ 
return
≠≠ 
Forbid
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠  
}
ÆÆ 
ViewData
∞∞ 
[
∞∞ 
$str
∞∞  
]
∞∞  !
=
∞∞" #
	returnUrl
∞∞$ -
;
∞∞- .
if
≤≤ 
(
≤≤ 
	viewModel
≤≤ 
.
≤≤ 
Creating
≤≤ "
&&
≤≤# %
await
≤≤& + 
_placementsManager
≤≤, >
.
≤≤> ?%
GetShapePlacementsAsync
≤≤? V
(
≤≤V W
	viewModel
≤≤W `
.
≤≤` a
	ShapeType
≤≤a j
)
≤≤j k
!=
≤≤l n
null
≤≤o s
)
≤≤s t
{
≥≥ 
	_notifier
µµ 
.
µµ 
Warning
µµ !
(
µµ! "
H
µµ" #
[
µµ# $
$str
µµ$ l
,
µµl m
	viewModel
µµn w
.
µµw x
	ShapeTypeµµx Å
]µµÅ Ç
)µµÇ É
;µµÉ Ñ
return
∂∂ 
View
∂∂ 
(
∂∂ 
	viewModel
∂∂ %
)
∂∂% &
;
∂∂& '
}
∑∑ 
try
ππ 
{
∫∫ 
IEnumerable
ªª 
<
ªª 
PlacementNode
ªª )
>
ªª) *
placementNodes
ªª+ 9
=
ªª: ;
JsonConvert
ªª< G
.
ªªG H
DeserializeObject
ªªH Y
<
ªªY Z
PlacementNode
ªªZ g
[
ªªg h
]
ªªh i
>
ªªi j
(
ªªj k
	viewModel
ªªk t
.
ªªt u
Nodes
ªªu z
)
ªªz {
??
ªª| ~
newªª Ç
PlacementNodeªªÉ ê
[ªªê ë
$numªªë í
]ªªí ì
;ªªì î
placementNodes
ææ 
=
ææ  
placementNodes
ææ! /
.
ææ/ 0
Where
ææ0 5
(
ææ5 6
node
ææ6 :
=>
ææ; =
!
ææ> ?
IsEmpty
ææ? F
(
ææF G
node
ææG K
)
ææK L
)
ææL M
;
ææM N
if
¿¿ 
(
¿¿ 
placementNodes
¿¿ "
.
¿¿" #
Any
¿¿# &
(
¿¿& '
)
¿¿' (
)
¿¿( )
{
¡¡ 
await
√√  
_placementsManager
√√ ,
.
√√, -(
UpdateShapePlacementsAsync
√√- G
(
√√G H
	viewModel
√√H Q
.
√√Q R
	ShapeType
√√R [
,
√√[ \
placementNodes
√√] k
)
√√k l
;
√√l m
	viewModel
ƒƒ 
.
ƒƒ 
Creating
ƒƒ &
=
ƒƒ' (
false
ƒƒ) .
;
ƒƒ. /
	_notifier
∆∆ 
.
∆∆ 
Success
∆∆ %
(
∆∆% &
H
∆∆& '
[
∆∆' (
$str
∆∆( P
,
∆∆P Q
	viewModel
∆∆R [
.
∆∆[ \
	ShapeType
∆∆\ e
]
∆∆e f
)
∆∆f g
;
∆∆g h
}
«« 
else
»» 
if
»» 
(
»» 
	viewModel
»» "
.
»»" #
Creating
»»# +
)
»»+ ,
{
…… 
	_notifier
   
.
   
Warning
   %
(
  % &
H
  & '
[
  ' (
$str
  ( I
,
  I J
	viewModel
  K T
.
  T U
	ShapeType
  U ^
]
  ^ _
)
  _ `
;
  ` a
return
ÀÀ 
View
ÀÀ 
(
ÀÀ  
	viewModel
ÀÀ  )
)
ÀÀ) *
;
ÀÀ* +
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 
await
––  
_placementsManager
–– ,
.
––, -(
RemoveShapePlacementsAsync
––- G
(
––G H
	viewModel
––H Q
.
––Q R
	ShapeType
––R [
)
––[ \
;
––\ ]
	_notifier
—— 
.
—— 
Success
—— %
(
——% &
H
——& '
[
——' (
$str
——( Q
,
——Q R
	viewModel
——S \
.
——\ ]
	ShapeType
——] f
]
——f g
)
——g h
;
——h i
}
““ 
}
”” 
catch
‘‘ 
(
‘‘ !
JsonReaderException
‘‘ %
jsonException
‘‘& 3
)
‘‘3 4
{
’’ 
	_notifier
÷÷ 
.
÷÷ 
Error
÷÷ 
(
÷÷  
H
÷÷  !
[
÷÷! "
$str
÷÷" Y
,
÷÷Y Z
jsonException
÷÷[ h
.
÷÷h i
Message
÷÷i p
]
÷÷p q
)
÷÷q r
;
÷÷r s
return
◊◊ 
View
◊◊ 
(
◊◊ 
	viewModel
◊◊ %
)
◊◊% &
;
◊◊& '
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
e
ŸŸ 
)
ŸŸ 
{
⁄⁄ 
	_notifier
€€ 
.
€€ 
Error
€€ 
(
€€  
H
€€  !
[
€€! "
$str
€€" Q
]
€€Q R
)
€€R S
;
€€S T
_logger
‹‹ 
.
‹‹ 
LogError
‹‹  
(
‹‹  !
e
‹‹! "
,
‹‹" #
$str
‹‹$ S
)
‹‹S T
;
‹‹T U
return
›› 
View
›› 
(
›› 
	viewModel
›› %
)
››% &
;
››& '
}
ﬁﬁ 
if
‡‡ 
(
‡‡ 
submit
‡‡ 
!=
‡‡ 
$str
‡‡ +
)
‡‡+ ,
{
·· 
return
‚‚ (
RedirectToReturnUrlOrIndex
‚‚ 1
(
‚‚1 2
	returnUrl
‚‚2 ;
)
‚‚; <
;
‚‚< =
}
„„ 
return
ÂÂ 
View
ÂÂ 
(
ÂÂ 
	viewModel
ÂÂ !
)
ÂÂ! "
;
ÂÂ" #
}
ÊÊ 	
[
ËË 	
HttpPost
ËË	 
,
ËË 

ActionName
ËË 
(
ËË 
$str
ËË &
)
ËË& '
]
ËË' (
public
ÈÈ 
async
ÈÈ 
Task
ÈÈ 
<
ÈÈ 
IActionResult
ÈÈ '
>
ÈÈ' (
Delete
ÈÈ) /
(
ÈÈ/ 0
string
ÈÈ0 6
	shapeType
ÈÈ7 @
,
ÈÈ@ A
string
ÈÈB H
	returnUrl
ÈÈI R
=
ÈÈS T
null
ÈÈU Y
)
ÈÈY Z
{
ÍÍ 	
if
ÎÎ 
(
ÎÎ 
!
ÎÎ 
await
ÎÎ #
_authorizationService
ÎÎ ,
.
ÎÎ, -
AuthorizeAsync
ÎÎ- ;
(
ÎÎ; <
User
ÎÎ< @
,
ÎÎ@ A
Permissions
ÎÎB M
.
ÎÎM N
ManagePlacements
ÎÎN ^
)
ÎÎ^ _
)
ÎÎ_ `
{
ÏÏ 
return
ÌÌ 
Forbid
ÌÌ 
(
ÌÌ 
)
ÌÌ 
;
ÌÌ  
}
ÓÓ 
await
  
_placementsManager
 $
.
$ %(
RemoveShapePlacementsAsync
% ?
(
? @
	shapeType
@ I
)
I J
;
J K
	_notifier
ÒÒ 
.
ÒÒ 
Success
ÒÒ 
(
ÒÒ 
H
ÒÒ 
[
ÒÒ  
$str
ÒÒ  I
,
ÒÒI J
	shapeType
ÒÒK T
]
ÒÒT U
)
ÒÒU V
;
ÒÒV W
return
ÛÛ (
RedirectToReturnUrlOrIndex
ÛÛ -
(
ÛÛ- .
	returnUrl
ÛÛ. 7
)
ÛÛ7 8
;
ÛÛ8 9
}
ÙÙ 	
[
ˆˆ 	
HttpPost
ˆˆ	 
,
ˆˆ 

ActionName
ˆˆ 
(
ˆˆ 
$str
ˆˆ %
)
ˆˆ% &
]
ˆˆ& '
[
˜˜ 	
FormValueRequired
˜˜	 
(
˜˜ 
$str
˜˜ .
)
˜˜. /
]
˜˜/ 0
public
¯¯ 
async
¯¯ 
Task
¯¯ 
<
¯¯ 
ActionResult
¯¯ &
>
¯¯& '
	IndexPost
¯¯( 1
(
¯¯1 2

ViewModels
¯¯2 <
.
¯¯< =
ContentOptions
¯¯= K
options
¯¯L S
,
¯¯S T
IEnumerable
¯¯U `
<
¯¯` a
string
¯¯a g
>
¯¯g h
itemIds
¯¯i p
)
¯¯p q
{
˘˘ 	
if
˙˙ 
(
˙˙ 
!
˙˙ 
await
˙˙ #
_authorizationService
˙˙ ,
.
˙˙, -
AuthorizeAsync
˙˙- ;
(
˙˙; <
User
˙˙< @
,
˙˙@ A
Permissions
˙˙B M
.
˙˙M N
ManagePlacements
˙˙N ^
)
˙˙^ _
)
˙˙_ `
{
˚˚ 
return
¸¸ 
Forbid
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸  
}
˝˝ 
if
ˇˇ 
(
ˇˇ 
itemIds
ˇˇ 
?
ˇˇ 
.
ˇˇ 
Count
ˇˇ 
(
ˇˇ 
)
ˇˇ  
>
ˇˇ! "
$num
ˇˇ# $
)
ˇˇ$ %
{
ÄÄ 
switch
ÅÅ 
(
ÅÅ 
options
ÅÅ 
.
ÅÅ  

BulkAction
ÅÅ  *
)
ÅÅ* +
{
ÇÇ 
case
ÉÉ  
ContentsBulkAction
ÉÉ +
.
ÉÉ+ ,
None
ÉÉ, 0
:
ÉÉ0 1
break
ÑÑ 
;
ÑÑ 
case
ÖÖ  
ContentsBulkAction
ÖÖ +
.
ÖÖ+ ,
Remove
ÖÖ, 2
:
ÖÖ2 3
foreach
ÜÜ 
(
ÜÜ  !
var
ÜÜ! $
item
ÜÜ% )
in
ÜÜ* ,
itemIds
ÜÜ- 4
)
ÜÜ4 5
{
áá 
await
àà ! 
_placementsManager
àà" 4
.
àà4 5(
RemoveShapePlacementsAsync
àà5 O
(
ààO P
item
ààP T
)
ààT U
;
ààU V
}
ââ 
	_notifier
ää !
.
ää! "
Success
ää" )
(
ää) *
H
ää* +
[
ää+ ,
$str
ää, N
]
ääN O
)
ääO P
;
ääP Q
break
ãã 
;
ãã 
default
åå 
:
åå 
throw
çç 
new
çç !)
ArgumentOutOfRangeException
çç" =
(
çç= >
)
çç> ?
;
çç? @
}
éé 
}
èè 
return
ëë 
RedirectToAction
ëë #
(
ëë# $
$str
ëë$ +
)
ëë+ ,
;
ëë, -
}
íí 	
private
îî 
IActionResult
îî (
RedirectToReturnUrlOrIndex
îî 8
(
îî8 9
string
îî9 ?
	returnUrl
îî@ I
)
îîI J
{
ïï 	
if
ññ 
(
ññ 
(
ññ 
String
ññ 
.
ññ 
IsNullOrEmpty
ññ %
(
ññ% &
	returnUrl
ññ& /
)
ññ/ 0
==
ññ1 3
false
ññ4 9
)
ññ9 :
&&
ññ; =
(
ññ> ?
Url
ññ? B
.
ññB C

IsLocalUrl
ññC M
(
ññM N
	returnUrl
ññN W
)
ññW X
)
ññX Y
)
ññY Z
{
óó 
return
òò 
Redirect
òò 
(
òò  
	returnUrl
òò  )
)
òò) *
;
òò* +
}
ôô 
else
öö 
{
õõ 
return
úú 
RedirectToAction
úú '
(
úú' (
nameof
úú( .
(
úú. /
Index
úú/ 4
)
úú4 5
)
úú5 6
;
úú6 7
}
ùù 
}
ûû 	
private
†† 
static
†† 
bool
†† 
ShouldCreateNode
†† ,
(
††, -
IEnumerable
††- 8
<
††8 9
PlacementNode
††9 F
>
††F G
nodes
††H M
,
††M N
string
††O U
displayType
††V a
,
††a b
string
††c i
contentType
††j u
,
††u v
string
††w }
contentPart††~ â
,††â ä
string††ã ë
differentiator††í †
)††† °
{
°° 	
if
¢¢ 
(
¢¢ 
string
¢¢ 
.
¢¢ 
IsNullOrEmpty
¢¢ $
(
¢¢$ %
displayType
¢¢% 0
)
¢¢0 1
&&
¢¢2 4
string
¢¢5 ;
.
¢¢; <
IsNullOrEmpty
¢¢< I
(
¢¢I J
differentiator
¢¢J X
)
¢¢X Y
)
¢¢Y Z
{
££ 
return
§§ 
false
§§ 
;
§§ 
}
•• 
else
¶¶ 
{
ßß 
return
®® 
!
®® 
nodes
®® 
.
®® 
Any
®® !
(
®®! "
node
®®" &
=>
®®' )
(
©© 
string
©© 
.
©© 
IsNullOrEmpty
©© )
(
©©) *
displayType
©©* 5
)
©©5 6
||
©©7 9
node
©©: >
.
©©> ?
DisplayType
©©? J
==
©©K M
displayType
©©N Y
)
©©Y Z
&&
©©[ ]
(
™™ 
string
™™ 
.
™™ 
IsNullOrEmpty
™™ )
(
™™) *
contentType
™™* 5
)
™™5 6
||
™™7 9
(
™™: ;
node
™™; ?
.
™™? @
Filters
™™@ G
.
™™G H
ContainsKey
™™H S
(
™™S T
$str
™™T a
)
™™a b
&&
™™c e
FilterEquals
™™f r
(
™™r s
node
™™s w
.
™™w x
Filters
™™x 
[™™ Ä
$str™™Ä ç
]™™ç é
,™™é è
contentType™™ê õ
)™™õ ú
)™™ú ù
)™™ù û
&&™™ü °
(
´´ 
string
´´ 
.
´´ 
IsNullOrEmpty
´´ )
(
´´) *
contentPart
´´* 5
)
´´5 6
||
´´7 9
(
´´: ;
node
´´; ?
.
´´? @
Filters
´´@ G
.
´´G H
ContainsKey
´´H S
(
´´S T
$str
´´T a
)
´´a b
&&
´´c e
FilterEquals
´´f r
(
´´r s
node
´´s w
.
´´w x
Filters
´´x 
[´´ Ä
$str´´Ä ç
]´´ç é
,´´é è
contentPart´´ê õ
)´´õ ú
)´´ú ù
)´´ù û
&&´´ü °
(
¨¨ 
string
¨¨ 
.
¨¨ 
IsNullOrEmpty
¨¨ )
(
¨¨) *
differentiator
¨¨* 8
)
¨¨8 9
||
¨¨: <
node
¨¨= A
.
¨¨A B
Differentiator
¨¨B P
==
¨¨Q S
differentiator
¨¨T b
)
¨¨b c
)
¨¨c d
;
¨¨d e
}
≠≠ 
}
ÆÆ 	
private
∞∞ 
static
∞∞ 
bool
∞∞ 
IsEmpty
∞∞ #
(
∞∞# $
PlacementNode
∞∞$ 1
node
∞∞2 6
)
∞∞6 7
{
±± 	
return
≤≤ 
string
≤≤ 
.
≤≤ 
IsNullOrEmpty
≤≤ '
(
≤≤' (
node
≤≤( ,
.
≤≤, -
Location
≤≤- 5
)
≤≤5 6
&&
≥≥ 
string
≥≥ 
.
≥≥ 
IsNullOrEmpty
≥≥ '
(
≥≥' (
node
≥≥( ,
.
≥≥, -
	ShapeType
≥≥- 6
)
≥≥6 7
&&
¥¥ 
(
¥¥ 
node
¥¥ 
.
¥¥ 

Alternates
¥¥ #
==
¥¥$ &
null
¥¥' +
||
¥¥, .
node
¥¥/ 3
.
¥¥3 4

Alternates
¥¥4 >
.
¥¥> ?
Length
¥¥? E
==
¥¥F H
$num
¥¥I J
)
¥¥J K
&&
µµ 
(
µµ 
node
µµ 
.
µµ 
Wrappers
µµ !
==
µµ" $
null
µµ% )
||
µµ* ,
node
µµ- 1
.
µµ1 2
Wrappers
µµ2 :
.
µµ: ;
Length
µµ; A
==
µµB D
$num
µµE F
)
µµF G
;
µµG H
}
∂∂ 	
private
ππ 
static
ππ 
bool
ππ 
FilterEquals
ππ (
(
ππ( )
JToken
ππ) /
token
ππ0 5
,
ππ5 6
string
ππ7 =
value
ππ> C
)
ππC D
{
∫∫ 	
if
ªª 
(
ªª 
token
ªª 
is
ªª 
JArray
ªª 
)
ªª  
{
ºº 
var
ΩΩ 
tokenValues
ΩΩ 
=
ΩΩ  !
token
ΩΩ" '
.
ΩΩ' (
Values
ΩΩ( .
<
ΩΩ. /
string
ΩΩ/ 5
>
ΩΩ5 6
(
ΩΩ6 7
)
ΩΩ7 8
;
ΩΩ8 9
return
ææ 
tokenValues
ææ "
.
ææ" #
Count
ææ# (
(
ææ( )
)
ææ) *
==
ææ+ -
$num
ææ. /
&&
ææ0 2
tokenValues
ææ3 >
.
ææ> ?
First
ææ? D
(
ææD E
)
ææE F
==
ææG I
value
ææJ O
;
ææO P
}
øø 
else
¿¿ 
{
¡¡ 
return
¬¬ 
token
¬¬ 
.
¬¬ 
Value
¬¬ "
<
¬¬" #
string
¬¬# )
>
¬¬) *
(
¬¬* +
)
¬¬+ ,
==
¬¬- /
value
¬¬0 5
;
¬¬5 6
}
√√ 
}
ƒƒ 	
}
≈≈ 
}∆∆ •
üD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Deployment\PlacementsDeploymentSource.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

Deployment! +
{ 
public 

class &
PlacementsDeploymentSource +
:, -
IDeploymentSource. ?
{		 
private

 
readonly

 
PlacementsManager

 *
_placementsManager

+ =
;

= >
public &
PlacementsDeploymentSource )
() *
PlacementsManager* ;
placementsManager< M
)M N
{ 	
_placementsManager 
=  
placementsManager! 2
;2 3
} 	
public 
async 
Task &
ProcessDeploymentStepAsync 4
(4 5
DeploymentStep5 C
stepD H
,H I 
DeploymentPlanResultJ ^
result_ e
)e f
{ 	
var 
placementsStep 
=  
step! %
as& ($
PlacementsDeploymentStep) A
;A B
if 
( 
placementsStep 
== !
null" &
)& '
{ 
return 
; 
} 
var 
placementObjects  
=! "
new# &
JObject' .
(. /
)/ 0
;0 1
var 

placements 
= 
await "
_placementsManager# 5
.5 6$
ListShapePlacementsAsync6 N
(N O
)O P
;P Q
foreach 
( 
var 
	placement "
in# %

placements& 0
)0 1
{ 
placementObjects  
[  !
	placement! *
.* +
Key+ .
]. /
=0 1
JArray2 8
.8 9

FromObject9 C
(C D
	placementD M
.M N
ValueN S
)S T
;T U
}   
result"" 
."" 
Steps"" 
."" 
Add"" 
("" 
new""  
JObject""! (
(""( )
new## 
	JProperty## 
(## 
$str## $
,##$ %
$str##& 2
)##2 3
,##3 4
new$$ 
	JProperty$$ 
($$ 
$str$$ *
,$$* +
placementObjects$$, <
)$$< =
)%% 
)%% 
;%% 
}&& 	
}'' 
}(( Ñ
ùD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Deployment\PlacementsDeploymentStep.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

Deployment! +
{ 
public 

class $
PlacementsDeploymentStep )
:* +
DeploymentStep, :
{		 
public

 $
PlacementsDeploymentStep

 '
(

' (
)

( )
{ 	
Name 
= 
$str 
;  
} 	
} 
} ”
£D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Deployment\PlacementsDeploymentStepDriver.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

Deployment! +
{ 
public 

class *
PlacementsDeploymentStepDriver /
:0 1
DisplayDriver2 ?
<? @
DeploymentStep@ N
,N O$
PlacementsDeploymentStepP h
>h i
{ 
public		 
override		 
IDisplayResult		 &
Display		' .
(		. /$
PlacementsDeploymentStep		/ G
step		H L
)		L M
{

 	
return 
Combine 
( 
View 
( 
$str ;
,; <
step= A
)A B
.B C
LocationC K
(K L
$strL U
,U V
$strW `
)` a
,a b
View 
( 
$str =
,= >
step? C
)C D
.D E
LocationE M
(M N
$strN Y
,Y Z
$str[ d
)d e
) 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,$
PlacementsDeploymentStep, D
stepE I
)I J
{ 	
return 
View 
( 
$str 7
,7 8
step9 =
)= >
.> ?
Location? G
(G H
$strH Q
)Q R
;R S
} 	
} 
} ß
ÇD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Manifest.cs
[ 
assembly 	
:	 

Module 
( 
Name 
=	 

$str 
, 
Author 

= 
ManifestConstants 
. 
OrchardCoreTeam .
,. /
Website 
= 
ManifestConstants 
.  
OrchardCoreWebsite  2
,2 3
Version 
= 
ManifestConstants 
.  
OrchardCoreVersion  2
) 
] 
[

 
assembly

 	
:

	 

Feature

 
(

 
Id 
= 
$str	 !
,! "
Name 
=	 

$str 
, 
Description 
= 
$str _
,_ `
Category 
= 
$str 
) 
] 
[ 
assembly 	
:	 

Feature 
( 
Id 
= 
$str	 -
,- .
Name 
=	 

$str $
,$ %
Description 
= 
$str 6
,6 7
Dependencies 
= 
new 
[ 
] 
{ 
$str 3
}4 5
,5 6
Category 
= 
$str 
) 
] Ä
ìD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Models\PlacementsDocument.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Models! '
{ 
public 

class 
PlacementsDocument #
:$ %
Document& .
{		 
public

 

Dictionary

 
<

 
string

  
,

  !
PlacementNode

" /
[

/ 0
]

0 1
>

1 2

Placements

3 =
{

> ?
get

@ C
;

C D
set

E H
;

H I
}

J K
=

L M
new

N Q

Dictionary

R \
<

\ ]
string

] c
,

c d
PlacementNode

e r
[

r s
]

s t
>

t u
(

u v
StringComparer	

v Ñ
.


Ñ Ö
OrdinalIgnoreCase


Ö ñ
)


ñ ó
;


ó ò
} 
} ƒ
ÖD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Permissions.cs
	namespace 	
OrchardCore
 
. 

Placements  
{ 
public 

class 
Permissions 
: 
IPermissionProvider 2
{		 
public

 
static

 
readonly

 

Permission

 )
ManagePlacements

* :
=

; <
new

= @

Permission

A K
(

K L
$str

L ^
,

^ _
$str

` s
)

s t
;

t u
public 
Task 
< 
IEnumerable 
<  

Permission  *
>* +
>+ ,
GetPermissionsAsync- @
(@ A
)A B
{ 	
return 
Task 
. 

FromResult "
(" #
new# &
[& '
]' (
{) *
ManagePlacements+ ;
}< =
.= >
AsEnumerable> J
(J K
)K L
)L M
;M N
} 	
public 
IEnumerable 
<  
PermissionStereotype /
>/ 0!
GetDefaultStereotypes1 F
(F G
)G H
{ 	
return 
new 
[ 
] 
{ 
new  
PermissionStereotype (
{ 
Name 
= 
$str *
,* +
Permissions 
=  !
new" %
[% &
]& '
{( )
ManagePlacements* :
}; <
} 
, 
new  
PermissionStereotype (
{ 
Name 
= 
$str #
,# $
Permissions 
=  !
new" %
[% &
]& '
{( )
ManagePlacements* :
}; <
} 
} 
; 
}   	
}!! 
}"" 
èD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Recipes\PlacementStep.cs
	namespace		 	
OrchardCore		
 
.		 

Placements		  
.		  !
Recipes		! (
{

 
public 

class 
PlacementStep 
:  
IRecipeStepHandler! 3
{ 
private 
readonly 
PlacementsManager *
_placementsManager+ =
;= >
public 
PlacementStep 
( 
PlacementsManager .
placementsManager/ @
)@ A
{ 	
_placementsManager 
=  
placementsManager! 2
;2 3
} 	
public 
async 
Task 
ExecuteAsync &
(& '"
RecipeExecutionContext' =
context> E
)E F
{ 	
if 
( 
! 
String 
. 
Equals 
( 
context &
.& '
Name' +
,+ ,
$str- 9
,9 :
StringComparison; K
.K L
OrdinalIgnoreCaseL ]
)] ^
)^ _
{ 
return 
; 
} 
if 
( 
context 
. 
Step 
. 
Property %
(% &
$str& 2
)2 3
.3 4
Value4 9
is: <
JObject= D
	templatesE N
)N O
{ 
foreach   
(   
var   
property   %
in  & (
	templates  ) 2
.  2 3

Properties  3 =
(  = >
)  > ?
)  ? @
{!! 
var"" 
name"" 
="" 
property"" '
.""' (
Name""( ,
;"", -
var## 
value## 
=## 
property##  (
.##( )
Value##) .
.##. /
ToObject##/ 7
<##7 8
PlacementNode##8 E
[##E F
]##F G
>##G H
(##H I
)##I J
;##J K
await%% 
_placementsManager%% ,
.%%, -&
UpdateShapePlacementsAsync%%- G
(%%G H
name%%H L
,%%L M
value%%N S
)%%S T
;%%T U
}&& 
}'' 
}(( 	
})) 
}** Ù
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Services\DatabasePlacementsStore.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Services! )
{ 
public 

class #
DatabasePlacementsStore (
:) *
IPlacementStore+ :
{ 
private		 
readonly		 
IDocumentManager		 )
<		) *
PlacementsDocument		* <
>		< =
_documentManager		> N
;		N O
public #
DatabasePlacementsStore &
(& '
IDocumentManager' 7
<7 8
PlacementsDocument8 J
>J K
documentManagerL [
)[ \
{ 	
_documentManager 
= 
documentManager .
;. /
} 	
public 
Task 
< 
PlacementsDocument &
>& '
LoadPlacementsAsync( ;
(; <
)< =
=>> @
_documentManagerA Q
.Q R#
GetOrCreateMutableAsyncR i
(i j
)j k
;k l
public 
Task 
< 
PlacementsDocument &
>& '
GetPlacementsAsync( :
(: ;
); <
=>= ?
_documentManager@ P
.P Q%
GetOrCreateImmutableAsyncQ j
(j k
)k l
;l m
public 
Task 
SavePlacementsAsync '
(' (
PlacementsDocument( :
placementsDocument; M
)M N
=>O Q
_documentManagerR b
.b c
UpdateAsyncc n
(n o
placementsDocument	o Å
)
Å Ç
;
Ç É
} 
} ∆
ñD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Services\FilePlacementsStore.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Services! )
{ 
public 

class 
FilePlacementsStore $
:% &
IPlacementStore' 6
{		 
private

 
readonly

 
IDocumentManager

 )
<

) *
IFileDocumentStore

* <
,

< =
PlacementsDocument

> P
>

P Q
_documentManager

R b
;

b c
public 
FilePlacementsStore "
(" #
IDocumentManager# 3
<3 4
IFileDocumentStore4 F
,F G
PlacementsDocumentH Z
>Z [
documentManager\ k
)k l
{ 	
_documentManager 
= 
documentManager .
;. /
} 	
public 
Task 
< 
PlacementsDocument &
>& '
LoadPlacementsAsync( ;
(; <
)< =
=>> @
_documentManagerA Q
.Q R#
GetOrCreateMutableAsyncR i
(i j
)j k
;k l
public 
Task 
< 
PlacementsDocument &
>& '
GetPlacementsAsync( :
(: ;
); <
=>= ?
_documentManager@ P
.P Q%
GetOrCreateImmutableAsyncQ j
(j k
)k l
;l m
public 
Task 
SavePlacementsAsync '
(' (
PlacementsDocument( :
placementsDocument; M
)M N
=>O Q
_documentManagerR b
.b c
UpdateAsyncc n
(n o
placementsDocument	o Å
)
Å Ç
;
Ç É
} 
} Í
íD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Services\IPlacementStore.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Services! )
{ 
public 

	interface 
IPlacementStore $
{ 
Task 
< 
PlacementsDocument 
>  
LoadPlacementsAsync! 4
(4 5
)5 6
;6 7
Task 
< 
PlacementsDocument 
>  
GetPlacementsAsync! 3
(3 4
)4 5
;5 6
Task 
SavePlacementsAsync  
(  !
PlacementsDocument! 3
placementsDocument4 F
)F G
;G H
} 
} àE
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Services\PlacementProvider.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Services! )
{ 
public 

class 
PlacementProvider "
:# $#
IShapePlacementProvider% <
{ 
private 
readonly 
PlacementsManager *
_placementsManager+ =
;= >
private 
readonly 
IEnumerable $
<$ %(
IPlacementNodeFilterProvider% A
>A B)
_placementNodeFilterProvidersC `
;` a
public 
PlacementProvider  
(  !
PlacementsManager 
placementsManager /
,/ 0
IEnumerable 
< (
IPlacementNodeFilterProvider 4
>4 5(
placementNodeFilterProviders6 R
)R S
{ 	
_placementsManager 
=  
placementsManager! 2
;2 3)
_placementNodeFilterProviders )
=* +(
placementNodeFilterProviders, H
;H I
} 	
public 
async 
Task 
< "
IPlacementInfoResolver 0
>0 1+
BuildPlacementInfoResolverAsync2 Q
(Q R
IBuildShapeContextR d
contexte l
)l m
{ 	
var 

placements 
= 
await "
_placementsManager# 5
.5 6$
ListShapePlacementsAsync6 N
(N O
)O P
;P Q
return 
new !
PlacementInfoResolver ,
(, -

placements- 7
,7 8)
_placementNodeFilterProviders9 V
)V W
;W X
} 	
public   
class   !
PlacementInfoResolver   *
:  + ,"
IPlacementInfoResolver  - C
{!! 	
private"" 
readonly"" 
IReadOnlyDictionary"" 0
<""0 1
string""1 7
,""7 8
IEnumerable""9 D
<""D E
PlacementNode""E R
>""R S
>""S T
_placements""U `
;""` a
private## 
readonly## 
IEnumerable## (
<##( )(
IPlacementNodeFilterProvider##) E
>##E F)
_placementNodeFilterProviders##G d
;##d e
public%% !
PlacementInfoResolver%% (
(%%( )
IReadOnlyDictionary&& #
<&&# $
string&&$ *
,&&* +
IEnumerable&&, 7
<&&7 8
PlacementNode&&8 E
>&&E F
>&&F G

placements&&H R
,&&R S
IEnumerable'' 
<'' (
IPlacementNodeFilterProvider'' 8
>''8 9(
placementNodeFilterProviders'': V
)''V W
{(( 
_placements)) 
=)) 

placements)) (
;))( ))
_placementNodeFilterProviders** -
=**. /(
placementNodeFilterProviders**0 L
;**L M
}++ 
public-- 
PlacementInfo--  
ResolvePlacement--! 1
(--1 2!
ShapePlacementContext--2 G
placementContext--H X
)--X Y
{.. 
PlacementInfo// 
	placement// '
=//( )
null//* .
;//. /
if11 
(11 
_placements11 
.11  
ContainsKey11  +
(11+ ,
placementContext11, <
.11< =
	ShapeType11= F
)11F G
)11G H
{22 
var33 
shapePlacements33 '
=33( )
_placements33* 5
[335 6
placementContext336 F
.33F G
	ShapeType33G P
]33P Q
;33Q R
foreach55 
(55 
var55  
placementRule55! .
in55/ 1
shapePlacements552 A
)55A B
{66 
var77 
filters77 #
=77$ %
placementRule77& 3
.773 4
Filters774 ;
.77; <
ToList77< B
(77B C
)77C D
;77D E
Func99 
<99 !
ShapePlacementContext99 2
,992 3
bool994 8
>998 9
	predicate99: C
=99D E
ctx99F I
=>99J L
CheckFilter99M X
(99X Y
ctx99Y \
,99\ ]
placementRule99^ k
)99k l
;99l m
if;; 
(;; 
filters;; #
.;;# $
Any;;$ '
(;;' (
);;( )
);;) *
{<< 
	predicate== %
===& '
filters==( /
.==/ 0
	Aggregate==0 9
(==9 :
	predicate==: C
,==C D
BuildPredicate==E S
)==S T
;==T U
}>> 
if@@ 
(@@ 
!@@ 
	predicate@@ &
(@@& '
placementContext@@' 7
)@@7 8
)@@8 9
{AA 
continueCC $
;CC$ %
}DD 
ifFF 
(FF 
	placementFF %
==FF& (
nullFF) -
)FF- .
{GG 
	placementHH %
=HH& '
newHH( +
PlacementInfoHH, 9
{II 
SourceJJ  &
=JJ' (
$strJJ) A
}KK 
;KK 
}LL 
ifNN 
(NN 
!NN 
stringNN #
.NN# $
IsNullOrEmptyNN$ 1
(NN1 2
placementRuleNN2 ?
.NN? @
LocationNN@ H
)NNH I
)NNI J
{OO 
	placementPP %
.PP% &
LocationPP& .
=PP/ 0
placementRulePP1 >
.PP> ?
LocationPP? G
;PPG H
}QQ 
ifSS 
(SS 
!SS 
stringSS #
.SS# $
IsNullOrEmptySS$ 1
(SS1 2
placementRuleSS2 ?
.SS? @
	ShapeTypeSS@ I
)SSI J
)SSJ K
{TT 
	placementUU %
.UU% &
	ShapeTypeUU& /
=UU0 1
placementRuleUU2 ?
.UU? @
	ShapeTypeUU@ I
;UUI J
}VV 
ifXX 
(XX 
placementRuleXX )
.XX) *

AlternatesXX* 4
?XX4 5
.XX5 6
LengthXX6 <
>XX= >
$numXX? @
)XX@ A
{YY 
	placementZZ %
.ZZ% &

AlternatesZZ& 0
=ZZ1 2
	placementZZ3 <
.ZZ< =

AlternatesZZ= G
.ZZG H
CombineZZH O
(ZZO P
newZZP S 
AlternatesCollectionZZT h
(ZZh i
placementRuleZZi v
.ZZv w

Alternates	ZZw Å
)
ZZÅ Ç
)
ZZÇ É
;
ZZÉ Ñ
}[[ 
if]] 
(]] 
placementRule]] )
.]]) *
Wrappers]]* 2
?]]2 3
.]]3 4
Length]]4 :
>]]; <
$num]]= >
)]]> ?
{^^ 
	placement__ %
.__% &
Wrappers__& .
=__/ 0
	placement__1 :
.__: ;
Wrappers__; C
.__C D
Combine__D K
(__K L
new__L O 
AlternatesCollection__P d
(__d e
placementRule__e r
.__r s
Wrappers__s {
)__{ |
)__| }
;__} ~
}`` 
}aa 
}bb 
returndd 
	placementdd  
;dd  !
}ee 
privategg 
staticgg 
boolgg 
CheckFiltergg  +
(gg+ ,!
ShapePlacementContextgg, A
ctxggB E
,ggE F
PlacementNodeggG T
filterggU [
)gg[ \
=>gg] _)
ShapePlacementParsingStrategygg` }
.gg} ~
CheckFilter	gg~ â
(
ggâ ä
ctx
ggä ç
,
ggç é
filter
ggè ï
)
ggï ñ
;
ggñ ó
privateii 
Funcii 
<ii !
ShapePlacementContextii .
,ii. /
boolii0 4
>ii4 5
BuildPredicateii6 D
(iiD E
FunciiE I
<iiI J!
ShapePlacementContextiiJ _
,ii_ `
booliia e
>iie f
	predicateiig p
,iip q
KeyValuePairjj 
<jj 
stringjj %
,jj% &
JTokenjj' -
>jj- .
termjj/ 3
)jj3 4
{kk 
returnll )
ShapePlacementParsingStrategyll 4
.ll4 5
BuildPredicatell5 C
(llC D
	predicatellD M
,llM N
termllO S
,llS T)
_placementNodeFilterProvidersllU r
)llr s
;lls t
}mm 
}nn 	
}oo 
}pp ˜#
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Services\PlacementsManager.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Services! )
{ 
public		 

class		 
PlacementsManager		 "
{

 
private 
readonly 
IPlacementStore (
_placementStore) 8
;8 9
public 
PlacementsManager  
(  !
IPlacementStore! 0
placementStore1 ?
)? @
=>A C
_placementStoreD S
=T U
placementStoreV d
;d e
public 
async 
Task 
< 
IReadOnlyDictionary -
<- .
string. 4
,4 5
IEnumerable6 A
<A B
PlacementNodeB O
>O P
>P Q
>Q R$
ListShapePlacementsAsyncS k
(k l
)l m
{ 	
var 
document 
= 
await  
_placementStore! 0
.0 1
GetPlacementsAsync1 C
(C D
)D E
;E F
return 
document 
. 

Placements &
.& '!
ToImmutableDictionary' <
(< =
kvp= @
=>A C
kvpD G
.G H
KeyH K
,K L
kvpM P
=>Q S
kvpT W
.W X
ValueX ]
.] ^
AsEnumerable^ j
(j k
)k l
)l m
;m n
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
PlacementNode& 3
>3 4
>4 5#
GetShapePlacementsAsync6 M
(M N
stringN T
	shapeTypeU ^
)^ _
{ 	
var 
document 
= 
await  
_placementStore! 0
.0 1
GetPlacementsAsync1 C
(C D
)D E
;E F
if 
( 
document 
. 

Placements #
.# $
ContainsKey$ /
(/ 0
	shapeType0 9
)9 :
): ;
{ 
return 
document 
.  

Placements  *
[* +
	shapeType+ 4
]4 5
;5 6
} 
else 
{ 
return   
null   
;   
}!! 
}"" 	
public$$ 
async$$ 
Task$$ &
UpdateShapePlacementsAsync$$ 4
($$4 5
string$$5 ;
	shapeType$$< E
,$$E F
IEnumerable$$G R
<$$R S
PlacementNode$$S `
>$$` a
placementNodes$$b p
)$$p q
{%% 	
var&& 
document&& 
=&& 
await&&  
_placementStore&&! 0
.&&0 1
LoadPlacementsAsync&&1 D
(&&D E
)&&E F
;&&F G
document(( 
.(( 

Placements(( 
[((  
	shapeType((  )
](() *
=((+ ,
placementNodes((- ;
.((; <
ToArray((< C
(((C D
)((D E
;((E F
await** 
_placementStore** !
.**! "
SavePlacementsAsync**" 5
(**5 6
document**6 >
)**> ?
;**? @
}++ 	
public-- 
async-- 
Task-- &
RemoveShapePlacementsAsync-- 4
(--4 5
string--5 ;
	shapeType--< E
)--E F
{.. 	
var// 
document// 
=// 
await//  
_placementStore//! 0
.//0 1
LoadPlacementsAsync//1 D
(//D E
)//E F
;//F G
if11 
(11 
document11 
.11 

Placements11 #
.11# $
ContainsKey11$ /
(11/ 0
	shapeType110 9
)119 :
)11: ;
{22 
document33 
.33 

Placements33 #
.33# $
Remove33$ *
(33* +
	shapeType33+ 4
)334 5
;335 6
await55 
_placementStore55 %
.55% &
SavePlacementsAsync55& 9
(559 :
document55: B
)55B C
;55C D
}66 
}77 	
}88 
}99 ó
ßD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Settings\PlacementContentPartDefinitionDriver.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Settings! )
{		 
public

 

class

 0
$PlacementContentPartDefinitionDriver

 5
:

6 7.
"ContentPartDefinitionDisplayDriver

8 Z
{ 
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public 0
$PlacementContentPartDefinitionDriver 3
(3 4
IStringLocalizer4 D
<D E0
$PlacementContentPartDefinitionDriverE i
>i j
	localizerk t
)t u
{ 	
S 
= 
	localizer 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,!
ContentPartDefinition, A!
contentPartDefinitionB W
)W X
{ 	
var 
displayName 
= !
contentPartDefinition 3
.3 4
DisplayName4 ?
(? @
)@ A
;A B
return 

Initialize 
< $
ContentSettingsViewModel 6
>6 7
(7 8
$str8 K
,K L
modelM R
=>S U
{ 
model 
. "
ContentSettingsEntries ,
., -
Add- 0
(0 1
new  
ContentSettingsEntry ,
{ 
	ShapeType !
=" #!
contentPartDefinition$ 9
.9 :
Name: >
,> ?
Description #
=$ %
S& '
[' (
$str( B
,B C
displayNameD O
]O P
} 
) 
; 
model   
.   "
ContentSettingsEntries   ,
.  , -
Add  - 0
(  0 1
new!!  
ContentSettingsEntry!! ,
{"" 
	ShapeType## !
=##" #!
contentPartDefinition##$ 9
.##9 :
Name##: >
,##> ?
DisplayType$$ #
=$$$ %
$str$$& .
,$$. /
Description%% #
=%%$ %
S%%& '
[%%' (
$str%%( R
,%%R S
displayName%%T _
]%%_ `
}&& 
)&& 
;&& 
model(( 
.(( "
ContentSettingsEntries(( ,
.((, -
Add((- 0
(((0 1
new))  
ContentSettingsEntry)) ,
{** 
	ShapeType++ !
=++" #!
contentPartDefinition++$ 9
.++9 :
Name++: >
,++> ?
DisplayType,, #
=,,$ %
$str,,& /
,,,/ 0
Description-- #
=--$ %
S--& '
[--' (
$str--( S
,--S T
displayName--U `
]--` a
}.. 
).. 
;.. 
model00 
.00 "
ContentSettingsEntries00 ,
.00, -
Add00- 0
(000 1
new11  
ContentSettingsEntry11 ,
{22 
	ShapeType33 !
=33" #
$"33$ &
{33& '!
contentPartDefinition33' <
.33< =
Name33= A
}33A B
_Edit33B G
"33G H
,33H I
Description44 #
=44$ %
S44& '
[44' (
$str44( R
,44R S
displayName44T _
]44_ `
}55 
)55 
;55 
}77 
)77 
.77 
Location77 
(77 
$str77 #
)77# $
;77$ %
}88 	
}99 
}:: Ù&
≥D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Settings\PlacementContentPartFieldDefinitionDisplayDriver.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Settings! )
{ 
public		 

class		 <
0PlacementContentPartFieldDefinitionDisplayDriver		 A
:		B C3
'ContentPartFieldDefinitionDisplayDriver		D k
{

 
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public <
0PlacementContentPartFieldDefinitionDisplayDriver ?
(? @
IStringLocalizer@ P
<P Q4
(PlacementContentTypePartDefinitionDriverQ y
>y z
	localizer	{ Ñ
)
Ñ Ö
{ 	
S 
= 
	localizer 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,&
ContentPartFieldDefinition, F&
contentPartFieldDefinitionG a
)a b
{ 	
return 

Initialize 
< $
ContentSettingsViewModel 6
>6 7
(7 8
$str8 K
,K L
modelM R
=>S U
{ 
var 
	shapeType 
= &
contentPartFieldDefinition  :
.: ;
FieldDefinition; J
.J K
NameK O
;O P
var 
partName 
= &
contentPartFieldDefinition 9
.9 :
PartDefinition: H
.H I
NameI M
;M N
var 
differentiator "
=# $
$"% '
{' (&
contentPartFieldDefinition( B
.B C
PartDefinitionC Q
.Q R
NameR V
}V W
-W X
{X Y&
contentPartFieldDefinitionY s
.s t
Namet x
}x y
"y z
;z {
var 
displayName 
=  !&
contentPartFieldDefinition" <
.< =
DisplayName= H
(H I
)I J
;J K
model 
. "
ContentSettingsEntries ,
., -
Add- 0
(0 1
new  
ContentSettingsEntry ,
{ 
	ShapeType !
=" #
	shapeType$ -
,- .
Differentiator &
=' (
differentiator) 7
,7 8
Description   #
=  $ %
S  & '
[  ' (
$str  ( N
,  N O
displayName  P [
,  [ \
partName  ] e
]  e f
}!! 
)!! 
;!! 
model## 
.## "
ContentSettingsEntries## ,
.##, -
Add##- 0
(##0 1
new$$  
ContentSettingsEntry$$ ,
{%% 
	ShapeType&& !
=&&" #
	shapeType&&$ -
,&&- .
Differentiator'' &
=''' (
differentiator'') 7
,''7 8
DisplayType(( #
=(($ %
$str((& .
,((. /
Description)) #
=))$ %
S))& '
[))' (
$str))( ^
,))^ _
displayName))` k
,))k l
partName))m u
]))u v
}** 
)** 
;** 
model,, 
.,, "
ContentSettingsEntries,, ,
.,,, -
Add,,- 0
(,,0 1
new--  
ContentSettingsEntry-- ,
{.. 
	ShapeType// !
=//" #
	shapeType//$ -
,//- .
Differentiator00 &
=00' (
differentiator00) 7
,007 8
DisplayType11 #
=11$ %
$str11& /
,11/ 0
Description22 #
=22$ %
S22& '
[22' (
$str22( _
,22_ `
displayName22a l
,22l m
partName22n v
]22v w
}33 
)33 
;33 
model55 
.55 "
ContentSettingsEntries55 ,
.55, -
Add55- 0
(550 1
new66  
ContentSettingsEntry66 ,
{77 
	ShapeType88 !
=88" #
$"88$ &
{88& '
	shapeType88' 0
}880 1
_Edit881 6
"886 7
,887 8
Differentiator99 &
=99' (
differentiator99) 7
,997 8
Description:: #
=::$ %
S::& '
[::' (
$str::( ^
,::^ _
displayName::` k
,::k l
partName::m u
]::u v
};; 
);; 
;;; 
}== 
)== 
.== 
Location== 
(== 
$str== #
)==# $
;==$ %
}>> 	
}?? 
}@@ ∂#
´D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Settings\PlacementContentTypePartDefinitionDriver.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !
Settings! )
{ 
public		 

class		 4
(PlacementContentTypePartDefinitionDriver		 9
:		: ;2
&ContentTypePartDefinitionDisplayDriver		< b
{

 
private 
readonly 
IStringLocalizer )
S* +
;+ ,
public 4
(PlacementContentTypePartDefinitionDriver 7
(7 8
IStringLocalizer8 H
<H I4
(PlacementContentTypePartDefinitionDriverI q
>q r
	localizers |
)| }
{ 	
S 
= 
	localizer 
; 
} 	
public 
override 
IDisplayResult &
Edit' +
(+ ,%
ContentTypePartDefinition, E%
contentTypePartDefinitionF _
)_ `
{ 	
return 

Initialize 
< $
ContentSettingsViewModel 6
>6 7
(7 8
$str8 K
,K L
modelM R
=>S U
{ 
var 
contentType 
=  !%
contentTypePartDefinition" ;
.; <!
ContentTypeDefinition< Q
.Q R
NameR V
;V W
var 
partName 
= %
contentTypePartDefinition 8
.8 9
Name9 =
;= >
var 
displayName 
=  !%
contentTypePartDefinition" ;
.; <!
ContentTypeDefinition< Q
.Q R
DisplayNameR ]
;] ^
model 
. "
ContentSettingsEntries ,
., -
Add- 0
(0 1
new  
ContentSettingsEntry ,
{ 
	ShapeType !
=" #
partName$ ,
,, -
ContentType #
=$ %
contentType& 1
,1 2
Description #
=$ %
S& '
[' (
$str( R
,R S
partNameT \
,\ ]
displayName^ i
]i j
}   
)   
;   
model"" 
."" "
ContentSettingsEntries"" ,
."", -
Add""- 0
(""0 1
new##  
ContentSettingsEntry## ,
{$$ 
	ShapeType%% !
=%%" #
partName%%$ ,
,%%, -
ContentType&& #
=&&$ %
contentType&&& 1
,&&1 2
DisplayType'' #
=''$ %
$str''& .
,''. /
Description(( #
=(($ %
S((& '
[((' (
$str((( b
,((b c
partName((d l
,((l m
displayName((n y
]((y z
})) 
))) 
;)) 
model++ 
.++ "
ContentSettingsEntries++ ,
.++, -
Add++- 0
(++0 1
new,,  
ContentSettingsEntry,, ,
{-- 
	ShapeType.. !
=.." #
partName..$ ,
,.., -
ContentType// #
=//$ %
contentType//& 1
,//1 2
DisplayType00 #
=00$ %
$str00& /
,00/ 0
Description11 #
=11$ %
S11& '
[11' (
$str11( c
,11c d
partName11e m
,11m n
displayName11o z
]11z {
}22 
)22 
;22 
model44 
.44 "
ContentSettingsEntries44 ,
.44, -
Add44- 0
(440 1
new55  
ContentSettingsEntry55 ,
{66 
	ShapeType77 !
=77" #
$"77$ &
{77& '
partName77' /
}77/ 0
_Edit770 5
"775 6
,776 7
ContentType88 #
=88$ %
contentType88& 1
,881 2
Description99 #
=99$ %
S99& '
[99' (
$str99( b
,99b c
partName99d l
,99l m
displayName99n y
]99y z
}:: 
):: 
;:: 
}<< 
)<< 
.<< 
Location<< 
(<< 
$str<< #
)<<# $
;<<$ %
}== 	
}>> 
}?? ÇC
ÅD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\Startup.cs
	namespace 	
OrchardCore
 
. 

Placements  
{ 
public 

class 
Startup 
: 
StartupBase &
{ 
private 
readonly 
AdminOptions %
_adminOptions& 3
;3 4
public 
Startup 
( 
IOptions 
<  
AdminOptions  ,
>, -
adminOptions. :
): ;
{ 	
_adminOptions 
= 
adminOptions (
.( )
Value) .
;. /
}   	
public"" 
override"" 
void"" 
ConfigureServices"" .
("". /
IServiceCollection""/ A
services""B J
)""J K
{## 	
services$$ 
.$$ 
	AddScoped$$ 
<$$ 
IPermissionProvider$$ 2
,$$2 3
Permissions$$4 ?
>$$? @
($$@ A
)$$A B
;$$B C
services%% 
.%% 
	AddScoped%% 
<%% 
INavigationProvider%% 2
,%%2 3
	AdminMenu%%4 =
>%%= >
(%%> ?
)%%? @
;%%@ A
services'' 
.'' 
TryAddScoped'' !
<''! "
IPlacementStore''" 1
,''1 2#
DatabasePlacementsStore''3 J
>''J K
(''K L
)''L M
;''M N
services(( 
.(( 
	AddScoped(( 
<(( 
PlacementsManager(( 0
>((0 1
(((1 2
)((2 3
;((3 4
services)) 
.)) 
	AddScoped)) 
<)) #
IShapePlacementProvider)) 6
,))6 7
PlacementProvider))8 I
>))I J
())J K
)))K L
;))L M
services,, 
.,, 
	AddScoped,, 
<,, /
#IContentPartDefinitionDisplayDriver,, B
,,,B C0
$PlacementContentPartDefinitionDriver,,D h
>,,h i
(,,i j
),,j k
;,,k l
services-- 
.-- 
	AddScoped-- 
<-- 3
'IContentTypePartDefinitionDisplayDriver-- F
,--F G4
(PlacementContentTypePartDefinitionDriver--H p
>--p q
(--q r
)--r s
;--s t
services.. 
... 
	AddScoped.. 
<.. 4
(IContentPartFieldDefinitionDisplayDriver.. G
,..G H<
0PlacementContentPartFieldDefinitionDisplayDriver..I y
>..y z
(..z {
)..{ |
;..| }
services11 
.11 "
AddRecipeExecutionStep11 +
<11+ ,
PlacementStep11, 9
>119 :
(11: ;
)11; <
;11< =
}22 	
public44 
override44 
void44 
	Configure44 &
(44& '
IApplicationBuilder44' :
builder44; B
,44B C!
IEndpointRouteBuilder44D Y
routes44Z `
,44` a
IServiceProvider44b r
serviceProvider	44s Ç
)
44Ç É
{55 	
var66 "
templateControllerName66 &
=66' (
typeof66) /
(66/ 0
AdminController660 ?
)66? @
.66@ A
ControllerName66A O
(66O P
)66P Q
;66Q R
routes88 
.88 "
MapAreaControllerRoute88 )
(88) *
name99 
:99 
$str99 (
,99( )
areaName:: 
::: 
$str:: 2
,::2 3
pattern;; 
:;; 
_adminOptions;; &
.;;& '
AdminUrlPrefix;;' 5
+;;6 7
$str;;8 E
,;;E F
defaults<< 
:<< 
new<< 
{<< 

controller<<  *
=<<+ ,"
templateControllerName<<- C
,<<C D
action<<E K
=<<L M
nameof<<N T
(<<T U
AdminController<<U d
.<<d e
Index<<e j
)<<j k
}<<l m
)== 
;== 
routes?? 
.?? "
MapAreaControllerRoute?? )
(??) *
name@@ 
:@@ 
$str@@ )
,@@) *
areaNameAA 
:AA 
$strAA 2
,AA2 3
patternBB 
:BB 
_adminOptionsBB &
.BB& '
AdminUrlPrefixBB' 5
+BB6 7
$strBB8 L
,BBL M
defaultsCC 
:CC 
newCC 
{CC 

controllerCC  *
=CC+ ,"
templateControllerNameCC- C
,CCC D
actionCCE K
=CCL M
nameofCCN T
(CCT U
AdminControllerCCU d
.CCd e
CreateCCe k
)CCk l
}CCm n
)DD 
;DD 
routesFF 
.FF "
MapAreaControllerRouteFF )
(FF) *
nameGG 
:GG 
$strGG '
,GG' (
areaNameHH 
:HH 
$strHH 2
,HH2 3
patternII 
:II 
_adminOptionsII &
.II& '
AdminUrlPrefixII' 5
+II6 7
$strII8 V
,IIV W
defaultsJJ 
:JJ 
newJJ 
{JJ 

controllerJJ  *
=JJ+ ,"
templateControllerNameJJ- C
,JJC D
actionJJE K
=JJL M
nameofJJN T
(JJT U
AdminControllerJJU d
.JJd e
EditJJe i
)JJi j
}JJk l
)KK 
;KK 
routesMM 
.MM "
MapAreaControllerRouteMM )
(MM) *
nameNN 
:NN 
$strNN )
,NN) *
areaNameOO 
:OO 
$strOO 2
,OO2 3
patternPP 
:PP 
_adminOptionsPP &
.PP& '
AdminUrlPrefixPP' 5
+PP6 7
$strPP8 X
,PPX Y
defaultsQQ 
:QQ 
newQQ 
{QQ 

controllerQQ  *
=QQ+ ,"
templateControllerNameQQ- C
,QQC D
actionQQE K
=QQL M
nameofQQN T
(QQT U
AdminControllerQQU d
.QQd e
DeleteQQe k
)QQk l
}QQm n
)RR 
;RR 
}SS 	
}TT 
[VV 
FeatureVV 
(VV 
$strVV 1
)VV1 2
]VV2 3
publicWW 

classWW (
FileContentDefinitionStartupWW -
:WW. /
StartupBaseWW0 ;
{XX 
publicYY 
overrideYY 
voidYY 
ConfigureServicesYY .
(YY. /
IServiceCollectionYY/ A
servicesYYB J
)YYJ K
{ZZ 	
services[[ 
.[[ 
	RemoveAll[[ 
<[[ 
IPlacementStore[[ .
>[[. /
([[/ 0
)[[0 1
;[[1 2
services\\ 
.\\ 
	AddScoped\\ 
<\\ 
IPlacementStore\\ .
,\\. /
FilePlacementsStore\\0 C
>\\C D
(\\D E
)\\E F
;\\F G
}]] 	
}^^ 
[`` 
RequireFeatures`` 
(`` 
$str`` -
)``- .
]``. /
publicaa 

classaa 
DeploymentStartupaa "
:aa# $
StartupBaseaa% 0
{bb 
publiccc 
overridecc 
voidcc 
ConfigureServicescc .
(cc. /
IServiceCollectioncc/ A
servicesccB J
)ccJ K
{dd 	
servicesee 
.ee 
AddTransientee !
<ee! "
IDeploymentSourceee" 3
,ee3 4&
PlacementsDeploymentSourceee5 O
>eeO P
(eeP Q
)eeQ R
;eeR S
servicesff 
.ff 
AddSingletonff !
<ff! ""
IDeploymentStepFactoryff" 8
>ff8 9
(ff9 :
newff: =!
DeploymentStepFactoryff> S
<ffS T$
PlacementsDeploymentStepffT l
>ffl m
(ffm n
)ffn o
)ffo p
;ffp q
servicesgg 
.gg 
	AddScopedgg 
<gg 
IDisplayDrivergg -
<gg- .
DeploymentStepgg. <
>gg< =
,gg= >*
PlacementsDeploymentStepDrivergg? ]
>gg] ^
(gg^ _
)gg_ `
;gg` a
}hh 	
}ii 
}jj ”
ùD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\ViewModels\ContentSettingsViewModel.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

ViewModels! +
{ 
public 

class $
ContentSettingsViewModel )
{ 
public 
List 
<  
ContentSettingsEntry (
>( )"
ContentSettingsEntries* @
{A B
getC F
;F G
setH K
;K L
}M N
=O P
newQ T
ListU Y
<Y Z 
ContentSettingsEntryZ n
>n o
(o p
)p q
;q r
}		 
public 

class  
ContentSettingsEntry %
{ 
public 
string 
	ShapeType 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
DisplayType !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
ContentType !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
ContentPart !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Differentiator $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
LocalizedString 
Description *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} ®
†D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\ViewModels\EditShapePlacementViewModel.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

ViewModels! +
{ 
public 

class '
EditShapePlacementViewModel ,
{ 
public 
bool 
Creating 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
false- 2
;2 3
public 
string 
	ShapeType 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
Nodes		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
}

 
} Ö
°D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\ViewModels\ListShapePlacementsViewModel.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

ViewModels! +
{ 
public 

class (
ListShapePlacementsViewModel -
{ 
public		 
IList		 
<		 #
ShapePlacementViewModel		 ,
>		, -
ShapePlacements		. =
{		> ?
get		@ C
;		C D
set		E H
;		H I
}		J K
public

 
dynamic

 
Pager

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
ContentOptions 
Options %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
=4 5
new6 9
ContentOptions: H
(H I
)I J
;J K
} 
public 

class 
ContentOptions 
{ 
public 
string 
Search 
{ 
get "
;" #
set$ '
;' (
}) *
public 
ContentsBulkAction !

BulkAction" ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
[ 	
	BindNever	 
] 
public 
List 
< 
SelectListItem "
>" #
ContentsBulkAction$ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
} 
public 

enum 
ContentsBulkAction "
{ 
None 
, 
Remove 
} 
}   º
úD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore.Modules\OrchardCore.Placements\ViewModels\ShapePlacementViewModel.cs
	namespace 	
OrchardCore
 
. 

Placements  
.  !

ViewModels! +
{ 
public 

class #
ShapePlacementViewModel (
{ 
public 
string 
	ShapeType 
{  !
get" %
;% &
set' *
;* +
}, -
} 
} 