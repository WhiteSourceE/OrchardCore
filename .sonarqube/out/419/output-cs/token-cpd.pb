öp
ÖD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\LuceneQueryService.cs
	namespace

 	
OrchardCore


 
.

 
Lucene

 
{ 
public 

class 
LuceneQueryService #
:$ %
ILuceneQueryService& 9
{ 
private 
readonly 
IEnumerable $
<$ % 
ILuceneQueryProvider% 9
>9 :
_queryProviders; J
;J K
public 
LuceneQueryService !
(! "
IEnumerable" -
<- . 
ILuceneQueryProvider. B
>B C
queryProvidersD R
)R S
{ 	
_queryProviders 
= 
queryProviders ,
;, -
} 	
public 
Task 
< 
LuceneTopDocs !
>! "
SearchAsync# .
(. /
LuceneQueryContext/ A
contextB I
,I J
JObjectK R
queryObjS [
)[ \
{ 	
var 
	queryProp 
= 
queryObj $
[$ %
$str% ,
], -
as. 0
JObject1 8
;8 9
if 
( 
	queryProp 
== 
null !
)! "
{ 
throw 
new 
ArgumentException +
(+ ,
$str, S
)S T
;T U
} 
var 
query 
= 
CreateQueryFragment +
(+ ,
context, 3
,3 4
	queryProp5 >
)> ?
;? @
var   
sortProperty   
=   
queryObj   '
[  ' (
$str  ( .
]  . /
;  / 0
var!! 
fromProperty!! 
=!! 
queryObj!! '
[!!' (
$str!!( .
]!!. /
;!!/ 0
var"" 
sizeProperty"" 
="" 
queryObj"" '
[""' (
$str""( .
]"". /
;""/ 0
var$$ 
size$$ 
=$$ 
sizeProperty$$ #
?$$# $
.$$$ %
Value$$% *
<$$* +
int$$+ .
>$$. /
($$/ 0
)$$0 1
??$$2 4
$num$$5 7
;$$7 8
var%% 
from%% 
=%% 
fromProperty%% #
?%%# $
.%%$ %
Value%%% *
<%%* +
int%%+ .
>%%. /
(%%/ 0
)%%0 1
??%%2 4
$num%%5 6
;%%6 7
string'' 
	sortField'' 
='' 
null'' #
;''# $
string(( 
	sortOrder(( 
=(( 
null(( #
;((# $
string)) 
sortType)) 
=)) 
null)) "
;))" #
var** 

sortFields** 
=** 
new**  
List**! %
<**% &
	SortField**& /
>**/ 0
(**0 1
)**1 2
;**2 3
if,, 
(,, 
sortProperty,, 
!=,, 
null,,  $
),,$ %
{-- 
if.. 
(.. 
sortProperty..  
...  !
Type..! %
==..& (

JTokenType..) 3
...3 4
String..4 :
)..: ;
{// 
	sortField00 
=00 
sortProperty00  ,
.00, -
ToString00- 5
(005 6
)006 7
;007 8

sortFields11 
.11 
Add11 "
(11" #
new11# &
	SortField11' 0
(110 1
	sortField111 :
,11: ;
SortFieldType11< I
.11I J
STRING11J P
,11P Q
	sortOrder11R [
==11\ ^
$str11_ e
)11e f
)11f g
;11g h
}22 
else33 
if33 
(33 
sortProperty33 %
.33% &
Type33& *
==33+ -

JTokenType33. 8
.338 9
Object339 ?
)33? @
{44 
	sortField55 
=55 
(55  !
(55! "
	JProperty55" +
)55+ ,
sortProperty55, 8
.558 9
First559 >
)55> ?
.55? @
Name55@ D
;55D E
	sortOrder66 
=66 
(66  !
(66! "
	JProperty66" +
)66+ ,
sortProperty66, 8
.668 9
First669 >
)66> ?
.66? @
Value66@ E
[66E F
$str66F M
]66M N
.66N O
ToString66O W
(66W X
)66X Y
;66Y Z
sortType77 
=77 
(77  
(77  !
	JProperty77! *
)77* +
sortProperty77+ 7
.777 8
First778 =
)77= >
.77> ?
Value77? D
[77D E
$str77E K
]77K L
?77L M
.77M N
ToString77N V
(77V W
)77W X
;77X Y
var88 
sortFieldType88 %
=88& '
SortFieldType88( 5
.885 6
STRING886 <
;88< =
if99 
(99 
sortType99  
!=99! #
null99$ (
)99( )
{:: 
sortFieldType;; %
=;;& '
(;;( )
SortFieldType;;) 6
);;6 7
Enum;;7 ;
.;;; <
Parse;;< A
(;;A B
typeof;;B H
(;;H I
SortFieldType;;I V
);;V W
,;;W X
sortType;;Y a
.;;a b
ToUpper;;b i
(;;i j
);;j k
);;k l
;;;l m
}<< 

sortFields>> 
.>> 
Add>> "
(>>" #
new>># &
	SortField>>' 0
(>>0 1
	sortField>>1 :
,>>: ;
sortFieldType>>< I
,>>I J
	sortOrder>>K T
==>>U W
$str>>X ^
)>>^ _
)>>_ `
;>>` a
}?? 
else@@ 
if@@ 
(@@ 
sortProperty@@ %
.@@% &
Type@@& *
==@@+ -

JTokenType@@. 8
.@@8 9
Array@@9 >
)@@> ?
{AA 
foreachBB 
(BB 
varBB  
itemBB! %
inBB& (
sortPropertyBB) 5
.BB5 6
ChildrenBB6 >
(BB> ?
)BB? @
)BB@ A
{CC 
	sortFieldDD !
=DD" #
(DD$ %
(DD% &
	JPropertyDD& /
)DD/ 0
itemDD0 4
.DD4 5
FirstDD5 :
)DD: ;
.DD; <
NameDD< @
;DD@ A
	sortOrderEE !
=EE" #
(EE$ %
(EE% &
	JPropertyEE& /
)EE/ 0
itemEE0 4
.EE4 5
FirstEE5 :
)EE: ;
.EE; <
ValueEE< A
[EEA B
$strEEB I
]EEI J
.EEJ K
ToStringEEK S
(EES T
)EET U
;EEU V
sortTypeFF  
=FF! "
(FF# $
(FF$ %
	JPropertyFF% .
)FF. /
itemFF/ 3
.FF3 4
FirstFF4 9
)FF9 :
.FF: ;
ValueFF; @
[FF@ A
$strFFA G
]FFG H
?FFH I
.FFI J
ToStringFFJ R
(FFR S
)FFS T
;FFT U
varGG 
sortFieldTypeGG )
=GG* +
SortFieldTypeGG, 9
.GG9 :
STRINGGG: @
;GG@ A
ifHH 
(HH 
sortTypeHH $
!=HH% '
nullHH( ,
)HH, -
{II 
sortFieldTypeJJ )
=JJ* +
(JJ, -
SortFieldTypeJJ- :
)JJ: ;
EnumJJ; ?
.JJ? @
ParseJJ@ E
(JJE F
typeofJJF L
(JJL M
SortFieldTypeJJM Z
)JJZ [
,JJ[ \
sortTypeJJ] e
.JJe f
ToUpperJJf m
(JJm n
)JJn o
)JJo p
;JJp q
}KK 

sortFieldsMM "
.MM" #
AddMM# &
(MM& '
newMM' *
	SortFieldMM+ 4
(MM4 5
	sortFieldMM5 >
,MM> ?
sortFieldTypeMM@ M
,MMM N
	sortOrderMMO X
==MMY [
$strMM\ b
)MMb c
)MMc d
;MMd e
}NN 
}OO 
}PP 
LuceneTopDocsRR 
resultRR  
=RR! "
nullRR# '
;RR' (
TopDocsSS 
topDocsSS 
=SS 
nullSS "
;SS" #
ifUU 
(UU 
sizeUU 
>UU 
$numUU 
)UU 
{VV 
topDocsWW 
=WW 
contextWW !
.WW! "
IndexSearcherWW" /
.WW/ 0
SearchWW0 6
(WW6 7
queryXX 
,XX 
sizeYY 
+YY 
fromYY 
,YY  
	sortFieldZZ 
==ZZ  
nullZZ! %
?ZZ& '
SortZZ( ,
.ZZ, -
	RELEVANCEZZ- 6
:ZZ7 8
newZZ9 <
SortZZ= A
(ZZA B

sortFieldsZZB L
.ZZL M
ToArrayZZM T
(ZZT U
)ZZU V
)ZZV W
)[[ 
;[[ 
if]] 
(]] 
from]] 
>]] 
$num]] 
)]] 
{^^ 
topDocs__ 
=__ 
new__ !
TopDocs__" )
(__) *
topDocs__* 1
.__1 2
	TotalHits__2 ;
-__< =
from__> B
,__B C
topDocs__D K
.__K L
	ScoreDocs__L U
.__U V
Skip__V Z
(__Z [
from__[ _
)___ `
.__` a
ToArray__a h
(__h i
)__i j
,__j k
topDocs__l s
.__s t
MaxScore__t |
)__| }
;__} ~
}`` 
varbb 
	collectorbb 
=bb 
newbb  #"
TotalHitCountCollectorbb$ :
(bb: ;
)bb; <
;bb< =
contextcc 
.cc 
IndexSearchercc %
.cc% &
Searchcc& ,
(cc, -
querycc- 2
,cc2 3
	collectorcc4 =
)cc= >
;cc> ?
resultee 
=ee 
newee 
LuceneTopDocsee *
(ee* +
)ee+ ,
{ee- .
TopDocsee/ 6
=ee7 8
topDocsee9 @
,ee@ A
CounteeB G
=eeH I
	collectoreeJ S
.eeS T
	TotalHitseeT ]
}ee^ _
;ee_ `
}ff 
returnhh 
Taskhh 
.hh 

FromResulthh "
(hh" #
resulthh# )
)hh) *
;hh* +
}ii 	
publickk 
Querykk 
CreateQueryFragmentkk (
(kk( )
LuceneQueryContextkk) ;
contextkk< C
,kkC D
JObjectkkE L
queryObjkkM U
)kkU V
{ll 	
varmm 
firstmm 
=mm 
queryObjmm  
.mm  !

Propertiesmm! +
(mm+ ,
)mm, -
.mm- .
Firstmm. 3
(mm3 4
)mm4 5
;mm5 6
Queryoo 
queryoo 
=oo 
nulloo 
;oo 
foreachqq 
(qq 
varqq 
queryProviderqq &
inqq' )
_queryProvidersqq* 9
)qq9 :
{rr 
queryss 
=ss 
queryProviderss %
.ss% &
CreateQueryss& 1
(ss1 2
thisss2 6
,ss6 7
contextss8 ?
,ss? @
firstssA F
.ssF G
NamessG K
,ssK L
(ssM N
JObjectssN U
)ssU V
firstssV [
.ss[ \
Valuess\ a
)ssa b
;ssb c
ifuu 
(uu 
queryuu 
!=uu 
nulluu !
)uu! "
{vv 
breakww 
;ww 
}xx 
}yy 
return{{ 
query{{ 
;{{ 
}|| 	
public~~ 
static~~ 
List~~ 
<~~ 
string~~ !
>~~! "
Tokenize~~# +
(~~+ ,
string~~, 2
	fieldName~~3 <
,~~< =
string~~> D
text~~E I
,~~I J
Analyzer~~K S
analyzer~~T \
)~~\ ]
{ 	
if
ÄÄ 
(
ÄÄ 
string
ÄÄ 
.
ÄÄ 
IsNullOrEmpty
ÄÄ $
(
ÄÄ$ %
text
ÄÄ% )
)
ÄÄ) *
)
ÄÄ* +
{
ÅÅ 
return
ÇÇ 
new
ÇÇ 
List
ÇÇ 
<
ÇÇ  
string
ÇÇ  &
>
ÇÇ& '
(
ÇÇ' (
)
ÇÇ( )
;
ÇÇ) *
}
ÉÉ 
var
ÖÖ 
result
ÖÖ 
=
ÖÖ 
new
ÖÖ 
List
ÖÖ !
<
ÖÖ! "
string
ÖÖ" (
>
ÖÖ( )
(
ÖÖ) *
)
ÖÖ* +
;
ÖÖ+ ,
using
ÜÜ 
(
ÜÜ 
var
ÜÜ 
tokenStream
ÜÜ "
=
ÜÜ# $
analyzer
ÜÜ% -
.
ÜÜ- .
GetTokenStream
ÜÜ. <
(
ÜÜ< =
	fieldName
ÜÜ= F
,
ÜÜF G
text
ÜÜH L
)
ÜÜL M
)
ÜÜM N
{
áá 
tokenStream
àà 
.
àà 
Reset
àà !
(
àà! "
)
àà" #
;
àà# $
while
ââ 
(
ââ 
tokenStream
ââ "
.
ââ" #
IncrementToken
ââ# 1
(
ââ1 2
)
ââ2 3
)
ââ3 4
{
ää 
var
ãã 
termAttribute
ãã %
=
ãã& '
tokenStream
ãã( 3
.
ãã3 4
GetAttribute
ãã4 @
<
ãã@ A 
ICharTermAttribute
ããA S
>
ããS T
(
ããT U
)
ããU V
;
ããV W
if
çç 
(
çç 
termAttribute
çç %
!=
çç& (
null
çç) -
)
çç- .
{
éé 
result
èè 
.
èè 
Add
èè "
(
èè" #
termAttribute
èè# 0
.
èè0 1
ToString
èè1 9
(
èè9 :
)
èè: ;
)
èè; <
;
èè< =
}
êê 
}
ëë 
}
íí 
return
îî 
result
îî 
;
îî 
}
ïï 	
}
ññ 
}óó È,
ñD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\BooleanQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public 

class  
BooleanQueryProvider %
:& ' 
ILuceneQueryProvider( <
{ 
public		 
Query		 
CreateQuery		  
(		  !
ILuceneQueryService		! 4
builder		5 <
,		< =
LuceneQueryContext		> P
context		Q X
,		X Y
string		Z `
type		a e
,		e f
JObject		g n
query		o t
)		t u
{

 	
if 
( 
type 
!= 
$str 
) 
{ 
return 
null 
; 
} 
var 
	boolQuery 
= 
new 
BooleanQuery  ,
(, -
)- .
;. /
foreach 
( 
var 
property !
in" $
query% *
.* +

Properties+ 5
(5 6
)6 7
)7 8
{ 
var 
occur 
= 
Occur !
.! "
MUST" &
;& '
bool 
isProps 
= 
false $
;$ %
switch 
( 
property  
.  !
Name! %
.% &
ToLowerInvariant& 6
(6 7
)7 8
)8 9
{ 
case 
$str 
:  
occur 
= 
Occur  %
.% &
MUST& *
;* +
break 
; 
case 
$str "
:" #
case 
$str #
:# $
occur 
= 
Occur  %
.% &
MUST_NOT& .
;. /
break 
; 
case   
$str   !
:  ! "
occur!! 
=!! 
Occur!!  %
.!!% &
SHOULD!!& ,
;!!, -
break"" 
;"" 
case## 
$str##  
:##  !
	boolQuery$$ !
.$$! "
Boost$$" '
=$$( )
property$$* 2
.$$2 3
Value$$3 8
.$$8 9
Value$$9 >
<$$> ?
float$$? D
>$$D E
($$E F
)$$F G
;$$G H
isProps%% 
=%%  !
true%%" &
;%%& '
break&& 
;&& 
case'' 
$str'' /
:''/ 0
	boolQuery(( !
.((! "$
MinimumNumberShouldMatch((" :
=((; <
property((= E
.((E F
Value((F K
.((K L
Value((L Q
<((Q R
int((R U
>((U V
(((V W
)((W X
;((X Y
isProps)) 
=))  !
true))" &
;))& '
break** 
;** 
default++ 
:++ 
throw++ "
new++# &
ArgumentException++' 8
(++8 9
$"++9 ;
Invalid property '++; M
{++M N
property++N V
.++V W
Name++W [
}++[ \
' in boolean query++\ n
"++n o
)++o p
;++p q
},, 
if.. 
(.. 
!.. 
isProps.. 
).. 
{// 
switch00 
(00 
property00 $
.00$ %
Value00% *
.00* +
Type00+ /
)00/ 0
{11 
case22 

JTokenType22 '
.22' (
Object22( .
:22. /
	boolQuery33 %
.33% &
Add33& )
(33) *
builder33* 1
.331 2
CreateQueryFragment332 E
(33E F
context33F M
,33M N
(33O P
JObject33P W
)33W X
property33X `
.33` a
Value33a f
)33f g
,33g h
occur33i n
)33n o
;33o p
break44 !
;44! "
case55 

JTokenType55 '
.55' (
Array55( -
:55- .
foreach66 #
(66$ %
var66% (
item66) -
in66. 0
(661 2
(662 3
JArray663 9
)669 :
property66: B
.66B C
Value66C H
)66H I
)66I J
{77 
if88  "
(88# $
item88$ (
.88( )
Type88) -
!=88. 0

JTokenType881 ;
.88; <
Object88< B
)88B C
{99  !
throw::$ )
new::* -
ArgumentException::. ?
(::? @
$"::@ B*
Invalid value in boolean query::B `
"::` a
)::a b
;::b c
};;  !
	boolQuery<<  )
.<<) *
Add<<* -
(<<- .
builder<<. 5
.<<5 6
CreateQueryFragment<<6 I
(<<I J
context<<J Q
,<<Q R
(<<S T
JObject<<T [
)<<[ \
item<<\ `
)<<` a
,<<a b
occur<<c h
)<<h i
;<<i j
}== 
break>> !
;>>! "
default?? 
:??  
throw??! &
new??' *
ArgumentException??+ <
(??< =
$"??= ?*
Invalid value in boolean query??? ]
"??] ^
)??^ _
;??_ `
}@@ 
}AA 
}BB 
returnDD 
	boolQueryDD 
;DD 
}EE 	
}FF 
}GG ˛%
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\FuzzyQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{		 
public

 

class

 
FuzzyQueryProvider

 #
:

$ % 
ILuceneQueryProvider

& :
{ 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str 
)  
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
return 
new 

FuzzyQuery )
() *
new* -
Term. 2
(2 3
first3 8
.8 9
Name9 =
,= >
first? D
.D E
ValueE J
.J K
ToStringK S
(S T
)T U
)U V
)V W
;W X
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
if 
( 
! 
obj 
. 
TryGetValue (
(( )
$str) 0
,0 1
out2 5
var6 9
value: ?
)? @
)@ A
{ 
throw 
new !
ArgumentException" 3
(3 4
$str4 R
)R S
;S T
} 
obj!! 
.!! 
TryGetValue!! #
(!!# $
$str!!$ /
,!!/ 0
out!!1 4
var!!5 8
	fuzziness!!9 B
)!!B C
;!!C D
obj"" 
."" 
TryGetValue"" #
(""# $
$str""$ 3
,""3 4
out""5 8
var""9 <
prefixLength""= I
)""I J
;""J K
obj## 
.## 
TryGetValue## #
(### $
$str##$ 4
,##4 5
out##6 9
var##: =
maxExpansions##> K
)##K L
;##L M
var%% 

fuzzyQuery%% "
=%%# $
new%%% (

FuzzyQuery%%) 3
(%%3 4
new&& 
Term&&  
(&&  !
first&&! &
.&&& '
Name&&' +
,&&+ ,
value&&- 2
.&&2 3
Value&&3 8
<&&8 9
string&&9 ?
>&&? @
(&&@ A
)&&A B
)&&B C
,&&C D
	fuzziness'' !
?''! "
.''" #
Value''# (
<''( )
int'') ,
>'', -
(''- .
)''. /
??''0 2
LevenshteinAutomata''3 F
.''F G&
MAXIMUM_SUPPORTED_DISTANCE''G a
,''a b
prefixLength(( $
?(($ %
.((% &
Value((& +
<((+ ,
int((, /
>((/ 0
(((0 1
)((1 2
??((3 5
$num((6 7
,((7 8
maxExpansions)) %
?))% &
.))& '
Value))' ,
<)), -
int))- 0
>))0 1
())1 2
)))2 3
??))4 6
$num))7 9
,))9 :
true** 
)** 
;** 
if,, 
(,, 
obj,, 
.,, 
TryGetValue,, '
(,,' (
$str,,( /
,,,/ 0
out,,1 4
var,,5 8
boost,,9 >
),,> ?
),,? @
{-- 

fuzzyQuery.. "
..." #
Boost..# (
=..) *
boost..+ 0
...0 1
Value..1 6
<..6 7
float..7 <
>..< =
(..= >
)..> ?
;..? @
}// 
return11 

fuzzyQuery11 %
;11% &
default22 
:22 
throw22 
new22 "
ArgumentException22# 4
(224 5
$str225 J
)22J K
;22K L
}33 
}44 	
}55 
}66 ê
óD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\MatchAllQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public 

class !
MatchAllQueryProvider &
:' ( 
ILuceneQueryProvider) =
{ 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{		 	
if

 
(

 
type

 
!=

 
$str

 #
)

# $
{ 
return 
null 
; 
} 
var 
matchAllQuery 
= 
new  #
MatchAllDocsQuery$ 5
(5 6
)6 7
;7 8
if 
( 
query 
. 
TryGetValue !
(! "
$str" )
,) *
out+ .
var/ 2
boost3 8
)8 9
)9 :
{ 
matchAllQuery 
. 
Boost #
=$ %
boost& +
.+ ,
Value, 1
<1 2
float2 7
>7 8
(8 9
)9 :
;: ;
} 
return 
matchAllQuery  
;  !
} 	
} 
} ›
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\MatchPhraseQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 $
MatchPhraseQueryProvider		 )
:		* + 
ILuceneQueryProvider		, @
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str &
)& '
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
var 
phraseQuery 
= 
new !
PhraseQuery" -
(- .
). /
;/ 0
JToken 
value 
; 
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
value 
= 
first !
.! "
Value" '
;' (
break 
; 
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
if 
( 
! 
obj 
. 
TryGetValue (
(( )
$str) 0
,0 1
out2 5
value6 ;
); <
)< =
{   
throw!! 
new!! !
ArgumentException!!" 3
(!!3 4
$str!!4 Y
)!!Y Z
;!!Z [
}"" 
if&& 
(&& 
obj&& 
.&& 
TryGetValue&& '
(&&' (
$str&&( .
,&&. /
out&&0 3
var&&4 7
slop&&8 <
)&&< =
)&&= >
{'' 
phraseQuery(( #
.((# $
Slop(($ (
=(() *
slop((+ /
.((/ 0
Value((0 5
<((5 6
int((6 9
>((9 :
(((: ;
)((; <
;((< =
})) 
break++ 
;++ 
default,, 
:,, 
throw,, 
new,, "
ArgumentException,,# 4
(,,4 5
$str,,5 M
),,M N
;,,N O
}-- 
foreach// 
(// 
var// 
term// 
in//  
LuceneQueryService//! 3
.//3 4
Tokenize//4 <
(//< =
first//= B
.//B C
Name//C G
,//G H
value//I N
.//N O
Value//O T
<//T U
string//U [
>//[ \
(//\ ]
)//] ^
,//^ _
context//` g
.//g h
DefaultAnalyzer//h w
)//w x
)//x y
{00 
phraseQuery11 
.11 
Add11 
(11  
new11  #
Term11$ (
(11( )
first11) .
.11. /
Name11/ 3
,113 4
term115 9
)119 :
)11: ;
;11; <
}22 
return44 
phraseQuery44 
;44 
}55 	
}66 
}77  /
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\MatchQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 
MatchQueryProvider		 #
:		$ % 
ILuceneQueryProvider		& :
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str 
)  
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
var 
	boolQuery 
= 
new 
BooleanQuery  ,
(, -
)- .
;. /
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
foreach 
( 
var  
term! %
in& (
LuceneQueryService) ;
.; <
Tokenize< D
(D E
firstE J
.J K
NameK O
,O P
firstQ V
.V W
ValueW \
.\ ]
ToString] e
(e f
)f g
,g h
contexti p
.p q
DefaultAnalyzer	q Ä
)
Ä Å
)
Å Ç
{ 
	boolQuery !
.! "
Add" %
(% &
new& )
	TermQuery* 3
(3 4
new4 7
Term8 <
(< =
first= B
.B C
NameC G
,G H
termI M
)M N
)N O
,O P
OccurQ V
.V W
SHOULDW ]
)] ^
;^ _
} 
return 
	boolQuery $
;$ %
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
var   
value   
=   
obj    #
.  # $
Property  $ ,
(  , -
$str  - 4
)  4 5
?  5 6
.  6 7
Value  7 <
.  < =
Value  = B
<  B C
string  C I
>  I J
(  J K
)  K L
;  L M
if"" 
("" 
obj"" 
."" 
TryGetValue"" '
(""' (
$str""( /
,""/ 0
out""1 4
var""5 8
boost""9 >
)""> ?
)""? @
{## 
	boolQuery$$ !
.$$! "
Boost$$" '
=$$( )
boost$$* /
.$$/ 0
Value$$0 5
<$$5 6
float$$6 ;
>$$; <
($$< =
)$$= >
;$$> ?
}%% 
var'' 
occur'' 
='' 
Occur''  %
.''% &
SHOULD''& ,
;'', -
if(( 
((( 
obj(( 
.(( 
TryGetValue(( '
(((' (
$str((( 2
,((2 3
out((4 7
var((8 ;
op((< >
)((> ?
)((? @
{)) 
occur** 
=** 
op**  "
.**" #
ToString**# +
(**+ ,
)**, -
==**. 0
$str**1 6
?**7 8
Occur**9 >
.**> ?
MUST**? C
:**D E
Occur**F K
.**K L
SHOULD**L R
;**R S
}++ 
var-- 
terms-- 
=-- 
LuceneQueryService--  2
.--2 3
Tokenize--3 ;
(--; <
first--< A
.--A B
Name--B F
,--F G
value--H M
,--M N
context--O V
.--V W
DefaultAnalyzer--W f
)--f g
;--g h
if// 
(// 
!// 
terms// 
.// 
Any// "
(//" #
)//# $
)//$ %
{00 
if11 
(11 
obj11 
.11  
TryGetValue11  +
(11+ ,
$str11, >
,11> ?
out11@ C
var11D G
zeroTermsQuery11H V
)11V W
)11W X
{22 
if33 
(33  
zeroTermsQuery33  .
.33. /
ToString33/ 7
(337 8
)338 9
==33: <
$str33= B
)33B C
{44 
return55  &
new55' *
MatchAllDocsQuery55+ <
(55< =
)55= >
;55> ?
}66 
}77 
}88 
foreach:: 
(:: 
var::  
term::! %
in::& (
terms::) .
)::. /
{;; 
	boolQuery<< !
.<<! "
Add<<" %
(<<% &
new<<& )
	TermQuery<<* 3
(<<3 4
new<<4 7
Term<<8 <
(<<< =
first<<= B
.<<B C
Name<<C G
,<<G H
term<<I M
)<<M N
)<<N O
,<<O P
occur<<Q V
)<<V W
;<<W X
}== 
return?? 
	boolQuery?? $
;??$ %
default@@ 
:@@ 
throw@@ 
new@@ "
ArgumentException@@# 4
(@@4 5
$str@@5 D
)@@D E
;@@E F
}AA 
}BB 	
}CC 
}DD Ö"
ïD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\PrefixQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 
PrefixQueryProvider		 $
:		% & 
ILuceneQueryProvider		' ;
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str  
)  !
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
return 
new 
PrefixQuery *
(* +
new+ .
Term/ 3
(3 4
first4 9
.9 :
Name: >
,> ?
first@ E
.E F
ValueF K
.K L
ToStringL T
(T U
)U V
)V W
)W X
;X Y
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
PrefixQuery 
prefixQuery  +
=, -
null. 2
;2 3
if 
( 
obj 
. 
TryGetValue '
(' (
$str( /
,/ 0
out1 4
var5 8
value9 >
)> ?
)? @
{ 
prefixQuery   #
=  $ %
new  & )
PrefixQuery  * 5
(  5 6
new  6 9
Term  : >
(  > ?
first  ? D
.  D E
Name  E I
,  I J
value  K P
.  P Q
Value  Q V
<  V W
string  W ]
>  ] ^
(  ^ _
)  _ `
)  ` a
)  a b
;  b c
}!! 
else"" 
if"" 
("" 
obj""  
.""  !
TryGetValue""! ,
("", -
$str""- 5
,""5 6
out""7 :
var""; >
prefix""? E
)""E F
)""F G
{## 
prefixQuery$$ #
=$$$ %
new$$& )
PrefixQuery$$* 5
($$5 6
new$$6 9
Term$$: >
($$> ?
first$$? D
.$$D E
Name$$E I
,$$I J
prefix$$K Q
.$$Q R
Value$$R W
<$$W X
string$$X ^
>$$^ _
($$_ `
)$$` a
)$$a b
)$$b c
;$$c d
}%% 
else&& 
{'' 
throw(( 
new(( !
ArgumentException((" 3
(((3 4
$str((4 V
)((V W
;((W X
})) 
if++ 
(++ 
obj++ 
.++ 
TryGetValue++ '
(++' (
$str++( /
,++/ 0
out++1 4
var++5 8
boost++9 >
)++> ?
)++? @
{,, 
prefixQuery-- #
.--# $
Boost--$ )
=--* +
boost--, 1
.--1 2
Value--2 7
<--7 8
float--8 =
>--= >
(--> ?
)--? @
;--@ A
}.. 
return00 
prefixQuery00 &
;00& '
default11 
:11 
throw11 
new11 "
ArgumentException11# 4
(114 5
$str115 K
)11K L
;11L M
}22 
}33 	
}44 
}55 ’
öD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\QueryStringQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public 

class $
QueryStringQueryProvider )
:* + 
ILuceneQueryProvider, @
{ 
public		 
Query		 
CreateQuery		  
(		  !
ILuceneQueryService		! 4
builder		5 <
,		< =
LuceneQueryContext		> P
context		Q X
,		X Y
string		Z `
type		a e
,		e f
JObject		g n
query		o t
)		t u
{

 	
if 
( 
type 
!= 
$str &
)& '
{ 
return 
null 
; 
} 
var 
queryString 
= 
query #
[# $
$str$ +
]+ ,
?, -
.- .
Value. 3
<3 4
string4 :
>: ;
(; <
)< =
;= >
var 
defaultField 
= 
query $
[$ %
$str% 4
]4 5
?5 6
.6 7
Value7 <
<< =
string= C
>C D
(D E
)E F
;F G
var 
queryParser 
= 
new !
QueryParser" -
(- .
context. 5
.5 6
DefaultVersion6 D
,D E
$strF H
,H I
contextJ Q
.Q R
DefaultAnalyzerR a
)a b
;b c
return 
queryParser 
. 
Parse $
($ %
queryString% 0
)0 1
;1 2
} 	
} 
} ÖA
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\RangeQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public 

class 
RangeQueryProvider #
:$ % 
ILuceneQueryProvider& :
{		 
public

 
Query

 
CreateQuery

  
(

  !
ILuceneQueryService

! 4
builder

5 <
,

< =
LuceneQueryContext

> P
context

Q X
,

X Y
string

Z `
type

a e
,

e f
JObject

g n
query

o t
)

t u
{ 	
if 
( 
type 
!= 
$str 
)  
{ 
return 
null 
; 
} 
var 
range 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
Query 

rangeQuery 
; 
switch 
( 
range 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
Object  &
:& '
var 
field 
= 
range  %
.% &
Name& *
;* +
JToken 
gt 
= 
null  $
;$ %
JToken 
lt 
= 
null  $
;$ %
var 
	tokenType !
=" #

JTokenType$ .
.. /
None/ 3
;3 4
float 
? 
boost  
=! "
null# '
;' (
bool 
includeLower %
=& '
false( -
,- .
includeUpper/ ;
=< =
false> C
;C D
foreach   
(   
var    
element  ! (
in  ) +
(  , -
(  - .
JObject  . 5
)  5 6
range  6 ;
.  ; <
Value  < A
)  A B
.  B C

Properties  C M
(  M N
)  N O
)  O P
{!! 
switch"" 
(""  
element""  '
.""' (
Name""( ,
."", -
ToLowerInvariant""- =
(""= >
)""> ?
)""? @
{## 
case$$  
$str$$! %
:$$% &
gt%%  "
=%%# $
element%%% ,
.%%, -
Value%%- 2
;%%2 3
	tokenType&&  )
=&&* +
gt&&, .
.&&. /
Type&&/ 3
;&&3 4
break''  %
;''% &
case((  
$str((! &
:((& '
gt))  "
=))# $
element))% ,
.)), -
Value))- 2
;))2 3
	tokenType**  )
=*** +
gt**, .
.**. /
Type**/ 3
;**3 4
includeLower++  ,
=++- .
true++/ 3
;++3 4
break,,  %
;,,% &
case--  
$str--! %
:--% &
lt..  "
=..# $
element..% ,
..., -
Value..- 2
;..2 3
	tokenType//  )
=//* +
lt//, .
.//. /
Type/// 3
;//3 4
break00  %
;00% &
case11  
$str11! &
:11& '
lt22  "
=22# $
element22% ,
.22, -
Value22- 2
;222 3
	tokenType33  )
=33* +
lt33, .
.33. /
Type33/ 3
;333 4
includeUpper44  ,
=44- .
true44/ 3
;443 4
break55  %
;55% &
case66  
$str66! (
:66( )
boost77  %
=77& '
element77( /
.77/ 0
Value770 5
.775 6
Value776 ;
<77; <
float77< A
>77A B
(77B C
)77C D
;77D E
break88  %
;88% &
}99 
}:: 
if<< 
(<< 
gt<< 
!=<< 
null<< "
&&<<# %
lt<<& (
!=<<) +
null<<, 0
&&<<1 3
gt<<4 6
.<<6 7
Type<<7 ;
!=<<< >
lt<<? A
.<<A B
Type<<B F
)<<F G
{== 
throw>> 
new>> !
ArgumentException>>" 3
(>>3 4
$str>>4 c
)>>c d
;>>d e
}?? 
switchAA 
(AA 
	tokenTypeAA %
)AA% &
{BB 
caseCC 

JTokenTypeCC '
.CC' (
IntegerCC( /
:CC/ 0
varDD 
minIntDD  &
=DD' (
gtDD) +
?DD+ ,
.DD, -
ValueDD- 2
<DD2 3
longDD3 7
>DD7 8
(DD8 9
)DD9 :
;DD: ;
varEE 
maxIntEE  &
=EE' (
ltEE) +
?EE+ ,
.EE, -
ValueEE- 2
<EE2 3
longEE3 7
>EE7 8
(EE8 9
)EE9 :
;EE: ;

rangeQueryFF &
=FF' (
NumericRangeQueryFF) :
.FF: ;
NewInt64RangeFF; H
(FFH I
fieldFFI N
,FFN O
minIntFFP V
,FFV W
maxIntFFX ^
,FF^ _
includeLowerFF` l
,FFl m
includeUpperFFn z
)FFz {
;FF{ |
breakGG !
;GG! "
caseHH 

JTokenTypeHH '
.HH' (
FloatHH( -
:HH- .
varII 
minFloatII  (
=II) *
gtII+ -
?II- .
.II. /
ValueII/ 4
<II4 5
doubleII5 ;
>II; <
(II< =
)II= >
;II> ?
varJJ 
maxFloatJJ  (
=JJ) *
ltJJ+ -
?JJ- .
.JJ. /
ValueJJ/ 4
<JJ4 5
doubleJJ5 ;
>JJ; <
(JJ< =
)JJ= >
;JJ> ?

rangeQueryKK &
=KK' (
NumericRangeQueryKK) :
.KK: ;
NewDoubleRangeKK; I
(KKI J
fieldKKJ O
,KKO P
minFloatKKQ Y
,KKY Z
maxFloatKK[ c
,KKc d
includeLowerKKe q
,KKq r
includeUpperKKs 
)	KK Ä
;
KKÄ Å
breakLL !
;LL! "
caseMM 

JTokenTypeMM '
.MM' (
StringMM( .
:MM. /
varNN 
	minStringNN  )
=NN* +
gtNN, .
?NN. /
.NN/ 0
ValueNN0 5
<NN5 6
stringNN6 <
>NN< =
(NN= >
)NN> ?
;NN? @
varOO 
	maxStringOO  )
=OO* +
ltOO, .
?OO. /
.OO/ 0
ValueOO0 5
<OO5 6
stringOO6 <
>OO< =
(OO= >
)OO> ?
;OO? @

rangeQueryPP &
=PP' (
TermRangeQueryPP) 7
.PP7 8
NewStringRangePP8 F
(PPF G
fieldPPG L
,PPL M
	minStringPPN W
,PPW X
	maxStringPPY b
,PPb c
includeLowerPPd p
,PPp q
includeUpperPPr ~
)PP~ 
;	PP Ä
breakQQ !
;QQ! "
defaultRR 
:RR  
throwRR! &
newRR' *
ArgumentExceptionRR+ <
(RR< =
$"RR= ?*
Unsupported range value type: RR? ]
{RR] ^
typeRR^ b
}RRb c
"RRc d
)RRd e
;RRe f
}SS 
ifUU 
(UU 
boostUU 
!=UU  
nullUU! %
)UU% &
{VV 

rangeQueryWW "
.WW" #
BoostWW# (
=WW) *
boostWW+ 0
.WW0 1
ValueWW1 6
;WW6 7
}XX 
returnZZ 

rangeQueryZZ %
;ZZ% &
default[[ 
:[[ 
throw[[ 
new[[ "
ArgumentException[[# 4
([[4 5
$str[[5 J
)[[J K
;[[K L
}\\ 
}]] 	
}^^ 
}__ ˛
ïD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\RegexpQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 
RegexpQueryProvider		 $
:		% & 
ILuceneQueryProvider		' ;
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str  
)  !
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
return 
new 
RegexpQuery *
(* +
new+ .
Term/ 3
(3 4
first4 9
.9 :
Name: >
,> ?
first@ E
.E F
ValueF K
.K L
ToStringL T
(T U
)U V
)V W
)W X
;X Y
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
if 
( 
! 
obj 
. 
TryGetValue (
(( )
$str) 0
,0 1
out2 5
var6 9
value: ?
)? @
)@ A
{ 
throw 
new !
ArgumentException" 3
(3 4
$str4 S
)S T
;T U
} 
var"" 
regexpQuery"" #
=""$ %
new""& )
RegexpQuery""* 5
(""5 6
new""6 9
Term"": >
(""> ?
first""? D
.""D E
Name""E I
,""I J
value""K P
.""P Q
Value""Q V
<""V W
string""W ]
>""] ^
(""^ _
)""_ `
)""` a
)""a b
;""b c
if$$ 
($$ 
obj$$ 
.$$ 
TryGetValue$$ '
($$' (
$str$$( /
,$$/ 0
out$$1 4
var$$5 8
boost$$9 >
)$$> ?
)$$? @
{%% 
regexpQuery&& #
.&&# $
Boost&&$ )
=&&* +
boost&&, 1
.&&1 2
Value&&2 7
<&&7 8
float&&8 =
>&&= >
(&&> ?
)&&? @
;&&@ A
}'' 
return)) 
regexpQuery)) &
;))& '
default** 
:** 
throw** 
new** "
ArgumentException**# 4
(**4 5
$str**5 K
)**K L
;**L M
}++ 
},, 	
}-- 
}.. ˛"
†D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\SimpleQueryStringQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 *
SimpleQueryStringQueryProvider		 /
:		0 1 
ILuceneQueryProvider		2 F
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str -
)- .
{ 
return 
null 
; 
} 
var 
queryString 
= 
query #
[# $
$str$ +
]+ ,
?, -
.- .
Value. 3
<3 4
string4 :
>: ;
(; <
)< =
;= >
var 
fields 
= 
query 
[ 
$str '
]' (
?( )
.) *
Values* 0
<0 1
string1 7
>7 8
(8 9
)9 :
??; =
new> A
stringB H
[H I
$numI J
]J K
;K L
var 
defaultOperator 
=  !
query" '
[' (
$str( :
]: ;
?; <
.< =
Value= B
<B C
stringC I
>I J
(J K
)K L
.L M
ToLowerInvariantM ]
(] ^
)^ _
??` b
$strc g
;g h
var 
weight 
= 
$num 
; 
var 
weights 
= 
fields  
.  !
ToDictionary! -
(- .
field. 3
=>4 6
field7 <
,< =
field> C
=>D F
weightG M
)M N
;N O
foreach 
( 
var 
field 
in  
fields! '
)' (
{ 
var 
fieldWeightArray $
=% &
field' ,
., -
Split- 2
(2 3
$char3 6
,6 7
$num8 9
)9 :
;: ;
if 
( 
fieldWeightArray #
.# $
Length$ *
>+ ,
$num- .
&&/ 1
Single2 8
.8 9
TryParse9 A
(A B
fieldWeightArrayB R
[R S
$numS T
]T U
,U V
outW Z
weight[ a
)a b
)b c
{ 
weights 
. 
Remove "
(" #
field# (
)( )
;) *
weights 
. 
Add 
(  
fieldWeightArray  0
[0 1
$num1 2
]2 3
,3 4
weight5 ;
); <
;< =
}   
}!! 
var## 
queryParser## 
=## 
new## !
SimpleQueryParser##" 3
(##3 4
context##4 ;
.##; <
DefaultAnalyzer##< K
,##K L
weights##M T
)##T U
;##U V
switch$$ 
($$ 
defaultOperator$$ #
)$$# $
{%% 
case&& 
$str&& 
:&& 
queryParser'' 
.''  
DefaultOperator''  /
=''0 1
Occur''2 7
.''7 8
MUST''8 <
;''< =
break(( 
;(( 
case)) 
$str)) 
:)) 
queryParser** 
.**  
DefaultOperator**  /
=**0 1
Occur**2 7
.**7 8
SHOULD**8 >
;**> ?
break++ 
;++ 
},, 
return-- 
queryParser-- 
.-- 
Parse-- $
(--$ %
queryString--% 0
)--0 1
;--1 2
}.. 	
}// 
}00 ∞
ìD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\TermQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 
TermQueryProvider		 "
:		# $ 
ILuceneQueryProvider		% 9
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str 
) 
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
return 
new 
	TermQuery (
(( )
new) ,
Term- 1
(1 2
first2 7
.7 8
Name8 <
,< =
first> C
.C D
ValueD I
.I J
ToStringJ R
(R S
)S T
)T U
)U V
;V W
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
var 
value 
= 
obj  #
.# $
Property$ ,
(, -
$str- 4
)4 5
.5 6
Value6 ;
.; <
Value< A
<A B
stringB H
>H I
(I J
)J K
;K L
var 
	termQuery !
=" #
new$ '
	TermQuery( 1
(1 2
new2 5
Term6 :
(: ;
first; @
.@ A
NameA E
,E F
valueG L
)L M
)M N
;N O
if 
( 
obj 
. 
TryGetValue '
(' (
$str( /
,/ 0
out1 4
var5 8
boost9 >
)> ?
)? @
{   
	termQuery!! !
.!!! "
Boost!!" '
=!!( )
boost!!* /
.!!/ 0
Value!!0 5
<!!5 6
float!!6 ;
>!!; <
(!!< =
)!!= >
;!!> ?
}"" 
return$$ 
	termQuery$$ $
;$$$ %
default%% 
:%% 
throw%% 
new%% "
ArgumentException%%# 4
(%%4 5
$str%%5 I
)%%I J
;%%J K
}&& 
}'' 	
}(( 
})) ˚
îD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\TermsQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 
TermsQueryProvider		 #
:		$ % 
ILuceneQueryProvider		& :
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str 
)  
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
var 
field 
= 
first 
. 
Name "
;" #
var 
	boolQuery 
= 
new 
BooleanQuery  ,
(, -
)- .
;. /
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
Array  %
:% &
foreach 
( 
var  
item! %
in& (
() *
(* +
JArray+ 1
)1 2
first2 7
.7 8
Value8 =
)= >
)> ?
{ 
if 
( 
item  
.  !
Type! %
!=& (

JTokenType) 3
.3 4
String4 :
): ;
{ 
throw !
new" %
ArgumentException& 7
(7 8
$"8 :'
Invalid term in terms query: U
"U V
)V W
;W X
}   
	boolQuery"" !
.""! "
Add""" %
(""% &
new""& )
	TermQuery""* 3
(""3 4
new""4 7
Term""8 <
(""< =
field""= B
,""B C
item""D H
.""H I
Value""I N
<""N O
string""O U
>""U V
(""V W
)""W X
)""X Y
)""Y Z
,""Z [
Occur""\ a
.""a b
SHOULD""b h
)""h i
;""i j
}## 
break%% 
;%% 
case&& 

JTokenType&& 
.&&  
Object&&  &
:&&& '
throw'' 
new'' 
ArgumentException'' /
(''/ 0
$str''0 Y
)''Y Z
;''Z [
default(( 
:(( 
throw(( 
new(( "
ArgumentException((# 4
(((4 5
$str((5 J
)((J K
;((K L
})) 
return++ 
	boolQuery++ 
;++ 
},, 	
}-- 
}.. å
óD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\QueryProviders\WildcardQueryProvider.cs
	namespace 	
OrchardCore
 
. 
Lucene 
. 
QueryProviders +
{ 
public		 

class		 !
WildcardQueryProvider		 &
:		' ( 
ILuceneQueryProvider		) =
{

 
public 
Query 
CreateQuery  
(  !
ILuceneQueryService! 4
builder5 <
,< =
LuceneQueryContext> P
contextQ X
,X Y
stringZ `
typea e
,e f
JObjectg n
queryo t
)t u
{ 	
if 
( 
type 
!= 
$str "
)" #
{ 
return 
null 
; 
} 
var 
first 
= 
query 
. 

Properties (
(( )
)) *
.* +
First+ 0
(0 1
)1 2
;2 3
switch 
( 
first 
. 
Value 
.  
Type  $
)$ %
{ 
case 

JTokenType 
.  
String  &
:& '
return 
new 
WildcardQuery ,
(, -
new- 0
Term1 5
(5 6
first6 ;
.; <
Name< @
,@ A
firstB G
.G H
ValueH M
.M N
ToStringN V
(V W
)W X
)X Y
)Y Z
;Z [
case 

JTokenType 
.  
Object  &
:& '
var 
obj 
= 
( 
JObject &
)& '
first' ,
., -
Value- 2
;2 3
if 
( 
! 
obj 
. 
TryGetValue (
(( )
$str) 0
,0 1
out2 5
var6 9
value: ?
)? @
)@ A
{ 
throw 
new !
ArgumentException" 3
(3 4
$str4 U
)U V
;V W
} 
var   
wildCardQuery   %
=  & '
new  ( +
WildcardQuery  , 9
(  9 :
new  : =
Term  > B
(  B C
first  C H
.  H I
Name  I M
,  M N
value  O T
.  T U
Value  U Z
<  Z [
string  [ a
>  a b
(  b c
)  c d
)  d e
)  e f
;  f g
if"" 
("" 
obj"" 
."" 
TryGetValue"" '
(""' (
$str""( /
,""/ 0
out""1 4
var""5 8
boost""9 >
)""> ?
)""? @
{## 
wildCardQuery$$ %
.$$% &
Boost$$& +
=$$, -
boost$$. 3
.$$3 4
Value$$4 9
<$$9 :
float$$: ?
>$$? @
($$@ A
)$$A B
;$$B C
}%% 
return'' 
wildCardQuery'' (
;''( )
default(( 
:(( 
throw(( 
new(( "
ArgumentException((# 4
(((4 5
$str((5 M
)((M N
;((N O
})) 
}** 	
}++ 
},, ∏
éD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\OrchardCore\src\OrchardCore\OrchardCore.Lucene.Core\ServiceCollectionExtensions.cs
	namespace 	
OrchardCore
 
. 
Lucene 
{ 
public 

static 
class '
ServiceCollectionExtensions 3
{ 
public 
static 
IServiceCollection (
AddLuceneQueries) 9
(9 :
this: >
IServiceCollection? Q
servicesR Z
)Z [
{ 	
services 
. 
	AddScoped 
< 
ILuceneQueryService 2
,2 3
LuceneQueryService4 F
>F G
(G H
)H I
;I J
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7 
BooleanQueryProvider8 L
>L M
(M N
)N O
;O P
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
FuzzyQueryProvider8 J
>J K
(K L
)L M
;M N
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
MatchQueryProvider8 J
>J K
(K L
)L M
;M N
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7!
MatchAllQueryProvider8 M
>M N
(N O
)O P
;P Q
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7$
MatchPhraseQueryProvider8 P
>P Q
(Q R
)R S
;S T
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7$
QueryStringQueryProvider8 P
>P Q
(Q R
)R S
;S T
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
PrefixQueryProvider8 K
>K L
(L M
)M N
;N O
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
RangeQueryProvider8 J
>J K
(K L
)L M
;M N
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
RegexpQueryProvider8 K
>K L
(L M
)M N
;N O
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7*
SimpleQueryStringQueryProvider8 V
>V W
(W X
)X Y
;Y Z
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
TermQueryProvider8 I
>I J
(J K
)K L
;L M
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7
TermsQueryProvider8 J
>J K
(K L
)L M
;M N
services 
. 
AddSingleton !
<! " 
ILuceneQueryProvider" 6
,6 7!
WildcardQueryProvider8 M
>M N
(N O
)O P
;P Q
return 
services 
; 
} 	
} 
} 